{"This file extracts credentials from LSASS similar to Mimikatz.": [["OS Credential Dumping", 0.46898701912653834], ["Unsecured Credentials", 0.23003611792612724], ["Credentials from Password Stores", 0.13829233284932033], ["Input Capture", 0.015705900070532845], ["Brute Force", 0.011163934752018092], ["Network Sniffing", 0.008556450992769664]], "It calls OpenProcess on lsass.exe with access flag set to VM_READ, and looks for the modules wdigest.dll and lsasrv.dll loaded in the lsass.exe process.": [["Native API", 0.3104380069859016], ["Process Injection", 0.08769741283842547], ["Virtualization/Sandbox Evasion", 0.07402397326040742], ["File and Directory Discovery", 0.06745753599301789], ["Process Discovery", 0.05466114743144667], ["Windows Management Instrumentation", 0.03734578481468307]], "It spreads to Microsoft Windows machines using several propagation methods, including the EternalBlue exploit for the CVE-2017-0144 vulnerability in the SMB service.": [["Exploitation of Remote Services", 0.23572567543548742], ["Taint Shared Content", 0.09850123094504444], ["Software Deployment Tools", 0.06140779513661767], ["Lateral Tool Transfer", 0.05302078024110254], ["Remote Services", 0.05042903889045201], ["Exploitation for Client Execution", 0.03551358625716763]], "SMB exploitation via EternalBlue": [["Exploitation of Remote Services", 0.2467028687694483], ["Remote Services", 0.18435225903021196], ["Lateral Tool Transfer", 0.16295945275926324], ["Taint Shared Content", 0.04683836982086719], ["Network Share Discovery", 0.04118739353895963], ["Data from Network Shared Drive", 0.013503034041422005]], "SMBv1 Exploitation via EternalBlue": [["Exploitation of Remote Services", 0.43153527707868006], ["Remote Services", 0.07977012997529083], ["Lateral Tool Transfer", 0.0500050080744555], ["Event Triggered Execution", 0.0262847497847431], ["Taint Shared Content", 0.020204902037722378], ["System Services", 0.013666592648529246]], "has the capability to exploit SMBv1 via the well known EternalBlue exploit.": [["Exploitation of Remote Services", 0.5897823111037485], ["Exploitation for Client Execution", 0.03842905423481796], ["Remote Services", 0.03229170390568287], ["Exploitation for Privilege Escalation", 0.027951203523076455], ["Lateral Tool Transfer", 0.016680811446302454], ["Network Service Discovery", 0.012519033850327857]], "SMB copy and remote execution": [["Lateral Tool Transfer", 0.40205572845680776], ["Remote Services", 0.2923427280618695], ["Taint Shared Content", 0.06512903820378713], ["Exploitation of Remote Services", 0.02778865213539636], ["Network Share Discovery", 0.02019525739818372], ["Data from Network Shared Drive", 0.016955132844719938]], "This thread is then used to execute the SMB copy and remote execution": [["Remote Services", 0.3497241012623821], ["Lateral Tool Transfer", 0.24045589914740956], ["Exploitation of Remote Services", 0.03528810143064825], ["Taint Shared Content", 0.029264972723632963], ["Network Share Discovery", 0.02217520016785497], ["Data from Network Shared Drive", 0.02109853237710432]], "SMB Copy and Remote Execution": [["Lateral Tool Transfer", 0.40205572845680776], ["Remote Services", 0.2923427280618695], ["Taint Shared Content", 0.06512903820378713], ["Exploitation of Remote Services", 0.02778865213539636], ["Network Share Discovery", 0.02019525739818372], ["Data from Network Shared Drive", 0.016955132844719938]], "The malware decompresses its resource named": [["Deobfuscate/Decode Files or Information", 0.34967505652136266], ["Archive Collected Data", 0.1586265832440445], ["Obfuscated Files or Information", 0.10602360307582578], ["Indicator Removal", 0.027301423660916983], ["Hide Artifacts", 0.026693726498589643], ["Masquerading", 0.021924621967159885]], "The malware decompresses a resource": [["Deobfuscate/Decode Files or Information", 0.3858341472747533], ["Archive Collected Data", 0.1590317626885921], ["Obfuscated Files or Information", 0.09843060106377849], ["Indicator Removal", 0.02069133918913221], ["Hide Artifacts", 0.01867331052306823], ["Masquerading", 0.013220521061604693]], "This is used as an integrity check for the decryption process.": [["Deobfuscate/Decode Files or Information", 0.39974382210914705], ["Obfuscated Files or Information", 0.11125546900831008], ["Data Encrypted for Impact", 0.07855036943205947], ["Execution Guardrails", 0.05165787089199712], ["Archive Collected Data", 0.031861817020918684], ["Encrypted Channel", 0.028517103764295178]], "decrypt the MFT,": [["Deobfuscate/Decode Files or Information", 0.36800774847460327], ["Data Encrypted for Impact", 0.12569933218770157], ["Weaken Encryption", 0.061746529718141416], ["Obfuscated Files or Information", 0.04161111596824174], ["Archive Collected Data", 0.030524498367264275], ["Execution Guardrails", 0.024110835024722017]], "the code attempts to decrypt the contents": [["Deobfuscate/Decode Files or Information", 0.6286713197088972], ["Obfuscated Files or Information", 0.10628891480307379], ["Data Encrypted for Impact", 0.054079783998941984], ["Archive Collected Data", 0.0394900660135492], ["Encrypted Channel", 0.0330864050797977], ["Weaken Encryption", 0.01466300557821535]], "Once the sector is decrypted,": [["Deobfuscate/Decode Files or Information", 0.21437585543792398], ["Data Encrypted for Impact", 0.20353544746632707], ["Weaken Encryption", 0.0621402360269533], ["Archive Collected Data", 0.046387114596227054], ["Disk Wipe", 0.03144311305013328], ["Execution Guardrails", 0.02444222857736959]], "and the same key is used to decrypt the MFT.": [["Weaken Encryption", 0.14031714413814314], ["Data Encrypted for Impact", 0.13237722689295328], ["Deobfuscate/Decode Files or Information", 0.11968574250284884], ["Execution Guardrails", 0.06571901281470911], ["Encrypted Channel", 0.027166322544556466], ["Obfuscated Files or Information", 0.01910049689745793]], "is also decoded, and placed back": [["Deobfuscate/Decode Files or Information", 0.3850217736567635], ["Obfuscated Files or Information", 0.10203212767390461], ["Archive Collected Data", 0.0875915546332504], ["Data Encoding", 0.06585161351830723], ["Exfiltration Over Alternative Protocol", 0.023499204233341425], ["Encrypted Channel", 0.020521127295633115]], "its resource section are decompressed and written to disk": [["Archive Collected Data", 0.2900606558429368], ["Deobfuscate/Decode Files or Information", 0.08409890552481859], ["Data Staged", 0.048357585271264485], ["Hide Artifacts", 0.0343252669444617], ["Indicator Removal", 0.03317010876382794], ["Data from Local System", 0.03160601716562045]], "The malware is a DLL that is launched using rundll32.exe:": [["System Binary Proxy Execution", 0.3367348476347997], ["Hijack Execution Flow", 0.15142974235815979], ["Native API", 0.0786296801878001], ["Process Injection", 0.07418071321914589], ["Masquerading", 0.049150743796396355], ["Event Triggered Execution", 0.030601565752734095]], "being invoked by rundll32.exe.": [["Native API", 0.286318099639858], ["System Binary Proxy Execution", 0.26021632327553257], ["Hijack Execution Flow", 0.04912902347225969], ["Process Injection", 0.04319111040243018], ["Masquerading", 0.03495982534248346], ["Windows Management Instrumentation", 0.030056390545210587]], "Command Line Execution": [["Command and Scripting Interpreter", 0.6612502133751166], ["System Binary Proxy Execution", 0.05316754020342919], ["Indirect Command Execution", 0.03899269360152841], ["Native API", 0.03777271037138825], ["System Services", 0.026147472154665927], ["Ingress Tool Transfer", 0.01756984009035752]], "Once the command line arguments are generated": [["Command and Scripting Interpreter", 0.24862553734458986], ["Native API", 0.11116669347557268], ["Indirect Command Execution", 0.054514351752976], ["Virtualization/Sandbox Evasion", 0.023750924627850903], ["Event Triggered Execution", 0.023469300215297802], ["System Binary Proxy Execution", 0.020074039497973515]], "The malware also spawns cmd.exe to execute the following command": [["Command and Scripting Interpreter", 0.279120553437353], ["System Binary Proxy Execution", 0.17014059917013696], ["System Services", 0.06969088399935076], ["Native API", 0.05170743680134288], ["Event Triggered Execution", 0.0478396774138045], ["Windows Management Instrumentation", 0.03469123783193069]], "that hashes each running process on the system": [["Process Discovery", 0.5724159965424305], ["Process Injection", 0.03686887575896782], ["System Service Discovery", 0.025513811972800754], ["Impair Defenses", 0.02368970957541697], ["OS Credential Dumping", 0.021619999743640938], ["Virtualization/Sandbox Evasion", 0.01817792420513832]], "Process Hashes and Process Privilege Checks": [["Process Discovery", 0.1672486384447864], ["Use Alternate Authentication Material", 0.060676550170990655], ["Process Injection", 0.04708130873255803], ["Access Token Manipulation", 0.0399259710715088], ["Impair Defenses", 0.0340581538648704], ["Native API", 0.02801690813245832]], "to track which of the 3 processes are running on the system.": [["Process Discovery", 0.7575490043345331], ["System Information Discovery", 0.026873883607178514], ["Virtualization/Sandbox Evasion", 0.020356681745514207], ["System Service Discovery", 0.02007336939831496], ["Software Discovery", 0.01658744149137744], ["Native API", 0.01496500928061895]], "compares each hash with 3 hardcoded hashes:\n\n0x6403527E \u2192 avp.exe associated with Kaspersky AV\n0x23214B44\u00a0 \u2192 ns.exe associated with Norton Security\n0x651B3005 \u2192 ccSvcHst.exe associated with Symantec": [["Obfuscated Files or Information", 0.1051225160898201], ["Software Discovery", 0.08381932281527307], ["Use Alternate Authentication Material", 0.04838340080671349], ["Query Registry", 0.04033320095952482], ["Masquerading", 0.030667219242700213], ["Automated Collection", 0.03066105292334837]], "using the API NtRaiseHardError": [["OS Credential Dumping", 0.09629999650689323], ["Native API", 0.07230575193065888], ["System Information Discovery", 0.07140126932961825], ["Virtualization/Sandbox Evasion", 0.0372432743227026], ["File and Directory Discovery", 0.037172161246976206], ["Indicator Removal", 0.036789704269289646]], "invokes the following API\u2019s:": [["Native API", 0.4758851658663353], ["Command and Scripting Interpreter", 0.06823791203097088], ["Deobfuscate/Decode Files or Information", 0.017140342441205422], ["Ingress Tool Transfer", 0.01701868334271006], ["System Services", 0.01434496437836692], ["Virtualization/Sandbox Evasion", 0.013673176751592865]], "GetExtendedTcpTable to retrieve a list of TCP endpoints\nGetIpNetTable to retrieve": [["System Network Connections Discovery", 0.29746933528876013], ["System Network Configuration Discovery", 0.11475187468095369], ["Non-Application Layer Protocol", 0.06583395288306729], ["Network Service Discovery", 0.06484150874075295], ["Network Sniffing", 0.0326741062354447], ["Non-Standard Port", 0.023481346500098782]], "NetServerEnum to get a list": [["System Network Connections Discovery", 0.2909943084128082], ["System Network Configuration Discovery", 0.12189640821340644], ["Remote System Discovery", 0.09620573801393655], ["Network Service Discovery", 0.06923946155432226], ["Query Registry", 0.02038296504610395], ["Network Sniffing", 0.018865114099829605]], "NetServerGetInfoto retrieve the current configuration": [["System Network Configuration Discovery", 0.3786576574563796], ["System Network Connections Discovery", 0.15591064169128588], ["Query Registry", 0.09141860445531716], ["Remote System Discovery", 0.026836214127630594], ["Network Service Discovery", 0.025072773415723754], ["Windows Management Instrumentation", 0.022802835904946903]], "CreateFile and WriteFile are used": [["Data Staged", 0.11022377379785026], ["Indicator Removal", 0.06426150851258282], ["Archive Collected Data", 0.04868642661404235], ["File and Directory Discovery", 0.04862444028967424], ["Native API", 0.04651815091457209], ["Hide Artifacts", 0.04594386946103751]], "CreateProcessAsUser or CreateProcess is executed,": [["Access Token Manipulation", 0.2660786965664574], ["Native API", 0.16316211504607142], ["System Owner/User Discovery", 0.05611593179345947], ["Process Injection", 0.050704093282781935], ["Process Discovery", 0.0448476662164953], ["Create or Modify System Process", 0.03870673953504846]], "is created using the same API call;": [["Native API", 0.111414191930397], ["Create or Modify System Process", 0.032580761067170824], ["Cloud Service Dashboard", 0.029710330231959115], ["Ingress Tool Transfer", 0.021352939101464123], ["Fallback Channels", 0.018903350122410217], ["System Services", 0.018546123714910292]], "Calls CryptEncrypt": [["Obfuscated Files or Information", 0.21974771449845984], ["Data Encrypted for Impact", 0.17863129226385643], ["Deobfuscate/Decode Files or Information", 0.1520482826864996], ["Encrypted Channel", 0.08661332481710458], ["Archive Collected Data", 0.06669575905857658], ["Weaken Encryption", 0.03561507672508913]], "it also invokes the API NTRaiseHardError.": [["Native API", 0.11512619375439755], ["OS Credential Dumping", 0.0824236228131946], ["Virtualization/Sandbox Evasion", 0.0662262429986085], ["System Information Discovery", 0.05216191260443131], ["Masquerading", 0.037015115009353346], ["Windows Management Instrumentation", 0.029275445348872452]], "undocumented Windows API that causes": [["Native API", 0.3914703737767948], ["Masquerading", 0.0700297015544433], ["Event Triggered Execution", 0.04544669162922951], ["Process Injection", 0.04233746974156539], ["System Binary Proxy Execution", 0.039096301610088056], ["Hijack Execution Flow", 0.029770977184677538]], "If the API fails to execute, the malware calls InitiateSystemShutdownExW": [["Native API", 0.12781283210985514], ["System Services", 0.050185846924038095], ["Event Triggered Execution", 0.04956749695804362], ["Impair Defenses", 0.04934199682297651], ["Create or Modify System Process", 0.04394945075344679], ["Command and Scripting Interpreter", 0.042226581178820735]], "NetServerGetInfoto retrieve the current configuration for the local server": [["System Network Configuration Discovery", 0.33055804813466205], ["System Network Connections Discovery", 0.13983972901856243], ["Query Registry", 0.07964489267057794], ["Remote System Discovery", 0.03908544340076711], ["Network Service Discovery", 0.02980122022829782], ["System Information Discovery", 0.025180991446653724]], "Obtains the IP address from the ClientIpAddress field": [["System Network Configuration Discovery", 0.7875529857991991], ["Gather Victim Network Information", 0.016407466776748973], ["Dynamic Resolution", 0.015233883641178276], ["System Location Discovery", 0.014820205327248683], ["Remote System Discovery", 0.010633615013634919], ["System Network Connections Discovery", 0.010524020157386241]], "There are two approaches to using valid credentials to copy and execute the malware to a remote host:": [["Remote Services", 0.1993760153703079], ["Valid Accounts", 0.19630711794431896], ["Command and Scripting Interpreter", 0.05711378712664035], ["OS Credential Dumping", 0.04582757325998909], ["Ingress Tool Transfer", 0.04236137382545512], ["Lateral Tool Transfer", 0.03988905152391558]], "is used to connect to a server using the default credentials": [["Valid Accounts", 0.0893550423831489], ["Modify Authentication Process", 0.08833274088412404], ["Credentials from Password Stores", 0.0711324794438335], ["Brute Force", 0.06237711999291731], ["Unsecured Credentials", 0.056019478848807196], ["Forced Authentication", 0.05312425557755654]], "WMIC": [["Windows Management Instrumentation", 0.5738337147964214], ["Event Triggered Execution", 0.01786319158356258], ["OS Credential Dumping", 0.01429872113056913], ["Remote Services", 0.012444490335443589], ["Command and Scripting Interpreter", 0.011932241657207791], ["Input Capture", 0.010272827511704054]], "C:\\Windows\\system32\\wbem\\wmic.exe /node": [["Windows Management Instrumentation", 0.2955688070358319], ["System Information Discovery", 0.07133147369634257], ["Native API", 0.05889312560828999], ["File and Directory Discovery", 0.04668909803953999], ["Masquerading", 0.03340920526403284], ["OS Credential Dumping", 0.03312443511336056]], "encodes it using XOR encoding with key": [["Obfuscated Files or Information", 0.29419221668293133], ["Deobfuscate/Decode Files or Information", 0.29361169511031343], ["Data Encoding", 0.14806787097425614], ["Archive Collected Data", 0.07306017775934531], ["Encrypted Channel", 0.04112338549594573], ["Data Obfuscation", 0.012052792360440847]], "contains the original MBR that was encoded by XORing": [["Deobfuscate/Decode Files or Information", 0.17633671528843056], ["Obfuscated Files or Information", 0.09055646611426617], ["System Information Discovery", 0.06263865337757309], ["OS Credential Dumping", 0.04497245956394947], ["Hide Artifacts", 0.04413646951955775], ["File and Directory Discovery", 0.036537688528162866]], "which were previously encrypted": [["Data Encrypted for Impact", 0.19342546357929827], ["Archive Collected Data", 0.14354129385797684], ["Deobfuscate/Decode Files or Information", 0.14317086202717522], ["Obfuscated Files or Information", 0.08647512737752826], ["Weaken Encryption", 0.04062341193378841], ["Execution Guardrails", 0.03129346345097178]], "the original encoded MBR": [["Deobfuscate/Decode Files or Information", 0.18203878122436642], ["Obfuscated Files or Information", 0.09461600125965709], ["Archive Collected Data", 0.06673277465996025], ["Data Encoding", 0.03623170978842127], ["Disk Wipe", 0.027508664506525705], ["System Information Discovery", 0.023542467134872895]], "obtain keystrokes, and status of keyboard buffer": [["Input Capture", 0.7393470843900893], ["Virtualization/Sandbox Evasion", 0.021774369274759394], ["Native API", 0.013491811975574182], ["Clipboard Data", 0.012692111793447943], ["System Information Discovery", 0.012313768987297502], ["Query Registry", 0.011239908790461378]], "The malware only targets fixed drives on the system.": [["Peripheral Device Discovery", 0.10325708090702605], ["Replication Through Removable Media", 0.060187090459193286], ["Pre-OS Boot", 0.055722562360257785], ["Disk Wipe", 0.03426621105708191], ["Taint Shared Content", 0.032489604232640336], ["File and Directory Discovery", 0.03144197068842594]], "The malware will first start enumerating files in the directory it is being executed from.": [["File and Directory Discovery", 0.819618702682919], ["Data from Local System", 0.021149958797531447], ["Automated Collection", 0.015471413519239583], ["Native API", 0.011496307792333625], ["Data from Network Shared Drive", 0.010521278468162866], ["Data Staged", 0.009021664932141734]], "the scheduled task is set to trigger 60 minutes after the malware execution by default.": [["Scheduled Task/Job", 0.7870731073024853], ["Inter-Process Communication", 0.02098152548518858], ["System Time Discovery", 0.012967404039962264], ["Indicator Removal", 0.012423237596383533], ["Masquerading", 0.010961004938658203], ["Virtualization/Sandbox Evasion", 0.007826114320823281]], "the scheduled task will trigger 30 minutes after the malware execution.": [["Scheduled Task/Job", 0.798360509172335], ["Inter-Process Communication", 0.022292968193972144], ["System Time Discovery", 0.011925051292500394], ["Masquerading", 0.010117130259419604], ["Indicator Removal", 0.008817020922310398], ["Command and Scripting Interpreter", 0.007756497202664557]], "Explanation of schtask parameters": [["Scheduled Task/Job", 0.2744521040366514], ["Masquerading", 0.049937259558879406], ["Virtualization/Sandbox Evasion", 0.025370459222097515], ["Inter-Process Communication", 0.02350288573811437], ["Traffic Signaling", 0.023329145440263883], ["Steal or Forge Kerberos Tickets", 0.02187054371670393]], "taskrun. Path and filename of the task to be run": [["Scheduled Task/Job", 0.14213831351433476], ["Masquerading", 0.10486256632939511], ["Process Discovery", 0.10323246046723641], ["Native API", 0.06838695183767197], ["Windows Management Instrumentation", 0.04346685595247099], ["File and Directory Discovery", 0.035478664717853534]], "For instance, immediately after execution, it loads itself in memory, and deletes itself from the disk.": [["Indicator Removal", 0.3755578865751367], ["Data Destruction", 0.060233736274277395], ["Hide Artifacts", 0.032787813112007826], ["System Shutdown/Reboot", 0.032651968619711695], ["Virtualization/Sandbox Evasion", 0.02667591618640332], ["Inhibit System Recovery", 0.02655248775450304]], "delete important files": [["Indicator Removal", 0.7385555351636576], ["Data Destruction", 0.08076993220356184], ["Disk Wipe", 0.021760825509796623], ["Inhibit System Recovery", 0.02063329917316611], ["System Shutdown/Reboot", 0.010991044268357583], ["Service Stop", 0.007497515815576574]], "the configuration file will be deleted": [["Indicator Removal", 0.5782893330079062], ["Modify Registry", 0.11421068041337759], ["Inhibit System Recovery", 0.03534101923768547], ["Data Destruction", 0.021926951680252365], ["System Shutdown/Reboot", 0.01557859034757958], ["Impair Defenses", 0.013602963239902713]], "threat actors use Themida packer to obfuscate the signature used for detection.": [["Obfuscated Files or Information", 0.45650018258715275], ["Subvert Trust Controls", 0.12514553178698465], ["Data Obfuscation", 0.06607753229399028], ["Masquerading", 0.0612052525702843], ["Deobfuscate/Decode Files or Information", 0.031180820730346785], ["Data Encoding", 0.029585248191554708]], "packed by noted tools": [["Obfuscated Files or Information", 0.30201572100807067], ["Archive Collected Data", 0.09395854559065084], ["Ingress Tool Transfer", 0.05866806442128779], ["Command and Scripting Interpreter", 0.03717225606069468], ["Automated Collection", 0.02706781146652], ["Data Staged", 0.02701815410680327]], "Themida-packed": [["Obfuscated Files or Information", 0.28215528760305725], ["Ingress Tool Transfer", 0.036293175530671594], ["Masquerading", 0.03595077316841961], ["Command and Scripting Interpreter", 0.032736750391176545], ["Deobfuscate/Decode Files or Information", 0.02798186212838425], ["Archive Collected Data", 0.026109354292010823]], "upload/download file": [["Ingress Tool Transfer", 0.6416884531132109], ["Data from Local System", 0.02886482099909039], ["Exfiltration Over C2 Channel", 0.022104109514694954], ["Exfiltration Over Alternative Protocol", 0.019626058290951463], ["Application Layer Protocol", 0.019157888844252485], ["Exfiltration Over Web Service", 0.015513273331371326]], "remote shell functions.": [["Command and Scripting Interpreter", 0.29786691082903094], ["Remote Services", 0.24379543769590006], ["System Services", 0.06275607476481072], ["Windows Management Instrumentation", 0.02574949639764201], ["Remote Service Session Hijacking", 0.020808903820630074], ["Native API", 0.018301689686501775]], "It supports proxy (Socks5),": [["Proxy", 0.38261013324324006], ["Protocol Tunneling", 0.1297574032015332], ["Non-Application Layer Protocol", 0.08210023663648325], ["Application Layer Protocol", 0.08128784238208492], ["Non-Standard Port", 0.048983243462191836], ["Encrypted Channel", 0.020452626150671387]], "with SOCKS v5 server": [["Application Layer Protocol", 0.14896619774547137], ["Non-Application Layer Protocol", 0.1332192456354269], ["Proxy", 0.12119459658962185], ["Non-Standard Port", 0.07712198112863637], ["Protocol Tunneling", 0.07640119533263322], ["Encrypted Channel", 0.03943828953219328]], "used to dump information from the victim\u2019s Oracle database.": [["Data from Information Repositories", 0.18479398088608803], ["Data from Local System", 0.08469779617281711], ["Data Staged", 0.06483487357113867], ["Automated Collection", 0.05064628685999285], ["Data Manipulation", 0.02821593592907806], ["Archive Collected Data", 0.02629680614763858]], "an information stealer used to harvest internal information.": [["Data Manipulation", 0.1087638434143373], ["Data from Information Repositories", 0.0918388859663155], ["Email Collection", 0.05251109581171446], ["Data Staged", 0.04683781251240216], ["Exfiltration Over C2 Channel", 0.04447097512918177], ["Data from Local System", 0.034423904583796405]], "Obfuscated PowerShell script": [["Obfuscated Files or Information", 0.7573776387934407], ["Deobfuscate/Decode Files or Information", 0.05758235215772798], ["Command and Scripting Interpreter", 0.02797794868680945], ["Execution Guardrails", 0.011352489407850943], ["System Binary Proxy Execution", 0.009479109985471692], ["Archive Collected Data", 0.009196592859330477]], "multi-layer obfuscation": [["Obfuscated Files or Information", 0.6488901903839818], ["Data Obfuscation", 0.0388005906754585], ["Deobfuscate/Decode Files or Information", 0.027334599797079234], ["Hide Artifacts", 0.020425297549844443], ["Encrypted Channel", 0.019707053234781103], ["Archive Collected Data", 0.017183749721117327]], "to obfuscate their tools": [["Obfuscated Files or Information", 0.7620126222019613], ["Deobfuscate/Decode Files or Information", 0.030671645799207174], ["Archive Collected Data", 0.018297052877746498], ["Masquerading", 0.01632826785261712], ["Data Obfuscation", 0.0139361617115027], ["Execution Guardrails", 0.011869175894603297]], "have adopted more obfuscation techniques": [["Obfuscated Files or Information", 0.7643212440277565], ["Deobfuscate/Decode Files or Information", 0.037357968130567104], ["Data Obfuscation", 0.020422813996895824], ["Data Encoding", 0.019787886960560216], ["Execution Guardrails", 0.010943878614637947], ["Masquerading", 0.010595907248438216]], "Heavily obfuscated PowerShell script": [["Obfuscated Files or Information", 0.7837060688126538], ["Deobfuscate/Decode Files or Information", 0.05084005621984981], ["Command and Scripting Interpreter", 0.025456447738967148], ["Execution Guardrails", 0.009717789628513829], ["Archive Collected Data", 0.008723811271740005], ["System Binary Proxy Execution", 0.008325476430560405]], "the encrypted payload": [["Obfuscated Files or Information", 0.32572354864418224], ["Deobfuscate/Decode Files or Information", 0.19786680682280283], ["Encrypted Channel", 0.09897107755066685], ["Archive Collected Data", 0.05747185603043873], ["Data Encrypted for Impact", 0.056725550011563416], ["Execution Guardrails", 0.03302286002548498]], "to obfuscate control flow of program.": [["Obfuscated Files or Information", 0.7481705814771059], ["Deobfuscate/Decode Files or Information", 0.044357736121378714], ["Process Injection", 0.02119220484503893], ["Execution Guardrails", 0.015657919799929285], ["Masquerading", 0.012473614796697311], ["Hide Artifacts", 0.012167078684305145]], "Heavy obfuscation in a simple but useful anti-analysis approach makes it difficult for security products to detect their scripts.": [["Obfuscated Files or Information", 0.8141291246774577], ["Execution Guardrails", 0.021233801470366704], ["Deobfuscate/Decode Files or Information", 0.020987023785569096], ["Data Obfuscation", 0.011296036872027532], ["Masquerading", 0.009362787250029023], ["Hide Artifacts", 0.005597051394766528]], "threat actors use multi-layered AES encryption and base64 encoding to obfuscate": [["Obfuscated Files or Information", 0.5911209341753714], ["Deobfuscate/Decode Files or Information", 0.0851405130826767], ["Encrypted Channel", 0.054635850501894415], ["Data Encoding", 0.050023385522226876], ["Archive Collected Data", 0.04727927321223314], ["Data Encrypted for Impact", 0.022245733339918073]], "obfuscate the execution flow of the program": [["Obfuscated Files or Information", 0.7458583801012243], ["Deobfuscate/Decode Files or Information", 0.055872941932554265], ["Process Injection", 0.025694167910083672], ["Execution Guardrails", 0.012945853590499892], ["Hide Artifacts", 0.010554184341084537], ["Data Obfuscation", 0.010345741166196387]], "the decryption algorithm": [["Deobfuscate/Decode Files or Information", 0.5254657769621026], ["Data Encrypted for Impact", 0.09384095840763958], ["Obfuscated Files or Information", 0.06476342963634903], ["Encrypted Channel", 0.05922979120539399], ["Archive Collected Data", 0.04920852242649914], ["Weaken Encryption", 0.03894338730395639]], "decrypted with RC4 algorithm": [["Deobfuscate/Decode Files or Information", 0.5407993385006722], ["Encrypted Channel", 0.10737927155198544], ["Data Encrypted for Impact", 0.07362406492564777], ["Obfuscated Files or Information", 0.04863957392338818], ["Archive Collected Data", 0.03896336520153928], ["Weaken Encryption", 0.025350418211832235]], "usage of a highly similar decryption algorithm": [["Deobfuscate/Decode Files or Information", 0.3994777101915664], ["Data Encrypted for Impact", 0.10659351595766858], ["Encrypted Channel", 0.0751536720355228], ["Obfuscated Files or Information", 0.07294830096686561], ["Archive Collected Data", 0.06351420346539467], ["Weaken Encryption", 0.05246525887895641]], "to decrypt the payload": [["Deobfuscate/Decode Files or Information", 0.6605596578776783], ["Obfuscated Files or Information", 0.10016621034529903], ["Data Encrypted for Impact", 0.03478138060108359], ["Encrypted Channel", 0.029023324153830764], ["Archive Collected Data", 0.028379004345436262], ["Weaken Encryption", 0.021312420148242396]], "decrypt it": [["Deobfuscate/Decode Files or Information", 0.5790670808138757], ["Data Encrypted for Impact", 0.11558289581373117], ["Archive Collected Data", 0.06770663527042607], ["Obfuscated Files or Information", 0.040514778955498584], ["Weaken Encryption", 0.027805681318848755], ["Encrypted Channel", 0.02285702419373199]], "the decryption function into RC4": [["Deobfuscate/Decode Files or Information", 0.7230446470034307], ["Encrypted Channel", 0.0536050522837788], ["Obfuscated Files or Information", 0.05000190043371711], ["Data Encrypted for Impact", 0.035547432071519384], ["Archive Collected Data", 0.027193347754234952], ["Weaken Encryption", 0.01314409944489412]], "they always have used DLL sideloading as their major technique to launch their malware.": [["Hijack Execution Flow", 0.39934652766260187], ["System Binary Proxy Execution", 0.08506556840377377], ["Process Injection", 0.06457905382662207], ["Shared Modules", 0.0633084238895274], ["Event Triggered Execution", 0.022299152802980605], ["Masquerading", 0.018366503577757]], "adopted DLL sideloading techniques to run their malware.": [["Hijack Execution Flow", 0.3954770512913422], ["System Binary Proxy Execution", 0.11650648692016681], ["Shared Modules", 0.09496925711417403], ["Process Injection", 0.08884599969909494], ["Event Triggered Execution", 0.021484771756352557], ["Native API", 0.01653723780323958]], "used DLL sideloading to launch their malware": [["Hijack Execution Flow", 0.48830360565084246], ["System Binary Proxy Execution", 0.13945675904779123], ["Shared Modules", 0.10988084238728915], ["Process Injection", 0.04442213670098258], ["Event Triggered Execution", 0.018328589535460283], ["Boot or Logon Autostart Execution", 0.01644477316143266]], "The malicious DLL \u201cgtn.dll\u201d, which we named as \u201cShellFang\u201d, loads when a legitimate executable is launched.": [["Hijack Execution Flow", 0.4580536157747438], ["System Binary Proxy Execution", 0.1308712947239048], ["Process Injection", 0.06847523590666064], ["Event Triggered Execution", 0.05104841251965115], ["Native API", 0.04267388572952756], ["Shared Modules", 0.041972022915103914]], "including API hashing and execution flow obfuscation through exception mechanism": [["Obfuscated Files or Information", 0.6517833726759931], ["Deobfuscate/Decode Files or Information", 0.04018435590663838], ["Execution Guardrails", 0.035175135925201294], ["Data Obfuscation", 0.03394974685975085], ["Data Encoding", 0.023663729491865345], ["Masquerading", 0.012687526058103865]], "Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.": [["Obfuscated Files or Information", 0.6294076380956531], ["Deobfuscate/Decode Files or Information", 0.08714171148552732], ["Masquerading", 0.0473478753542601], ["Native API", 0.02803589408866663], ["Data Encoding", 0.014451986847965876], ["Hide Artifacts", 0.013975091534886077]], "Necessary APIs will be dynamically resolved during execution.": [["Native API", 0.3456943362607666], ["Hijack Execution Flow", 0.03391156536137909], ["Shared Modules", 0.032206964916542485], ["Event Triggered Execution", 0.023116178431652177], ["Command and Scripting Interpreter", 0.02284047026117845], ["System Binary Proxy Execution", 0.019496146861121416]], "API obfuscation, and execution flow obfuscation": [["Obfuscated Files or Information", 0.7479486332927773], ["Deobfuscate/Decode Files or Information", 0.05592366958583048], ["Data Obfuscation", 0.02094534790548074], ["Execution Guardrails", 0.01431364812385788], ["Data Encoding", 0.01410295608199691], ["Masquerading", 0.011225098971235824]], "abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing.": [["Obfuscated Files or Information", 0.6866620632981679], ["Deobfuscate/Decode Files or Information", 0.03813306203304665], ["Masquerading", 0.02876335796949803], ["Execution Guardrails", 0.02032597071422576], ["Data Obfuscation", 0.019616889498594758], ["Process Injection", 0.01537082685281109]], "the final payload is an HTTPs Cobalt Strike beacon.": [["Data Obfuscation", 0.08771592558009832], ["Application Layer Protocol", 0.0857823137227649], ["Fallback Channels", 0.050632945708887066], ["Encrypted Channel", 0.049244716478317324], ["Web Service", 0.04845851773062703], ["Data Encoding", 0.035691651995337484]], "by creating immediate tasks through GPO.": [["Scheduled Task/Job", 0.15443156377595352], ["Abuse Elevation Control Mechanism", 0.07563540592137534], ["Domain Policy Modification", 0.07525212639387537], ["Access Token Manipulation", 0.062206610598230065], ["Create or Modify System Process", 0.05409430733095919], ["Create Account", 0.03667272492180233]], "abused group policy objects (GPO) to install loaders": [["System Binary Proxy Execution", 0.1211456021707002], ["Boot or Logon Autostart Execution", 0.09279233900383509], ["Abuse Elevation Control Mechanism", 0.08759871113602387], ["Domain Policy Modification", 0.08174756680406593], ["Create or Modify System Process", 0.06357570777197112], ["Hijack Execution Flow", 0.04494086314173957]], "Propagation through GPO": [["Domain Policy Modification", 0.2977273844828692], ["Abuse Elevation Control Mechanism", 0.04250969240385209], ["Access Token Manipulation", 0.03620833463779864], ["Valid Accounts", 0.03169328802462853], ["Account Manipulation", 0.03159513493757956], ["Event Triggered Execution", 0.026268385790019416]], "they will submit immediate tasks to the hosts in the domain through GPO": [["Domain Policy Modification", 0.17755962486390636], ["Valid Accounts", 0.06134487568486126], ["Compromise Infrastructure", 0.05243143752985458], ["Scheduled Task/Job", 0.03834502414714597], ["Inter-Process Communication", 0.03761955508356688], ["Account Manipulation", 0.03231810087651964]], "As the hosts receive the task through GPO": [["Scheduled Task/Job", 0.13983125630963408], ["Access Token Manipulation", 0.09573880231381705], ["Domain Policy Modification", 0.0724360719722613], ["Inter-Process Communication", 0.04676165928844473], ["Remote Services", 0.03684174538755549], ["Abuse Elevation Control Mechanism", 0.03355077938373971]], "usually compile all necessary libraries in a single binary, making malware classification more difficult for analysts and resulting in a large binary": [["Obfuscated Files or Information", 0.36984017811105774], ["Hijack Execution Flow", 0.08469141779446948], ["Develop Capabilities", 0.03644763454741743], ["Trusted Developer Utilities Proxy Execution", 0.02852984585035849], ["Exploitation for Client Execution", 0.021838884633449327], ["Compromise Client Software Binary", 0.017035204290822867]], "Once the victim opens the document,": [["User Execution", 0.4065627536430095], ["Template Injection", 0.16877810720590208], ["Office Application Startup", 0.05707436844227241], ["Phishing", 0.042677096241391405], ["Data Manipulation", 0.021039348253410004], ["Inter-Process Communication", 0.01453118533106232]], "injecting the shellcode into rundll32.exe": [["System Binary Proxy Execution", 0.2628894091126791], ["Process Injection", 0.2161803818794823], ["Native API", 0.17642102412870866], ["Hijack Execution Flow", 0.07318236807611837], ["Event Triggered Execution", 0.034183670274827126], ["Command and Scripting Interpreter", 0.02250198438893515]], "Shellcode which is used for code injection": [["Process Injection", 0.21327654297231846], ["Obfuscated Files or Information", 0.1288699141308807], ["Native API", 0.10366772423885331], ["Hijack Execution Flow", 0.04593965518017343], ["Shared Modules", 0.030388165151626085], ["Deobfuscate/Decode Files or Information", 0.02978155344960023]], "proxy": [["Proxy", 0.5196452831920866], ["Fallback Channels", 0.036601160924014144], ["Application Layer Protocol", 0.03391966488532412], ["Protocol Tunneling", 0.02631073607125299], ["Compromise Infrastructure", 0.024966158304890542], ["Data Obfuscation", 0.022727052200294133]], "create scheduled tasks for persistence.": [["Scheduled Task/Job", 0.6535893817371159], ["Create or Modify System Process", 0.05315349347898911], ["Boot or Logon Autostart Execution", 0.035253788604657894], ["Event Triggered Execution", 0.03470314773486602], ["Boot or Logon Initialization Scripts", 0.02109732055440496], ["Inter-Process Communication", 0.017223310788145135]], "to create a ImmediateTask": [["Command and Scripting Interpreter", 0.1203820875574497], ["Scheduled Task/Job", 0.11557495362177382], ["Native API", 0.07214499656652065], ["Inter-Process Communication", 0.0404714327010502], ["Event Triggered Execution", 0.032020950877267404], ["System Services", 0.0318687167796018]], "Windows API": [["Native API", 0.5410694678687247], ["Masquerading", 0.052346866968032625], ["Windows Management Instrumentation", 0.03456176687872193], ["System Binary Proxy Execution", 0.027681669844081956], ["Application Window Discovery", 0.019933434687904376], ["Command and Scripting Interpreter", 0.01655999485124817]], "Windows APIs": [["Native API", 0.6118699969552793], ["Masquerading", 0.03372843243126742], ["Windows Management Instrumentation", 0.02508191485892392], ["System Binary Proxy Execution", 0.024163680368331376], ["Command and Scripting Interpreter", 0.016450678137459915], ["Application Window Discovery", 0.01453772773929978]], "backdoor is a basic remote shell": [["Command and Scripting Interpreter", 0.2263328792387955], ["Remote Services", 0.09768966833638928], ["Remote Access Software", 0.05353347003150609], ["Remote Service Session Hijacking", 0.03490272454233956], ["Windows Management Instrumentation", 0.03301447449011333], ["Event Triggered Execution", 0.02886854955879989]], "C:\\Windows\\System32\\cmd.exe /c": [["Native API", 0.1331577001742168], ["Masquerading", 0.10039591457046008], ["File and Directory Discovery", 0.0962226818413464], ["System Binary Proxy Execution", 0.05491019659964276], ["Command and Scripting Interpreter", 0.053323963481769515], ["Windows Management Instrumentation", 0.05034487194600984]], "forcing its component SmadAVprotect32.exe to side-load their malicious DLL.": [["Hijack Execution Flow", 0.4569689960926666], ["Process Injection", 0.11002404564645227], ["System Binary Proxy Execution", 0.10361275446084951], ["Shared Modules", 0.04678121202818174], ["Masquerading", 0.027962746348396045], ["Event Triggered Execution", 0.019093139992241753]], "the malware starts a function called\u00a0bypassSMADAV": [["Masquerading", 0.07840501977257609], ["File and Directory Discovery", 0.036104510069749234], ["Command and Scripting Interpreter", 0.03146021635987768], ["Ingress Tool Transfer", 0.03084813389787416], ["Native API", 0.030135715581648966], ["System Binary Proxy Execution", 0.029905833708212284]], "with the API function\u00a0IsWindowVisible.": [["Hide Artifacts", 0.20526645763074258], ["Application Window Discovery", 0.13111561139178154], ["Virtualization/Sandbox Evasion", 0.055081750290958055], ["Native API", 0.02585046334694217], ["Event Triggered Execution", 0.025265032630075623], ["Windows Management Instrumentation", 0.017837042591425486]], "by\u00a0IsWindowVisible\u00a0function": [["Hide Artifacts", 0.19872342112163638], ["Application Window Discovery", 0.15423425934024534], ["Virtualization/Sandbox Evasion", 0.052477644654987526], ["Native API", 0.035422172897105725], ["Event Triggered Execution", 0.033843514982636706], ["Command and Scripting Interpreter", 0.0209647256659878]], "calling the\u00a0RegisterClass\u00a0function prior to calling\u00a0CreateWindow.": [["Native API", 0.11644528575749878], ["Application Window Discovery", 0.11124098042474809], ["Event Triggered Execution", 0.10825018846121032], ["Hide Artifacts", 0.08729551360775505], ["Process Injection", 0.067210298397607], ["Office Application Startup", 0.0397642685922019]], "Before a call to\u00a0CreateWindowEx, you would usually first need to create a class by calling\u00a0RegisterClass\u00a0and then class\u00a0CreateWindowEx.": [["Native API", 0.13542346630850555], ["Application Window Discovery", 0.10500459759729744], ["Event Triggered Execution", 0.07579971965726583], ["Hide Artifacts", 0.0732834683108133], ["Process Injection", 0.06064514329838406], ["Office Application Startup", 0.03671834078705568]], "the malware creates 2 scheduled tasks": [["Scheduled Task/Job", 0.7096792653973502], ["Inter-Process Communication", 0.048224065566797134], ["Masquerading", 0.023257368346009652], ["Command and Scripting Interpreter", 0.017203126408419592], ["Create or Modify System Process", 0.011639154619187717], ["System Services", 0.010462465646518407]], "schtasks /Create /TN test /SC MINUTE /MO 15 /TR": [["Scheduled Task/Job", 0.3179713475437387], ["System Time Discovery", 0.13905805910688465], ["Virtualization/Sandbox Evasion", 0.06512992652654802], ["Indicator Removal", 0.0464964816718517], ["Process Discovery", 0.02114663105414326], ["Masquerading", 0.018444911809550806]], "the malware creates a scheduled task to execute its copy from this randomized path:\n\nschtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR \"explorer.exe c:\\users\\public\\8NaZrCq3pGeDRXKF.zip\\8NaZr.exe\" /f": [["Scheduled Task/Job", 0.3482621357252146], ["Masquerading", 0.12185136101374026], ["Data Staged", 0.02666529026191423], ["System Binary Proxy Execution", 0.019404888661222724], ["Lateral Tool Transfer", 0.018838290826368988], ["System Services", 0.017451683910278373]], "The final payload returned is a lightweight PowerShell backdoor,": [["Command and Scripting Interpreter", 0.6119779149928734], ["Native API", 0.02555057997936819], ["Virtualization/Sandbox Evasion", 0.022645847340418634], ["Obfuscated Files or Information", 0.02073497110108233], ["Deobfuscate/Decode Files or Information", 0.019212968286270442], ["Ingress Tool Transfer", 0.01698485347604323]], "It then picks one random C&C URL out of the three available and constructs a GET request": [["Application Layer Protocol", 0.1601935004313613], ["Dynamic Resolution", 0.05939619671307111], ["System Network Configuration Discovery", 0.035382363488357355], ["Web Service", 0.033459328264534606], ["Fallback Channels", 0.031192384127841963], ["Native API", 0.023768888445571887]], "sends them back to the server in POST request:": [["Exfiltration Over C2 Channel", 0.08397320548952554], ["Data Encoding", 0.05090438927083414], ["Application Layer Protocol", 0.04946917287073765], ["Archive Collected Data", 0.04716384125795589], ["Data from Local System", 0.04485123653975299], ["Automated Exfiltration", 0.03435503910600841]], "After the validation of the JSON and Base64 decoding": [["Data Encoding", 0.2805631340544361], ["Deobfuscate/Decode Files or Information", 0.16537244878409632], ["Obfuscated Files or Information", 0.14927705569742503], ["Data Obfuscation", 0.056418151941365395], ["Archive Collected Data", 0.039486734460228524], ["Encrypted Channel", 0.017438757528072203]], "used by various actors to disable endpoint protection tools.": [["Impair Defenses", 0.4682274739774924], ["Endpoint Denial of Service", 0.05331632434036316], ["Data Obfuscation", 0.021575755017110506], ["Network Boundary Bridging", 0.017068977504914953], ["Traffic Signaling", 0.016251122476055688], ["Subvert Trust Controls", 0.01624334521350213]], "techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.": [["Process Injection", 0.2990871950070393], ["Service Stop", 0.0816759542013667], ["Impair Defenses", 0.061002857417212966], ["Virtualization/Sandbox Evasion", 0.041204350067965446], ["Rootkit", 0.027495173550575593], ["Access Token Manipulation", 0.022224075994320188]], "The current system username": [["System Owner/User Discovery", 0.74324250168676], ["Account Discovery", 0.04611690985865212], ["Access Token Manipulation", 0.022874449011921545], ["System Information Discovery", 0.017375319914723682], ["Masquerading", 0.013692805847549576], ["Create Account", 0.008615945029503625]], "The current username home folder": [["System Owner/User Discovery", 0.20216626937652415], ["File and Directory Discovery", 0.11193617268112985], ["Account Discovery", 0.05894566353484173], ["Data Staged", 0.03785403424896731], ["Data from Local System", 0.03172467147070745], ["Masquerading", 0.023096844741814178]], "The system\u2019s network interfaces (name, MacAddress, description)": [["System Network Configuration Discovery", 0.6328903324308954], ["System Network Connections Discovery", 0.14110980970095371], ["Data from Configuration Repository", 0.01876074969842531], ["System Information Discovery", 0.014172295217888042], ["Remote System Discovery", 0.013481603343756024], ["Network Sniffing", 0.011619221636627227]], "was deployed using DLL side-loading": [["Hijack Execution Flow", 0.2799590909496021], ["Shared Modules", 0.15492628915610776], ["System Binary Proxy Execution", 0.08933883380593682], ["Process Injection", 0.05013638844942076], ["Event Triggered Execution", 0.0397417917546784], ["System Services", 0.025838863017312287]], "due to DLL side-loading, the loader/injector winutils.dll is loaded into memory and runs in the context": [["Hijack Execution Flow", 0.27660423343427304], ["Process Injection", 0.23525487693207256], ["Shared Modules", 0.09460695446843644], ["System Binary Proxy Execution", 0.08607590679240322], ["Native API", 0.06284319303608782], ["Event Triggered Execution", 0.03854196186356001]], "abused to side-load": [["Hijack Execution Flow", 0.2509362916157336], ["Shared Modules", 0.10035962879406407], ["System Binary Proxy Execution", 0.08598863556106602], ["Process Injection", 0.04263631273392164], ["Ingress Tool Transfer", 0.033408791916882556], ["Command and Scripting Interpreter", 0.028469848398449477]], "Packed Rorschach loader and injector": [["Process Injection", 0.20686830416002516], ["Obfuscated Files or Information", 0.15939757404349833], ["Shared Modules", 0.08111122996904596], ["Hijack Execution Flow", 0.06572350912431521], ["Deobfuscate/Decode Files or Information", 0.05827073362216655], ["System Binary Proxy Execution", 0.029053672746611116]], "the initial loader/injector winutils.dll is protected with UPX-style packing": [["Hijack Execution Flow", 0.3413153077901865], ["Process Injection", 0.17677119603505925], ["System Binary Proxy Execution", 0.11421055695096297], ["Shared Modules", 0.10359656881645339], ["Obfuscated Files or Information", 0.0244100443006793], ["Native API", 0.023344526042419145]], "After unpacking, the sample loads": [["Deobfuscate/Decode Files or Information", 0.20003903509320378], ["Obfuscated Files or Information", 0.07301303115896285], ["Hijack Execution Flow", 0.0547304321064542], ["Masquerading", 0.05259891340949875], ["System Binary Proxy Execution", 0.051475498556362194], ["Ingress Tool Transfer", 0.04933686622945697]], "decrypted and injected": [["Deobfuscate/Decode Files or Information", 0.5540153608783726], ["Obfuscated Files or Information", 0.12879321708023486], ["Data Encrypted for Impact", 0.04110161101499368], ["Archive Collected Data", 0.03644882192360291], ["Weaken Encryption", 0.02911571442474825], ["Encrypted Channel", 0.028847266945842696]], "and decrypts config": [["Deobfuscate/Decode Files or Information", 0.38404703224177617], ["Obfuscated Files or Information", 0.155689759546158], ["Modify Registry", 0.040708538796836356], ["Data Encrypted for Impact", 0.03734310895802879], ["Execution Guardrails", 0.0335020298753287], ["Weaken Encryption", 0.029139126177103822]], "injected into notepad.exe, where the ransomware logic begins.": [["Data Encrypted for Impact", 0.22145018155008275], ["Masquerading", 0.10249209918551554], ["Obfuscated Files or Information", 0.03341686109112191], ["System Binary Proxy Execution", 0.030572631521358074], ["Deobfuscate/Decode Files or Information", 0.029402496899247003], ["User Execution", 0.024846265343344054]], "is injected into notepad.exe": [["Native API", 0.13705034234756613], ["Process Injection", 0.11730013633713085], ["System Binary Proxy Execution", 0.09254750092545373], ["Masquerading", 0.06650450468325357], ["Office Application Startup", 0.05307617119434784], ["XSL Script Processing", 0.04019717938284038]], "Disable the Windows firewall, using netsh.exe": [["Impair Defenses", 0.6695432450619666], ["Software Discovery", 0.028694869112004046], ["Network Boundary Bridging", 0.020677872613103304], ["Network Service Discovery", 0.020335547196156274], ["Traffic Signaling", 0.01807591409348271], ["Non-Standard Port", 0.00926460489868389]], "When executed on a Windows Domain Controller (DC), the ransomware automatically creates a Group Policy, spreading itself to other machines within the domain.": [["Domain Policy Modification", 0.094853086389903], ["Software Deployment Tools", 0.05127915787522691], ["Lateral Tool Transfer", 0.045802566979977775], ["Windows Management Instrumentation", 0.035965789981365015], ["Valid Accounts", 0.025348586466509254], ["File and Directory Permissions Modification", 0.023525321807169396]], "creates a group policy": [["Domain Policy Modification", 0.29742105921858913], ["Modify Registry", 0.06367993865966436], ["Abuse Elevation Control Mechanism", 0.04628197221192767], ["Create or Modify System Process", 0.045677460340327866], ["Impair Defenses", 0.0380299958030593], ["Boot or Logon Autostart Execution", 0.03600031365583227]], "creates another group policy": [["Domain Policy Modification", 0.380478980239263], ["Modify Registry", 0.04509691523632682], ["File and Directory Permissions Modification", 0.04337663469367606], ["Abuse Elevation Control Mechanism", 0.043369884168885514], ["Create or Modify System Process", 0.04138376068881541], ["Impair Defenses", 0.03110729612275408]], "deletes them from the original location.": [["Indicator Removal", 0.5984976285537543], ["Data Destruction", 0.07570934757695241], ["Inhibit System Recovery", 0.028547322268988293], ["Hide Artifacts", 0.014186157801140747], ["Modify Cloud Compute Infrastructure", 0.013598750692762824], ["Disk Wipe", 0.0119450120744093]], "creating a schedule task": [["Scheduled Task/Job", 0.7740303331543219], ["Inter-Process Communication", 0.053373759926688295], ["Masquerading", 0.01784572925227191], ["Command and Scripting Interpreter", 0.012164068563257337], ["System Time Discovery", 0.006862151700052701], ["Create or Modify System Process", 0.004742418106917968]], "that registers a scheduled task which runs immediately and upon user logon,": [["Scheduled Task/Job", 0.7490021249019514], ["Inter-Process Communication", 0.021319788094681966], ["Create or Modify System Process", 0.019662070795822016], ["Boot or Logon Autostart Execution", 0.017184464612154397], ["Event Triggered Execution", 0.01652916417016771], ["Masquerading", 0.014250550147081579]], "finds the relevant syscall numbers for NT APIs,": [["System Information Discovery", 0.48898842412751176], ["Native API", 0.07050970990791844], ["Virtualization/Sandbox Evasion", 0.06582613499513419], ["Windows Management Instrumentation", 0.0494186792277532], ["Query Registry", 0.030834694198640076], ["Software Discovery", 0.025398832925383318]], "with the syscall instruction": [["Virtualization/Sandbox Evasion", 0.18575609808946364], ["System Information Discovery", 0.11260470394512463], ["Windows Management Instrumentation", 0.03894516078859513], ["Modify System Image", 0.03310938831854708], ["Rootkit", 0.03144247361365122], ["OS Credential Dumping", 0.028119821297428026]], "the malware first creates a syscall table for NT APIs": [["System Information Discovery", 0.28078587333920557], ["Windows Management Instrumentation", 0.07604858909369676], ["Virtualization/Sandbox Evasion", 0.07102541181866984], ["Software Discovery", 0.06255020064033498], ["Native API", 0.06207228393895055], ["Query Registry", 0.04567587062438362]], "Creation of syscall table for certain NT APIs.": [["System Information Discovery", 0.404575210468754], ["Virtualization/Sandbox Evasion", 0.06353870171639542], ["Windows Management Instrumentation", 0.060696825351176355], ["OS Credential Dumping", 0.039359950297700765], ["Query Registry", 0.030833649782597776], ["Software Discovery", 0.0264304871689131]], "It makes direct system calls using the \u201csyscall\u201d instruction.": [["Native API", 0.12079117381771207], ["Process Injection", 0.0995614004587131], ["Virtualization/Sandbox Evasion", 0.09654111127032437], ["Hijack Execution Flow", 0.047150948441718826], ["Rootkit", 0.04584820088651739], ["System Binary Proxy Execution", 0.03781078410017806]], "Example use of direct syscall.": [["Virtualization/Sandbox Evasion", 0.15140658407405236], ["Process Injection", 0.08423075174020656], ["System Information Discovery", 0.07931429457477474], ["Windows Management Instrumentation", 0.0397041993924244], ["Native API", 0.03911464215588219], ["OS Credential Dumping", 0.03228169402278564]], "It uses GetSystemDefaultUILanguage and GetUserDefaultUILanguage to": [["System Information Discovery", 0.5550665317899047], ["Query Registry", 0.04510192503139286], ["Native API", 0.03975795364099703], ["Deobfuscate/Decode Files or Information", 0.01975789899426393], ["Virtualization/Sandbox Evasion", 0.017775449250299356], ["File and Directory Discovery", 0.01521295229187633]], "The WinAPI CryptGenRandom is utilized": [["Deobfuscate/Decode Files or Information", 0.22074620319556917], ["Data Encrypted for Impact", 0.13505543793794333], ["Obfuscated Files or Information", 0.09922689103193223], ["Encrypted Channel", 0.08616533901475773], ["Weaken Encryption", 0.051457009302634], ["Archive Collected Data", 0.035690645884996826]], "is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation,": [["Masquerading", 0.5566857681778734], ["Indicator Removal", 0.042472722730143866], ["Hide Artifacts", 0.03056320323114718], ["File and Directory Discovery", 0.0303822531293029], ["Obfuscated Files or Information", 0.02600843753714637], ["System Information Discovery", 0.02144104629638807]], "Command Line Arguments": [["Command and Scripting Interpreter", 0.46245915269468907], ["Native API", 0.07079033181132864], ["Indirect Command Execution", 0.07038198220579327], ["System Binary Proxy Execution", 0.023235386271225813], ["System Services", 0.015383505470900583], ["Obfuscated Files or Information", 0.014142447661292665]], "the list of processes": [["Process Discovery", 0.8235562372232333], ["Native API", 0.0211571007416134], ["System Service Discovery", 0.018440786132677797], ["Process Injection", 0.0150296880827351], ["Windows Management Instrumentation", 0.009441745658750266], ["Software Discovery", 0.008797704250761014]], "code is protected and obfuscated": [["Obfuscated Files or Information", 0.620961715561973], ["Deobfuscate/Decode Files or Information", 0.13131998324254704], ["Execution Guardrails", 0.01704075306025587], ["Encrypted Channel", 0.013468159916827026], ["Masquerading", 0.011352438207398795], ["Data Obfuscation", 0.009985101293943813]], "This obfuscated process": [["Obfuscated Files or Information", 0.43826547788659814], ["Deobfuscate/Decode Files or Information", 0.1458342313092227], ["Process Injection", 0.12114123605969662], ["Native API", 0.02096827839326023], ["Hide Artifacts", 0.020938017189473534], ["Masquerading", 0.018018120788619106]], "reusing multiple code chunks from DEP-allowed memory pages, called ROP gadgets.": [["Hijack Execution Flow", 0.1053565263944903], ["Process Injection", 0.10428252800900538], ["Obfuscated Files or Information", 0.08368730398610826], ["Shared Modules", 0.07166239670685369], ["Modify System Image", 0.024111495328965768], ["System Binary Proxy Execution", 0.022705623670055585]], "ROP-based attacks execute \u201cRET\u201d instructions without a prior \u201cCALL\u201d instruction, the running thread\u2019s stack and the shadow stack values mismatch": [["Process Injection", 0.11958160447393505], ["Virtualization/Sandbox Evasion", 0.04621280618704555], ["Exploitation of Remote Services", 0.04228047059596265], ["Exploitation for Client Execution", 0.03510879545064259], ["Event Triggered Execution", 0.02700108378767821], ["Endpoint Denial of Service", 0.022823241389184883]], "call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.": [["Native API", 0.10800978809454731], ["Event Triggered Execution", 0.067779744175128], ["Shared Modules", 0.05257173008183615], ["System Binary Proxy Execution", 0.0509641666679137], ["Command and Scripting Interpreter", 0.043718615142878406], ["Hijack Execution Flow", 0.040552041968219925]], "Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker\u2019s counterfeit object": [["Modify Registry", 0.05198242105190951], ["Query Registry", 0.043248295603315445], ["Deobfuscate/Decode Files or Information", 0.029112599844638286], ["Automated Collection", 0.02895201091382547], ["OS Credential Dumping", 0.024848710225632883], ["Data Manipulation", 0.022207223881736172]], "leaked the stack pointer and retrieved the this pointer as a static offset from the stack.": [["Process Injection", 0.1830796788891754], ["Native API", 0.07821539076876789], ["Virtualization/Sandbox Evasion", 0.04200289126258439], ["Hijack Execution Flow", 0.03300486709693664], ["Rootkit", 0.02414613067413378], ["Hide Artifacts", 0.021683810220532056]], "vfgadget address,": [["Virtualization/Sandbox Evasion", 0.07102848335182836], ["Screen Capture", 0.060134667110335056], ["Hide Artifacts", 0.044656637314752], ["Application Window Discovery", 0.04163941676801932], ["Dynamic Resolution", 0.03975968571351675], ["System Information Discovery", 0.038547084203657114]], "prepare the address of the Windows API we want to invoke along with its arguments.": [["Native API", 0.6727462864331908], ["System Binary Proxy Execution", 0.04565663672966895], ["Masquerading", 0.03442030936480744], ["Windows Management Instrumentation", 0.02931849189670384], ["Process Injection", 0.01676891856490267], ["Hijack Execution Flow", 0.0138407414233617]], "the Windows API address and its arguments.": [["Native API", 0.3210261068902601], ["Query Registry", 0.06398763745979545], ["System Network Configuration Discovery", 0.059981248080285966], ["Masquerading", 0.043527879414038184], ["System Information Discovery", 0.04282608639289757], ["Dynamic Resolution", 0.01981852648058028]], "invoke any API we like,": [["Native API", 0.473869423302673], ["Command and Scripting Interpreter", 0.04738077526816472], ["System Services", 0.028303684072171643], ["Cloud Service Dashboard", 0.02127678265342004], ["Web Service", 0.019669888027757813], ["Ingress Tool Transfer", 0.016672767023847485]], "began sending spam emails, mailing new malicious attachments to continue spreading.": [["Phishing", 0.25411458074376997], ["Compromise Accounts", 0.09124026610640272], ["Establish Accounts", 0.05481470524808671], ["Defacement", 0.03840812406257414], ["Data Manipulation", 0.03471444650013118], ["User Execution", 0.032845575521482144]], "discover commands using the Windows utilities systeminfo": [["System Information Discovery", 0.2451063265417319], ["Windows Management Instrumentation", 0.12850319442049185], ["Query Registry", 0.1030643161000438], ["File and Directory Discovery", 0.08418590212107349], ["Software Discovery", 0.07716810524309038], ["Native API", 0.030457089291824686]], "systeminfo": [["System Information Discovery", 0.7077792217224463], ["Windows Management Instrumentation", 0.0380617257709966], ["Software Discovery", 0.028828184906075256], ["Query Registry", 0.024194451285501923], ["Virtualization/Sandbox Evasion", 0.02193021582016197], ["Process Discovery", 0.01181789382931871]], "ipconfig": [["System Network Configuration Discovery", 0.6798727029718078], ["System Network Connections Discovery", 0.043573333299833844], ["Dynamic Resolution", 0.021611180854007647], ["Impair Defenses", 0.012741708552649368], ["Adversary-in-the-Middle", 0.012210922843877037], ["Remote System Discovery", 0.01179997936995678]], "ipconfig /all": [["System Network Configuration Discovery", 0.7399259828683521], ["System Network Connections Discovery", 0.05930259077328733], ["Remote System Discovery", 0.02668134249068739], ["Network Service Discovery", 0.01363218167793512], ["Data from Configuration Repository", 0.012025486908148036], ["Gather Victim Network Information", 0.008012316307076809]], "Remote access tools were used for command and control, such as Tactical RMM and Anydesk.": [["Remote Access Software", 0.46967437859010686], ["Remote Services", 0.051179860381795735], ["Software Deployment Tools", 0.046122379558217186], ["External Remote Services", 0.0383672217779925], ["Communication Through Removable Media", 0.025574109945464583], ["Command and Scripting Interpreter", 0.019694261986386852]], "the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.": [["Remote Access Software", 0.18195402732887422], ["External Remote Services", 0.08416104394138867], ["Account Manipulation", 0.03469391258004235], ["Server Software Component", 0.03383475728901364], ["Event Triggered Execution", 0.032150952663841006], ["Software Deployment Tools", 0.023459906058061687]], "the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.": [["Remote Access Software", 0.058009805308083764], ["Windows Management Instrumentation", 0.042935199130193], ["Modify Cloud Compute Infrastructure", 0.03724019193198481], ["Exploitation of Remote Services", 0.03156859797482751], ["Remote Service Session Hijacking", 0.024666363251364568], ["Software Deployment Tools", 0.02431939133360622]], "the threat actors proceeded to deploy several remote management tools across the environment.": [["Software Deployment Tools", 0.21757847386682858], ["Remote Access Software", 0.10866093556416258], ["Exploitation of Remote Services", 0.04747353372091611], ["Develop Capabilities", 0.04665975133598819], ["Obtain Capabilities", 0.03866299116770573], ["Acquire Infrastructure", 0.027103763382284846]], "Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.": [["Remote Access Software", 0.44154188174641174], ["Software Deployment Tools", 0.06456257790818237], ["Remote Services", 0.04018881469110642], ["External Remote Services", 0.03549214804888075], ["Windows Management Instrumentation", 0.02398247904701319], ["Command and Scripting Interpreter", 0.022351850013918546]], "the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.": [["Remote Access Software", 0.041077012481874405], ["Data Encrypted for Impact", 0.03228039236099991], ["Ingress Tool Transfer", 0.03169508781269138], ["Obtain Capabilities", 0.026885326344980174], ["Execution Guardrails", 0.023252446034921055], ["Develop Capabilities", 0.023081510016559687]], "used by the threat actor for the remote management of Tactical RMM Agent.": [["Remote Access Software", 0.19682820284008798], ["Command and Scripting Interpreter", 0.035777045327435586], ["Acquire Infrastructure", 0.032706255067990034], ["External Remote Services", 0.03209564639351598], ["Software Deployment Tools", 0.023137954954314047], ["Develop Capabilities", 0.021566635947246924]], "Using this RMM agent they proceeded to install AnyDesk on the host.": [["Inhibit System Recovery", 0.04430813605225554], ["Windows Management Instrumentation", 0.044225121297396974], ["Masquerading", 0.03188752740136094], ["Virtualization/Sandbox Evasion", 0.03185451324802896], ["System Binary Proxy Execution", 0.02919931045162169], ["Command and Scripting Interpreter", 0.023000778167777916]], "Tactical RMM Agent was installed by the threat actor on a server to ensure remote access": [["Remote Access Software", 0.1531702613360792], ["Remote Services", 0.08362631426796382], ["External Remote Services", 0.06239539683015617], ["Valid Accounts", 0.05798906456030261], ["Exploitation of Remote Services", 0.04052982013458559], ["Server Software Component", 0.03174560729481896]], "The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands": [["Obfuscated Files or Information", 0.08167720752159487], ["Deobfuscate/Decode Files or Information", 0.0802438194652487], ["Command and Scripting Interpreter", 0.050536196134257194], ["Indicator Removal", 0.04583044607704832], ["Event Triggered Execution", 0.030487397008848727], ["Masquerading", 0.027344117273373818]], "The Powershell script, when double clicked (executed),": [["Command and Scripting Interpreter", 0.41726556225904976], ["User Execution", 0.04927526943324476], ["Event Triggered Execution", 0.04420640970746645], ["Native API", 0.04186776316029978], ["System Binary Proxy Execution", 0.029237816632143816], ["Boot or Logon Autostart Execution", 0.027675803145273202]], "they also used tasklist": [["Process Discovery", 0.16703967257583652], ["Masquerading", 0.13728441640245143], ["System Service Discovery", 0.060150135097209095], ["Scheduled Task/Job", 0.04306386541957577], ["Impair Defenses", 0.018420568945347243], ["Indicator Removal", 0.018151456717465316]], "Next, they proceeded to transfer a beacon executable over SMB to the remote host\u2019s ProgramData directory.": [["Lateral Tool Transfer", 0.18245406657458776], ["Remote Services", 0.09504648843875779], ["Taint Shared Content", 0.08876014320832443], ["Ingress Tool Transfer", 0.05022462301653415], ["System Services", 0.034748697923259395], ["Data from Network Shared Drive", 0.026990907711170034]], "The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers": [["Lateral Tool Transfer", 0.29540805357309874], ["Remote Services", 0.11967616587555674], ["Valid Accounts", 0.053229580291544905], ["Exploitation of Remote Services", 0.03452840689851343], ["Remote System Discovery", 0.027755110186706], ["Taint Shared Content", 0.026116987296746833]], "rasomware deployment to all hosts over SMB.": [["Lateral Tool Transfer", 0.19196796130202007], ["Remote Services", 0.14310173085731837], ["Taint Shared Content", 0.10360088902854499], ["Exploitation of Remote Services", 0.07311777734717682], ["Software Deployment Tools", 0.06053796217229869], ["Windows Management Instrumentation", 0.019360840981569875]], "files transferred via SMB as SYSTEM on remote hosts.": [["Lateral Tool Transfer", 0.3246880967771085], ["Remote Services", 0.18111645855506817], ["Network Share Discovery", 0.05975488016314214], ["Taint Shared Content", 0.05789971302518548], ["Data from Network Shared Drive", 0.05609216480492592], ["Data from Local System", 0.01743199457343997]], "an executable Cobalt Strike beacon was copied via SMB to a target machine": [["Lateral Tool Transfer", 0.1743032657569981], ["Remote Services", 0.06880943584002958], ["Taint Shared Content", 0.03786336735739273], ["Ingress Tool Transfer", 0.037656746548793134], ["Data from Network Shared Drive", 0.03743239413026723], ["System Services", 0.02802977621800915]], "This beacon was then successfully executed via WMI": [["Windows Management Instrumentation", 0.31751367296854704], ["Event Triggered Execution", 0.08224070548190884], ["System Services", 0.04852095323659214], ["Pre-OS Boot", 0.0207829959472495], ["Traffic Signaling", 0.020038599157152982], ["Multi-Factor Authentication Interception", 0.014500715756749927]], "then executed via WMI.": [["Windows Management Instrumentation", 0.3605270552136553], ["Event Triggered Execution", 0.10380711408081414], ["Boot or Logon Autostart Execution", 0.045732675181416604], ["Pre-OS Boot", 0.02892488547943052], ["Boot or Logon Initialization Scripts", 0.020093020061000208], ["System Services", 0.019607797873006]], "wmic": [["Windows Management Instrumentation", 0.5738337147964214], ["Event Triggered Execution", 0.01786319158356258], ["OS Credential Dumping", 0.01429872113056913], ["Remote Services", 0.012444490335443589], ["Command and Scripting Interpreter", 0.011932241657207791], ["Input Capture", 0.010272827511704054]], "setup a Registry Run Key to maintain persistence on the beachhead host.": [["Boot or Logon Autostart Execution", 0.10400560680780721], ["Boot or Logon Initialization Scripts", 0.08650233453916627], ["Event Triggered Execution", 0.07512358993004456], ["Scheduled Task/Job", 0.06814696390489566], ["Create or Modify System Process", 0.05855542113955588], ["Pre-OS Boot", 0.057216755145608124]], "established persistence via a run key.": [["Boot or Logon Autostart Execution", 0.34473879453652995], ["Boot or Logon Initialization Scripts", 0.11065227720816662], ["Event Triggered Execution", 0.09862091773851009], ["Create or Modify System Process", 0.08081121909099458], ["Scheduled Task/Job", 0.0464240398526095], ["Modify Registry", 0.03582371961136502]], "commands to download an Emotet DLL onto the computer.": [["Ingress Tool Transfer", 0.25278390417627417], ["System Binary Proxy Execution", 0.12657553630095567], ["BITS Jobs", 0.07444513726440591], ["Command and Scripting Interpreter", 0.048026550525183946], ["Shared Modules", 0.037961175890719], ["Masquerading", 0.02493991608373129]], "the threat actors dropped Powertool64.exe and dontsleep.exe in preparation for their final actions.": [["Masquerading", 0.09910482046649946], ["Impair Defenses", 0.08415687876959849], ["Service Stop", 0.0700699635002535], ["System Shutdown/Reboot", 0.04478551808761568], ["Obfuscated Files or Information", 0.03828484500312985], ["Virtualization/Sandbox Evasion", 0.031997741430908215]], "the threat actors then dropped SoftPerfect\u2019s Network Scanner": [["Network Service Discovery", 0.20178859922493794], ["Remote System Discovery", 0.10606278566221235], ["Active Scanning", 0.07257983875410888], ["System Network Connections Discovery", 0.05512329406423291], ["System Network Configuration Discovery", 0.05122860630510013], ["Impair Defenses", 0.04786380406540051]], "dropped and executed on the server": [["System Binary Proxy Execution", 0.06768518007841924], ["Command and Scripting Interpreter", 0.0598048699287764], ["Ingress Tool Transfer", 0.05915068662648834], ["Indicator Removal", 0.044941396291461363], ["Escape to Host", 0.0384103648415691], ["System Services", 0.036938244098690655]], "Windows net commands were run,": [["Windows Management Instrumentation", 0.13377029329574544], ["Command and Scripting Interpreter", 0.10140265524634175], ["System Network Connections Discovery", 0.05921641405290444], ["Remote System Discovery", 0.056975421851297434], ["Remote Services", 0.03675424584592002], ["Native API", 0.027441957465844866]], "threat actors proceeded to run the net commands": [["Impair Defenses", 0.08382459377734634], ["Remote System Discovery", 0.043130732076021666], ["Dynamic Resolution", 0.03309681529297178], ["System Network Configuration Discovery", 0.03288722986817463], ["Adversary-in-the-Middle", 0.0321363391164197], ["Command and Scripting Interpreter", 0.030740824017770722]], "the threat actors conducted further discovery tasks running find.bat and p.bat,": [["File and Directory Discovery", 0.09709349294390632], ["Automated Collection", 0.08808779844544441], ["Remote System Discovery", 0.05896882399704274], ["Active Scanning", 0.05108285571162179], ["Windows Management Instrumentation", 0.041016014729751644], ["Indicator Removal", 0.03488584817519132]], "and a batch file 1.bat were dropped on the host and the batch file was executed": [["Command and Scripting Interpreter", 0.42116438509366344], ["Scheduled Task/Job", 0.09120147345930728], ["System Binary Proxy Execution", 0.08175697384689612], ["System Services", 0.03909335567591045], ["Windows Management Instrumentation", 0.027155366651817697], ["Native API", 0.02378421141940258]], "two batch files were run.": [["Command and Scripting Interpreter", 0.2768575150522484], ["Scheduled Task/Job", 0.09023243701236769], ["Indicator Removal", 0.06261524308447784], ["Windows Management Instrumentation", 0.03704524447681812], ["System Binary Proxy Execution", 0.0349166117236835], ["Masquerading", 0.025990559574200617]], "The first find.bat was used to run": [["Command and Scripting Interpreter", 0.13247999608020217], ["Native API", 0.0887769365075011], ["File and Directory Discovery", 0.06892388848660377], ["System Binary Proxy Execution", 0.06538549110706977], ["Masquerading", 0.04126819576550694], ["Windows Management Instrumentation", 0.040282382289635245]], "cmd.exe /c start": [["Boot or Logon Autostart Execution", 0.20245013120168578], ["System Services", 0.07920460375585422], ["System Binary Proxy Execution", 0.07610197854603039], ["Command and Scripting Interpreter", 0.0719694743494369], ["Create or Modify System Process", 0.05080091862405522], ["Event Triggered Execution", 0.04988659392615159]], "the threat actor executed a batch script": [["Command and Scripting Interpreter", 0.35895895265558325], ["Scheduled Task/Job", 0.1528410646113096], ["Windows Management Instrumentation", 0.03927168666602872], ["System Services", 0.03409882757886655], ["System Binary Proxy Execution", 0.02921856328155955], ["Inter-Process Communication", 0.02674615261311883]], "They then proceeded to dump credentials from the LSASS process on the host.": [["OS Credential Dumping", 0.4773883944904493], ["Unsecured Credentials", 0.15785928465389348], ["Credentials from Password Stores", 0.0876766007299549], ["Network Sniffing", 0.03011890992895615], ["Input Capture", 0.02819462300947575], ["Brute Force", 0.019326258383566473]], "the \u2018mimikatz\u2019 string in the Netlogon event that is used by the Mimikatz Zerologon implementation.": [["System Owner/User Discovery", 0.06142241586775781], ["OS Credential Dumping", 0.055683074635075484], ["Event Triggered Execution", 0.05331847217370752], ["Boot or Logon Initialization Scripts", 0.042545078380321705], ["Input Capture", 0.03662384819736183], ["System Network Connections Discovery", 0.02721423004459867]], "Process access to LSASS was observed, likely to dump credentials": [["OS Credential Dumping", 0.6234661429146247], ["Unsecured Credentials", 0.08467290406271896], ["Credentials from Password Stores", 0.044305078674998825], ["Input Capture", 0.02797385454967023], ["Network Sniffing", 0.01945833146360114], ["Native API", 0.010973995463187494]], "The Granted Access level matches know indicators for Mimikatz": [["Permission Groups Discovery", 0.1508235234522424], ["File and Directory Permissions Modification", 0.08420330062344851], ["Abuse Elevation Control Mechanism", 0.06386660714955167], ["Query Registry", 0.050155099355681736], ["System Owner/User Discovery", 0.04696949287894682], ["Access Token Manipulation", 0.03266079436924752]], "request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.": [["OS Credential Dumping", 0.13522252157073134], ["Permission Groups Discovery", 0.05495284738636559], ["Password Policy Discovery", 0.052339942111428284], ["Query Registry", 0.04762217967608856], ["Unsecured Credentials", 0.04344349820542226], ["System Owner/User Discovery", 0.039839035145407285]], "With some further process injection": [["Process Injection", 0.6108897015982964], ["Native API", 0.1517590232025621], ["System Binary Proxy Execution", 0.026608346046987853], ["Access Token Manipulation", 0.01995251442746285], ["System Services", 0.019264130372156362], ["Hijack Execution Flow", 0.019259683843266776]], "The threat actor was observed process injecting into legitimate process": [["Process Injection", 0.4329715738208273], ["Process Discovery", 0.12998035265003707], ["Access Token Manipulation", 0.06468334805800396], ["Native API", 0.04010796468374056], ["Impair Defenses", 0.03286649727160016], ["Create or Modify System Process", 0.020391013356519928]], "from a process that was injected with Cobalt Strike.": [["Process Injection", 0.24204917745230828], ["Process Discovery", 0.0669370424269045], ["Native API", 0.057531234384148214], ["Deobfuscate/Decode Files or Information", 0.029704025716079732], ["BITS Jobs", 0.026467567390893017], ["Ingress Tool Transfer", 0.02425371953988979]], "Injected Process Name": [["Process Injection", 0.3645481886169098], ["Process Discovery", 0.20817322661250293], ["Native API", 0.13973121386340873], ["Access Token Manipulation", 0.03295846030073298], ["Masquerading", 0.030585733033017697], ["Create or Modify System Process", 0.02199326604508986]], "the processes used for injection": [["Process Injection", 0.613240635793956], ["Native API", 0.0974188840664216], ["Process Discovery", 0.015346819784410192], ["Hijack Execution Flow", 0.013570669268436352], ["Event Triggered Execution", 0.013256139454425143], ["System Binary Proxy Execution", 0.008368038470882147]], "The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread": [["Process Injection", 0.8845162282458156], ["Native API", 0.031048424742044792], ["Process Discovery", 0.009397075061778287], ["Access Token Manipulation", 0.00581329911230431], ["Hijack Execution Flow", 0.004220947585480918], ["Create or Modify System Process", 0.003919758964755958]], "from an injected process": [["Process Injection", 0.6538480336629966], ["Native API", 0.13686914419234356], ["Process Discovery", 0.019960323336093808], ["System Services", 0.01957740605580281], ["Access Token Manipulation", 0.019388058843669703], ["System Binary Proxy Execution", 0.0173763685761879]], "A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.": [["OS Credential Dumping", 0.08505273488271023], ["Modify Authentication Process", 0.06945848911638546], ["Brute Force", 0.05755470726754286], ["Valid Accounts", 0.05524996978770481], ["Steal or Forge Kerberos Tickets", 0.04698382443466385], ["Remote Services", 0.029099447146084017]], "After choosing a new server and connecting via RDP,": [["Remote Services", 0.4080792641578586], ["Remote Access Software", 0.10039610719061368], ["Remote Service Session Hijacking", 0.05543035059278733], ["External Remote Services", 0.02412519705214674], ["Lateral Tool Transfer", 0.021977350218507646], ["Remote System Discovery", 0.019125361486222358]], "From there, the threat actors began connecting to other hosts via RDP, including the a backup server.": [["Remote Services", 0.22364060881058762], ["Remote Access Software", 0.10471638067221047], ["External Remote Services", 0.05112427062833859], ["Lateral Tool Transfer", 0.03701127577547862], ["Transfer Data to Cloud Account", 0.02611088194764754], ["Valid Accounts", 0.024950081617673977]], "did RDP to a few other servers": [["Remote Services", 0.5590356243652568], ["Remote Access Software", 0.09404970687655735], ["Remote Service Session Hijacking", 0.0488752081020309], ["External Remote Services", 0.03369960085345254], ["Exploitation of Remote Services", 0.02698135699774999], ["Valid Accounts", 0.015009161148652401]], "traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement": [["System Network Connections Discovery", 0.23755520492617277], ["Remote Services", 0.17164890726078333], ["Remote Service Session Hijacking", 0.0573662283651985], ["Remote System Discovery", 0.04074562994301682], ["Exploitation of Remote Services", 0.03328890939322756], ["Remote Access Software", 0.02811625265720053]], "They started by connecting to a new server via RDP": [["Remote Services", 0.22424645207170685], ["Remote Access Software", 0.09756596304048142], ["Remote Service Session Hijacking", 0.06255450236254066], ["External Remote Services", 0.05144883729489847], ["Valid Accounts", 0.03517409981259324], ["Exploitation of Remote Services", 0.02246931420031002]], "Once establishing the RDP connection, they deployed Powertool64.exe,": [["Remote Services", 0.5725750845153104], ["Remote Access Software", 0.06938026228734627], ["Windows Management Instrumentation", 0.02767549086980862], ["Remote Service Session Hijacking", 0.022289290892001993], ["Event Triggered Execution", 0.019610190217022653], ["Exploitation of Remote Services", 0.013229976753329098]], "The threat actor kept the remote desktop session alive": [["Remote Services", 0.23942636022137592], ["Remote Service Session Hijacking", 0.2346801612503615], ["Remote Access Software", 0.08818278180173295], ["Event Triggered Execution", 0.05316230169668133], ["External Remote Services", 0.025847992351424806], ["Scheduled Task/Job", 0.023043378728821395]], "to execute encoded scripts.": [["Obfuscated Files or Information", 0.39390176226028184], ["Deobfuscate/Decode Files or Information", 0.21275388807250184], ["Data Encoding", 0.0631855801127266], ["Command and Scripting Interpreter", 0.048080242016941256], ["System Binary Proxy Execution", 0.016354803567768788], ["Native API", 0.01404849501374511]], "The script will decode itself": [["Deobfuscate/Decode Files or Information", 0.6544293250973784], ["Obfuscated Files or Information", 0.14497179690215467], ["Data Encoding", 0.048850771246163244], ["Archive Collected Data", 0.024346132318450484], ["Encrypted Channel", 0.012242444468208945], ["Command and Scripting Interpreter", 0.009143094511684413]], "The decoded base 64 content": [["Deobfuscate/Decode Files or Information", 0.5019117349852096], ["Obfuscated Files or Information", 0.19342985143304897], ["Data Encoding", 0.13183212496082292], ["Archive Collected Data", 0.03446212990452933], ["Data Obfuscation", 0.013694650903673652], ["Encrypted Channel", 0.012560468470947602]], "is a Base64 encoded script with various components split into different variables for obfuscation purposes.": [["Obfuscated Files or Information", 0.8418139594883018], ["Deobfuscate/Decode Files or Information", 0.07173946159891484], ["Data Encoding", 0.01159160442162069], ["Archive Collected Data", 0.007617730320799288], ["Masquerading", 0.005611226530304054], ["Data Obfuscation", 0.0050862902914659705]], "A service was also created for the agent.": [["Create or Modify System Process", 0.3632076199985334], ["System Services", 0.15361602372089522], ["Masquerading", 0.048844061004320066], ["System Service Discovery", 0.042995172318390965], ["Scheduled Task/Job", 0.0170449068408668], ["Cloud Service Discovery", 0.01483678402602911]], "service was installed in the system": [["Create or Modify System Process", 0.34009287196655774], ["System Service Discovery", 0.20091509504017546], ["System Services", 0.17766112492703504], ["Cloud Service Discovery", 0.03369786531822449], ["Masquerading", 0.027833119856717416], ["Hijack Execution Flow", 0.025990335613769497]], "svcService Type: user mode serviceService Start Type: auto startService Account: LocalSystem": [["Create or Modify System Process", 0.2665168492283042], ["Boot or Logon Autostart Execution", 0.10031307611242025], ["Boot or Logon Initialization Scripts", 0.09495947785722848], ["Access Token Manipulation", 0.038444555965288035], ["Create Account", 0.03589814849294176], ["Event Triggered Execution", 0.03567819020348604]], "a separate service was created for that agent.": [["Create or Modify System Process", 0.346071560258857], ["System Services", 0.10489259014102187], ["Masquerading", 0.05822803784553527], ["System Service Discovery", 0.02676373899363799], ["Access Token Manipulation", 0.025291190268528368], ["Service Stop", 0.018743446234842347]], "--serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystem": [["Create or Modify System Process", 0.29777036535933665], ["Boot or Logon Initialization Scripts", 0.11104782621140719], ["Boot or Logon Autostart Execution", 0.06049016008630884], ["Access Token Manipulation", 0.04065012973406595], ["Event Triggered Execution", 0.03509526077886744], ["Create Account", 0.0319482191481196]], "Service Type: user mode serviceService Start Type: auto startService Account: LocalSystem": [["Create or Modify System Process", 0.45714656647934265], ["Boot or Logon Initialization Scripts", 0.06738389448465487], ["Boot or Logon Autostart Execution", 0.05620624093085451], ["System Services", 0.04540068897863008], ["Access Token Manipulation", 0.03393669194015124], ["System Service Discovery", 0.028607743032547008]], "The threat actor was observed creating remote services": [["Network Service Discovery", 0.07257405481935379], ["System Services", 0.07220711474011476], ["System Service Discovery", 0.05503151350319769], ["Exploitation of Remote Services", 0.05099553655386187], ["Impair Defenses", 0.030704891052046258], ["Windows Management Instrumentation", 0.029316410681856028]], "This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.": [["System Binary Proxy Execution", 0.0781204414618663], ["System Services", 0.06802439933241987], ["Masquerading", 0.0431275851144703], ["Event Triggered Execution", 0.042939284793467446], ["Windows Management Instrumentation", 0.04201817263924089], ["Scheduled Task/Job", 0.03957598477490118]], "C:\\Windows\\System32\\cmd.exe /c rundll32.exe C:\\ProgramData\\x86.dll, StartA": [["System Binary Proxy Execution", 0.2050757264147219], ["Hijack Execution Flow", 0.18554851693434532], ["Native API", 0.08164655590408766], ["Boot or Logon Autostart Execution", 0.07858115566954944], ["Event Triggered Execution", 0.03856797873569467], ["Masquerading", 0.03841650094169123]], "delete its process file": [["Indicator Removal", 0.3447807165381786], ["Service Stop", 0.12193186910321295], ["Impair Defenses", 0.05049521011928957], ["Process Discovery", 0.040428278204350694], ["Data Destruction", 0.03601716585389218], ["Masquerading", 0.03282750597734915]], "delete the driver files.": [["Indicator Removal", 0.396172872814941], ["System Shutdown/Reboot", 0.0440369942068572], ["Inhibit System Recovery", 0.04403190718608424], ["Modify Registry", 0.029693366084512177], ["Impair Defenses", 0.02818646977581877], ["Disk Wipe", 0.02778941838268614]], "removing files from the system.": [["Indicator Removal", 0.6507156231094849], ["Data Destruction", 0.07774902245148474], ["Disk Wipe", 0.03653405668039671], ["Inhibit System Recovery", 0.03292229217688704], ["System Shutdown/Reboot", 0.026141219764214668], ["Service Stop", 0.012691890486486439]], "The threat actor was observed deleting files that had been dropped to disk": [["Indicator Removal", 0.614926970269981], ["Data Destruction", 0.09624475003963687], ["Inhibit System Recovery", 0.025253537805015748], ["Disk Wipe", 0.020701298905862024], ["System Shutdown/Reboot", 0.014616378358353024], ["Service Stop", 0.010697972725505307]], "whoami /groups": [["System Owner/User Discovery", 0.32371448044802975], ["Account Discovery", 0.24698434133208122], ["Permission Groups Discovery", 0.12089114362645784], ["Create Account", 0.036724243537560666], ["Valid Accounts", 0.01564629824690374], ["Account Manipulation", 0.015322165342261414]], "The threat actor was observed creating remote services in order to execute beacon DLL files": [["System Services", 0.26611153391599485], ["Hijack Execution Flow", 0.08384918850494623], ["System Binary Proxy Execution", 0.043591160477622036], ["Event Triggered Execution", 0.035944479596518086], ["Create or Modify System Process", 0.03353747737104111], ["Windows Management Instrumentation", 0.025014883130889898]], "the threat actors began to review sensitive documents": [["Obtain Capabilities", 0.07015560480184901], ["Email Collection", 0.0516951369101167], ["Phishing", 0.044669933976581325], ["Data Manipulation", 0.040243211225179744], ["Develop Capabilities", 0.035731409862753694], ["Impair Defenses", 0.027885285053310085]], "Both HTTP and HTTPS were observed to be used.": [["Application Layer Protocol", 0.6616075580183792], ["Non-Standard Port", 0.04502144456085196], ["Data Obfuscation", 0.029471195488390247], ["Encrypted Channel", 0.021323054135325634], ["Fallback Channels", 0.021192168414900472], ["Non-Application Layer Protocol", 0.01736566066330519]], "Infected email attachments": [["Phishing", 0.41010265267594015], ["User Execution", 0.21840393314662346], ["Email Collection", 0.045956110160577816], ["Template Injection", 0.016201340908144755], ["Application Layer Protocol", 0.014442798556632821], ["Office Application Startup", 0.013482525955741056]], "obtaining relevant device data, such as OS version and architecture, hardware ID, CPU, RAM, screen resolution, system language, etc.": [["System Information Discovery", 0.6309109681134758], ["Peripheral Device Discovery", 0.09985567902924081], ["Virtualization/Sandbox Evasion", 0.03875939921558679], ["Windows Management Instrumentation", 0.02973968381925834], ["System Network Configuration Discovery", 0.019877407785967305], ["Software Discovery", 0.014057387337991816]], "collects information, primarily system information": [["System Information Discovery", 0.5572234826025106], ["Software Discovery", 0.05298343551014926], ["Windows Management Instrumentation", 0.04898756207353623], ["Data from Configuration Repository", 0.02529882625638923], ["Automated Collection", 0.021891705619383986], ["Gather Victim Host Information", 0.020586951348273822]], "can take away system": [["System Shutdown/Reboot", 0.18682894067632003], ["Disk Wipe", 0.13673968003085668], ["Indicator Removal", 0.10721833610499143], ["Inhibit System Recovery", 0.06941954852483953], ["Data Destruction", 0.04889644275993411], ["Service Stop", 0.03097363850871814]], "exfiltrate files and extract data from specific applications.": [["Data from Local System", 0.1418915169418297], ["Exfiltration Over Web Service", 0.05755976380947157], ["Archive Collected Data", 0.04685636991471867], ["Exfiltration Over C2 Channel", 0.03538597500132289], ["Indicator Removal", 0.03354889177339766], ["Data Staged", 0.03293819812966386]], "acquire browsing histories, Internet cookies, usernames/passwords, personally identifiable details, credit card numbers, and other highly sensitive information from browsers.": [["Credentials from Password Stores", 0.30942709961683146], ["Browser Bookmark Discovery", 0.1564232261789144], ["Browser Session Hijacking", 0.13286963041177108], ["Browser Extensions", 0.04080340389515533], ["Steal Web Session Cookie", 0.03699030932226337], ["Unsecured Credentials", 0.02834040306550215]], "target stored browser data": [["Browser Session Hijacking", 0.20780649907586624], ["Browser Bookmark Discovery", 0.17859256098619097], ["Credentials from Password Stores", 0.08416422894235692], ["Browser Extensions", 0.07580469360536878], ["Stage Capabilities", 0.05370742676577469], ["Steal Web Session Cookie", 0.032541740289027114]], "collects sensitive information from the victim\u2019s machine": [["Data from Local System", 0.11363853563286506], ["Automated Collection", 0.10510166410761858], ["Exfiltration Over C2 Channel", 0.09163491586244502], ["Archive Collected Data", 0.0810728209439963], ["Email Collection", 0.0727207675009624], ["Data Staged", 0.056941731360561736]], "collects cookie information, search histories, and key inputs from browsers": [["Browser Bookmark Discovery", 0.18719167561944783], ["Credentials from Password Stores", 0.17293659247967255], ["Steal Web Session Cookie", 0.07937599614181287], ["Browser Extensions", 0.07368208723285549], ["Browser Session Hijacking", 0.07119188274616302], ["Input Capture", 0.03536479032019094]], "collect inside of the \u201cWeb Data\u201d\u00a0SQLite\u00a0file": [["Data from Local System", 0.11987475330728507], ["Data Staged", 0.11631164714555436], ["Data from Information Repositories", 0.10632851456671706], ["Automated Collection", 0.06498720222941752], ["Automated Exfiltration", 0.029900621761027604], ["Archive Collected Data", 0.029330614486859394]], "sensitive data from the victim\u2019s machine.": [["Exfiltration Over C2 Channel", 0.11900472244047443], ["Archive Collected Data", 0.10805457588733118], ["Exfiltration Over Alternative Protocol", 0.08127662799054089], ["Data from Local System", 0.07886697387722938], ["Email Collection", 0.07143932368136756], ["Data Staged", 0.04107168871703343]], "usernames/passwords,": [["Brute Force", 0.18318397169180148], ["Credentials from Password Stores", 0.1324336377685218], ["OS Credential Dumping", 0.09185865409325489], ["Unsecured Credentials", 0.07936807511400575], ["Input Capture", 0.06677480754991637], ["Password Policy Discovery", 0.044369995298595276]], "include saved credentials": [["Credentials from Password Stores", 0.17278573780807027], ["Unsecured Credentials", 0.1365007455155051], ["Input Capture", 0.06770352835743972], ["Valid Accounts", 0.0632340174894326], ["OS Credential Dumping", 0.06146670329484147], ["Modify Authentication Process", 0.04846738049101967]], "run under the name \u201ctmp.exe\u201d by unpacking itself to the \u201cC:\\Users\\admin\\AppData\\Local\\Temp\\\u201d file path.": [["Masquerading", 0.21955899261222594], ["Hijack Execution Flow", 0.2172504232002205], ["System Binary Proxy Execution", 0.18399523168590015], ["Native API", 0.0401482288883829], ["Process Injection", 0.03129630455223014], ["Hide Artifacts", 0.02523686895136049]], "Registry Key Sets": [["Modify Registry", 0.5303017587439264], ["Boot or Logon Autostart Execution", 0.13965156522114586], ["Query Registry", 0.1272404197709084], ["Office Application Startup", 0.014949108979497198], ["Boot or Logon Initialization Scripts", 0.012913187714649665], ["Impair Defenses", 0.008867321540755084]], "transmits information as a zip file": [["Archive Collected Data", 0.5457052081274344], ["Exfiltration Over Alternative Protocol", 0.05974470164689689], ["Obfuscated Files or Information", 0.04279815981106506], ["Exfiltration Over C2 Channel", 0.03769639939989306], ["Ingress Tool Transfer", 0.026877800002896943], ["Automated Collection", 0.023767813493829046]], "sends this information to its C2 server": [["Exfiltration Over C2 Channel", 0.16445735266840095], ["Automated Collection", 0.07468949737592748], ["System Information Discovery", 0.07247924482811653], ["Web Service", 0.05315089994260624], ["System Owner/User Discovery", 0.04848900339371856], ["System Network Configuration Discovery", 0.034558878094065194]], "C2 is transmitted as a zip file during the POST request.": [["Exfiltration Over C2 Channel", 0.20898932743589788], ["Application Layer Protocol", 0.1582600111369686], ["Data Encoding", 0.13366038476194692], ["Exfiltration Over Alternative Protocol", 0.07488085912745872], ["Archive Collected Data", 0.04340993127708269], ["Web Service", 0.037870222953606876]], "transferred to the C2 server as a zip file.": [["Archive Collected Data", 0.24150105720615792], ["Exfiltration Over C2 Channel", 0.11398559915385918], ["Exfiltration Over Alternative Protocol", 0.06643694865086933], ["Ingress Tool Transfer", 0.06581607068800256], ["Data from Local System", 0.044140315745216645], ["Automated Exfiltration", 0.04268428166029726]], "transfers them to the C2 address": [["Ingress Tool Transfer", 0.16631523470831389], ["Exfiltration Over C2 Channel", 0.13653482108894835], ["Web Service", 0.07013582932102315], ["Automated Exfiltration", 0.05178526795135033], ["Data from Local System", 0.03296572861894593], ["Application Layer Protocol", 0.0322254572910782]], "many obfuscated strings that are being covered by a random string, \u201cedx765\u201c, to evade detection.": [["Obfuscated Files or Information", 0.844515403300547], ["Deobfuscate/Decode Files or Information", 0.021582457440569656], ["Data Obfuscation", 0.016300296960519906], ["Data Encoding", 0.013094729510093056], ["Masquerading", 0.012701922204787499], ["Execution Guardrails", 0.009608910253599551]], "obfuscated information,": [["Obfuscated Files or Information", 0.7215422159692743], ["Deobfuscate/Decode Files or Information", 0.04563797643004268], ["Archive Collected Data", 0.025626859060915257], ["Data Encoding", 0.0248933549699102], ["Data Obfuscation", 0.021864448660169795], ["Encrypted Channel", 0.01229039785084379]], "passes the obfuscated string to a function that strips the arbitrary string and delivers the original string": [["Obfuscated Files or Information", 0.5931368554009379], ["Deobfuscate/Decode Files or Information", 0.15788621442905154], ["Data Encoding", 0.02290395269816448], ["Data Obfuscation", 0.018053965097821686], ["Archive Collected Data", 0.015475930159350027], ["Masquerading", 0.01411334009612755]], "passes the obfuscated string to a function that strips the arbitrary string and delivers the original string.": [["Obfuscated Files or Information", 0.602417397872452], ["Deobfuscate/Decode Files or Information", 0.15407835784737853], ["Data Encoding", 0.027566107944129472], ["Data Obfuscation", 0.019420952141374053], ["Archive Collected Data", 0.01597160011715532], ["Masquerading", 0.013728675543335365]], "Making a \u2018POST\u2019 request,": [["Application Layer Protocol", 0.10508700667080237], ["Web Service", 0.07139753386309428], ["Exfiltration Over C2 Channel", 0.05601016418043981], ["Exfiltration Over Alternative Protocol", 0.02826716678907742], ["Use Alternate Authentication Material", 0.025262561788726712], ["Browser Session Hijacking", 0.02452393834569877]], "multiple POST requests to the \u201cc2/sock\u201d address": [["Application Layer Protocol", 0.22382837579328493], ["Exfiltration Over C2 Channel", 0.08161440033857455], ["Fallback Channels", 0.06581127899129716], ["Data Obfuscation", 0.038448750947712704], ["Dynamic Resolution", 0.03820455084660605], ["Web Service", 0.034790047976030754]], "accessed C2 while visiting port 80": [["Application Layer Protocol", 0.3166828039091393], ["Non-Standard Port", 0.1343613580186265], ["Fallback Channels", 0.06136162821755937], ["Non-Application Layer Protocol", 0.04866678137246201], ["Dynamic Resolution", 0.03886704544794658], ["Proxy", 0.0377620355381688]], "they are instructed to click \u201cConfirm\u201d to view a message from \u201cExpress.\u201d": [["Email Collection", 0.05636703026763297], ["Web Service", 0.0514233966012306], ["Application Layer Protocol", 0.04404513712433814], ["Use Alternate Authentication Material", 0.036547875522336605], ["Fallback Channels", 0.03280970800838921], ["Data Manipulation", 0.02607729396268536]], "The user is also asked to permit push notifications in the browser,": [["Web Service", 0.05707831212464127], ["Browser Extensions", 0.03574614538526328], ["Fallback Channels", 0.030835758653972662], ["Event Triggered Execution", 0.018843727544452085], ["Steal Application Access Token", 0.018785463674916618], ["User Execution", 0.018547247964767474]], "Once decrypted, the configuration file reveals several parameters,": [["Deobfuscate/Decode Files or Information", 0.5259999384864734], ["Data Encrypted for Impact", 0.049705859981460515], ["Obfuscated Files or Information", 0.043946655046587575], ["Archive Collected Data", 0.032763206748541995], ["Weaken Encryption", 0.03180153541504509], ["Execution Guardrails", 0.027319793645916104]], "Decryption exclusion list": [["Deobfuscate/Decode Files or Information", 0.3316292143394543], ["Obfuscated Files or Information", 0.13107938669657657], ["Data Encrypted for Impact", 0.10581097281253998], ["Execution Guardrails", 0.09385821258223064], ["Archive Collected Data", 0.038454733393290044], ["Encrypted Channel", 0.03321268643517002]], "decrypted using the RC4 algorithm with a hard-coded key in the resource.": [["Deobfuscate/Decode Files or Information", 0.5640140326944545], ["Data Encrypted for Impact", 0.10532037318420079], ["Encrypted Channel", 0.04746441325651381], ["Weaken Encryption", 0.043157305987339266], ["Obfuscated Files or Information", 0.03454993761175914], ["Archive Collected Data", 0.03246618984811959]], "send the decryption program": [["Deobfuscate/Decode Files or Information", 0.6827173311606358], ["Obfuscated Files or Information", 0.059432346652359726], ["Data Encrypted for Impact", 0.05760494009945747], ["Archive Collected Data", 0.04959997409035597], ["Encrypted Channel", 0.028537234613517877], ["Weaken Encryption", 0.014285721174765901]], "and decrypted": [["Deobfuscate/Decode Files or Information", 0.2660978878565096], ["Data Encrypted for Impact", 0.1620129541074329], ["Archive Collected Data", 0.08458375478698754], ["Obfuscated Files or Information", 0.07629209544748106], ["Weaken Encryption", 0.02982134858457883], ["Execution Guardrails", 0.02771740288125004]], "decrypted using the RC4 algorithm with a hardcoded key in the resource.": [["Deobfuscate/Decode Files or Information", 0.5201451501205202], ["Data Encrypted for Impact", 0.12303122944448962], ["Weaken Encryption", 0.05006281018377462], ["Encrypted Channel", 0.048813664117015085], ["Archive Collected Data", 0.03588417967239966], ["Obfuscated Files or Information", 0.035185614686053725]], "the hardcoded key to decrypt the configuration file.": [["Deobfuscate/Decode Files or Information", 0.3101583508736908], ["Unsecured Credentials", 0.08679417377476935], ["Weaken Encryption", 0.06936470073774874], ["Modify Registry", 0.068722004020014], ["Data Encrypted for Impact", 0.05525458633147454], ["Execution Guardrails", 0.03229542898330057]], "to decrypt the configuration file.": [["Deobfuscate/Decode Files or Information", 0.378784272769657], ["Obfuscated Files or Information", 0.06586178274914158], ["Modify Registry", 0.0655282675970066], ["Data Encrypted for Impact", 0.04660441892336236], ["Weaken Encryption", 0.03884710610537049], ["Unsecured Credentials", 0.02962218572811442]], "Get configuration file and decrypt it": [["Deobfuscate/Decode Files or Information", 0.4427777330932247], ["Obfuscated Files or Information", 0.1012748793557905], ["Unsecured Credentials", 0.060186861073608475], ["Modify Registry", 0.043465358450242984], ["OS Credential Dumping", 0.03504057651571586], ["Query Registry", 0.034217328494020795]], "Decryptor download": [["Deobfuscate/Decode Files or Information", 0.6444090027769165], ["Data Encrypted for Impact", 0.07977164645971847], ["Archive Collected Data", 0.06704265245364302], ["Obfuscated Files or Information", 0.03751930755087374], ["Encrypted Channel", 0.017907688526009935], ["Weaken Encryption", 0.011948270079769355]], "The decryptor is delivered in a zip archive containing the decryptor executable": [["Deobfuscate/Decode Files or Information", 0.6745379384423383], ["Obfuscated Files or Information", 0.057859531129815685], ["Archive Collected Data", 0.0546978255154761], ["Data Encrypted for Impact", 0.05216550499025489], ["Encrypted Channel", 0.012678224061912925], ["Weaken Encryption", 0.012310890129305545]], "the decryptor to clean up their environment.": [["Deobfuscate/Decode Files or Information", 0.1415337230751605], ["Data Encrypted for Impact", 0.11101114515972862], ["Service Stop", 0.07152253773410401], ["Archive Collected Data", 0.05809060748772702], ["Weaken Encryption", 0.04227259494792298], ["Obfuscated Files or Information", 0.03819542425060821]], "At the end of the decryption process, the program indicates the number of decrypted files": [["Deobfuscate/Decode Files or Information", 0.2862032787857446], ["File and Directory Discovery", 0.13052588810056118], ["Data Encrypted for Impact", 0.12203159345951695], ["Archive Collected Data", 0.07115511129801526], ["Obfuscated Files or Information", 0.056895001795386146], ["System Information Discovery", 0.026317759537140543]], "Decryptor has finished the decryption process": [["Deobfuscate/Decode Files or Information", 0.5986560930550456], ["Data Encrypted for Impact", 0.10768516100781264], ["Encrypted Channel", 0.03124350053440321], ["Archive Collected Data", 0.03091702316548843], ["Weaken Encryption", 0.024181407875952736], ["Obfuscated Files or Information", 0.02088262711240118]], "Decryptor execution": [["Deobfuscate/Decode Files or Information", 0.6525367840987081], ["Data Encrypted for Impact", 0.08523012170497091], ["Obfuscated Files or Information", 0.03754936226162142], ["Encrypted Channel", 0.0313476503978864], ["Weaken Encryption", 0.026560051645267424], ["Archive Collected Data", 0.022041287542390858]], "The decryptor program appears unique and is linked to one victim specifically. In our example, it only decrypts the files": [["Deobfuscate/Decode Files or Information", 0.5165598039363835], ["Data Encrypted for Impact", 0.14378058377211653], ["Archive Collected Data", 0.049797765228769005], ["Obfuscated Files or Information", 0.03963246380851572], ["Execution Guardrails", 0.027563045496943234], ["Encrypted Channel", 0.01562086326506879]], "one to get information about the machine, such as the operating system version,": [["System Information Discovery", 0.8985345224073625], ["Software Discovery", 0.014915056067741364], ["Windows Management Instrumentation", 0.013267135645159078], ["Virtualization/Sandbox Evasion", 0.010102648901929958], ["Query Registry", 0.008640817899088396], ["File and Directory Discovery", 0.004591961067522891]], "one to get processes": [["Process Discovery", 0.802663183402922], ["Native API", 0.043421498926540215], ["Process Injection", 0.02277895766218087], ["System Service Discovery", 0.012674021976904294], ["Windows Management Instrumentation", 0.011127258650485583], ["Access Token Manipulation", 0.008610329324273585]], "reflective DLL loading, to inject a DLL from memory.": [["Process Injection", 0.3562408160349786], ["Hijack Execution Flow", 0.23316039175841502], ["Shared Modules", 0.18685889265750516], ["System Binary Proxy Execution", 0.026146210941025733], ["Event Triggered Execution", 0.015555815686406956], ["Native API", 0.01415223898010371]], "Use Windows API functions to inject DLL": [["Process Injection", 0.26693823211468154], ["Hijack Execution Flow", 0.20522512727990153], ["Shared Modules", 0.1547663733896307], ["System Binary Proxy Execution", 0.0984643655910023], ["Native API", 0.06310977612210546], ["Event Triggered Execution", 0.020722885087061504]], "a regular Bitmap (open matrix image format used by Windows) that can be used by malware to execute code or as a payload dropper": [["Obfuscated Files or Information", 0.15798657473355973], ["Screen Capture", 0.12470046350510916], ["Build Image on Host", 0.061931339808076774], ["Deploy Container", 0.03792354286130322], ["Masquerading", 0.03182930263516864], ["Archive Collected Data", 0.02764889768835499]], "The image\u2019s pixels are an actual binary representation of the payload.": [["Obfuscated Files or Information", 0.11448979103396424], ["Screen Capture", 0.08272054733892996], ["Data Obfuscation", 0.06332292814399197], ["Build Image on Host", 0.05303039302974481], ["Data Encoding", 0.04086656584095062], ["Deploy Container", 0.03899807252217175]], "This process can be summarized as Exe -> Resources -> BMP with embedded data in pixels fetched": [["Screen Capture", 0.2499335855607553], ["Data from Local System", 0.04741803720678599], ["Video Capture", 0.04143187962249289], ["Automated Collection", 0.03136803238092995], ["Archive Collected Data", 0.0297754168686652], ["Virtualization/Sandbox Evasion", 0.02645442462311896]], "The unpacked malware": [["Obfuscated Files or Information", 0.25778181968878777], ["Deobfuscate/Decode Files or Information", 0.11645753709029114], ["Masquerading", 0.06844601144896183], ["Software Discovery", 0.03097196342308351], ["Command and Scripting Interpreter", 0.030258141858777118], ["System Binary Proxy Execution", 0.029427692964819136]], "the configuration file encrypted.": [["Obfuscated Files or Information", 0.14749939756396116], ["Modify Registry", 0.12846895500367117], ["Deobfuscate/Decode Files or Information", 0.1166522935229943], ["Unsecured Credentials", 0.06482518420265752], ["Data Encrypted for Impact", 0.03682992819407864], ["Execution Guardrails", 0.03400599752560793]], "PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption": [["Obfuscated Files or Information", 0.48599588586782533], ["Deobfuscate/Decode Files or Information", 0.20347362872844624], ["Data Encoding", 0.11111993141850803], ["Archive Collected Data", 0.03572660250408571], ["Encrypted Channel", 0.023509145631804573], ["Command and Scripting Interpreter", 0.015143845072247988]], ". The malware will try first to write in the registry-hive \u201cHKEY_LOCAL_MACHINE\u201d but if it cannot create it, it will use the registry-hive \u201cHKEY_CURRENT_USER\u201d:": [["Query Registry", 0.31195408724889717], ["Modify Registry", 0.19124386274689578], ["Boot or Logon Autostart Execution", 0.08903500734561187], ["Abuse Elevation Control Mechanism", 0.026955008738547656], ["Event Triggered Execution", 0.024625545240946168], ["System Binary Proxy Execution", 0.023100160851251918]], "Write in the registry": [["Modify Registry", 0.6012168168890589], ["Boot or Logon Autostart Execution", 0.13720401757256384], ["Query Registry", 0.05798016398350654], ["Office Application Startup", 0.01717147424883606], ["Boot or Logon Initialization Scripts", 0.01592865083404287], ["Create or Modify System Process", 0.01364872243464959]], "After the writing in the registry has been completed": [["Modify Registry", 0.5697267641926235], ["Boot or Logon Autostart Execution", 0.12029659172180038], ["Query Registry", 0.053520146541763416], ["Indicator Removal", 0.02944611965137312], ["Office Application Startup", 0.02191724559101687], ["Event Triggered Execution", 0.015598169772451922]], "write in the registry information": [["Modify Registry", 0.5008506665478331], ["Query Registry", 0.24788821260394434], ["Boot or Logon Autostart Execution", 0.0694923625080463], ["Indicator Removal", 0.012025130605955062], ["Boot or Logon Initialization Scripts", 0.01011351298668932], ["Office Application Startup", 0.009776300822492656]], "Create its own registry key in \\SOFTWARE\\<uniquename>": [["Modify Registry", 0.5106112170633549], ["Boot or Logon Autostart Execution", 0.19488006759713347], ["Query Registry", 0.07548945306607395], ["Masquerading", 0.021930709093105225], ["Office Application Startup", 0.014592244954222303], ["Create or Modify System Process", 0.01208891722396303]], "using the functions \u201cSHGetFolderPathlW\u201d and \u201cCreateFileW\u201d": [["File and Directory Discovery", 0.2191509766335639], ["Data Staged", 0.12291106666542131], ["Native API", 0.07771430139510382], ["Masquerading", 0.061801612368301256], ["Hide Artifacts", 0.04979276564276156], ["Indicator Removal", 0.026516398334361948]], "with the function \u201cWriteFile\u201d.": [["Archive Collected Data", 0.0925026909086382], ["Data Staged", 0.08442490527693239], ["Hide Artifacts", 0.05293564287483194], ["Command and Scripting Interpreter", 0.05164309647425353], ["Indicator Removal", 0.04681327964204922], ["Data Destruction", 0.031011938348717412]], "Use Windows API functions": [["Native API", 0.6601981060900408], ["Command and Scripting Interpreter", 0.04234416388921634], ["System Binary Proxy Execution", 0.04148537080956426], ["Masquerading", 0.02538653547521225], ["Windows Management Instrumentation", 0.02534415832536433], ["Application Window Discovery", 0.012227638755728692]], "The batch script will delete the malware sample with its path using the command \u201cdel\u201d and finally delete the bat file with the command \u201cdel %0%\u201d.": [["Indicator Removal", 0.7086343180331316], ["Command and Scripting Interpreter", 0.043876690366362464], ["Data Destruction", 0.03652975978521328], ["Windows Management Instrumentation", 0.01486041155973949], ["Masquerading", 0.012608280791901615], ["Disk Wipe", 0.01112585614542083]], "the malware uses the \u201cdel\u201d command": [["Indicator Removal", 0.6815863451077354], ["Data Destruction", 0.07742158400187536], ["Inhibit System Recovery", 0.0203762991016568], ["System Shutdown/Reboot", 0.01926054412882153], ["Disk Wipe", 0.016559030204047764], ["Service Stop", 0.011051215630181164]], "the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers": [["Indicator Removal", 0.26468250206365534], ["Impair Defenses", 0.17513883455281345], ["Software Discovery", 0.0447433238104754], ["Masquerading", 0.03417472969087946], ["Windows Management Instrumentation", 0.023786465441648], ["System Shutdown/Reboot", 0.0185740256227356]], "deletes the ransom note": [["Indicator Removal", 0.22397968262225906], ["Data Encrypted for Impact", 0.2040416820821954], ["Data Destruction", 0.05986801941884751], ["Modify Registry", 0.036606610607437605], ["Inhibit System Recovery", 0.034957498684282946], ["Masquerading", 0.02535204918118041]], "The batch script": [["Command and Scripting Interpreter", 0.7449656245543509], ["Scheduled Task/Job", 0.030048590546642277], ["System Binary Proxy Execution", 0.01666722356605634], ["Windows Management Instrumentation", 0.01297323608281784], ["System Services", 0.008342790779803145], ["Indicator Removal", 0.007873986444360735]], "The download is done directly from the NetWalker Tor site": [["Ingress Tool Transfer", 0.24111539012261565], ["Application Layer Protocol", 0.04448450775805846], ["Web Service", 0.033045430913321565], ["Proxy", 0.02940974404711692], ["Stage Capabilities", 0.0290516100455025], ["BITS Jobs", 0.027512109539716677]], "they will be able to download the decryptor": [["Deobfuscate/Decode Files or Information", 0.35263597668770646], ["Data Encrypted for Impact", 0.15183762351091895], ["Archive Collected Data", 0.071877174106787], ["Obfuscated Files or Information", 0.04231424862144104], ["Weaken Encryption", 0.04071546756552108], ["Encrypted Channel", 0.021722618127716954]], "Place a value on RunOnce key": [["Boot or Logon Autostart Execution", 0.3750018973580737], ["Event Triggered Execution", 0.10552362961091442], ["Create or Modify System Process", 0.05713350035518682], ["System Binary Proxy Execution", 0.04572109495312117], ["Boot or Logon Initialization Scripts", 0.029162153649433937], ["Hijack Execution Flow", 0.027319752338110903]], "performing password spray,": [["Brute Force", 0.30883474960141466], ["Modify Authentication Process", 0.09423997886635052], ["Password Policy Discovery", 0.0678269324955582], ["OS Credential Dumping", 0.05596666817129949], ["Credentials from Password Stores", 0.03537283333480054], ["Unsecured Credentials", 0.029612447206708886]], "Activity from a password-spray associated IP address.": [["Network Sniffing", 0.14947707390186912], ["Adversary-in-the-Middle", 0.10836958885991312], ["System Network Configuration Discovery", 0.06241043323043491], ["Brute Force", 0.03892267681958406], ["System Network Connections Discovery", 0.031575543466448884], ["Gather Victim Network Information", 0.030047248285721282]], "an IP address that had been identified as participating in password spray": [["Brute Force", 0.15255818475452143], ["Adversary-in-the-Middle", 0.08403165519056377], ["Network Sniffing", 0.07213534752674522], ["Password Policy Discovery", 0.05951442028760909], ["Steal or Forge Kerberos Tickets", 0.03600344452924507], ["System Network Configuration Discovery", 0.03207289840539547]], "credential stuffing attacks": [["Modify Authentication Process", 0.11179884854959463], ["Brute Force", 0.09591896723341488], ["Forced Authentication", 0.06930556915754696], ["Valid Accounts", 0.060902478781358925], ["Forge Web Credentials", 0.058281558857184806], ["Use Alternate Authentication Material", 0.041644103533601595]], "is distributed through exposed Remote Desktop Protocol (RDP) setups": [["Remote Services", 0.48026897806970203], ["Remote Access Software", 0.10298122820316363], ["Exploitation of Remote Services", 0.039345605017747885], ["Remote System Discovery", 0.03909434345758053], ["Software Deployment Tools", 0.03549869272735127], ["Remote Service Session Hijacking", 0.023755156606449616]], "a heavy emphasis on Remote Desktop Protocols.": [["Remote Services", 0.32373609102488804], ["Remote Access Software", 0.12928394990196365], ["Exploitation of Remote Services", 0.0383220598086842], ["External Remote Services", 0.03546931304044581], ["Software Deployment Tools", 0.023934939291104098], ["Develop Capabilities", 0.020914883660265324]], "by brute-forcing them": [["Brute Force", 0.39046881918753706], ["Steal or Forge Kerberos Tickets", 0.031955407839696616], ["Gather Victim Identity Information", 0.028724151860397312], ["Credentials from Password Stores", 0.021517668029478753], ["OS Credential Dumping", 0.020952125952393003], ["Unsecured Credentials", 0.020070067000331846]], "using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway devices": [["Exploit Public-Facing Application", 0.32895360814081515], ["Exploitation of Remote Services", 0.07189730607634404], ["External Remote Services", 0.04037687842802595], ["Network Boundary Bridging", 0.023012135531415505], ["Server Software Component", 0.021593242661525198], ["Develop Capabilities", 0.020842688386018084]], "uses other tools to gather credentials that include Mimikatz, LaZagne, and NirSoft\u2019s NetPass.": [["Credentials from Password Stores", 0.25227699977402673], ["Unsecured Credentials", 0.19242074631935926], ["OS Credential Dumping", 0.16654019931504485], ["Brute Force", 0.057085385131954526], ["Modify Authentication Process", 0.030371024716584837], ["Network Sniffing", 0.026426564419355744]], "It uses bat files": [["Command and Scripting Interpreter", 0.5508000005103662], ["System Binary Proxy Execution", 0.054229263139332885], ["Scheduled Task/Job", 0.03750999042107562], ["Masquerading", 0.024425333790178243], ["Native API", 0.022204024641532084], ["Boot or Logon Autostart Execution", 0.021611946155499866]], "A batch file to stop services": [["Service Stop", 0.4480412135203135], ["System Services", 0.08542420539733918], ["Create or Modify System Process", 0.07755023404335441], ["System Service Discovery", 0.06481779582898839], ["Impair Defenses", 0.044615676706372356], ["Masquerading", 0.023352739413595645]], "the stolen credentials are used to reach high-value machines like servers": [["Valid Accounts", 0.1419112357641662], ["Brute Force", 0.0887212248581004], ["Unsecured Credentials", 0.07556514962197222], ["Credentials from Password Stores", 0.07014442548781971], ["Gather Victim Identity Information", 0.04633346651795386], ["Modify Authentication Process", 0.04281439437115359]], "WMIC /node": [["Windows Management Instrumentation", 0.6718183057743019], ["Command and Scripting Interpreter", 0.02392687074913851], ["Event Triggered Execution", 0.01640879707541914], ["OS Credential Dumping", 0.013154648349538053], ["Native API", 0.012950856875812267], ["Remote Services", 0.011499305934112492]], "reg add HKLM\\software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System": [["Query Registry", 0.24484870047351692], ["Modify Registry", 0.22569518742434458], ["Boot or Logon Autostart Execution", 0.08636789990949978], ["Domain Policy Modification", 0.042926080861508134], ["Abuse Elevation Control Mechanism", 0.03715710954048553], ["Create or Modify System Process", 0.02506001474971539]], "makes use of API GetTickCount / QueryPerformanceCounter": [["Virtualization/Sandbox Evasion", 0.09953975739733113], ["Automated Collection", 0.059005101284343414], ["System Information Discovery", 0.043781220102991195], ["System Network Connections Discovery", 0.04150257152515388], ["File and Directory Discovery", 0.04009218638331043], ["Query Registry", 0.023371869364734794]], "the help of ShellExecute API": [["Native API", 0.45045987641570884], ["Command and Scripting Interpreter", 0.27701332655400857], ["System Binary Proxy Execution", 0.040514703055422936], ["System Services", 0.02852590419793034], ["Indirect Command Execution", 0.01626370641412576], ["Windows Management Instrumentation", 0.010821548904298017]], "delete itself from the target systems after infection": [["Indicator Removal", 0.4902543209417848], ["Data Destruction", 0.11100730349148134], ["Inhibit System Recovery", 0.04791532692041171], ["System Shutdown/Reboot", 0.047472882355611944], ["Disk Wipe", 0.04211360657958729], ["Windows Management Instrumentation", 0.015448336338570366]], "It also drops and installs": [["Replication Through Removable Media", 0.09023274890394714], ["Pre-OS Boot", 0.036910371702004084], ["Create or Modify System Process", 0.03176484630024003], ["Masquerading", 0.031186337268314275], ["Ingress Tool Transfer", 0.03057672649624943], ["System Binary Proxy Execution", 0.030195071154866138]], "sets the following registry entry to open the downloaded PDF file every time the computer boots": [["Boot or Logon Autostart Execution", 0.17658100110372224], ["User Execution", 0.06791728551947808], ["Masquerading", 0.05653703342175884], ["Event Triggered Execution", 0.05001671136645553], ["Office Application Startup", 0.04989978122177622], ["Create or Modify System Process", 0.04662729071713772]], "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\iXqrVo": [["Query Registry", 0.21776581985735835], ["Boot or Logon Autostart Execution", 0.15637449120411714], ["Modify Registry", 0.1463837275289797], ["System Binary Proxy Execution", 0.038833696780536005], ["Abuse Elevation Control Mechanism", 0.03664368398414904], ["Event Triggered Execution", 0.03468426099859866]], "adding the HIDDEN file attribute": [["Hide Artifacts", 0.6029256793836651], ["Masquerading", 0.0756276452349548], ["Obfuscated Files or Information", 0.053319316845834276], ["Indicator Removal", 0.022581366156258425], ["Rootkit", 0.01849904183190179], ["File and Directory Discovery", 0.012286390095383626]], "adds the HIDDEN file attribute to the file:": [["Hide Artifacts", 0.6417829030281019], ["Masquerading", 0.061492064426992656], ["Obfuscated Files or Information", 0.05254536687482917], ["Indicator Removal", 0.025104394528033647], ["Rootkit", 0.014455869263902483], ["Deobfuscate/Decode Files or Information", 0.01269871968613168]], "taking command line arguments": [["Command and Scripting Interpreter", 0.4209482343171312], ["Native API", 0.13706405813498262], ["Indirect Command Execution", 0.0711636311497812], ["System Binary Proxy Execution", 0.024596110273713848], ["System Services", 0.017294528647564384], ["Obfuscated Files or Information", 0.010798419922040201]], "command line argument": [["Command and Scripting Interpreter", 0.42737666767996824], ["Indirect Command Execution", 0.09966012513779178], ["Native API", 0.084249917847761], ["System Binary Proxy Execution", 0.025841166204872205], ["System Services", 0.020811047309056304], ["Virtualization/Sandbox Evasion", 0.010519944910847923]], "to download and execute a remote \u201cnote.hta\u201d:": [["Ingress Tool Transfer", 0.13301959925180917], ["Data from Local System", 0.10534700992781028], ["Data Staged", 0.07466353361886474], ["Automated Collection", 0.0562081678978202], ["Command and Scripting Interpreter", 0.033020158384712055], ["File and Directory Discovery", 0.03211597161603924]], "to download another remote file": [["Ingress Tool Transfer", 0.8023740309882984], ["Command and Scripting Interpreter", 0.02165872041371695], ["Application Layer Protocol", 0.013137992145800657], ["Lateral Tool Transfer", 0.010183196602481244], ["BITS Jobs", 0.008057045763499004], ["Web Service", 0.007093114712024626]], "the download and execution": [["Ingress Tool Transfer", 0.5829544304376448], ["BITS Jobs", 0.05771172301398693], ["Command and Scripting Interpreter", 0.05283727917641475], ["Application Layer Protocol", 0.017822128851948237], ["System Binary Proxy Execution", 0.012886269949757835], ["Multi-Stage Channels", 0.01136850078802712]], "uses PowerShell to pull and run": [["Command and Scripting Interpreter", 0.5866508308105873], ["Native API", 0.0564408396231689], ["Ingress Tool Transfer", 0.037858582946068566], ["System Binary Proxy Execution", 0.031029510106168303], ["Automated Collection", 0.01900214913158638], ["Windows Management Instrumentation", 0.014677711059982761]], "downloading and executing": [["Ingress Tool Transfer", 0.6295875728115419], ["Command and Scripting Interpreter", 0.08555441252614067], ["BITS Jobs", 0.05997545498959665], ["System Binary Proxy Execution", 0.015963056323327306], ["Application Layer Protocol", 0.014990633386423176], ["Inter-Process Communication", 0.008540470157161797]], "downloads and runs": [["Ingress Tool Transfer", 0.5114757034435371], ["Command and Scripting Interpreter", 0.0822936245840239], ["BITS Jobs", 0.07666292981053102], ["System Binary Proxy Execution", 0.018871670272236254], ["Application Layer Protocol", 0.016765457741795654], ["Scheduled Task/Job", 0.01179422647080516]], "downloads and executes": [["Ingress Tool Transfer", 0.5982306099393996], ["Command and Scripting Interpreter", 0.10483439255707817], ["BITS Jobs", 0.05309143034756266], ["System Binary Proxy Execution", 0.01913949637584737], ["Application Layer Protocol", 0.012541016735461624], ["Native API", 0.012293830864422869]], "the download of wed.hta": [["Automated Collection", 0.13412002794116804], ["Data Staged", 0.07820013883940324], ["Ingress Tool Transfer", 0.06895945827705126], ["Data from Local System", 0.06030263874803677], ["Command and Scripting Interpreter", 0.03214532891450085], ["Indicator Removal", 0.029246658310120195]], "disables AMSI by hijacking the COM server, changing it from \"%windir%\\system32\\amsi.dll\" to \"C:\\IDontExist.dll\".": [["Abuse Elevation Control Mechanism", 0.06905178077683398], ["System Binary Proxy Execution", 0.05717420354642916], ["Event Triggered Execution", 0.050942050441237556], ["Subvert Trust Controls", 0.040925700169030355], ["Obfuscated Files or Information", 0.03920326658294245], ["Modify Registry", 0.03521702313545447]], "performs the following actions to alter Windows Defender settings": [["Impair Defenses", 0.3266949840656924], ["Domain Policy Modification", 0.06388477961747459], ["Modify Registry", 0.04899026125862988], ["Software Discovery", 0.03843293988185195], ["Modify System Image", 0.03475117105766405], ["File and Directory Permissions Modification", 0.0250150000372871]], "Adds the following exclusions to Windows DefenderExtensions": [["Impair Defenses", 0.39781730745919186], ["Software Discovery", 0.054271816986299536], ["Execution Guardrails", 0.043196569700102445], ["Obfuscated Files or Information", 0.03525160530125602], ["Domain Policy Modification", 0.0348943381362015], ["Subvert Trust Controls", 0.02396001880183683]], "Allows known Windows Defender Threat IDs to execute": [["Software Discovery", 0.1339432449060057], ["Windows Management Instrumentation", 0.10741562114648207], ["Masquerading", 0.07949509503971773], ["Impair Defenses", 0.0756473869236753], ["Execution Guardrails", 0.04674091634713273], ["System Binary Proxy Execution", 0.030688009433463843]], "Disables Windows Defender Attack Surface Reduction (ASR) rules": [["Impair Defenses", 0.46991586711446914], ["Domain Policy Modification", 0.03583733081427132], ["Subvert Trust Controls", 0.02575785260986951], ["Modify System Image", 0.024305236719570477], ["Execution Guardrails", 0.022041818286026853], ["Modify Registry", 0.015703064377025976]], "Disables the following Windows Defender features:Intrusion Prevention System\nIO AV Protection (does not scan downloaded files and attachments)\nRealtime monitoring\nScript scanning\nControlled folder access protection\nPUA protection\nScheduled scan": [["Impair Defenses", 0.5711283341646429], ["Software Discovery", 0.039597390942160936], ["Hide Artifacts", 0.02219533625505915], ["Masquerading", 0.017019757851145106], ["Windows Management Instrumentation", 0.01535786359055611], ["Modify Registry", 0.013874461243216816]], "Sets Network Protection to audit mode in Windows Defender": [["Impair Defenses", 0.5982292981108338], ["Software Discovery", 0.03742923506821549], ["Windows Management Instrumentation", 0.013903736237858878], ["System Network Configuration Discovery", 0.013732611658837036], ["Network Boundary Bridging", 0.0131762002564479], ["Network Service Discovery", 0.012332410373764665]], "Disables MAPS (Microsoft Active Protection Service) reporting": [["Impair Defenses", 0.4077936139900807], ["Data Manipulation", 0.030446795793519627], ["Indicator Removal", 0.02726723193108208], ["Modify Registry", 0.022700637087132564], ["Obfuscated Files or Information", 0.021741540983329227], ["Subvert Trust Controls", 0.02016627606989094]], "Allows severe/high/moderate/low-level threats to execute": [["Execution Guardrails", 0.068938445642527], ["Develop Capabilities", 0.06443555250874483], ["Impair Defenses", 0.0614673202092679], ["Obtain Capabilities", 0.04454914740331048], ["Obfuscated Files or Information", 0.03893574783490219], ["Exploitation for Defense Evasion", 0.03585825201449873]], "Disables the \"administrator in Admin Approval Mode\" user type (disables UAC prompts)": [["Abuse Elevation Control Mechanism", 0.40874686577595504], ["Domain Policy Modification", 0.08581933542407047], ["File and Directory Permissions Modification", 0.04181493988663044], ["Impair Defenses", 0.03472554447060506], ["Access Token Manipulation", 0.02490191346203775], ["Account Manipulation", 0.021493426504105902]], "Stops the WinDefend service (Windows Defender)": [["Impair Defenses", 0.24845821447066938], ["Service Stop", 0.08380117316079831], ["Masquerading", 0.05314505782466165], ["System Shutdown/Reboot", 0.04592631305328203], ["Windows Management Instrumentation", 0.03078504065076511], ["Indicator Removal", 0.02641783004540356]], "Disables the startup of the WinDefend service": [["Service Stop", 0.090062084766588], ["Create or Modify System Process", 0.08803539880565812], ["Impair Defenses", 0.0587593520898072], ["Masquerading", 0.05149219966298022], ["System Shutdown/Reboot", 0.04471580238985619], ["Boot or Logon Autostart Execution", 0.03769655833957208]], "Deletes the WinDefend service": [["Indicator Removal", 0.21144627263057242], ["System Shutdown/Reboot", 0.1153563859046454], ["Service Stop", 0.10351076255600178], ["Inhibit System Recovery", 0.04789882429751438], ["Modify Registry", 0.03776891585253802], ["Masquerading", 0.03677258049493406]], "Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc)": [["Impair Defenses", 0.6404887314996429], ["Software Discovery", 0.023313617948102376], ["Windows Management Instrumentation", 0.021360426433327265], ["Service Stop", 0.015204369463449545], ["Network Service Discovery", 0.014705226511526198], ["Indicator Removal", 0.012403282482392511]], "designed to hamper Windows Defender": [["Impair Defenses", 0.34276335511839123], ["Software Discovery", 0.08103913072794909], ["Masquerading", 0.043444667558882], ["Process Injection", 0.03213301281686681], ["Obfuscated Files or Information", 0.029078575680326655], ["Hide Artifacts", 0.024383231942571998]], "to fool potential victims into opening them.": [["User Execution", 0.27597934409810565], ["Masquerading", 0.13710060911500788], ["Phishing", 0.10916182990589159], ["Obfuscated Files or Information", 0.04599736954137328], ["Template Injection", 0.02677527701253908], ["Hide Artifacts", 0.021511282864074853]], "users still need to manually mount them and run the fake PDFs to trigger the infection chain": [["User Execution", 0.09567150805383391], ["Phishing", 0.05479973914890486], ["Taint Shared Content", 0.05203591735869572], ["Replication Through Removable Media", 0.03572903882661526], ["Masquerading", 0.03565825644652389], ["Data from Removable Media", 0.02543293024936216]], "Manually executing the lnk file triggers": [["Boot or Logon Autostart Execution", 0.24856214350367173], ["Event Triggered Execution", 0.0659024744065046], ["Modify Registry", 0.06572845956429677], ["Create or Modify System Process", 0.05507258699443008], ["Boot or Logon Initialization Scripts", 0.04073612640469593], ["System Binary Proxy Execution", 0.037153718671786254]], "Manual interactions are required": [["Command and Scripting Interpreter", 0.10772426186155105], ["Remote Services", 0.05507052027584372], ["Event Triggered Execution", 0.04975819697437375], ["User Execution", 0.030911368867494494], ["Input Capture", 0.02828875725057414], ["Web Service", 0.025582172206533697]], "a lot of junk code": [["Obfuscated Files or Information", 0.15203717668801325], ["Obtain Capabilities", 0.0922018815687791], ["Exploitation for Client Execution", 0.04641704465726835], ["Develop Capabilities", 0.04505054158057497], ["Acquire Infrastructure", 0.01933796682959973], ["Deobfuscate/Decode Files or Information", 0.017877905681312065]], "keylogging": [["Input Capture", 0.8745521679853931], ["Clipboard Data", 0.007098711052589075], ["Credentials from Password Stores", 0.005645060814521013], ["Screen Capture", 0.004853383381197705], ["Event Triggered Execution", 0.003345014990694936], ["Unsecured Credentials", 0.0033174420523192924]], "taking screenshots": [["Screen Capture", 0.8844017334136403], ["Video Capture", 0.014381578327888141], ["Application Window Discovery", 0.008865666728545005], ["Input Capture", 0.005681232220527153], ["Clipboard Data", 0.004823251035256011], ["Data from Local System", 0.003470704514939661]], "to load a binary into memory that injects": [["Process Injection", 0.5404448204318938], ["Shared Modules", 0.08684563688768991], ["Hijack Execution Flow", 0.06236434935776692], ["Native API", 0.03733784141664097], ["Obfuscated Files or Information", 0.021384007699181234], ["System Binary Proxy Execution", 0.01830434917885224]], "can modify group policy for privilege escalation and defense evasion": [["Domain Policy Modification", 0.1958612565265613], ["Abuse Elevation Control Mechanism", 0.19528801474040755], ["Exploitation for Privilege Escalation", 0.118384532058121], ["Impair Defenses", 0.047460729763386444], ["Access Token Manipulation", 0.04044366829197828], ["File and Directory Permissions Modification", 0.03686207384999044]], "can modify group policy for privilege escalation and defense evasion.": [["Abuse Elevation Control Mechanism", 0.26670326233839114], ["Exploitation for Privilege Escalation", 0.15993614000633133], ["Domain Policy Modification", 0.05893748275836965], ["File and Directory Permissions Modification", 0.053823946920614575], ["Access Token Manipulation", 0.051509241792958446], ["Impair Defenses", 0.03806533348977335]], "Attempts to delete malicious batch files.": [["Indicator Removal", 0.7693567917699381], ["Data Destruction", 0.043663417658826774], ["Masquerading", 0.013797568949171477], ["Inhibit System Recovery", 0.01273109029877035], ["Command and Scripting Interpreter", 0.011587464064821414], ["Disk Wipe", 0.01099984820764676]], "makes modifications to the Registry.": [["Modify Registry", 0.4947219020106437], ["Boot or Logon Autostart Execution", 0.08080455215537627], ["Query Registry", 0.0402618203236141], ["Impair Defenses", 0.03207308101689394], ["Create or Modify System Process", 0.02761310767965001], ["Indicator Removal", 0.019732808194067024]], "adds a custom icon to the registry,": [["Boot or Logon Autostart Execution", 0.22710689292231392], ["Masquerading", 0.14118714475014724], ["Modify Registry", 0.06457908859034737], ["Create or Modify System Process", 0.03555032197737014], ["Office Application Startup", 0.03034953579848385], ["Hijack Execution Flow", 0.02320675976101361]], "modifies the registry": [["Modify Registry", 0.6059633537533134], ["Boot or Logon Autostart Execution", 0.08262605770540947], ["Query Registry", 0.0639064800589567], ["Domain Policy Modification", 0.017554914684843225], ["Create or Modify System Process", 0.01681312874434742], ["Impair Defenses", 0.01481198208298269]], "creating a registry key HKCU\\Control Panel\\Desktop": [["Boot or Logon Autostart Execution", 0.5295261593033569], ["Modify Registry", 0.17707981095055322], ["Query Registry", 0.06015596239711345], ["Boot or Logon Initialization Scripts", 0.017952480316424754], ["Event Triggered Execution", 0.016265426073903622], ["Office Application Startup", 0.011930698853447951]], "Disables Windows Defender with batch scripts": [["Impair Defenses", 0.36702391092095527], ["Windows Management Instrumentation", 0.04267338021725126], ["Domain Policy Modification", 0.03826933676051631], ["Modify Registry", 0.03340353244663978], ["Software Discovery", 0.02646555632843873], ["Command and Scripting Interpreter", 0.02139965259357876]], "with batch scripts": [["Command and Scripting Interpreter", 0.6051380462751678], ["Scheduled Task/Job", 0.03058532458450236], ["Indicator Removal", 0.025244582957958582], ["Modify Registry", 0.01720870473195281], ["Windows Management Instrumentation", 0.014894171283491688], ["System Binary Proxy Execution", 0.011957085026267562]], "Uses batch scripts": [["Command and Scripting Interpreter", 0.741098013376149], ["Scheduled Task/Job", 0.03758163576944586], ["System Binary Proxy Execution", 0.012818235740703041], ["Windows Management Instrumentation", 0.010290079987431073], ["System Services", 0.007898603194721491], ["Indicator Removal", 0.007758030813535614]], "the command line argument": [["Command and Scripting Interpreter", 0.300884652264227], ["Native API", 0.12906648335309528], ["Indirect Command Execution", 0.09095000254305922], ["Virtualization/Sandbox Evasion", 0.02225444933171061], ["File and Directory Discovery", 0.020997130323851657], ["System Binary Proxy Execution", 0.018116614348880893]], "uses Mimikatz to dump passwords.": [["OS Credential Dumping", 0.32838526869125534], ["Credentials from Password Stores", 0.258718997774055], ["Unsecured Credentials", 0.13215585201462185], ["Brute Force", 0.05188838123091524], ["Input Capture", 0.041575990453113575], ["Password Policy Discovery", 0.04151955359646944]], "Uses GetComputerName to query the computer name.": [["System Information Discovery", 0.4042860223827321], ["Remote System Discovery", 0.21750912873604503], ["System Network Configuration Discovery", 0.05226799904592085], ["Windows Management Instrumentation", 0.028346749268267163], ["System Network Connections Discovery", 0.018070629601499244], ["Network Share Discovery", 0.017141873391894158]], "has used RDP for lateral movement.": [["Remote Services", 0.6575774241159515], ["Remote Access Software", 0.07493479208468283], ["Remote Service Session Hijacking", 0.042858943264554396], ["Exploitation of Remote Services", 0.04141578671795204], ["Lateral Tool Transfer", 0.012557989814464082], ["Communication Through Removable Media", 0.01193069416036454]], "has installed and used legitimate tools such as TeamViewer and AnyConnect on targeted systems.": [["Remote Access Software", 0.3462878159721698], ["Remote Services", 0.1847547111125251], ["Software Deployment Tools", 0.04362876561308991], ["Exploitation of Remote Services", 0.04112326645629261], ["Remote System Discovery", 0.03761830425093547], ["Communication Through Removable Media", 0.022499312882520425]], "iterate through the entire file system,": [["File and Directory Discovery", 0.44735093989483776], ["Data from Local System", 0.15272022053454787], ["Automated Collection", 0.043511364158039606], ["Indicator Removal", 0.030508619462894643], ["Data Staged", 0.026408844049711677], ["Data from Network Shared Drive", 0.025407013287397397]], "Victims receive spear phishing emails with attached malicious zip files": [["Phishing", 0.5510684379991658], ["User Execution", 0.1891176891653684], ["Phishing for Information", 0.02455887281064586], ["Internal Spearphishing", 0.012126328881856751], ["Obfuscated Files or Information", 0.011662086928608432], ["Template Injection", 0.010658819328234865]], "encoded PowerShell scripts": [["Obfuscated Files or Information", 0.4082758919840314], ["Command and Scripting Interpreter", 0.15272235664405753], ["Deobfuscate/Decode Files or Information", 0.12431882358152474], ["Data Encoding", 0.03660798647688143], ["System Binary Proxy Execution", 0.018361162145990893], ["Masquerading", 0.017155605921347707]], "scripts to download additional scripts.": [["Ingress Tool Transfer", 0.5681855662327935], ["Command and Scripting Interpreter", 0.22729384080084325], ["BITS Jobs", 0.02808729979572642], ["System Binary Proxy Execution", 0.018907738841429267], ["Web Service", 0.010963346427139555], ["Scheduled Task/Job", 0.009322634303197531]], "Creates benign-looking services for the ransomware binary.": [["Masquerading", 0.24778295948023016], ["Data Encrypted for Impact", 0.11061514746011704], ["Obfuscated Files or Information", 0.063119343207126], ["Command and Scripting Interpreter", 0.028977495876016345], ["Deobfuscate/Decode Files or Information", 0.028000288840879125], ["Ingress Tool Transfer", 0.02399007408389196]], "Lists internal IP addresses": [["System Network Configuration Discovery", 0.5537716276659524], ["Remote System Discovery", 0.0971146910482901], ["System Network Connections Discovery", 0.062040591179631475], ["Network Service Discovery", 0.030436121670496048], ["Gather Victim Network Information", 0.021511962813893264], ["Active Scanning", 0.02115168256011403]], "has installed and used PsExec to execute payloads on remote hosts.": [["Remote Services", 0.2179183506804348], ["System Services", 0.20240002414706765], ["Command and Scripting Interpreter", 0.16920627207756644], ["Windows Management Instrumentation", 0.06267325543345222], ["System Binary Proxy Execution", 0.04924850752676159], ["Scheduled Task/Job", 0.025306759528713346]], "\u00a0Malicious actors typically gain entry to organizations\u2019 Microsoft 365 environments by abusing either stolen account credentials": [["Valid Accounts", 0.2730805977517816], ["Brute Force", 0.05312661860610192], ["Forge Web Credentials", 0.03905101097203294], ["Compromise Accounts", 0.036649095054086006], ["Account Manipulation", 0.036582321180557924], ["Gather Victim Identity Information", 0.036100408476492984]], "malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.": [["Compromise Infrastructure", 0.11508194458607084], ["Obtain Capabilities", 0.07161007970206627], ["Trusted Relationship", 0.06232342358264211], ["Acquire Infrastructure", 0.05506324890479616], ["Develop Capabilities", 0.051444442280828014], ["Drive-by Compromise", 0.04304003798805125]], "Actor signs in to a Microsoft 365 account from an endpoint": [["Valid Accounts", 0.08195492050497344], ["Account Manipulation", 0.07573364693477047], ["Forge Web Credentials", 0.07239968425127428], ["Use Alternate Authentication Material", 0.06481184207305568], ["Create Account", 0.05540784190018415], ["Modify Authentication Process", 0.04593905133232044]], "malicious actor signing in to a Microsoft 365 account": [["Valid Accounts", 0.20566814499734928], ["Create Account", 0.12476604356539102], ["Account Manipulation", 0.07352573377913652], ["Establish Accounts", 0.053001676174638634], ["Compromise Accounts", 0.048484833545555925], ["Modify Authentication Process", 0.03764122747423057]], "which the actor took after logging in to a user\u2019s Microsoft 365 account": [["Account Discovery", 0.16047232187723323], ["System Owner/User Discovery", 0.10790002965232616], ["Valid Accounts", 0.0628763681334924], ["Create Account", 0.060223068904973906], ["Account Manipulation", 0.058220449616573265], ["Establish Accounts", 0.02507916733431644]], "a malicious actor was observed signing in to a Microsoft 365 account": [["Valid Accounts", 0.09983587455523944], ["Create Account", 0.07258897554086931], ["Modify Authentication Process", 0.0587045646101067], ["Account Manipulation", 0.05121870253793904], ["Account Access Removal", 0.04528938457791842], ["Use Alternate Authentication Material", 0.03586756745623596]], "began with an actor signing into an internal user\u2019s Microsoft 365 account from a VPN": [["Valid Accounts", 0.29946523387149043], ["External Remote Services", 0.21444820573287984], ["Create Account", 0.043952814436886034], ["Account Manipulation", 0.03699546093114179], ["Modify Authentication Process", 0.024057462285081196], ["Use Alternate Authentication Material", 0.020297480282926748]], "a spoof of the legitimate \u2018PerfectData\u2019 software designed to masquerade a malicious application as legitimate": [["Masquerading", 0.5363219058780625], ["Compromise Client Software Binary", 0.032200412652166], ["User Execution", 0.030480531004724566], ["Hide Artifacts", 0.029520039164880284], ["Obfuscated Files or Information", 0.028717922894838956], ["Data Manipulation", 0.025562392638083253]], "brute-force activity": [["Brute Force", 0.551744700899902], ["Steal or Forge Kerberos Tickets", 0.0356490663158989], ["Multi-Factor Authentication Interception", 0.02315080027173088], ["Use Alternate Authentication Material", 0.01577684699571539], ["Gather Victim Identity Information", 0.011964856997233557], ["OS Credential Dumping", 0.011755781560999866]], "The emails included an attachment named \u2018Credit Transfer Copy.html\u2019": [["Email Collection", 0.17554684823768793], ["Phishing", 0.09337438070935467], ["Automated Collection", 0.03254936053979128], ["Exfiltration Over C2 Channel", 0.029405299402289836], ["Data Manipulation", 0.02938670646983616], ["Exfiltration Over Alternative Protocol", 0.02368654762072136]], "capable of modifying Windows UAC prompt, disabling Windows Defender notifications, disabling Task Manager, disabling command prompt, preventing users from accessing Windows registry tools, disabling the Run command, and modifying the display timeout": [["Abuse Elevation Control Mechanism", 0.15055972793823857], ["Modify Registry", 0.06332847408539308], ["Impair Defenses", 0.05719942642354435], ["Event Triggered Execution", 0.053054279447953066], ["Boot or Logon Autostart Execution", 0.052951515927536434], ["Domain Policy Modification", 0.02988400788256236]], "performing antivirus tampering": [["Impair Defenses", 0.12610433852554706], ["Software Discovery", 0.11064776406072468], ["Obfuscated Files or Information", 0.07823468607170865], ["Modify System Image", 0.06537371068610491], ["Subvert Trust Controls", 0.06009418063940538], ["Masquerading", 0.035854533052200314]], "the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts": [["Abuse Elevation Control Mechanism", 0.5093866670231011], ["Access Token Manipulation", 0.05300481633970236], ["Domain Policy Modification", 0.04763996754631858], ["Command and Scripting Interpreter", 0.03640573645292765], ["Event Triggered Execution", 0.01997366455484472], ["Permission Groups Discovery", 0.01722599717820308]], "Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout": [["Impair Defenses", 0.12112685231342869], ["Modify Registry", 0.0653427062264151], ["Event Triggered Execution", 0.04582024222335641], ["Service Stop", 0.040561670580068813], ["Boot or Logon Autostart Execution", 0.03813135957785547], ["Abuse Elevation Control Mechanism", 0.03503949024915783]], "threat actor(s) made sure to add more paths and folders to Windows Defender exclusion including %TEMP% and C:\\Windows\\* as well as adding .ps1 (PowerShell) extension to the exclusion list.": [["Impair Defenses", 0.25548175528155365], ["Hide Artifacts", 0.0775172119857182], ["Masquerading", 0.07569379504384068], ["Windows Management Instrumentation", 0.027252523522323317], ["File and Directory Permissions Modification", 0.02690261790105626], ["Software Discovery", 0.025665392593250937]], "Disabling Windows Defender notifications, Task Manager and Command Prompt": [["Impair Defenses", 0.42413936294491783], ["Masquerading", 0.05287418607479733], ["Modify Registry", 0.03332274290351978], ["Domain Policy Modification", 0.024997459323273033], ["Service Stop", 0.023143820552918644], ["Windows Management Instrumentation", 0.021568435653469845]], "recursively removes the implementation of Windows Defender IOfficeAntiVirus": [["Impair Defenses", 0.2635946859668014], ["Indicator Removal", 0.11846298793381146], ["Software Discovery", 0.08262301292925042], ["Inhibit System Recovery", 0.05053641587299705], ["Windows Management Instrumentation", 0.03915877230358877], ["Masquerading", 0.026201277970207205]], "It then adds the extensions such as exe and DLL as exclusions to Windows Defender.": [["Impair Defenses", 0.35463486638479497], ["Software Discovery", 0.0795596160816837], ["Masquerading", 0.0462574891552625], ["Hide Artifacts", 0.02835298136216946], ["Obfuscated Files or Information", 0.02735390611295082], ["System Binary Proxy Execution", 0.023880071288807498]], "performs the antivirus checks": [["Software Discovery", 0.6507021438039315], ["Impair Defenses", 0.03560132576429469], ["Virtualization/Sandbox Evasion", 0.031013365662735815], ["Obfuscated Files or Information", 0.020552954239814437], ["System Information Discovery", 0.017922687797923227], ["Windows Management Instrumentation", 0.01617633242608726]], "The script checks the host against the list of antiviruses": [["Software Discovery", 0.5337399416228201], ["Virtualization/Sandbox Evasion", 0.050987995729759664], ["Command and Scripting Interpreter", 0.04537866248440511], ["Windows Management Instrumentation", 0.028888778338522082], ["System Information Discovery", 0.028429094787791667], ["Query Registry", 0.019568150992119015]], "antivirus check script": [["Software Discovery", 0.49433374381847855], ["Command and Scripting Interpreter", 0.06636447716055652], ["Virtualization/Sandbox Evasion", 0.043982366661550594], ["Impair Defenses", 0.03548471585868479], ["Obfuscated Files or Information", 0.027539808763700907], ["Windows Management Instrumentation", 0.025014459716627115]], "to download the malicious update.bat file from the C2 domain": [["Ingress Tool Transfer", 0.42346754639360273], ["Command and Scripting Interpreter", 0.09835600797068632], ["Web Service", 0.04101290421304533], ["Multi-Stage Channels", 0.022845370827674846], ["BITS Jobs", 0.020711933046828668], ["Masquerading", 0.01982889528251619]], "has the capability of sending additional payloads to the hosts": [["Data Obfuscation", 0.10096686152269989], ["Application Layer Protocol", 0.09536739136658462], ["Data Encoding", 0.04389749582150591], ["Ingress Tool Transfer", 0.04294690354870025], ["Command and Scripting Interpreter", 0.030797917572169483], ["Non-Application Layer Protocol", 0.027970539246954692]], "pulling additional BatLoader payloads and scripts from C2": [["Command and Scripting Interpreter", 0.3799867882341678], ["Ingress Tool Transfer", 0.18353027737066085], ["System Binary Proxy Execution", 0.08672177521621305], ["Deobfuscate/Decode Files or Information", 0.02871911981385844], ["Native API", 0.019004881685408946], ["Multi-Stage Channels", 0.01687380458435895]], "retrieves the same files from the C2": [["Ingress Tool Transfer", 0.24169178790872803], ["Data from Local System", 0.15865135887154377], ["Automated Collection", 0.0728735141194087], ["Exfiltration Over C2 Channel", 0.07188265332099801], ["Automated Exfiltration", 0.04633899125528878], ["Data Staged", 0.045300157479092856]], "executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe": [["Command and Scripting Interpreter", 0.6444965990079677], ["System Binary Proxy Execution", 0.045951600987281946], ["Native API", 0.04519943812537973], ["Ingress Tool Transfer", 0.04186990113336393], ["System Services", 0.0367272213250309], ["Indirect Command Execution", 0.012258237555638598]], "the script retrieves the Cobalt Strike payload": [["Command and Scripting Interpreter", 0.24684651518622638], ["Deobfuscate/Decode Files or Information", 0.12720348367927273], ["Ingress Tool Transfer", 0.07020718393342362], ["Obfuscated Files or Information", 0.024972519202832732], ["Execution Guardrails", 0.021769604916724285], ["BITS Jobs", 0.01942582717181033]], "retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2": [["Command and Scripting Interpreter", 0.45244920735760924], ["Indicator Removal", 0.21861014712196275], ["System Binary Proxy Execution", 0.018719394636732903], ["Deobfuscate/Decode Files or Information", 0.018084870192947796], ["Windows Management Instrumentation", 0.016000525081693383], ["Native API", 0.014504507737274984]], "then the full set of malware is retrieved from C2": [["Ingress Tool Transfer", 0.10939651519516137], ["Automated Collection", 0.09393476258365245], ["Exfiltration Over C2 Channel", 0.06333180059510385], ["Data from Local System", 0.04463358624662487], ["Command and Scripting Interpreter", 0.04137855500748766], ["Web Service", 0.04047580287950789]], "retrieving malware from C2": [["Ingress Tool Transfer", 0.17045077069100287], ["Exfiltration Over C2 Channel", 0.1010826723614936], ["Web Service", 0.06715046940193553], ["Automated Collection", 0.05550557518472752], ["Deobfuscate/Decode Files or Information", 0.042518164049947], ["Command and Scripting Interpreter", 0.03927219645024692]], "The batch file was executed": [["Command and Scripting Interpreter", 0.28240540810247583], ["Scheduled Task/Job", 0.08746378779136191], ["System Binary Proxy Execution", 0.05113684772106812], ["Indicator Removal", 0.048178473581077234], ["Windows Management Instrumentation", 0.03691867066610266], ["System Services", 0.026358132621880873]], "the batch file to run": [["Command and Scripting Interpreter", 0.5593800866871235], ["Scheduled Task/Job", 0.06471042496979147], ["System Binary Proxy Execution", 0.04513964208196388], ["Boot or Logon Autostart Execution", 0.025166017162232178], ["System Services", 0.02212584122016123], ["Windows Management Instrumentation", 0.016015672714028657]], "the batch file": [["Command and Scripting Interpreter", 0.5289955268333237], ["Scheduled Task/Job", 0.039358771714347436], ["System Binary Proxy Execution", 0.03581267522531932], ["Indicator Removal", 0.02622744452599573], ["Boot or Logon Autostart Execution", 0.023307209875707686], ["Modify Registry", 0.01916051439943277]], "The batch file": [["Command and Scripting Interpreter", 0.5289955268333237], ["Scheduled Task/Job", 0.039358771714347436], ["System Binary Proxy Execution", 0.03581267522531932], ["Indicator Removal", 0.02622744452599573], ["Boot or Logon Autostart Execution", 0.023307209875707686], ["Modify Registry", 0.01916051439943277]], "cmd /C": [["Command and Scripting Interpreter", 0.20381187624715857], ["Indirect Command Execution", 0.08634164449173724], ["Native API", 0.04207997939952324], ["File and Directory Discovery", 0.026772657523879875], ["Boot or Logon Autostart Execution", 0.025081823278014108], ["Indicator Removal", 0.01870047411154334]], "cmd /c": [["Command and Scripting Interpreter", 0.20381187624715857], ["Indirect Command Execution", 0.08634164449173724], ["Native API", 0.04207997939952324], ["File and Directory Discovery", 0.026772657523879875], ["Boot or Logon Autostart Execution", 0.025081823278014108], ["Indicator Removal", 0.01870047411154334]], "the username": [["System Owner/User Discovery", 0.6376724849680291], ["Account Discovery", 0.03583134692821553], ["System Information Discovery", 0.017700719868816252], ["Use Alternate Authentication Material", 0.01113807035164468], ["Gather Victim Identity Information", 0.010461099309706377], ["Phishing for Information", 0.009467276906107583]], "using the username": [["System Owner/User Discovery", 0.8083796740572122], ["Account Discovery", 0.027867409926263926], ["Access Token Manipulation", 0.01696356613826024], ["Create Account", 0.00708047288846135], ["Use Alternate Authentication Material", 0.006763120071755583], ["Masquerading", 0.006338184828887383]], "username": [["System Owner/User Discovery", 0.3289063559647771], ["Masquerading", 0.024849620469869212], ["Access Token Manipulation", 0.022982127837062098], ["Account Discovery", 0.021510716801012134], ["Use Alternate Authentication Material", 0.0189108980796959], ["Create Account", 0.013227243661488539]], "obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table": [["System Network Configuration Discovery", 0.2651518115709989], ["Adversary-in-the-Middle", 0.07143038079587102], ["Remote System Discovery", 0.06410950473395828], ["System Network Connections Discovery", 0.05389464573085383], ["Automated Collection", 0.034262522380768004], ["Network Service Discovery", 0.03413764040504005]], "it then checks the amount of IPs found in the ARP table": [["System Network Configuration Discovery", 0.45921645087250634], ["Remote System Discovery", 0.0948471614962251], ["System Network Connections Discovery", 0.08257721632847093], ["Network Service Discovery", 0.05276030777803605], ["Virtualization/Sandbox Evasion", 0.023931587264677034], ["Active Scanning", 0.017536048014673355]], "ARP table": [["System Network Configuration Discovery", 0.18581442722645192], ["Adversary-in-the-Middle", 0.15421734326493813], ["Remote System Discovery", 0.04947330219887578], ["Dynamic Resolution", 0.04113287105792321], ["System Network Connections Discovery", 0.033951331873369225], ["Network Service Discovery", 0.032603681655863644]], "the GPG-encrypted files:": [["Data Encrypted for Impact", 0.28129477742614073], ["Deobfuscate/Decode Files or Information", 0.11024636284938241], ["Obfuscated Files or Information", 0.10188505927050712], ["Archive Collected Data", 0.095147424258187], ["Unsecured Credentials", 0.038385321421631834], ["File and Directory Permissions Modification", 0.021963201337953864]], "the encrypted data": [["Archive Collected Data", 0.23388652733975698], ["Data Encrypted for Impact", 0.16928221238342966], ["Deobfuscate/Decode Files or Information", 0.10760923078818169], ["Obfuscated Files or Information", 0.07230491077351298], ["Exfiltration Over Alternative Protocol", 0.03964387988668878], ["Encrypted Channel", 0.038110091759706234]], "the encrypted strings reside within the function": [["Obfuscated Files or Information", 0.405675408440172], ["Deobfuscate/Decode Files or Information", 0.22092031766080225], ["Encrypted Channel", 0.07546908555532962], ["Archive Collected Data", 0.042539242568633936], ["Data Encoding", 0.03347860405688464], ["Data Encrypted for Impact", 0.025016468862175026]], "The data stored in the BSS section is encoded": [["Data Encoding", 0.32577720506797964], ["Obfuscated Files or Information", 0.17727257205302416], ["Deobfuscate/Decode Files or Information", 0.12874417032982996], ["Archive Collected Data", 0.04194109157774394], ["Data Obfuscation", 0.02878771847022545], ["Encrypted Channel", 0.018884223753859643]], "the encoded data in the BSS section": [["Data Encoding", 0.4231843888995784], ["Obfuscated Files or Information", 0.16877144873873826], ["Deobfuscate/Decode Files or Information", 0.1294179980218888], ["Archive Collected Data", 0.033541499177972785], ["Data Obfuscation", 0.029039640558088296], ["Encrypted Channel", 0.021864393516817016]], "on the API calls QueryPerformanceFrequency and QueryPerformanceCounter": [["Automated Collection", 0.1064651266595579], ["Virtualization/Sandbox Evasion", 0.04806746038559547], ["Cloud Service Dashboard", 0.040032072068160576], ["Data Staged", 0.03323251851440615], ["System Network Connections Discovery", 0.031061398543111005], ["System Time Discovery", 0.029262682165050652]], "from API call GetSystemTimeAsFileTime": [["System Time Discovery", 0.737324659074701], ["Indicator Removal", 0.052612942999176786], ["Virtualization/Sandbox Evasion", 0.03495243034225181], ["System Information Discovery", 0.013966869977833573], ["File and Directory Discovery", 0.007669204844728301], ["Native API", 0.006083722207843172]], "using the API": [["Native API", 0.11961867201931858], ["Cloud Service Dashboard", 0.10108868425036967], ["Web Service", 0.06694677749412935], ["Command and Scripting Interpreter", 0.045028494506111905], ["Ingress Tool Transfer", 0.031195641341470688], ["Application Layer Protocol", 0.020902674684722455]], "The traffic beaconing contains the following pattern that will be encrypted with the AES key extracted from the compressed blob": [["Deobfuscate/Decode Files or Information", 0.17018836029639206], ["Encrypted Channel", 0.1695958119301031], ["Obfuscated Files or Information", 0.12774699128198572], ["Archive Collected Data", 0.08821807342974775], ["Data Encoding", 0.06402567430531401], ["Weaken Encryption", 0.04729405516578121]], "the encrypted with AES-128 beacon": [["Encrypted Channel", 0.20252615564353235], ["Obfuscated Files or Information", 0.14864821661553965], ["Deobfuscate/Decode Files or Information", 0.12521345649224477], ["Data Encrypted for Impact", 0.05929445824745055], ["Archive Collected Data", 0.05438116182385492], ["Weaken Encryption", 0.04928901607914641]], "OS version and system type": [["System Information Discovery", 0.8170095507290694], ["Virtualization/Sandbox Evasion", 0.020386992380962518], ["Windows Management Instrumentation", 0.015639632252869917], ["Software Discovery", 0.014662315813170627], ["Modify System Image", 0.014031056275722317], ["Peripheral Device Discovery", 0.008915079072361885]], "computer name": [["System Information Discovery", 0.28125923461524155], ["Remote System Discovery", 0.08708371748739162], ["Masquerading", 0.08096687985088172], ["System Owner/User Discovery", 0.03742313416154439], ["System Network Configuration Discovery", 0.02484791853666667], ["Dynamic Resolution", 0.023008027287889782]], "screenshot": [["Screen Capture", 0.7638594611154118], ["Application Window Discovery", 0.012276902078195262], ["Hide Artifacts", 0.009975601965010454], ["Video Capture", 0.009725247055845446], ["Clipboard Data", 0.006906689761216497], ["Virtualization/Sandbox Evasion", 0.0067429359487877994]], "then collects the credentials, host information, files,": [["OS Credential Dumping", 0.16878137948419344], ["Credentials from Password Stores", 0.15814217435497915], ["Unsecured Credentials", 0.14665012151916657], ["Data from Local System", 0.08412843035379751], ["Network Sniffing", 0.029260610011943963], ["Input Capture", 0.024419353052621565]], "Syncro RMM is a Remote Monitoring and Management tool used to control and manage devices remotely.": [["Remote Access Software", 0.17933530234606057], ["Windows Management Instrumentation", 0.058509114800354284], ["Communication Through Removable Media", 0.04303156711712295], ["Peripheral Device Discovery", 0.03429993818570927], ["Pre-OS Boot", 0.030185173227625782], ["Remote Services", 0.028065329541588104]], "tool can be used as a persistence mechanism and remote accessing": [["Boot or Logon Autostart Execution", 0.14797569700586197], ["Event Triggered Execution", 0.09525392810988241], ["External Remote Services", 0.09433819311274186], ["Scheduled Task/Job", 0.06746484079688239], ["Boot or Logon Initialization Scripts", 0.057590676716543186], ["Create or Modify System Process", 0.03642612377760006]], "Syncro RMM can also be used as a persistence mechanism": [["Create or Modify System Process", 0.07524698685455503], ["Scheduled Task/Job", 0.06863064959946638], ["Modify Registry", 0.06350162946002073], ["Indicator Removal", 0.06344139931921394], ["Boot or Logon Autostart Execution", 0.060723244016885766], ["Event Triggered Execution", 0.04550867476236297]], "leverages SOCKS5": [["Non-Application Layer Protocol", 0.11604499119505603], ["Proxy", 0.11425487890766257], ["Application Layer Protocol", 0.11123845424202534], ["Protocol Tunneling", 0.0977383530126479], ["Non-Standard Port", 0.07364237094780642], ["Encrypted Channel", 0.044301217870123664]], "leverages SOCKS5 proxies to hide malicious traffic": [["Proxy", 0.4946791761647086], ["Protocol Tunneling", 0.0869335796405145], ["Data Obfuscation", 0.06893593984569488], ["Application Layer Protocol", 0.03935302639683663], ["Non-Application Layer Protocol", 0.03320967104709723], ["Non-Standard Port", 0.026585995874817414]], "task scheduling": [["Scheduled Task/Job", 0.5586762440695692], ["Inter-Process Communication", 0.07096019648903046], ["Masquerading", 0.019089511230079986], ["Process Discovery", 0.01416928928345662], ["System Time Discovery", 0.010987637051209444], ["Resource Hijacking", 0.010976536069981994]], "it proceeds with scheduled task creation": [["Scheduled Task/Job", 0.7864991153282627], ["Inter-Process Communication", 0.02725727915416161], ["Create or Modify System Process", 0.019312066415622574], ["System Services", 0.012609747028219959], ["Command and Scripting Interpreter", 0.01209665722140478], ["Masquerading", 0.011172840460902606]], "run the scheduled task every 2 minutes is  start.": [["Scheduled Task/Job", 0.731844657844923], ["Create or Modify System Process", 0.04683291500829127], ["Boot or Logon Autostart Execution", 0.024158655027389328], ["Event Triggered Execution", 0.01626564200216206], ["System Services", 0.015332723899132285], ["Boot or Logon Initialization Scripts", 0.010922242810730284]], "the scheduled task": [["Scheduled Task/Job", 0.7770922200125768], ["Inter-Process Communication", 0.03655024441775238], ["Masquerading", 0.017397455434339164], ["Command and Scripting Interpreter", 0.01627614440718608], ["System Services", 0.007916476358133619], ["Create or Modify System Process", 0.005979765072147829]], "creates the registry key": [["Modify Registry", 0.5444698386366479], ["Boot or Logon Autostart Execution", 0.19133066761886744], ["Query Registry", 0.08736422353112708], ["Office Application Startup", 0.012282029205932158], ["System Binary Proxy Execution", 0.011398060395692558], ["Create or Modify System Process", 0.010394309335949637]], "creating the registry key": [["Modify Registry", 0.5673211956707979], ["Boot or Logon Autostart Execution", 0.1793162333801131], ["Query Registry", 0.0763736217633413], ["Office Application Startup", 0.014208277108759477], ["System Binary Proxy Execution", 0.010705027022661975], ["Create or Modify System Process", 0.01061357582984844]], "These words are used to build the registry value names.": [["Modify Registry", 0.37930939792364377], ["Query Registry", 0.22313015247901188], ["Masquerading", 0.0830445342046266], ["Boot or Logon Autostart Execution", 0.038695697459334086], ["Office Application Startup", 0.015046441775516128], ["Indicator Removal", 0.013523193432762154]], "recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE}.": [["Impair Defenses", 0.32550262631442434], ["Indicator Removal", 0.09647092108553078], ["Software Discovery", 0.07473829634387408], ["Windows Management Instrumentation", 0.04129604952347343], ["Inhibit System Recovery", 0.03338151591013606], ["Modify Registry", 0.03083143879701092]], "enables the data transfer with URL syntax for protocols such as HTTP/HTTPS": [["Application Layer Protocol", 0.5892163372995856], ["Exfiltration Over Alternative Protocol", 0.048060616010680596], ["Non-Standard Port", 0.04214580235272423], ["Data Obfuscation", 0.037496816180529934], ["Non-Application Layer Protocol", 0.023957655725594603], ["Proxy", 0.021647511667865556]], "runs it via rundll32.exe": [["System Binary Proxy Execution", 0.5328614206102633], ["Native API", 0.11281485912648705], ["System Services", 0.04975818709352038], ["Hijack Execution Flow", 0.03333926741826439], ["Masquerading", 0.02509060492768388], ["Command and Scripting Interpreter", 0.02041670298050681]], "injects itself into explorer.exe": [["Process Injection", 0.42586732090714663], ["Masquerading", 0.0763459747617654], ["Native API", 0.07488389212942657], ["Boot or Logon Autostart Execution", 0.0530394347937185], ["Hijack Execution Flow", 0.052166514754806596], ["System Binary Proxy Execution", 0.05080354096113315]], "injecting itself into a running explorer.exe process.": [["Process Injection", 0.8010528665988135], ["Native API", 0.05038101221256192], ["Masquerading", 0.01829499230920981], ["Hijack Execution Flow", 0.017600590060029026], ["System Binary Proxy Execution", 0.012197883500753626], ["Event Triggered Execution", 0.0119986589855897]], "injecting itself into a running explorer.exe process": [["Process Injection", 0.792870887868541], ["Native API", 0.06698144221268687], ["Hijack Execution Flow", 0.014956674909343163], ["Masquerading", 0.013515685493352258], ["System Binary Proxy Execution", 0.011692717909992613], ["Event Triggered Execution", 0.011442738252470493]], "The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state": [["Process Injection", 0.4818288338172322], ["Native API", 0.1268643774065401], ["Process Discovery", 0.06911133922171614], ["Virtualization/Sandbox Evasion", 0.021381811930598803], ["Command and Scripting Interpreter", 0.018872577037168724], ["Access Token Manipulation", 0.018442705771675102]], "accessing browser credentials and cookies, Thunderbird and Outlook profiles": [["Credentials from Password Stores", 0.37476969101387614], ["Unsecured Credentials", 0.06926631710954141], ["Browser Session Hijacking", 0.051879179606488884], ["Steal Web Session Cookie", 0.04838522076364051], ["Browser Extensions", 0.04430001533528454], ["Browser Bookmark Discovery", 0.0384093086627222]], "malware creates the persistence via Registry Run Keys.": [["Boot or Logon Autostart Execution", 0.36743538005855764], ["Modify Registry", 0.14079502382979375], ["Boot or Logon Initialization Scripts", 0.09261590503758632], ["Create or Modify System Process", 0.0595421905904907], ["Event Triggered Execution", 0.050236092394702066], ["Office Application Startup", 0.02319125422616231]], "creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run": [["Boot or Logon Autostart Execution", 0.6230330347777066], ["Modify Registry", 0.07484286988738496], ["Boot or Logon Initialization Scripts", 0.05738421315635193], ["Create or Modify System Process", 0.04511958434325642], ["Event Triggered Execution", 0.040628146754642686], ["Office Application Startup", 0.018572203204896883]], "it stores three embedded binaries within the unpacked payload.": [["Obfuscated Files or Information", 0.2918306926523578], ["Deobfuscate/Decode Files or Information", 0.11292569449500464], ["Hijack Execution Flow", 0.08379031312885105], ["Ingress Tool Transfer", 0.032741097399015755], ["System Binary Proxy Execution", 0.030439576765855503], ["Hide Artifacts", 0.02874120706758488]], "the embedded compressed binaries": [["Obfuscated Files or Information", 0.522382282696816], ["Archive Collected Data", 0.15441987198605805], ["Deobfuscate/Decode Files or Information", 0.09641109867487604], ["Hijack Execution Flow", 0.01179189707247434], ["Process Injection", 0.009056180477684807], ["Masquerading", 0.00901124350356369]], "compressed binary": [["Obfuscated Files or Information", 0.36899842874337824], ["Archive Collected Data", 0.25834921580040077], ["Deobfuscate/Decode Files or Information", 0.14811808223431222], ["Data Encoding", 0.01294456340402662], ["BITS Jobs", 0.011868761497218617], ["Data Encrypted for Impact", 0.009165034024462709]], "unpacked payload": [["Deobfuscate/Decode Files or Information", 0.4456328784473709], ["Obfuscated Files or Information", 0.23687071150329933], ["Command and Scripting Interpreter", 0.03322594450272038], ["Ingress Tool Transfer", 0.024502642731508567], ["System Binary Proxy Execution", 0.01656379630297756], ["Hijack Execution Flow", 0.014349765488422463]], "The binaries are compressed using APLib compression algorithm.": [["Obfuscated Files or Information", 0.4615499861905905], ["Archive Collected Data", 0.1986079098958091], ["Deobfuscate/Decode Files or Information", 0.11053051087133463], ["Data Encoding", 0.01017494030518803], ["Hijack Execution Flow", 0.008274407658167431], ["Masquerading", 0.007491573348062796]], "The unpacked sample is approximately 540 KB": [["Obfuscated Files or Information", 0.25432789919101895], ["Archive Collected Data", 0.15170399402548754], ["Deobfuscate/Decode Files or Information", 0.08277640634031248], ["Data Transfer Size Limits", 0.0712495227607139], ["Automated Collection", 0.025040060362179883], ["Command and Scripting Interpreter", 0.018698335764339002]], "decompress data blobs": [["Archive Collected Data", 0.5102414410172399], ["Deobfuscate/Decode Files or Information", 0.1543524113391457], ["Obfuscated Files or Information", 0.05010983558346245], ["Exfiltration Over Alternative Protocol", 0.025000227413135807], ["Exfiltration Over C2 Channel", 0.019154130669378915], ["Data Encrypted for Impact", 0.015753897523127128]], "decompress them": [["Archive Collected Data", 0.49172545487677133], ["Deobfuscate/Decode Files or Information", 0.20014652618674117], ["Obfuscated Files or Information", 0.052434204722507885], ["Exfiltration Over Alternative Protocol", 0.021366799551968595], ["Automated Collection", 0.014220307605961265], ["Data Encrypted for Impact", 0.013910462699835053]], "The decompression function": [["Archive Collected Data", 0.43901681940317666], ["Deobfuscate/Decode Files or Information", 0.20782506066377698], ["Obfuscated Files or Information", 0.1136790417826647], ["Exfiltration Over Alternative Protocol", 0.015559975483985146], ["Data Encrypted for Impact", 0.015055320529451697], ["Exfiltration Over C2 Channel", 0.01125986938160587]], "Decrypted strings": [["Deobfuscate/Decode Files or Information", 0.6470871573267359], ["Obfuscated Files or Information", 0.12480207742859678], ["Data Encrypted for Impact", 0.029158982077177303], ["Encrypted Channel", 0.028563548242677785], ["Archive Collected Data", 0.027219478207735744], ["Data Encoding", 0.02461321537535378]], "Decompiled decryption function": [["Deobfuscate/Decode Files or Information", 0.7373489462952658], ["Archive Collected Data", 0.0570648208112449], ["Obfuscated Files or Information", 0.05208809339210533], ["Data Encrypted for Impact", 0.031201921438524103], ["Encrypted Channel", 0.016599453138932706], ["Weaken Encryption", 0.011451055829534849]], "Decryption function in Python": [["Deobfuscate/Decode Files or Information", 0.5667140998096802], ["Data Encrypted for Impact", 0.07416366510699701], ["Obfuscated Files or Information", 0.062271256133576335], ["Archive Collected Data", 0.05680681380023951], ["Encrypted Channel", 0.04966801237410787], ["Weaken Encryption", 0.020727797006651352]], "The decryption function": [["Deobfuscate/Decode Files or Information", 0.6363677419725045], ["Data Encrypted for Impact", 0.07521405540819548], ["Obfuscated Files or Information", 0.05853417720137413], ["Archive Collected Data", 0.04526577022892697], ["Encrypted Channel", 0.034122633791213136], ["Weaken Encryption", 0.026388205548150762]], "Decryption function": [["Deobfuscate/Decode Files or Information", 0.6237816958652259], ["Data Encrypted for Impact", 0.08706685380759117], ["Obfuscated Files or Information", 0.04882636634384091], ["Archive Collected Data", 0.04421344723460393], ["Encrypted Channel", 0.0368248024481579], ["Weaken Encryption", 0.027857050102251923]], "the decryption function": [["Deobfuscate/Decode Files or Information", 0.6363677419725045], ["Data Encrypted for Impact", 0.07521405540819548], ["Obfuscated Files or Information", 0.05853417720137413], ["Archive Collected Data", 0.04526577022892697], ["Encrypted Channel", 0.034122633791213136], ["Weaken Encryption", 0.026388205548150762]], "APLib decompression function": [["Archive Collected Data", 0.33958104270890244], ["Deobfuscate/Decode Files or Information", 0.26342778609647927], ["Obfuscated Files or Information", 0.16048298311955136], ["Exfiltration Over Alternative Protocol", 0.014153897432191713], ["Data Encrypted for Impact", 0.011686372701816656], ["Hide Artifacts", 0.010499726582500833]], "decrypts them": [["Deobfuscate/Decode Files or Information", 0.6745871928457086], ["Data Encrypted for Impact", 0.06742144085706422], ["Archive Collected Data", 0.049851043291517065], ["Obfuscated Files or Information", 0.03971364721289997], ["Encrypted Channel", 0.019188738889461997], ["Weaken Encryption", 0.013408895239094814]], "The decryption function is shown below, the decryption function can be represented as the following pseudocode:": [["Deobfuscate/Decode Files or Information", 0.7417042226531628], ["Obfuscated Files or Information", 0.04014363430455952], ["Data Encrypted for Impact", 0.039708195791823366], ["Encrypted Channel", 0.029798341675936414], ["Archive Collected Data", 0.026695792842281522], ["Weaken Encryption", 0.019128312859331198]], "The GPG decryption routine": [["Deobfuscate/Decode Files or Information", 0.5631839337262865], ["Data Encrypted for Impact", 0.09246358972774285], ["Obfuscated Files or Information", 0.06034752742734479], ["Archive Collected Data", 0.028975298982678047], ["Encrypted Channel", 0.022765025365220667], ["Weaken Encryption", 0.019052559333913404]], "GPG decryption": [["Deobfuscate/Decode Files or Information", 0.5987043108015695], ["Data Encrypted for Impact", 0.08790912829964288], ["Obfuscated Files or Information", 0.05415131709763454], ["Archive Collected Data", 0.03179183643617812], ["Encrypted Channel", 0.017792748454573765], ["Weaken Encryption", 0.015284877149173067]], "reg.exe query": [["Query Registry", 0.13817525434782035], ["Native API", 0.0956095368320141], ["File and Directory Discovery", 0.08939533091550413], ["System Binary Proxy Execution", 0.07822573018275798], ["Masquerading", 0.0698204140262435], ["Software Discovery", 0.060590367875959374]], "that pulls the written data from the registry under HKEY_CURRENT_USER\\Software\\AppDataLow\\Software\\Microsoft\\<registry_value>>": [["Query Registry", 0.6035623045161999], ["Modify Registry", 0.1787958472022823], ["Boot or Logon Autostart Execution", 0.033507551921914965], ["Unsecured Credentials", 0.014388084006332263], ["OS Credential Dumping", 0.014022958372977838], ["Software Discovery", 0.010543078057536312]], "the Tor communication capability": [["Proxy", 0.354106099364726], ["Application Layer Protocol", 0.10476800058402333], ["Protocol Tunneling", 0.09105087627490355], ["Encrypted Channel", 0.05947876175973443], ["Non-Application Layer Protocol", 0.05635058892491708], ["Data Obfuscation", 0.022256049254840923]], "Configured for WMI persistence": [["Event Triggered Execution", 0.29233307618277443], ["Windows Management Instrumentation", 0.17627970590558142], ["Boot or Logon Autostart Execution", 0.12418779033383856], ["Boot or Logon Initialization Scripts", 0.048279246810233704], ["Pre-OS Boot", 0.043289563281399504], ["Create or Modify System Process", 0.023110622201889006]], "WMI Persistence": [["Event Triggered Execution", 0.27897535234750814], ["Windows Management Instrumentation", 0.2142111101868504], ["Boot or Logon Autostart Execution", 0.0989520014658614], ["Pre-OS Boot", 0.044174555748387814], ["Boot or Logon Initialization Scripts", 0.040717379930145535], ["Modify Registry", 0.02121291306318335]], "As tasklist uses WMI \u201cunder the hood,": [["Windows Management Instrumentation", 0.44361976169441525], ["Event Triggered Execution", 0.05599788022165993], ["Process Discovery", 0.047985285878685544], ["Access Token Manipulation", 0.04718485767376919], ["Scheduled Task/Job", 0.020035756158293602], ["Masquerading", 0.019342663041748597]], "the malicious authentications into victim O365 tenants had originated from within the victim\u2019s own network.": [["Valid Accounts", 0.06753177761823306], ["Brute Force", 0.06414235757034374], ["Use Alternate Authentication Material", 0.061899386216209724], ["Forge Web Credentials", 0.05767474657900383], ["Modify Authentication Process", 0.05686235891670802], ["Steal or Forge Kerberos Tickets", 0.042705759529623695]], "the threat actor was making authentications to O365": [["Forge Web Credentials", 0.14544401118554123], ["Use Alternate Authentication Material", 0.11216882068196761], ["Modify Authentication Process", 0.06368131711047315], ["Multi-Factor Authentication Interception", 0.05670203789362769], ["Steal or Forge Kerberos Tickets", 0.05224831735811486], ["Forced Authentication", 0.03804314483927074]], "Log in to O365 as a user with privileged access to cloud resources.": [["Account Manipulation", 0.14941197476824317], ["Valid Accounts", 0.09159358085233801], ["Create Account", 0.0738390211197824], ["Steal Application Access Token", 0.05872764894534529], ["Modify Cloud Compute Infrastructure", 0.03783340970193058], ["Data from Cloud Storage", 0.03621209415115975]], "the threat actor succeeded in authenticating into victim O365 tenants": [["Account Manipulation", 0.09834801325140023], ["Use Alternate Authentication Material", 0.09642822491787614], ["Forge Web Credentials", 0.0722291743442015], ["Valid Accounts", 0.07101763770770617], ["Steal Application Access Token", 0.05206086067297367], ["Modify Authentication Process", 0.040380680422192596]], "This threat actor abused access to accounts in the Cloud Solution Partner\u2019s environment with legitimate delegated administrative privileges to then gain access to several customers\u2019 O365 environments": [["Valid Accounts", 0.20002074354872915], ["Account Manipulation", 0.15713282285211727], ["Compromise Accounts", 0.05146918197335651], ["Create Account", 0.04402312072855773], ["Compromise Infrastructure", 0.03686039697241522], ["Trusted Relationship", 0.02860458477923596]], "the threat actor connected to the victim\u2019s O365 tenant": [["Gather Victim Host Information", 0.0321113244943538], ["System Owner/User Discovery", 0.03082207935619363], ["Cloud Infrastructure Discovery", 0.030731308548842137], ["Account Manipulation", 0.029426661314310484], ["Gather Victim Identity Information", 0.02655289699298322], ["Active Scanning", 0.024325372157649208]], "the user account used to connect to the victim\u2019s O365 tenant": [["Account Manipulation", 0.15508681264889004], ["Valid Accounts", 0.14134601440736377], ["Account Discovery", 0.13426536090829952], ["Create Account", 0.10792247319721887], ["System Owner/User Discovery", 0.0324023313878268], ["Steal Application Access Token", 0.0301341258337306]], "the threat actor managed to continue to access the victim\u2019s cloud environment": [["Modify Cloud Compute Infrastructure", 0.23132129829761952], ["Account Manipulation", 0.06030537236587515], ["Cloud Infrastructure Discovery", 0.04331011746958687], ["Compromise Infrastructure", 0.037868509998240096], ["Data from Cloud Storage", 0.030221925187622595], ["External Remote Services", 0.027983606197174618]], "the accounts that were used to authenticate to the cloud.": [["Account Discovery", 0.21226229614024744], ["System Owner/User Discovery", 0.054585747892630744], ["Valid Accounts", 0.05366470243420614], ["Account Manipulation", 0.049122695593162194], ["Unsecured Credentials", 0.03966293030560849], ["Gather Victim Identity Information", 0.03343989556501173]], "the threat actor used a compromised O365 administrator account": [["Valid Accounts", 0.3196239264683465], ["Account Manipulation", 0.10514670346811102], ["Create Account", 0.06085366453742554], ["Account Discovery", 0.05119934959830811], ["Compromise Accounts", 0.028377350793258156], ["Domain Policy Modification", 0.022492235572144085]], "The threat actor created new O365 Service Principals to maintain access to victim\u2019s environments": [["Account Manipulation", 0.11280855291080688], ["Create or Modify System Process", 0.09669077268994797], ["Domain Policy Modification", 0.06103281404025283], ["Modify Cloud Compute Infrastructure", 0.05220336694038436], ["Establish Accounts", 0.03900296992510899], ["Access Token Manipulation", 0.029987389370934613]], "The threat actor used accounts with Delegated Administrator rights to access other O365 tenants": [["Valid Accounts", 0.2624601721681307], ["Account Manipulation", 0.20058188536639787], ["Create Account", 0.06245729619977469], ["Account Discovery", 0.040082204366062774], ["Permission Groups Discovery", 0.02410902773791381], ["Use Alternate Authentication Material", 0.02319091785450386]], "the threat actor leveraged different credentials for each step while moving laterally through the victim\u2019s network": [["Valid Accounts", 0.24512779411473118], ["Brute Force", 0.10928464921825948], ["Modify Authentication Process", 0.052417524042860486], ["Forced Authentication", 0.04061708618599958], ["Use Alternate Authentication Material", 0.039031211456753125], ["Remote Services", 0.03721152612489003]], "using privileged accounts and then accessed the wiki using a different set of credentials.": [["Valid Accounts", 0.06676386242639172], ["Forge Web Credentials", 0.06131130216639276], ["Use Alternate Authentication Material", 0.045675881420039], ["Server Software Component", 0.0401328596641335], ["Account Manipulation", 0.0399672882127021], ["Credentials from Password Stores", 0.030940579765361863]], "the threat actor began attempting to connect into the environment via VPN": [["External Remote Services", 0.4117204886813965], ["Proxy", 0.038046436693661055], ["Impair Defenses", 0.03630856235645119], ["Protocol Tunneling", 0.02980947604604325], ["Valid Accounts", 0.027262050646945212], ["Exploit Public-Facing Application", 0.01869032964307638]], "The threat actor attempted to log in to the VPN using several user accounts": [["External Remote Services", 0.25336694011122557], ["Valid Accounts", 0.17317418081162103], ["Brute Force", 0.03102009119713388], ["Use Alternate Authentication Material", 0.0296969831148275], ["Remote Services", 0.024217953126931386], ["Steal or Forge Kerberos Tickets", 0.023928670206934902]], "threat actor had knowledge of these accounts and used them on the correct systems": [["Valid Accounts", 0.14445150316034666], ["Compromise Accounts", 0.14169595567523963], ["Establish Accounts", 0.12182506591446031], ["Account Manipulation", 0.07583683108451701], ["Create Account", 0.06307552750601712], ["Account Discovery", 0.06286146556306418]], "the threat actor connected into the victim\u2019s environment via a VPN": [["External Remote Services", 0.460919499673565], ["Proxy", 0.07220964497826363], ["Protocol Tunneling", 0.03726782213467007], ["Valid Accounts", 0.02472836298774973], ["Network Boundary Bridging", 0.01586255347651788], ["Adversary-in-the-Middle", 0.014093948762462581]], "The Threat actor also used valid accounts to create persistence within the environment": [["Account Manipulation", 0.21994349029434354], ["Create Account", 0.07192132903486904], ["Event Triggered Execution", 0.05183307751961929], ["Valid Accounts", 0.05111917157604022], ["External Remote Services", 0.036379854660439075], ["Boot or Logon Initialization Scripts", 0.03335695913454355]], "to establish a Remote Desktop Protocol (RDP) session to an internal server": [["Remote Services", 0.421192032267475], ["Remote Service Session Hijacking", 0.16957994149114924], ["Remote Access Software", 0.06914501552988869], ["External Remote Services", 0.03346260811870904], ["Exploitation of Remote Services", 0.01203589375770991], ["Command and Scripting Interpreter", 0.010475641031660224]], "establish another RDP session to a different internal server": [["Remote Service Session Hijacking", 0.3142850979432132], ["Remote Services", 0.2877134550560666], ["Remote Access Software", 0.06495413935438735], ["External Remote Services", 0.026162626331632428], ["Access Token Manipulation", 0.013949370690792906], ["Exploitation of Remote Services", 0.01255878801704275]], "the threat actor connected via RDP to a user\u2019s workstation": [["Remote Services", 0.437996428274514], ["Remote Service Session Hijacking", 0.056958931641335975], ["Remote Access Software", 0.050637503254775396], ["System Network Connections Discovery", 0.03877984779462517], ["Remote System Discovery", 0.029850304963754022], ["Windows Management Instrumentation", 0.02808833042147882]], "the threat actor\u2019s RDP session.": [["Remote Services", 0.3409912063293671], ["Remote Service Session Hijacking", 0.15364512748355955], ["Remote Access Software", 0.0824756969287191], ["System Network Connections Discovery", 0.022002341799624597], ["External Remote Services", 0.021537198279674562], ["System Owner/User Discovery", 0.01723157603753744]], "The threat actor established RDP sessions to internal servers": [["Remote Services", 0.27781669418760313], ["Remote Service Session Hijacking", 0.26700022679099855], ["Remote Access Software", 0.05504695943685904], ["External Remote Services", 0.04544899049443505], ["Exploitation of Remote Services", 0.02510241037788337], ["Valid Accounts", 0.015134797434339455]], "The threat actor connected via Remote Desktop": [["Remote Services", 0.45239957075250553], ["Remote Access Software", 0.11386743497928754], ["Remote Service Session Hijacking", 0.06576696422190603], ["Windows Management Instrumentation", 0.041666077417437226], ["Exploitation of Remote Services", 0.02208285690491905], ["Event Triggered Execution", 0.018146222615867295]], "the user the threat actor used to RDP": [["Remote Services", 0.3740467891744185], ["System Owner/User Discovery", 0.15324417068379725], ["Remote Service Session Hijacking", 0.04777290247586636], ["Remote Access Software", 0.042175766593540664], ["System Network Connections Discovery", 0.02698898531798732], ["Account Discovery", 0.026044290597712964]], "the threat actor connected via Remote Desktop to a Domain Controller": [["Remote Services", 0.24979693037806036], ["Remote System Discovery", 0.09494779781615731], ["Remote Access Software", 0.0646821246728071], ["Windows Management Instrumentation", 0.04728127774547523], ["Remote Service Session Hijacking", 0.03834137275482247], ["Domain Policy Modification", 0.03677879851007013]], "The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system": [["Remote Services", 0.2989544271558149], ["Valid Accounts", 0.1300348899702304], ["Create Account", 0.04166730778980788], ["Account Discovery", 0.03701356063530134], ["Remote Service Session Hijacking", 0.03545054891395347], ["Account Manipulation", 0.026309072090939665]], "using a domain service account.": [["Create Account", 0.31994490502789097], ["Valid Accounts", 0.2663163520101736], ["Account Manipulation", 0.05741861268041682], ["Account Discovery", 0.036840578423037514], ["Modify Authentication Process", 0.020031223162445422], ["Remote Services", 0.012722437556709718]], "using a domain administrator\u2019s account.": [["Valid Accounts", 0.26222734658822844], ["Create Account", 0.22941240048343242], ["Account Manipulation", 0.04434335836331999], ["Account Discovery", 0.034788284664453176], ["Abuse Elevation Control Mechanism", 0.025956607130000146], ["Domain Policy Modification", 0.0221302545167985]], "the threat actor could have easily used a second domain administrator account": [["Valid Accounts", 0.39464362166493794], ["Create Account", 0.09962278389131657], ["Account Manipulation", 0.050364008396437225], ["Domain Policy Modification", 0.04028933493465368], ["Account Discovery", 0.036982567296279106], ["Permission Groups Discovery", 0.020358630912805552]], "The threat actor accomplished this by using administrative accounts": [["Valid Accounts", 0.24417984567373222], ["Create Account", 0.20903890098516906], ["Account Manipulation", 0.12704868568890135], ["Account Discovery", 0.05121012655467677], ["Account Access Removal", 0.03222623464910223], ["Modify Authentication Process", 0.023016010495488053]], "a given user account was also authenticating to Active Directory from a given source IP address two years prior": [["Valid Accounts", 0.0579827579358948], ["OS Credential Dumping", 0.04959310882061475], ["Account Discovery", 0.04397309906172453], ["Modify Authentication Process", 0.04100925104818626], ["Adversary-in-the-Middle", 0.02958056750704742], ["Account Access Removal", 0.029478938768110828]], "the user account was known to have recently been abused by the threat actor": [["Account Discovery", 0.13665174048228204], ["System Owner/User Discovery", 0.08956138367315304], ["Create Account", 0.06366202229492891], ["Valid Accounts", 0.05009439820572884], ["Compromise Accounts", 0.04937675787501834], ["Account Access Removal", 0.04673706222753571]], "the threat actor accessing the wiki as users who would be considered \u201cnon-privileged\u201d": [["Drive-by Compromise", 0.049542702366726823], ["Stage Capabilities", 0.037668524437094564], ["Server Software Component", 0.03629302159685083], ["Valid Accounts", 0.034249009054127304], ["Compromise Infrastructure", 0.03308845633433937], ["Account Manipulation", 0.026626965034256007]], "A local account was used by the Threat Actor": [["Valid Accounts", 0.17096447996460065], ["Create Account", 0.13732874043519594], ["Account Manipulation", 0.09908491578441495], ["Account Discovery", 0.05760619076086966], ["Compromise Accounts", 0.05150023897579213], ["Establish Accounts", 0.04056832577406355]], "to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.": [["Lateral Tool Transfer", 0.07577084396156035], ["Credentials from Password Stores", 0.06404537095867657], ["Remote Services", 0.05817004598998882], ["Ingress Tool Transfer", 0.05271937197053291], ["Web Service", 0.03923992845155466], ["Browser Bookmark Discovery", 0.03893139598589364]], "the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.": [["Command and Scripting Interpreter", 0.14959138772776862], ["Remote Services", 0.12057628424462177], ["Windows Management Instrumentation", 0.07028313955323424], ["Inter-Process Communication", 0.05988741567093298], ["Remote Access Software", 0.03949160238542227], ["Domain Policy Modification", 0.0387922672675142]], "the threat actor must first decrypt them": [["Deobfuscate/Decode Files or Information", 0.6130979050351436], ["Data Encrypted for Impact", 0.07659112473462251], ["Obfuscated Files or Information", 0.05474507182618935], ["Archive Collected Data", 0.04735909543596356], ["Encrypted Channel", 0.03019518512107793], ["Weaken Encryption", 0.02139180486010353]], "they decrypted the cookies file using the user\u2019s DPAPI key.": [["Credentials from Password Stores", 0.06492439708701418], ["Steal Web Session Cookie", 0.055079816459264554], ["Deobfuscate/Decode Files or Information", 0.053832314260998985], ["Forge Web Credentials", 0.048999884253382586], ["Unsecured Credentials", 0.04766129002682594], ["Use Alternate Authentication Material", 0.041708661798867716]], "The decryption of the cookies": [["Deobfuscate/Decode Files or Information", 0.1572965261594572], ["Data Encoding", 0.06646786228392326], ["Steal Web Session Cookie", 0.04388263634637488], ["Forge Web Credentials", 0.04258864865033439], ["Archive Collected Data", 0.04143606439236225], ["Use Alternate Authentication Material", 0.03603601294636926]], "deleted the specific history items related to threat actor activity": [["Indicator Removal", 0.6647500389766541], ["Impair Defenses", 0.03920636106770946], ["Inhibit System Recovery", 0.024571806158167245], ["Modify Cloud Compute Infrastructure", 0.023877072141148065], ["Data Destruction", 0.01940331858674416], ["Modify Registry", 0.012469409417086984]], "Attempted to blend in with a file name that matched the system name it resided on": [["Masquerading", 0.541706818489983], ["Hide Artifacts", 0.09978982938150924], ["Obfuscated Files or Information", 0.03032986615676789], ["Indicator Removal", 0.019407099008860798], ["File and Directory Discovery", 0.01906027170111833], ["Hijack Execution Flow", 0.01882019410902979]], "With the binary named to masquerade as a legitimate file on the system": [["Masquerading", 0.4609718604740446], ["Hijack Execution Flow", 0.12085359960462591], ["Obfuscated Files or Information", 0.038661679822896436], ["Hide Artifacts", 0.037335559635004636], ["System Binary Proxy Execution", 0.035705273197015344], ["Compromise Client Software Binary", 0.034302014086726736]], "AdFind was renamed to masquerade as a legitimate Windows binary": [["Masquerading", 0.3144273375682351], ["Native API", 0.04513297454958284], ["Remote System Discovery", 0.02804715634953318], ["System Binary Proxy Execution", 0.027198596633528423], ["File and Directory Discovery", 0.023712011215490388], ["OS Credential Dumping", 0.023380351708060788]], "The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system\u2019s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).": [["Masquerading", 0.8020448388362055], ["Hijack Execution Flow", 0.016600107702457918], ["Compromise Client Software Binary", 0.013893122312235339], ["Impair Defenses", 0.007388597604137301], ["Obfuscated Files or Information", 0.006507003304133664], ["Subvert Trust Controls", 0.006196998308148803]], "the threat actor renamed their systems prior to connecting to victim\u2019s VPNs to match the victim\u2019s system naming convention": [["Masquerading", 0.1488073365612291], ["Dynamic Resolution", 0.0799939784956682], ["External Remote Services", 0.06507319740684162], ["Adversary-in-the-Middle", 0.05018642423034142], ["Acquire Infrastructure", 0.03666643396828082], ["Proxy", 0.033769886327122994]], "Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests": [["Application Layer Protocol", 0.1553861125962318], ["Web Service", 0.10693861887841555], ["Data Obfuscation", 0.07981470366566247], ["Proxy", 0.05937758712194774], ["Dynamic Resolution", 0.04565974726010983], ["Network Denial of Service", 0.03356805701222692]], "placed in a hidden directory": [["Hide Artifacts", 0.5865566004856784], ["Masquerading", 0.09986353896908534], ["Data Staged", 0.03215552771904976], ["Obfuscated Files or Information", 0.02893313114833361], ["Rootkit", 0.019122535056615635], ["Indicator Removal", 0.015093729686921912]], "directories with random names of a consistent length were navigated to by the same user that ran the tool.": [["File and Directory Discovery", 0.33141985936315027], ["Data Staged", 0.09044670806390485], ["Automated Collection", 0.034488270588546935], ["Native API", 0.031017127233117454], ["Masquerading", 0.024957021724392396], ["Data from Local System", 0.024575257833218782]], "ListUsers": [["Account Discovery", 0.5703456939148152], ["System Owner/User Discovery", 0.2758984221458925], ["Permission Groups Discovery", 0.03575085540303569], ["Remote System Discovery", 0.006289321016645338], ["Create Account", 0.0046299644312318596], ["Gather Victim Identity Information", 0.004079368467479201]], "The threat actor attempted to remotely list running processes on systems using tasklist.exe": [["Process Discovery", 0.8216011745544152], ["Windows Management Instrumentation", 0.020944539948989354], ["System Service Discovery", 0.018207936348520644], ["Native API", 0.008814501791277234], ["Software Discovery", 0.008570360996623727], ["Process Injection", 0.008498402279155]], "process listing": [["Process Discovery", 0.8104723766766104], ["Native API", 0.01852956482316923], ["System Service Discovery", 0.01596781054440787], ["Process Injection", 0.014314930085244593], ["Windows Management Instrumentation", 0.011071590475441654], ["Impair Defenses", 0.010048698770143201]], "This remote process listing": [["Process Discovery", 0.8231529202955538], ["Native API", 0.02130278245410067], ["Windows Management Instrumentation", 0.016082349959860538], ["System Service Discovery", 0.015395124358641819], ["Process Injection", 0.011928617104824011], ["Software Discovery", 0.007387787844786635]], "the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.": [["Browser Bookmark Discovery", 0.08618914559360479], ["Process Discovery", 0.07024064818568858], ["Software Discovery", 0.0673264844981079], ["Query Registry", 0.038462018158333264], ["Windows Management Instrumentation", 0.029843192328783175], ["System Network Connections Discovery", 0.028429734456464663]], "The threat actor regularly interrogated other systems using tasklist.exe": [["Process Discovery", 0.49891690240575287], ["Windows Management Instrumentation", 0.06902508856087955], ["System Service Discovery", 0.05089344141972244], ["Scheduled Task/Job", 0.028522344221631454], ["Software Discovery", 0.02665734600308194], ["Virtualization/Sandbox Evasion", 0.01809818328055699]], "the use of a PowerShell script to execute Mimikatz in-memory": [["Command and Scripting Interpreter", 0.5744607074419841], ["System Binary Proxy Execution", 0.058294391913861085], ["Native API", 0.04877848769962614], ["Scheduled Task/Job", 0.027864783825189508], ["Windows Management Instrumentation", 0.023730716704084505], ["OS Credential Dumping", 0.022824273199194132]], "to execute the Mimikatz commands \u2018privilege::debug sekurlsa::logonpasswords \u201clsadump::lsa /patch\u201d\u2018 in-memory": [["Abuse Elevation Control Mechanism", 0.26143775444090256], ["Access Token Manipulation", 0.1017232372052205], ["Event Triggered Execution", 0.07188660600864258], ["OS Credential Dumping", 0.061429726045597065], ["Boot or Logon Autostart Execution", 0.05626395070750791], ["Boot or Logon Initialization Scripts", 0.02223322064690898]], "the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.": [["Obfuscated Files or Information", 0.45506432722290907], ["Deobfuscate/Decode Files or Information", 0.1300280595797749], ["Data Encoding", 0.08742440064731005], ["Encrypted Channel", 0.05230173900410005], ["Archive Collected Data", 0.04225874972641849], ["Data Obfuscation", 0.025301577289318065]], "used a heavily obfuscated PowerShell script": [["Obfuscated Files or Information", 0.7848751353866324], ["Deobfuscate/Decode Files or Information", 0.04810986002496412], ["Command and Scripting Interpreter", 0.017890722776176336], ["Masquerading", 0.01147378449727868], ["Archive Collected Data", 0.00986240549169698], ["Execution Guardrails", 0.009316556517988954]], "enumerating current directory\u00a0": [["File and Directory Discovery", 0.8194405594399534], ["Native API", 0.019182849697885977], ["Data Staged", 0.014603261376960379], ["Hide Artifacts", 0.008717604981416889], ["Data from Local System", 0.008555374535322555], ["System Information Discovery", 0.006589270435372953]], "tries to enumerate the current directory": [["File and Directory Discovery", 0.7968751170535253], ["Native API", 0.027476995559822838], ["Data Staged", 0.01397582012165689], ["Hide Artifacts", 0.009364850012445138], ["Data from Local System", 0.008158927317449511], ["Automated Collection", 0.007510685878486976]], "crawl the filesystem": [["File and Directory Discovery", 0.37224398599752456], ["Data from Local System", 0.1874151314886293], ["Automated Collection", 0.08433019498911674], ["Data from Network Shared Drive", 0.03471336162024067], ["Data Staged", 0.03252476276987407], ["Data from Removable Media", 0.01614126050651613]], "The decrypted payload": [["Deobfuscate/Decode Files or Information", 0.6909053925252794], ["Obfuscated Files or Information", 0.07580455401752977], ["Data Encrypted for Impact", 0.035397351729608], ["Archive Collected Data", 0.030432275113322534], ["Encrypted Channel", 0.022794449853172163], ["Weaken Encryption", 0.017596884685921774]], "Decrypted payload\u00a0": [["Deobfuscate/Decode Files or Information", 0.7136223546896522], ["Obfuscated Files or Information", 0.07866641453352867], ["Data Encrypted for Impact", 0.029477363580733076], ["Archive Collected Data", 0.02604323853282294], ["Encrypted Channel", 0.023027514598525242], ["Weaken Encryption", 0.014637056231748592]], "try to decrypt it using the RC4 encryption scheme with the key": [["Deobfuscate/Decode Files or Information", 0.6114566330558159], ["Data Encrypted for Impact", 0.07616068846217582], ["Archive Collected Data", 0.04534121583554956], ["Obfuscated Files or Information", 0.04338281258832638], ["Encrypted Channel", 0.037774892759771625], ["Weaken Encryption", 0.035213209204180564]], "then decrypts and communicates to": [["Deobfuscate/Decode Files or Information", 0.4781374685500568], ["Encrypted Channel", 0.10973650230206515], ["Archive Collected Data", 0.050744038546272074], ["Obfuscated Files or Information", 0.05015458474554088], ["Data Encrypted for Impact", 0.04150323519329669], ["Data Encoding", 0.03864756260679177]], "decodes the embedded shellcode": [["Deobfuscate/Decode Files or Information", 0.5914126178340393], ["Obfuscated Files or Information", 0.2491963880652715], ["Data Encoding", 0.024298301120235444], ["Native API", 0.00912621537314286], ["Encrypted Channel", 0.008937802758623327], ["Process Injection", 0.008812166142299632]], "contain encrypted C2 strings": [["Obfuscated Files or Information", 0.23570287218752434], ["Data Encoding", 0.19072544669019895], ["Deobfuscate/Decode Files or Information", 0.1689334994316051], ["Encrypted Channel", 0.15947335659442247], ["Archive Collected Data", 0.027782652367206485], ["Data Obfuscation", 0.02710679940181352]], "encrypted payload\u00a0": [["Obfuscated Files or Information", 0.37123349955754925], ["Deobfuscate/Decode Files or Information", 0.1576183090559039], ["Encrypted Channel", 0.11101234331963926], ["Data Encrypted for Impact", 0.05500086396375509], ["Archive Collected Data", 0.050621938086897925], ["Data Encoding", 0.03314630985824883]], "Embedded encrypted payload\u00a0": [["Obfuscated Files or Information", 0.5444013102897297], ["Deobfuscate/Decode Files or Information", 0.13031643848269317], ["Encrypted Channel", 0.05343247712763101], ["Archive Collected Data", 0.027692061746976304], ["Data Encrypted for Impact", 0.025863838171003416], ["Execution Guardrails", 0.024288110194955005]], "DLL has an encrypted payload embedded in it.": [["Obfuscated Files or Information", 0.4911398297821988], ["Deobfuscate/Decode Files or Information", 0.16246096193206389], ["Process Injection", 0.037407181642082864], ["Encrypted Channel", 0.023681002589699966], ["Hijack Execution Flow", 0.021390420383097866], ["Execution Guardrails", 0.017982229822238332]], "The embedded DLL": [["Hijack Execution Flow", 0.1779996758275699], ["Shared Modules", 0.16080692301948635], ["Process Injection", 0.14282625600734686], ["System Binary Proxy Execution", 0.11382433692006508], ["Native API", 0.043645389080282586], ["Obfuscated Files or Information", 0.02928097452032611]], "side loading \u201cffmpeg.dll\u201d.": [["System Binary Proxy Execution", 0.13663866887786036], ["Hijack Execution Flow", 0.12256732512328435], ["Masquerading", 0.0685776871842845], ["Process Injection", 0.05684660909952501], ["Deobfuscate/Decode Files or Information", 0.0424914392529321], ["Obfuscated Files or Information", 0.03733512375964929]], "that have Base64 and AES encrypted C2\u2019s appended to them": [["Obfuscated Files or Information", 0.3096752035449371], ["Data Encoding", 0.17184662669751766], ["Deobfuscate/Decode Files or Information", 0.14386996854639728], ["Encrypted Channel", 0.11066670798637213], ["Archive Collected Data", 0.041668840694410875], ["Data Obfuscation", 0.02848363114355204]], "using NetWkstaGetInfo() API.": [["System Network Configuration Discovery", 0.3366178564912103], ["System Network Connections Discovery", 0.2052222600042903], ["System Information Discovery", 0.052729839566350696], ["Network Sniffing", 0.03519515025073943], ["Remote System Discovery", 0.03476017346742308], ["Network Service Discovery", 0.03274350272261092]], "domain name, Hostname and OS Version": [["System Information Discovery", 0.7024250564734017], ["System Network Configuration Discovery", 0.05341138140625423], ["Remote System Discovery", 0.023537598641020428], ["Gather Victim Host Information", 0.018930416763229988], ["Query Registry", 0.011643225157930264], ["Windows Management Instrumentation", 0.011308355909715526]], "The info stealer also collects information on infected hosts": [["Automated Collection", 0.10449992276200949], ["System Information Discovery", 0.07079266440844204], ["Data from Local System", 0.06315909896485837], ["Exfiltration Over C2 Channel", 0.05030258671009502], ["Data from Information Repositories", 0.04682257489535897], ["Data from Configuration Repository", 0.045072176281412205]], "Manipulates registry": [["Modify Registry", 0.6218761637646204], ["Query Registry", 0.08913291491603467], ["Boot or Logon Autostart Execution", 0.08684505993099914], ["Office Application Startup", 0.013402017547069338], ["Domain Policy Modification", 0.012832100777097386], ["Boot or Logon Initialization Scripts", 0.012280493936893868]], "decrypting and executing the shellcode": [["Deobfuscate/Decode Files or Information", 0.7023688853659423], ["Obfuscated Files or Information", 0.12905562177699265], ["Data Encrypted for Impact", 0.016948195733253516], ["Encrypted Channel", 0.016888292709945834], ["Execution Guardrails", 0.011088017354470776], ["Command and Scripting Interpreter", 0.008074989863241216]], "decrypt the payload": [["Deobfuscate/Decode Files or Information", 0.6868528871350611], ["Obfuscated Files or Information", 0.0939379541454689], ["Data Encrypted for Impact", 0.03100801028096534], ["Encrypted Channel", 0.02701991477236684], ["Archive Collected Data", 0.0264299365610076], ["Weaken Encryption", 0.01884391477658207]], "decrypts a shellcode": [["Deobfuscate/Decode Files or Information", 0.6995266995471688], ["Obfuscated Files or Information", 0.12807822310021036], ["Encrypted Channel", 0.026764571049924343], ["Data Encrypted for Impact", 0.01801373301014647], ["Data Encoding", 0.013254313984873372], ["Archive Collected Data", 0.00868946017622187]], "performed through the CryptUnprotectData API function": [["Deobfuscate/Decode Files or Information", 0.24137326390724204], ["Data Encrypted for Impact", 0.12830248990584942], ["Obfuscated Files or Information", 0.12491237444277743], ["Archive Collected Data", 0.11431559209196127], ["Encrypted Channel", 0.04319131896637435], ["Weaken Encryption", 0.04126623008548151]], "an encrypted shellcode payload.": [["Obfuscated Files or Information", 0.5694741638541508], ["Deobfuscate/Decode Files or Information", 0.15239958817328159], ["Encrypted Channel", 0.05968921166703795], ["Data Encoding", 0.029469039750110466], ["Data Encrypted for Impact", 0.025243828654783446], ["Archive Collected Data", 0.022871583743607822]], "Encrypts a provided payload": [["Obfuscated Files or Information", 0.32919387025780045], ["Encrypted Channel", 0.12545484181570218], ["Data Encrypted for Impact", 0.12357644787645017], ["Deobfuscate/Decode Files or Information", 0.07959387554751671], ["Archive Collected Data", 0.062251382065378086], ["Execution Guardrails", 0.04360772519677155]], "DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded": [["Hijack Execution Flow", 0.4416337751896695], ["System Binary Proxy Execution", 0.11239109165713435], ["Shared Modules", 0.10011826154979772], ["Process Injection", 0.04331669178558172], ["Event Triggered Execution", 0.02647116801958047], ["Masquerading", 0.0240032288157798]], "collects system information and browser history, then sends it to the C2 server.": [["Browser Bookmark Discovery", 0.12529796582169955], ["Exfiltration Over C2 Channel", 0.09330974099136922], ["Automated Collection", 0.06110800240588128], ["Fallback Channels", 0.030879893452714306], ["Browser Session Hijacking", 0.030106026050050486], ["Steal Web Session Cookie", 0.02939407459112989]], "downloads an infostealer and starts it.": [["System Information Discovery", 0.0844631781574923], ["Web Service", 0.04376094913582055], ["Command and Scripting Interpreter", 0.03922707611433683], ["System Service Discovery", 0.037614623882945966], ["Automated Collection", 0.030753146125781672], ["Native API", 0.029346247132776053]], "Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread.": [["Process Injection", 0.7425883871717753], ["Native API", 0.05713506439297434], ["Event Triggered Execution", 0.014689141937821268], ["Access Token Manipulation", 0.013785272372899414], ["System Binary Proxy Execution", 0.012870073355049258], ["System Services", 0.008797906026050923]], "The driver collects information about installed AV filters": [["Software Discovery", 0.31781060742721945], ["Impair Defenses", 0.0683847936267602], ["Virtualization/Sandbox Evasion", 0.06271539688248212], ["Windows Management Instrumentation", 0.0486182447986893], ["Query Registry", 0.04735263494296481], ["System Information Discovery", 0.0449690798943488]], "Connects to a given host via a socket and waits for the server to send data.": [["Non-Application Layer Protocol", 0.2521512080768684], ["Traffic Signaling", 0.07756523534615666], ["Application Layer Protocol", 0.057044858365546056], ["Non-Standard Port", 0.04776498135978978], ["Fallback Channels", 0.046669276061080824], ["Network Sniffing", 0.04588939849630854]], "Manipulates (creates, lists, starts, stops and deletes) services.": [["Create or Modify System Process", 0.36180499632877305], ["System Services", 0.12529489202668728], ["Service Stop", 0.10706979569042727], ["System Service Discovery", 0.10147724617440877], ["Cloud Service Discovery", 0.03024441822415589], ["Masquerading", 0.022610079945592707]], "attackers placed": [["Active Scanning", 0.054386058944449894], ["Compromise Infrastructure", 0.04231156909569742], ["Phishing", 0.0378889022713096], ["System Location Discovery", 0.03499741438624284], ["Stage Capabilities", 0.03453493807735397], ["Network Denial of Service", 0.03442725557705806]], "administrator credentials": [["Valid Accounts", 0.38715310240809014], ["Modify Authentication Process", 0.045639679904780905], ["Credentials from Password Stores", 0.04563755818766861], ["OS Credential Dumping", 0.040820314441854154], ["Unsecured Credentials", 0.035440950327575306], ["Brute Force", 0.031658649378119415]], "compromised administrative [T1078.001] accounts": [["Valid Accounts", 0.18573575036692566], ["Account Discovery", 0.16034508268971168], ["Create Account", 0.11159180771449699], ["Account Manipulation", 0.07795098414016365], ["Account Access Removal", 0.06609255156825007], ["Compromise Accounts", 0.038545973377714406]], "user": [["System Owner/User Discovery", 0.2679463464106263], ["Create Account", 0.0643372477884902], ["Account Discovery", 0.05976442530705068], ["Establish Accounts", 0.02678971716929864], ["Valid Accounts", 0.025295101081801302], ["Compromise Accounts", 0.02316468983218992]], "Access to valid": [["Subvert Trust Controls", 0.1636184925262418], ["Use Alternate Authentication Material", 0.040833982642867195], ["Execution Guardrails", 0.03119917996119459], ["Exploit Public-Facing Application", 0.02197491126302614], ["Stage Capabilities", 0.01975602404385181], ["Valid Accounts", 0.019530683785598177]], "locate high value assets in order to exfiltrate data": [["Data from Local System", 0.15409420115081862], ["Exfiltration Over Web Service", 0.1082316715564516], ["Data Staged", 0.0598242181725225], ["Automated Collection", 0.056710846647483965], ["File and Directory Discovery", 0.0491159242843887], ["Archive Collected Data", 0.04782836276520849]], "Spearphishing emails with malicious attachments": [["Phishing", 0.5845137024801722], ["User Execution", 0.16227050308896557], ["Phishing for Information", 0.04409785366211281], ["Internal Spearphishing", 0.021045854168855148], ["Compromise Accounts", 0.011397488610226103], ["Establish Accounts", 0.01072640178042558]], "attached to spearphishing emails": [["Phishing", 0.5233649501521367], ["User Execution", 0.14327912796904854], ["Phishing for Information", 0.07445471644779364], ["Internal Spearphishing", 0.025499435388935517], ["Establish Accounts", 0.01522037127422919], ["Compromise Accounts", 0.012526694986027343]], "exploitation of public-facing applications": [["Drive-by Compromise", 0.3808942867888342], ["Stage Capabilities", 0.06357387169966358], ["Obtain Capabilities", 0.05637350231602023], ["Phishing", 0.044648616444343765], ["Exploit Public-Facing Application", 0.04142920357423897], ["User Execution", 0.03901676522066839]], "User execution [T1204] of malicious files": [["User Execution", 0.12760904969154702], ["System Binary Proxy Execution", 0.1193188882318636], ["Ingress Tool Transfer", 0.08117669051812794], ["Event Triggered Execution", 0.03361512714107644], ["Command and Scripting Interpreter", 0.033460458600300336], ["Indicator Removal", 0.03322879520201219]], "steganography [T1027.003] to hide stolen data inside other files stored on GitHub": [["Obfuscated Files or Information", 0.26371093046073213], ["Hide Artifacts", 0.1660500833179162], ["Archive Collected Data", 0.07167185873171798], ["Masquerading", 0.041325426844662415], ["Data Obfuscation", 0.026004923673260245], ["Data Staged", 0.02406948307420472]], "multi-hop proxies": [["Proxy", 0.6734453501150536], ["Application Layer Protocol", 0.042055557518633054], ["Fallback Channels", 0.02591577477068631], ["Protocol Tunneling", 0.025832777527182146], ["Adversary-in-the-Middle", 0.01755217427825386], ["Data Obfuscation", 0.015167933749931757]], "stage collected data\u00a0 locally": [["Data Staged", 0.42123030084878466], ["Data from Local System", 0.07612546382368612], ["Archive Collected Data", 0.05828435165100857], ["Automated Collection", 0.054836730772104804], ["Automated Exfiltration", 0.041379420882885605], ["Exfiltration Over C2 Channel", 0.03923443846314425]], "Exfiltration over C2 channel": [["Exfiltration Over C2 Channel", 0.3260842881241607], ["Exfiltration Over Alternative Protocol", 0.08332145875528481], ["Scheduled Transfer", 0.0743903136054214], ["Automated Exfiltration", 0.06536364072223574], ["Data Encoding", 0.029147938658234986], ["Fallback Channels", 0.028921308129600747]], "encryption": [["Encrypted Channel", 0.17502628290885577], ["Data Encrypted for Impact", 0.14862216933117584], ["Obfuscated Files or Information", 0.14331743941123273], ["Archive Collected Data", 0.093945892179173], ["Deobfuscate/Decode Files or Information", 0.0694597580996399], ["Weaken Encryption", 0.054893898100514746]], "24 different IP addresses in use": [["Dynamic Resolution", 0.10686648987155747], ["Active Scanning", 0.06290023391401856], ["System Network Configuration Discovery", 0.06004318220281415], ["Network Denial of Service", 0.05724213049827457], ["Adversary-in-the-Middle", 0.05473327904981631], ["Endpoint Denial of Service", 0.04588273340007566]], "compromised devices that act as proxies for their C&C servers": [["Proxy", 0.5525783613084433], ["Application Layer Protocol", 0.033119034726977664], ["Compromise Infrastructure", 0.029870719478592902], ["Fallback Channels", 0.028245742457468127], ["Network Boundary Bridging", 0.026179136970296554], ["Adversary-in-the-Middle", 0.02499633578717958]], "use some victims as proxies, or some vulnerable devices to forward communication to their real C&C servers.": [["Proxy", 0.4912073088934278], ["Compromise Infrastructure", 0.054201775327127014], ["Fallback Channels", 0.0362168180145994], ["Application Layer Protocol", 0.033858800609131656], ["Network Denial of Service", 0.031035709572095414], ["Protocol Tunneling", 0.028524281099022494]], "phishing emails have similar topics and pretend to come from some of the same entities": [["Phishing", 0.16624994043967295], ["Phishing for Information", 0.1640406306257951], ["Internal Spearphishing", 0.09187863291718705], ["Compromise Accounts", 0.054379963690686504], ["User Execution", 0.04489274495789294], ["Establish Accounts", 0.042956081556698375]], "attachments used for phishing emails,": [["Phishing", 0.46851160485947246], ["User Execution", 0.19441342301074913], ["Phishing for Information", 0.048357373660778205], ["Internal Spearphishing", 0.024128417607304387], ["Email Collection", 0.01591940854450859], ["Template Injection", 0.013637484867396299]], "emails have a PDF document attached": [["Phishing", 0.4196993281408411], ["User Execution", 0.20758214477661194], ["Template Injection", 0.04886028419658419], ["Email Collection", 0.033690183865574486], ["Office Application Startup", 0.01728611359332452], ["Inter-Process Communication", 0.011127090776238769]], "PDF file attached": [["User Execution", 0.21512478423169246], ["Phishing", 0.16064638190695885], ["Template Injection", 0.06010737441743949], ["Ingress Tool Transfer", 0.04830909427233322], ["Masquerading", 0.025234080837368684], ["File and Directory Discovery", 0.019065213611523295]], "used emails with PDF or RTF files attached that contain a link to download malware": [["Phishing", 0.3929584414385185], ["User Execution", 0.2935555098741261], ["Template Injection", 0.023070773617566737], ["Ingress Tool Transfer", 0.01873789296904939], ["Email Collection", 0.017946936508950923], ["Web Service", 0.01460999934576103]], "user must click to download the malware": [["Ingress Tool Transfer", 0.3260084651343143], ["User Execution", 0.18774129016302252], ["Command and Scripting Interpreter", 0.09722535922823272], ["Stage Capabilities", 0.03090205297199471], ["BITS Jobs", 0.02808627480296886], ["Drive-by Compromise", 0.017833202522076392]], "manually extract the file and execute it": [["Deobfuscate/Decode Files or Information", 0.16988868852527064], ["Ingress Tool Transfer", 0.11089667289570673], ["Command and Scripting Interpreter", 0.09080509042550784], ["Archive Collected Data", 0.044200729533105436], ["System Binary Proxy Execution", 0.044059553058930834], ["Data from Local System", 0.0411136910728076]], "have attempted to get users to execute malicious files masquerading as documents": [["User Execution", 0.7229743014273867], ["Template Injection", 0.062115464725784685], ["Phishing", 0.05353346940912237], ["Masquerading", 0.024055348733773442], ["Office Application Startup", 0.01481065534849814], ["Command and Scripting Interpreter", 0.010889787273695307]], "regular RAR archives that have an executable file inside.": [["Archive Collected Data", 0.358675349571732], ["Deobfuscate/Decode Files or Information", 0.05681256489250485], ["Data from Local System", 0.048987151887831266], ["Automated Collection", 0.044238205824467976], ["Data Staged", 0.03177169168892229], ["Obfuscated Files or Information", 0.027135674517853564]], "contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious": [["File and Directory Discovery", 0.20976145675225083], ["Indicator Removal", 0.16306443334926982], ["Data from Local System", 0.05536891429084906], ["Hide Artifacts", 0.04414100793744121], ["Data Staged", 0.039980608020990335], ["Automated Collection", 0.027887277369733753]], "reads a string (or binary data) from its resource section": [["Deobfuscate/Decode Files or Information", 0.23720044358463302], ["Obfuscated Files or Information", 0.13216673715849905], ["Native API", 0.0681267128868522], ["Data Encoding", 0.03422139662892761], ["Masquerading", 0.03269823665987595], ["Archive Collected Data", 0.026584351912389552]], "reads data from its own resource section and decrypts a payload.": [["Deobfuscate/Decode Files or Information", 0.6612384759772508], ["Obfuscated Files or Information", 0.08040991677268826], ["Archive Collected Data", 0.05432613887589514], ["Data Encrypted for Impact", 0.02185999278954332], ["Encrypted Channel", 0.01509496725729418], ["Data Encoding", 0.014506491269113572]], "is read from an encrypted resource": [["Deobfuscate/Decode Files or Information", 0.31007800244953637], ["Obfuscated Files or Information", 0.1374823820212192], ["Data Encrypted for Impact", 0.0963309939184842], ["Archive Collected Data", 0.07364558267074081], ["Encrypted Channel", 0.06459957724998415], ["Execution Guardrails", 0.0199986422033439]], "two shellcodes contained in the compiled AutoIt script": [["Command and Scripting Interpreter", 0.19117022323771238], ["System Binary Proxy Execution", 0.11752886691078634], ["Event Triggered Execution", 0.07013578956504818], ["Native API", 0.054155235622586444], ["Boot or Logon Autostart Execution", 0.04843397766463419], ["Hijack Execution Flow", 0.03269451457208473]], "Read a binary from its resource section, write it to disk and execute it": [["Deobfuscate/Decode Files or Information", 0.09811842038209946], ["System Binary Proxy Execution", 0.06579402169654551], ["Native API", 0.06284759561402273], ["Obfuscated Files or Information", 0.06030929294319673], ["Process Injection", 0.057229678609944414], ["BITS Jobs", 0.05717201130687528]], "variety of packers used for these executables": [["Obfuscated Files or Information", 0.32729677437084675], ["Deobfuscate/Decode Files or Information", 0.11408330552238505], ["Masquerading", 0.049205795295747846], ["Archive Collected Data", 0.04347896787135195], ["System Binary Proxy Execution", 0.03839800340034245], ["Command and Scripting Interpreter", 0.026871353785307]], "different variants of a packer": [["Obfuscated Files or Information", 0.4379563905164354], ["Masquerading", 0.036749868023076775], ["Archive Collected Data", 0.03261063971330898], ["Ingress Tool Transfer", 0.024039359128117468], ["Command and Scripting Interpreter", 0.0217359390589301], ["Deobfuscate/Decode Files or Information", 0.019050339046620127]], "is packed with CyaX": [["Obfuscated Files or Information", 0.0868858582888441], ["Ingress Tool Transfer", 0.07386655436137146], ["Software Discovery", 0.035112325265253805], ["Command and Scripting Interpreter", 0.027933159462243562], ["Masquerading", 0.020678172721255442], ["Deobfuscate/Decode Files or Information", 0.0184204915941933]], "is gzip-decompressed and executed": [["Deobfuscate/Decode Files or Information", 0.34891470078596515], ["Archive Collected Data", 0.303880241032255], ["Obfuscated Files or Information", 0.13392566294479324], ["Data Encrypted for Impact", 0.012145603570724823], ["Automated Collection", 0.007667836267817037], ["Command and Scripting Interpreter", 0.007232825734621958]], ".NET packer known as CyaX": [["Obfuscated Files or Information", 0.22537544588907132], ["System Binary Proxy Execution", 0.09914224005127123], ["Masquerading", 0.07419708647443608], ["Ingress Tool Transfer", 0.05657091794136714], ["Hijack Execution Flow", 0.04282147468486132], ["BITS Jobs", 0.03642262065548785]], "used an AutoIt packer that comes heavily obfuscated.": [["Obfuscated Files or Information", 0.686355672005971], ["Deobfuscate/Decode Files or Information", 0.05637437475553976], ["Masquerading", 0.032970176741456796], ["Hide Artifacts", 0.030932682623938498], ["Archive Collected Data", 0.01980132188263473], ["System Binary Proxy Execution", 0.011132995513042887]], "have used various layers of packers for obfuscating their droppers.": [["Obfuscated Files or Information", 0.7476348736087428], ["Deobfuscate/Decode Files or Information", 0.05571066146725825], ["Masquerading", 0.020688922360289668], ["Hide Artifacts", 0.02063500937476441], ["Archive Collected Data", 0.015223071703439757], ["Data Obfuscation", 0.011242726047992199]], "decrypting the payload": [["Deobfuscate/Decode Files or Information", 0.7024831520676434], ["Obfuscated Files or Information", 0.07877435462103571], ["Data Encrypted for Impact", 0.032942262844935705], ["Archive Collected Data", 0.026061937713938808], ["Encrypted Channel", 0.0239717182182285], ["Weaken Encryption", 0.020550484316614815]], "decrypting": [["Deobfuscate/Decode Files or Information", 0.5746195881147206], ["Data Encrypted for Impact", 0.11295972691917949], ["Archive Collected Data", 0.05164633047476399], ["Obfuscated Files or Information", 0.03741451100795746], ["Weaken Encryption", 0.03664450503603221], ["Encrypted Channel", 0.026576219533712562]], "decrypt": [["Deobfuscate/Decode Files or Information", 0.5768008232689691], ["Data Encrypted for Impact", 0.11536982542778498], ["Archive Collected Data", 0.05516130589364476], ["Obfuscated Files or Information", 0.036730627759635204], ["Weaken Encryption", 0.03340485565455445], ["Encrypted Channel", 0.02604323743916146]], "decrypts it": [["Deobfuscate/Decode Files or Information", 0.7043766123543888], ["Data Encrypted for Impact", 0.06245725002845726], ["Archive Collected Data", 0.039961559451668474], ["Obfuscated Files or Information", 0.03666823396038049], ["Encrypted Channel", 0.0245322044401517], ["Weaken Encryption", 0.01669769912097867]], "decrypts another executable": [["Deobfuscate/Decode Files or Information", 0.7291825480239059], ["Obfuscated Files or Information", 0.07737963864764534], ["Data Encrypted for Impact", 0.044383486015689144], ["Archive Collected Data", 0.014850636955784667], ["Encrypted Channel", 0.0146803995477678], ["Execution Guardrails", 0.009285185518631995]], "a string that will be decrypted": [["Deobfuscate/Decode Files or Information", 0.5166887818546794], ["Obfuscated Files or Information", 0.17718796845426527], ["Encrypted Channel", 0.04910954411744252], ["Data Encrypted for Impact", 0.036384066040431096], ["Data Encoding", 0.034050940341816015], ["Archive Collected Data", 0.029657910096123043]], "decrypts the array by doing a single-byte XOR operation, cycling through the key": [["Deobfuscate/Decode Files or Information", 0.703656634436203], ["Encrypted Channel", 0.05185456871776161], ["Obfuscated Files or Information", 0.037642159542816286], ["Data Encrypted for Impact", 0.026140755965190065], ["Weaken Encryption", 0.020701393661017697], ["Archive Collected Data", 0.01525796261427568]], "decryption of the payload is based on XOR operations": [["Deobfuscate/Decode Files or Information", 0.7449074261343748], ["Obfuscated Files or Information", 0.05861295658261878], ["Encrypted Channel", 0.04085175539892292], ["Data Encrypted for Impact", 0.026198333553133637], ["Archive Collected Data", 0.0230592004839479], ["Execution Guardrails", 0.011906097198629407]], "a single-byte XOR algorithm.": [["Obfuscated Files or Information", 0.22235284369108396], ["Deobfuscate/Decode Files or Information", 0.2109473864704771], ["Encrypted Channel", 0.11007362218395628], ["Data Encrypted for Impact", 0.015259308918690075], ["Virtualization/Sandbox Evasion", 0.014605273213370325], ["Native API", 0.013187962622442775]], "have used various encryption algorithms in their droppers to hide strings and payloads": [["Obfuscated Files or Information", 0.6942027288412413], ["Deobfuscate/Decode Files or Information", 0.05422278896045246], ["Hide Artifacts", 0.03146137563111582], ["Data Obfuscation", 0.020501083342461753], ["Execution Guardrails", 0.016618200602942352], ["Data Encoding", 0.01511993969135435]], "injecting it into legitimate processes.": [["Process Injection", 0.8085333733025762], ["Hijack Execution Flow", 0.02339217286324627], ["Native API", 0.023133630582871576], ["System Binary Proxy Execution", 0.012043341622867595], ["Event Triggered Execution", 0.008381160149493838], ["Shared Modules", 0.007892852364828364]], "be injected into a new process or loaded in the same process space": [["Process Injection", 0.8149452130720539], ["Native API", 0.04048575478670337], ["Hijack Execution Flow", 0.022341270754428637], ["Create or Modify System Process", 0.012857903208839795], ["Access Token Manipulation", 0.010286735890601894], ["Event Triggered Execution", 0.007228459894798047]], "injected into a different process,": [["Process Injection", 0.812429047134886], ["Native API", 0.05725858723832921], ["Access Token Manipulation", 0.011304889106606228], ["Hijack Execution Flow", 0.009172631553016548], ["System Services", 0.007334150897845783], ["Event Triggered Execution", 0.0071335052913877655]], "injection of the payload": [["Process Injection", 0.24435189639607796], ["Obfuscated Files or Information", 0.044006596638292705], ["Hijack Execution Flow", 0.043976939542304076], ["Exploit Public-Facing Application", 0.03548531320535721], ["Command and Scripting Interpreter", 0.03347565186156847], ["Shared Modules", 0.03162838290404676]], "performs the injection and execution of the payload": [["Process Injection", 0.19679762849228605], ["Shared Modules", 0.05811585687386522], ["Native API", 0.04814635871691566], ["Hijack Execution Flow", 0.04568367113561183], ["Command and Scripting Interpreter", 0.04554355092974797], ["System Binary Proxy Execution", 0.041632704715157315]], "inject it into some process": [["Process Injection", 0.7738809914590358], ["Native API", 0.04080365772752222], ["Hijack Execution Flow", 0.02420099437396704], ["Shared Modules", 0.015989632447818328], ["System Binary Proxy Execution", 0.014244645358578745], ["Event Triggered Execution", 0.01138419353677055]], "shellcode with RunPE code is used to perform the injection": [["Process Injection", 0.2673778979231824], ["Native API", 0.10469314783632977], ["Command and Scripting Interpreter", 0.05591492838402485], ["System Binary Proxy Execution", 0.04022571261637807], ["Shared Modules", 0.039824685136444514], ["Hijack Execution Flow", 0.033087666364380555]], "RAR archive is downloaded": [["Archive Collected Data", 0.23437405492312924], ["Ingress Tool Transfer", 0.08299700860918412], ["Deobfuscate/Decode Files or Information", 0.08112879740064566], ["Automated Collection", 0.03263527115508767], ["Exfiltration Over C2 Channel", 0.03253477395772718], ["Data Staged", 0.03221416880253952]], "compressed archives": [["Archive Collected Data", 0.6584577902040344], ["Obfuscated Files or Information", 0.034267137820870826], ["Deobfuscate/Decode Files or Information", 0.03316593708753521], ["Data Staged", 0.019534176345486775], ["Automated Collection", 0.018538111481164188], ["Exfiltration Over Alternative Protocol", 0.018141523286784624]], "layers of encryption, obfuscation or anti-analysis": [["Obfuscated Files or Information", 0.533501182994595], ["Encrypted Channel", 0.0453381070779321], ["Deobfuscate/Decode Files or Information", 0.04103880464492892], ["Archive Collected Data", 0.039146321740687696], ["Weaken Encryption", 0.038730774887764954], ["Data Encrypted for Impact", 0.03457421655923998]], "was hiding in non-malicious code,": [["Hide Artifacts", 0.49211366043156357], ["Obfuscated Files or Information", 0.13534020454889184], ["Masquerading", 0.04776333024841116], ["Rootkit", 0.03045372305913364], ["Compromise Client Software Binary", 0.016773845974042034], ["Deobfuscate/Decode Files or Information", 0.014276744481614947]], "encrypted resource and XORed with a hardcoded password": [["Data Encrypted for Impact", 0.12801874793895857], ["Obfuscated Files or Information", 0.07068378584465466], ["Deobfuscate/Decode Files or Information", 0.06517055055767758], ["Archive Collected Data", 0.05904535219370853], ["Encrypted Channel", 0.0538771396253692], ["Unsecured Credentials", 0.052668204545971]], "encrypted with this same XOR-based algorithm": [["Encrypted Channel", 0.22648784048356424], ["Obfuscated Files or Information", 0.22432923560108942], ["Data Encrypted for Impact", 0.128912650607837], ["Deobfuscate/Decode Files or Information", 0.11294808560147192], ["Archive Collected Data", 0.06250358812607704], ["Weaken Encryption", 0.03736691515392735]], "DLL is run with rundll32": [["Hijack Execution Flow", 0.2447037879227966], ["System Binary Proxy Execution", 0.23946705568012325], ["Shared Modules", 0.1257668326758488], ["Process Injection", 0.06302639365720918], ["Native API", 0.05895215074602296], ["System Services", 0.030683808841942738]], "uses steganography": [["Obfuscated Files or Information", 0.48990937988674016], ["Data Obfuscation", 0.12026100941669911], ["Masquerading", 0.0546929225850236], ["Data Encoding", 0.03071690884229527], ["Archive Collected Data", 0.02141064259276393], ["Hide Artifacts", 0.018017807787173976]], "reads pixels from an image contained in the first binary": [["Screen Capture", 0.10225553850638865], ["Obfuscated Files or Information", 0.05221902574706864], ["Deploy Container", 0.03343982517342551], ["Native API", 0.031410637573375644], ["Hide Artifacts", 0.030982898952950796], ["Build Image on Host", 0.02879353564636569]], "stores every pixel as three numbers according to its red, green and blue components": [["Screen Capture", 0.07571699671614922], ["Obfuscated Files or Information", 0.03807195321797323], ["Data Obfuscation", 0.030914656894796704], ["Archive Collected Data", 0.02885824663183916], ["Automated Collection", 0.024990063989250945], ["Command and Scripting Interpreter", 0.024446627432210585]], "have used packers that read pixel data from images contained in PE files\u2019 resource sections and build the next layer of execution from the data": [["Obfuscated Files or Information", 0.07109573621227755], ["Screen Capture", 0.06921895074090025], ["Build Image on Host", 0.05656088362024612], ["Archive Collected Data", 0.040698669695517074], ["Deploy Container", 0.040198196036534295], ["Data from Local System", 0.03556534429356142]], "DLL that will be loaded and called in the same address space": [["Hijack Execution Flow", 0.36237640547674377], ["Shared Modules", 0.15659703644721498], ["Process Injection", 0.13395551500313854], ["System Binary Proxy Execution", 0.07713043636840869], ["Native API", 0.03834584872172742], ["Masquerading", 0.021587176065191782]], "performs the injection is contained in an array and is dynamically loaded.": [["Process Injection", 0.18275262364920591], ["Shared Modules", 0.06337190626011924], ["Native API", 0.053430842994711354], ["Hijack Execution Flow", 0.03427664120369188], ["Exploit Public-Facing Application", 0.02834524655634935], ["Command and Scripting Interpreter", 0.025810697109174264]], "disabling Windows Defender": [["Impair Defenses", 0.5162314128321495], ["Software Discovery", 0.03003104750906538], ["Modify Registry", 0.021124733405017127], ["Windows Management Instrumentation", 0.020703187685160843], ["Subvert Trust Controls", 0.019563299566937548], ["Modify System Image", 0.01897246744341595]], "have used CyaX packer, which can disable Windows Defender.": [["Impair Defenses", 0.27497878449694213], ["Masquerading", 0.05083471286837676], ["Subvert Trust Controls", 0.034453813433821694], ["Hide Artifacts", 0.033378002517953455], ["Software Discovery", 0.0333443117134657], ["System Binary Proxy Execution", 0.03153391360510118]], "checking for security products": [["Software Discovery", 0.6722258354648645], ["Query Registry", 0.02665299377300663], ["Obtain Capabilities", 0.019039049882285417], ["Exploitation for Defense Evasion", 0.01895021847175242], ["Impair Defenses", 0.0159532524077011], ["Domain Trust Discovery", 0.014878170033723633]], "used droppers that check for security software present in a victim\u2019s computer": [["Software Discovery", 0.7691121307517085], ["Query Registry", 0.01717454665128037], ["Windows Management Instrumentation", 0.016380004307083307], ["Execution Guardrails", 0.012517870171072596], ["Exploitation for Defense Evasion", 0.010673628735901563], ["Virtualization/Sandbox Evasion", 0.01048400024152069]], "loaded with VirtualAlloc and executed": [["Process Injection", 0.21723966372041167], ["Native API", 0.12317354964757064], ["System Binary Proxy Execution", 0.09856489819879982], ["Shared Modules", 0.06363595066922613], ["Virtualization/Sandbox Evasion", 0.057044055662232945], ["Hijack Execution Flow", 0.054057761631262524]], "used API calls in their droppers, such as  CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory": [["Process Injection", 0.3603293720551209], ["Native API", 0.2669772592454432], ["Shared Modules", 0.05048384216561606], ["Hijack Execution Flow", 0.0418752658199926], ["System Binary Proxy Execution", 0.03444032292677159], ["Command and Scripting Interpreter", 0.023421710917460096]], "created in the Startup folder to execute the script.": [["Boot or Logon Autostart Execution", 0.27908075431012025], ["Boot or Logon Initialization Scripts", 0.11063078605639773], ["Scheduled Task/Job", 0.09977739041946844], ["Create or Modify System Process", 0.08378534665754386], ["Command and Scripting Interpreter", 0.07230937860220799], ["System Binary Proxy Execution", 0.05048066551939071]], "used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder": [["Boot or Logon Autostart Execution", 0.5852962971714336], ["Boot or Logon Initialization Scripts", 0.0841787344914232], ["Modify Registry", 0.06326132126063659], ["Create or Modify System Process", 0.040274356086271244], ["Event Triggered Execution", 0.025372838696877394], ["Pre-OS Boot", 0.019605350174351756]], "Delete the dropper executable": [["Indicator Removal", 0.36214265479055074], ["Masquerading", 0.07168999480201373], ["Rootkit", 0.05238831244079789], ["Hijack Execution Flow", 0.03574009921842744], ["Impair Defenses", 0.02797503354168728], ["Modify Registry", 0.025615233723003544]], "have used malware that deletes itself from the system": [["Indicator Removal", 0.5508699385583936], ["Data Destruction", 0.08720294514486647], ["Inhibit System Recovery", 0.06538920013785446], ["Disk Wipe", 0.04802704608686762], ["System Shutdown/Reboot", 0.03857270839137938], ["Modify Registry", 0.012830867285682555]], "Download and execute files": [["Ingress Tool Transfer", 0.7256341379040692], ["Command and Scripting Interpreter", 0.07302023362398134], ["BITS Jobs", 0.02391515635871982], ["Application Layer Protocol", 0.0116417859045163], ["System Binary Proxy Execution", 0.010069521186429013], ["Data from Local System", 0.00849330432610835]], "ability to download and execute other malware": [["Ingress Tool Transfer", 0.6057984032719952], ["Command and Scripting Interpreter", 0.06497541417037896], ["BITS Jobs", 0.04360245743108791], ["Application Layer Protocol", 0.017097455465273474], ["System Binary Proxy Execution", 0.017008286963174087], ["Stage Capabilities", 0.01266209284286651]], "uploading and downloading files": [["Ingress Tool Transfer", 0.5542965232417495], ["Data from Local System", 0.050951711010485706], ["Application Layer Protocol", 0.028242161992590564], ["Exfiltration Over C2 Channel", 0.023790733901451314], ["Exfiltration Over Alternative Protocol", 0.02058155985862825], ["Exfiltration Over Web Service", 0.01811600659652717]], "keylogging,": [["Input Capture", 0.866167898194642], ["Clipboard Data", 0.007726701908062125], ["Credentials from Password Stores", 0.006756628942528219], ["Screen Capture", 0.0055859857406116795], ["Unsecured Credentials", 0.0037231737919009], ["Boot or Logon Autostart Execution", 0.0036343557746298665]], "used various RATs that have keylogging capabilities": [["Input Capture", 0.8674048207273197], ["Screen Capture", 0.007322887347169572], ["Clipboard Data", 0.006883206216833776], ["Boot or Logon Autostart Execution", 0.005866306678838499], ["Credentials from Password Stores", 0.005133748615736061], ["Event Triggered Execution", 0.00402508229440731]], "screen capture": [["Screen Capture", 0.7624946422003457], ["Video Capture", 0.06924886746774797], ["Input Capture", 0.015460898931132703], ["Application Window Discovery", 0.015323702723236339], ["Clipboard Data", 0.006064269278951724], ["Data from Local System", 0.005736170273273268]], "used various RATs that can capture screenshots of victim machines": [["Screen Capture", 0.8819592184447558], ["Video Capture", 0.019607166392413753], ["Application Window Discovery", 0.010055956858727249], ["Input Capture", 0.005594716915766045], ["Data from Local System", 0.0034457673787018565], ["Clipboard Data", 0.0032868410033493676]], "exfiltration of files": [["Indicator Removal", 0.1894430079998072], ["Data from Local System", 0.1164746855360818], ["Data Staged", 0.06525062945183391], ["Automated Exfiltration", 0.05100152461570838], ["Archive Collected Data", 0.0418659440990842], ["Exfiltration Over Web Service", 0.04023456164836017]], "used various RATs that exfiltrate data over the same channel used for C&C": [["Exfiltration Over C2 Channel", 0.1601364621783771], ["Exfiltration Over Other Network Medium", 0.14654777881154396], ["Exfiltration Over Alternative Protocol", 0.10962102646297192], ["Exfiltration Over Web Service", 0.05742285237629555], ["Archive Collected Data", 0.053154010393429436], ["Scheduled Transfer", 0.03502622079823595]], "used RATs that can launch a command shell for executing commands.": [["Command and Scripting Interpreter", 0.6732133159218394], ["Indirect Command Execution", 0.07293435864847199], ["System Services", 0.042111161980727375], ["Native API", 0.015540294389940234], ["Scheduled Task/Job", 0.015311107081567911], ["System Binary Proxy Execution", 0.013611529535062165]], "have used scheduled tasks in their droppers and payloads to achieve persistence": [["Scheduled Task/Job", 0.592413435556907], ["Create or Modify System Process", 0.06903090843684316], ["Event Triggered Execution", 0.03986097249916068], ["Boot or Logon Autostart Execution", 0.03174394098645822], ["Inter-Process Communication", 0.02744429567819007], ["Boot or Logon Initialization Scripts", 0.01657068543166219]], "used RATs that implement UAC bypassing.": [["Abuse Elevation Control Mechanism", 0.6850594458458157], ["Access Token Manipulation", 0.041366690427622727], ["File and Directory Permissions Modification", 0.01990549024206989], ["Exploitation for Privilege Escalation", 0.01484853214927928], ["Event Triggered Execution", 0.012367308788360247], ["Domain Policy Modification", 0.01142535557677565]], "have used RATs that allow full access to the Registry,": [["Modify Registry", 0.5725789316443494], ["Query Registry", 0.13884061541616474], ["Boot or Logon Autostart Execution", 0.10462930794350188], ["Office Application Startup", 0.012134466919216031], ["Indicator Removal", 0.011182302992105328], ["Create or Modify System Process", 0.010789550890707255]], "have used droppers that inject the payload into legitimate processes": [["Process Injection", 0.7495242522156926], ["Native API", 0.041169738298196035], ["Hijack Execution Flow", 0.03396144499946999], ["System Binary Proxy Execution", 0.029682491685106272], ["System Services", 0.014324785222428495], ["Create or Modify System Process", 0.012781474994885664]], "used various RATs that can browse file systems": [["File and Directory Discovery", 0.6054939881340484], ["Data from Local System", 0.08855291915750235], ["Data from Network Shared Drive", 0.0323804081710192], ["Data from Removable Media", 0.027445567739388145], ["Hide Artifacts", 0.026009011230622565], ["Data Staged", 0.022123777141274076]], "used various RATs with modules that show running processes": [["Process Discovery", 0.8815143132067691], ["Process Injection", 0.01315363460704103], ["System Service Discovery", 0.01141377482487515], ["Native API", 0.009986740216512757], ["Software Discovery", 0.005963856187509076], ["Windows Management Instrumentation", 0.00532346289329282]], "used various RATs that can read the Registry.": [["Query Registry", 0.6044783265487867], ["Modify Registry", 0.19082062024410845], ["Boot or Logon Autostart Execution", 0.029616286530166173], ["Unsecured Credentials", 0.011773971758491302], ["Software Discovery", 0.009170592410722342], ["Windows Management Instrumentation", 0.0086486320359875]], "used various RATs that gather system information such as computer name and operating system during the initial infection": [["System Information Discovery", 0.8806214124269629], ["Windows Management Instrumentation", 0.01788925081810492], ["Software Discovery", 0.007797725587245233], ["Virtualization/Sandbox Evasion", 0.007593662120204692], ["Query Registry", 0.006412684616619673], ["System Network Configuration Discovery", 0.006411448222629151]], "used various RATs that can collect the IP address of the victim machine": [["System Network Configuration Discovery", 0.8063000492562382], ["Remote System Discovery", 0.017966369230622174], ["System Network Connections Discovery", 0.016371259383751037], ["Gather Victim Network Information", 0.016136710113423845], ["System Location Discovery", 0.01596345219178778], ["Dynamic Resolution", 0.012095290511154587]], "used various RATs that retrieve the current username during initial infection": [["System Owner/User Discovery", 0.7913121014424295], ["Account Discovery", 0.039331108720123534], ["Access Token Manipulation", 0.013371372166341003], ["System Information Discovery", 0.009626271038846983], ["Native API", 0.007562255074818601], ["Masquerading", 0.00569545016801627]], "used various RATs that can perform remote desktop access.": [["Remote Services", 0.4561956076579694], ["Remote Access Software", 0.2569956311646637], ["Remote Service Session Hijacking", 0.028251037039437984], ["External Remote Services", 0.016451395071377908], ["Software Deployment Tools", 0.014809501823945135], ["Communication Through Removable Media", 0.013981141135169085]], "used various RATs that can access the local file system and upload, download or delete files": [["Data from Local System", 0.16330135389718237], ["Indicator Removal", 0.11829249544721482], ["Data Destruction", 0.050250429535769914], ["Data Staged", 0.04234789382574368], ["File and Directory Discovery", 0.04158999756073113], ["Ingress Tool Transfer", 0.04100611048579784]], "used Remcos RAT, which uses RC4 for encrypting C&C communications": [["Encrypted Channel", 0.6201378142307358], ["Obfuscated Files or Information", 0.05350638769227829], ["Weaken Encryption", 0.052706603231128066], ["Deobfuscate/Decode Files or Information", 0.023627472832899062], ["Exfiltration Over Alternative Protocol", 0.02334735217746271], ["Data Obfuscation", 0.019138745089609513]], "used various RATs that use TCP for C&C communications": [["Non-Application Layer Protocol", 0.5306753970122179], ["Application Layer Protocol", 0.10232648036739915], ["Non-Standard Port", 0.04920712355664646], ["Encrypted Channel", 0.04719688544851479], ["Protocol Tunneling", 0.04117143642677286], ["Proxy", 0.03466071765818136]], "data exfiltration of sensitive information": [["Exfiltration Over C2 Channel", 0.14260380415233806], ["Archive Collected Data", 0.08742138359716986], ["Exfiltration Over Alternative Protocol", 0.08348710435582764], ["Automated Exfiltration", 0.06325094751793195], ["Data Staged", 0.05993870011545581], ["Data from Local System", 0.04577202982122066]], "move through the victim environment via RDP": [["Remote Services", 0.6479861889577098], ["Remote Service Session Hijacking", 0.1338842767314135], ["Remote Access Software", 0.037974441417558076], ["Exploitation of Remote Services", 0.013237778326350189], ["External Remote Services", 0.011890302353511786], ["Valid Accounts", 0.010741603569415356]], "mass deletion of virtual machines, storage, and configurations": [["Indicator Removal", 0.23009930314473484], ["Inhibit System Recovery", 0.10449595223827443], ["Data Destruction", 0.07596626005507125], ["Disk Wipe", 0.07332536799852796], ["System Shutdown/Reboot", 0.04840636702259677], ["Modify Cloud Compute Infrastructure", 0.042344023546998906]], "to identify any credentials which may be stored in technical documentation": [["Unsecured Credentials", 0.34481317249709575], ["Credentials from Password Stores", 0.13510887885508718], ["OS Credential Dumping", 0.06848606786349536], ["Gather Victim Identity Information", 0.03091716584710985], ["Input Capture", 0.026082054562708384], ["Brute Force", 0.024119534595193823]], "extraction of sensitive API Keys": [["Unsecured Credentials", 0.30393917235914397], ["Deobfuscate/Decode Files or Information", 0.082409927212713], ["Steal or Forge Kerberos Tickets", 0.03874689469060441], ["Query Registry", 0.032537616722434076], ["OS Credential Dumping", 0.030346444608036618], ["Native API", 0.030031213576683737]], "Access to local password managers and databases to obtain further credentials": [["Credentials from Password Stores", 0.3566010357532465], ["OS Credential Dumping", 0.18092699441593948], ["Unsecured Credentials", 0.13805559948883778], ["Brute Force", 0.09833214677094312], ["Password Policy Discovery", 0.027529752821026487], ["Modify Authentication Process", 0.018772824697278315]], "Using compromised credentials to access corporate VPNs.": [["External Remote Services", 0.542876448783001], ["Valid Accounts", 0.17147273282614472], ["Brute Force", 0.012751558651359256], ["Remote Services", 0.010856918549238809], ["Exploitation for Credential Access", 0.009724372481300633], ["Forge Web Credentials", 0.008835328301339174]], "victim controlled hostnames were revealed": [["System Information Discovery", 0.09318925064149625], ["Remote System Discovery", 0.07543293873699705], ["System Owner/User Discovery", 0.06751482702979503], ["System Network Configuration Discovery", 0.0658456335232067], ["Dynamic Resolution", 0.055318162590919526], ["Gather Victim Host Information", 0.0421562610635971]], "runs a scheduled task": [["Scheduled Task/Job", 0.8038476813793045], ["Inter-Process Communication", 0.03673663515915435], ["Command and Scripting Interpreter", 0.01795968832430994], ["Masquerading", 0.015691077418744363], ["System Services", 0.008988335097458446], ["Create or Modify System Process", 0.005499271129673516]], "decryption of credentials": [["Deobfuscate/Decode Files or Information", 0.17213185908404413], ["Unsecured Credentials", 0.12399246402581506], ["Credentials from Password Stores", 0.06744903902944085], ["OS Credential Dumping", 0.06723901740030246], ["Brute Force", 0.0378741151436029], ["Data Encrypted for Impact", 0.035999489729352165]], "decrypted using DPAPI": [["Deobfuscate/Decode Files or Information", 0.26672329732352773], ["Weaken Encryption", 0.10925541872650084], ["Data Encrypted for Impact", 0.09026521172200365], ["Obfuscated Files or Information", 0.08779513264908023], ["Execution Guardrails", 0.05893738226858277], ["Archive Collected Data", 0.03830924322392315]], "These credentials are generated and stored in the memory of the LSASS process": [["OS Credential Dumping", 0.3145955705828238], ["Unsecured Credentials", 0.18883103500773812], ["Credentials from Password Stores", 0.12433896420232235], ["Modify Authentication Process", 0.042179801031325195], ["Brute Force", 0.031100561798944305], ["Input Capture", 0.028500056928646832]], "Attackers may attempt to access LSASS process memory to extract credentials as it stores a variety of credentials.": [["OS Credential Dumping", 0.5633849730954343], ["Unsecured Credentials", 0.09248465014545992], ["Credentials from Password Stores", 0.07831949043011491], ["Input Capture", 0.028794580014982425], ["Network Sniffing", 0.02000827911540317], ["Brute Force", 0.011041073573768377]], "LSASS process memory is one of the prime targets for attackers, as well as malware armed with lateral movement capabilities since it caches a variety of credentials": [["OS Credential Dumping", 0.17939060405276472], ["Process Injection", 0.13573348025050072], ["Process Discovery", 0.059087232947870785], ["Native API", 0.026076875798364364], ["Credentials from Password Stores", 0.023575594829840917], ["Virtualization/Sandbox Evasion", 0.02089811808482013]], "Credential extraction from the LSASS process": [["OS Credential Dumping", 0.7009650192034402], ["Unsecured Credentials", 0.04639184366809462], ["Credentials from Password Stores", 0.03362508635577478], ["Account Discovery", 0.014433233426593486], ["Brute Force", 0.011933388071514239], ["System Owner/User Discovery", 0.009921793615552439]], "credential-based deception is to stage the deceptive credentials in LSASS process memory.": [["OS Credential Dumping", 0.23493071482655056], ["Modify Authentication Process", 0.07104932855961966], ["Access Token Manipulation", 0.04748202345077712], ["Forced Authentication", 0.034953684265960835], ["Input Capture", 0.032553998626676295], ["Multi-Factor Authentication Interception", 0.02739958349060473]], "credentials are extracted with Mimikatz.": [["Credentials from Password Stores", 0.28544117221843096], ["OS Credential Dumping", 0.2628961079905553], ["Unsecured Credentials", 0.20260969962869588], ["Input Capture", 0.0249174473185214], ["Brute Force", 0.017471240840348908], ["Valid Accounts", 0.013782739493470217]], "credential extraction tool Mimikatz": [["OS Credential Dumping", 0.4670677123263254], ["Credentials from Password Stores", 0.14329660528183705], ["Unsecured Credentials", 0.09446833938896727], ["Brute Force", 0.027086819239627632], ["Modify Authentication Process", 0.02014363339606871], ["Valid Accounts", 0.015587462392572604]], "uses the CreateProcessWithLogonW Windows API": [["Event Triggered Execution", 0.11789833194661954], ["Boot or Logon Autostart Execution", 0.11191128734275337], ["Access Token Manipulation", 0.06669263596643968], ["Native API", 0.060608090706247085], ["Input Capture", 0.058342263562673885], ["Command and Scripting Interpreter", 0.04916403026683531]], "calling the API": [["Native API", 0.3327005349365852], ["Cloud Service Dashboard", 0.06288958691911598], ["Web Service", 0.03370131575113906], ["System Services", 0.02575558975832084], ["Application Layer Protocol", 0.02392044577890231], ["Command and Scripting Interpreter", 0.02138907892381426]], "recon for interesting hostnames": [["Dynamic Resolution", 0.12511469653914728], ["Remote System Discovery", 0.09604086305043798], ["System Information Discovery", 0.03509182530000889], ["System Network Configuration Discovery", 0.033833414158385255], ["Masquerading", 0.02949984840212958], ["Acquire Infrastructure", 0.025142831311941193]], "public facing systems is compromised": [["Compromise Infrastructure", 0.12092425924453035], ["Drive-by Compromise", 0.06743671759208272], ["Stage Capabilities", 0.06721775278664888], ["Exploit Public-Facing Application", 0.04901705192326679], ["Acquire Infrastructure", 0.04153500974847908], ["Obtain Capabilities", 0.027784168374584663]], "be injected with deceptive credentials at multiple places like LSASS process memory": [["OS Credential Dumping", 0.09560333846588148], ["Process Injection", 0.08742596576614577], ["Input Capture", 0.06584444710684155], ["Access Token Manipulation", 0.05131461128336756], ["Forced Authentication", 0.03296380957792044], ["Credentials from Password Stores", 0.03265802951943772]], "Injecting NETONLY credentials into LSASS process memory": [["OS Credential Dumping", 0.32341976483254886], ["Access Token Manipulation", 0.04969240685658291], ["Process Injection", 0.04940952452688578], ["Credentials from Password Stores", 0.039368324580669745], ["Input Capture", 0.0353058791593715], ["Modify Authentication Process", 0.034230052879668765]], "Injecting credentials into LSASS memory": [["OS Credential Dumping", 0.3257336456000204], ["Credentials from Password Stores", 0.0735837639529682], ["Unsecured Credentials", 0.07281251648402705], ["Modify Authentication Process", 0.047622485084658425], ["Forced Authentication", 0.039069699701501315], ["Input Capture", 0.03396238166904518]], "credentials being picked up and used to pivot to decoy systems in the network": [["Valid Accounts", 0.09621013060896262], ["Brute Force", 0.09619503849730753], ["OS Credential Dumping", 0.05956295975774029], ["Modify Authentication Process", 0.05686328289134211], ["Unsecured Credentials", 0.044584522629876534], ["Credentials from Password Stores", 0.03701483693192754]], "keyloggers": [["Input Capture", 0.866663526432326], ["Credentials from Password Stores", 0.005814432692065601], ["Screen Capture", 0.004915568514350987], ["Clipboard Data", 0.004594152698358181], ["Unsecured Credentials", 0.004372569068160218], ["Network Sniffing", 0.0042736017972709725]], "flood a remote DNS server with false traffic.": [["Network Denial of Service", 0.20917740114724923], ["Endpoint Denial of Service", 0.127379730018576], ["Compromise Infrastructure", 0.09642132211716925], ["Dynamic Resolution", 0.07917342579377971], ["Acquire Infrastructure", 0.047576658196948694], ["Adversary-in-the-Middle", 0.04671880994091931]], "send traffic simultaneously to one server,": [["Proxy", 0.19879013923167765], ["Fallback Channels", 0.06816185562698694], ["Application Layer Protocol", 0.0535125208556806], ["Non-Application Layer Protocol", 0.049171285916341685], ["Adversary-in-the-Middle", 0.041941873076583154], ["Network Denial of Service", 0.041549022254417416]], "using the default factory credentials.": [["OS Credential Dumping", 0.09211405728850602], ["Valid Accounts", 0.09079776345124033], ["Credentials from Password Stores", 0.09043475020488809], ["Modify Authentication Process", 0.08985015905375501], ["Unsecured Credentials", 0.06422758026992799], ["Brute Force", 0.045686605875451154]], "exfiltrating data from the target device": [["Exfiltration Over Physical Medium", 0.17026674602039968], ["Exfiltration Over Web Service", 0.07752887557827431], ["Exfiltration Over C2 Channel", 0.07112943503752162], ["Data from Removable Media", 0.05284698420308972], ["Exfiltration Over Alternative Protocol", 0.043433873729237384], ["Exfiltration Over Other Network Medium", 0.04298732611699449]], "covert channel that can be used to exfiltrate data from the victim device": [["Exfiltration Over Other Network Medium", 0.12670200159332384], ["Exfiltration Over Physical Medium", 0.10823047201239251], ["Exfiltration Over C2 Channel", 0.09732768873713356], ["Exfiltration Over Alternative Protocol", 0.0885390360098127], ["Exfiltration Over Web Service", 0.04602783362651548], ["Data from Removable Media", 0.034223543165374765]], "deliver more malware,": [["Develop Capabilities", 0.08918132560389272], ["Drive-by Compromise", 0.07677785441810905], ["Obtain Capabilities", 0.07110719582707946], ["Stage Capabilities", 0.06175700330985074], ["Acquire Infrastructure", 0.050107391649056844], ["Phishing", 0.04124846207543584]], "extract data and files from endpoint devices.": [["Data from Local System", 0.17214282588837554], ["Data from Removable Media", 0.1368682565491107], ["Automated Collection", 0.06225197345150698], ["Exfiltration Over C2 Channel", 0.049324777146649325], ["Data from Network Shared Drive", 0.03746721626616465], ["Exfiltration Over Physical Medium", 0.03446794938651172]], "a version of the malware that was injected into a victim\u2019s system": [["Software Discovery", 0.12407188897675483], ["Develop Capabilities", 0.035050761565279885], ["Supply Chain Compromise", 0.029589835952488173], ["Modify System Image", 0.02790548012345504], ["Obtain Capabilities", 0.027833126860276967], ["Obfuscated Files or Information", 0.027582424545999195]], "It usually pretends to be a legitimate file, such as an Adobe PDF or Dropbox file,": [["Masquerading", 0.19211793474018807], ["User Execution", 0.08114205150760143], ["Hide Artifacts", 0.0540888045005189], ["Ingress Tool Transfer", 0.048766596881347775], ["Phishing", 0.04721180107550051], ["Archive Collected Data", 0.041069503152369985]], "The phishing email with the malicious attachment": [["Phishing", 0.4265110909004967], ["User Execution", 0.22649949558625826], ["Phishing for Information", 0.05728721299848811], ["Internal Spearphishing", 0.03714949733095835], ["Email Collection", 0.01647326821386147], ["Stage Capabilities", 0.008283451412621063]], "file is a Python program packaged by PyInstaller.": [["Masquerading", 0.13471990685668125], ["File and Directory Discovery", 0.060871578975847544], ["Native API", 0.05846530438539411], ["Ingress Tool Transfer", 0.04995134905680986], ["Hide Artifacts", 0.04699523515214671], ["Deobfuscate/Decode Files or Information", 0.044711935113102765]], "is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected.": [["Obfuscated Files or Information", 0.772697920200546], ["Deobfuscate/Decode Files or Information", 0.042456878276391614], ["Masquerading", 0.012649045071539562], ["Execution Guardrails", 0.011989236839820174], ["Hide Artifacts", 0.010300757653834433], ["Data Obfuscation", 0.007413796045066159]], "It contains Base64-encoded data": [["Data Encoding", 0.4356243237824054], ["Deobfuscate/Decode Files or Information", 0.15792455349106332], ["Obfuscated Files or Information", 0.13379879829344601], ["Archive Collected Data", 0.07245254351957664], ["Data Obfuscation", 0.026401187728617725], ["Exfiltration Over Alternative Protocol", 0.01622018862102141]], "Python programs that are obfuscated using\u00a0PyArmor": [["Obfuscated Files or Information", 0.666282780718071], ["Deobfuscate/Decode Files or Information", 0.09410986339357222], ["Archive Collected Data", 0.019400352495457705], ["Encrypted Channel", 0.014316668421037682], ["Process Injection", 0.013324273405900564], ["Masquerading", 0.013321902166397616]], "After decrypting the pyc file,": [["Deobfuscate/Decode Files or Information", 0.6011559901733797], ["Obfuscated Files or Information", 0.057665305333312926], ["Archive Collected Data", 0.05469706424042774], ["Data Encrypted for Impact", 0.05438030528551308], ["Encrypted Channel", 0.01542488650733224], ["Weaken Encryption", 0.008757501027948724]], "it uses the following command to delete the data in PSReadline": [["Indicator Removal", 0.487538996425738], ["Data Destruction", 0.12724662257012243], ["Disk Wipe", 0.05783688403510816], ["Inhibit System Recovery", 0.04067766586165889], ["System Shutdown/Reboot", 0.02698083303981028], ["Modify Registry", 0.016476557729099534]], "It also checks the victim\u2019s hostname": [["System Information Discovery", 0.17132314324290537], ["System Owner/User Discovery", 0.13918662353622635], ["System Network Configuration Discovery", 0.13635394451316035], ["Remote System Discovery", 0.046455637146347865], ["Virtualization/Sandbox Evasion", 0.0390314782963835], ["Query Registry", 0.029807752097335324]], "collects browser history and passwords from the following browsers": [["Credentials from Password Stores", 0.6573285895026152], ["Unsecured Credentials", 0.05371413807962304], ["Browser Bookmark Discovery", 0.04423513479683424], ["Input Capture", 0.029986603020906933], ["Browser Session Hijacking", 0.026611670079981407], ["OS Credential Dumping", 0.017056834404736317]], "It also uses the command \u201cCopyFromScreen\u201d to capture a screenshot.": [["Screen Capture", 0.8569047388722717], ["Video Capture", 0.016947213459095372], ["Application Window Discovery", 0.015529610612410248], ["Clipboard Data", 0.008695264696224744], ["Input Capture", 0.007654092892726684], ["Hide Artifacts", 0.004155378210441901]], "Downloading files and getting a screenshot": [["Screen Capture", 0.4370737342159646], ["Ingress Tool Transfer", 0.0916653889585028], ["Data from Local System", 0.05964775062415907], ["Video Capture", 0.025002022271093723], ["Command and Scripting Interpreter", 0.020674370451931365], ["Automated Collection", 0.013595370959314085]], "Download components for the Keylogger": [["Input Capture", 0.7286781597822224], ["Credentials from Password Stores", 0.031247552374475084], ["Unsecured Credentials", 0.014536475395800831], ["Deobfuscate/Decode Files or Information", 0.010600314438998613], ["Command and Scripting Interpreter", 0.009927996095498616], ["OS Credential Dumping", 0.00920545182465252]], "It is a key logger that saves data in the \u201cKeyLogs\u201d folder.": [["Input Capture", 0.37388108390392855], ["Data Staged", 0.045823762314608496], ["Credentials from Password Stores", 0.03093375123068306], ["Unsecured Credentials", 0.030912207298415227], ["Automated Collection", 0.030060930389818486], ["Indicator Removal", 0.026443825727229753]], "downloads three components from": [["Ingress Tool Transfer", 0.5815715599810758], ["Command and Scripting Interpreter", 0.12052711148015605], ["BITS Jobs", 0.03283266068603691], ["System Binary Proxy Execution", 0.015966782701505068], ["Multi-Stage Channels", 0.014178960190498921], ["Data from Local System", 0.011619022944860436]], "can be executed via scheduled tasks.": [["Scheduled Task/Job", 0.7910083126767395], ["Command and Scripting Interpreter", 0.024291356437701153], ["Inter-Process Communication", 0.024177781552478097], ["System Services", 0.013347262044314617], ["Create or Modify System Process", 0.010635148951898172], ["Masquerading", 0.009096810763741144]], "It was quite common to see scheduled tasks used to create persistence for the ransomware executable,": [["Scheduled Task/Job", 0.36062183312252566], ["Event Triggered Execution", 0.0740407192893947], ["Boot or Logon Autostart Execution", 0.06772655458697317], ["Create or Modify System Process", 0.06519560877582704], ["Command and Scripting Interpreter", 0.03690355650862011], ["Masquerading", 0.03150147007143858]], "The threat actors also expressed interest in other access methods such as RDP": [["Remote Services", 0.11284793202723925], ["External Remote Services", 0.10940083895683725], ["Remote Access Software", 0.0613423453635089], ["Exploitation of Remote Services", 0.04862156412528744], ["Develop Capabilities", 0.042441350908477324], ["Hardware Additions", 0.03359701032318522]], "Credentials that have either been reused across multiple platforms or have previously been exposed": [["Unsecured Credentials", 0.15805464385839096], ["Credentials from Password Stores", 0.12398941235867383], ["Valid Accounts", 0.09127839346459972], ["Brute Force", 0.07462556447846828], ["OS Credential Dumping", 0.073476540432536], ["Modify Authentication Process", 0.039808964563372025]], "this includes VPN accounts": [["Valid Accounts", 0.15650979466663126], ["External Remote Services", 0.11583263757570468], ["Account Discovery", 0.03761754031213206], ["Compromise Accounts", 0.03167338225355611], ["Gather Victim Identity Information", 0.03160831247581255], ["Create Account", 0.03053803102093151]], "Compromised accounts may be used to maintain access to the network.": [["Valid Accounts", 0.2858076977318771], ["External Remote Services", 0.07142540780652831], ["Account Manipulation", 0.05073621699038134], ["Create Account", 0.046024825809543944], ["Compromise Accounts", 0.04370637171442829], ["Account Access Removal", 0.03327708477488859]], "local accounts.": [["Valid Accounts", 0.22491274288928617], ["Create Account", 0.18105331689511148], ["Account Discovery", 0.1111863198771143], ["Account Manipulation", 0.07459375160848754], ["Establish Accounts", 0.041873140495167174], ["Compromise Accounts", 0.03437015965703646]], "domain and local accounts": [["Create Account", 0.2874845765381224], ["Valid Accounts", 0.22714686654871316], ["Account Discovery", 0.12147485204883714], ["Account Manipulation", 0.059724682128282365], ["Establish Accounts", 0.024472236642878984], ["Modify Authentication Process", 0.019813071159272715]], "Affiliates have been seen brute forcing": [["Brute Force", 0.3408669818111213], ["Gather Victim Identity Information", 0.09006230302843705], ["Steal or Forge Kerberos Tickets", 0.03652897845757977], ["Acquire Infrastructure", 0.03136832337897465], ["Use Alternate Authentication Material", 0.020187272322505275], ["Multi-Factor Authentication Interception", 0.019924630861127144]], "Affiliates have been seen brute forcing exposed RDP services and compromising accounts with weak passwords.": [["Brute Force", 0.5270408753332986], ["Valid Accounts", 0.04224673078159483], ["Modify Authentication Process", 0.03756825663544735], ["Gather Victim Identity Information", 0.025326329297968304], ["Password Policy Discovery", 0.018870525668511055], ["Steal or Forge Kerberos Tickets", 0.01799847527281305]], "Exploit Public-Facing Applications": [["Drive-by Compromise", 0.32864729530641723], ["Exploit Public-Facing Application", 0.08385407780847319], ["Exploitation for Client Execution", 0.06510739062896734], ["Obtain Capabilities", 0.05942441897457985], ["Stage Capabilities", 0.055730489949069414], ["Develop Capabilities", 0.03719030931135346]], "is typically executed via command line arguments": [["Command and Scripting Interpreter", 0.3091497331246386], ["Native API", 0.10818993685059883], ["System Binary Proxy Execution", 0.07570159235616497], ["Indirect Command Execution", 0.07388666042934187], ["System Services", 0.05056953060430254], ["Event Triggered Execution", 0.021170034660107865]], "some defense evasion batch scripts.": [["Command and Scripting Interpreter", 0.12088833074072963], ["Impair Defenses", 0.08751240308435795], ["Masquerading", 0.043431299824185116], ["System Binary Proxy Execution", 0.04079471644220721], ["Domain Policy Modification", 0.03937075376243428], ["Execution Guardrails", 0.033889269708521075]], "a batch script or a specially crafted command line script.": [["Command and Scripting Interpreter", 0.5360925730574878], ["Indicator Removal", 0.029407750328262063], ["Scheduled Task/Job", 0.028706843139346058], ["Modify Registry", 0.025246536272824794], ["Masquerading", 0.01420987259704816], ["Boot or Logon Autostart Execution", 0.013443118517763452]], "The ProxyShell elevation of privilege on the Exchange PowerShell Backend (CVE-2021-34523), Windows Background Intelligent Transfer Service (BITS) improperly handling symbolic links (CVE-2020-0787), and abusing the CMSTPLUA COM interface have all been seen as methods of privilege escalation.": [["Exploitation for Privilege Escalation", 0.33059925610287766], ["Abuse Elevation Control Mechanism", 0.15400390382359344], ["Access Token Manipulation", 0.068809583592173], ["Domain Policy Modification", 0.03174952249078012], ["Valid Accounts", 0.028742372430934374], ["Hijack Execution Flow", 0.02465633496726139]], "has utilized a UAC bypass tool.": [["Abuse Elevation Control Mechanism", 0.5923985852432119], ["Access Token Manipulation", 0.04419959667801805], ["File and Directory Permissions Modification", 0.02924491619390489], ["Exploitation for Privilege Escalation", 0.02086441184024646], ["Domain Policy Modification", 0.015869484553207178], ["Boot or Logon Autostart Execution", 0.012979743800972748]], "Indicators, such as logs in Windows Event Logs or malicious files, are typically removed using wevtutil, a batch script, or CCleaner.": [["Indicator Removal", 0.812835673193092], ["Impair Defenses", 0.03923663909434855], ["Data Destruction", 0.014466256626972004], ["Inhibit System Recovery", 0.013113043059358112], ["Modify Registry", 0.008477946639666655], ["Hide Artifacts", 0.008435795257022332]], "Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool,": [["Impair Defenses", 0.4704886668145927], ["Process Discovery", 0.08298018504068315], ["Software Discovery", 0.07570003733696855], ["Windows Management Instrumentation", 0.038528041214695795], ["Service Stop", 0.03227038231101966], ["Process Injection", 0.023025043411222895]], "Firewall rules have occasionally been seen being disabled as well.": [["Impair Defenses", 0.6776429241059585], ["Software Discovery", 0.02698884752795758], ["Network Boundary Bridging", 0.020453408893854413], ["Endpoint Denial of Service", 0.017281354813216753], ["Network Service Discovery", 0.014405851052310457], ["Traffic Signaling", 0.010132895197756024]], "During the defense evasion phase, anti-malware and monitoring software is often disabled.": [["Impair Defenses", 0.523822715706971], ["Software Discovery", 0.1601746959696083], ["Subvert Trust Controls", 0.014185757980230038], ["Virtualization/Sandbox Evasion", 0.011117131924262934], ["Windows Management Instrumentation", 0.010270364835427967], ["Execution Guardrails", 0.009062163961202628]], "Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well.": [["OS Credential Dumping", 0.5535891865267649], ["Credentials from Password Stores", 0.16342069164224424], ["Unsecured Credentials", 0.05290627097418746], ["Input Capture", 0.050024938543301034], ["Brute Force", 0.011563461671944854], ["Network Sniffing", 0.008599980576560206]], "has been seen using the PowerShell module InvokeGPUpdate to update the group policy.": [["Domain Policy Modification", 0.40184428431753], ["Modify Registry", 0.05622226046839168], ["Abuse Elevation Control Mechanism", 0.038728311734368866], ["File and Directory Permissions Modification", 0.034521407460351344], ["Permission Groups Discovery", 0.030186572147988974], ["Impair Defenses", 0.028190420410108635]], "Most PowerShell scripts involved in LockBit 2.0 cases are Base64 encoded.": [["Obfuscated Files or Information", 0.2551824847534423], ["Deobfuscate/Decode Files or Information", 0.14095756556263023], ["Data Encrypted for Impact", 0.04878574187236114], ["Encrypted Channel", 0.02761315466733537], ["OS Credential Dumping", 0.02539418558011619], ["Data Encoding", 0.024799392404087118]], "enumerates system information such as hostname, shares, and domain information.": [["System Information Discovery", 0.34008889610106735], ["Network Share Discovery", 0.14531734025115495], ["Remote System Discovery", 0.1367850570368519], ["System Network Configuration Discovery", 0.05138796843418816], ["File and Directory Discovery", 0.0389629778084986], ["Windows Management Instrumentation", 0.026685697740708086]], "has been known to self-propagate via SMB.": [["Lateral Tool Transfer", 0.16962081082276328], ["Taint Shared Content", 0.1601853475004691], ["Remote Services", 0.15127283790971105], ["Exploitation of Remote Services", 0.12477325759470173], ["Software Deployment Tools", 0.027352674636371224], ["Communication Through Removable Media", 0.024074660403491075]], "a method of lateral movement and a tool for downloading/executing files.": [["Ingress Tool Transfer", 0.42693228035204717], ["Lateral Tool Transfer", 0.06025845114601082], ["Command and Scripting Interpreter", 0.052198004326352625], ["Remote Services", 0.040179180262223904], ["Masquerading", 0.02477555389059817], ["Native API", 0.018101964176400046]], "AnyDesk has been the most common legitimate desktop software used to establish an interactive command and control channel, with ConnectWise seen slightly less frequently.": [["Remote Access Software", 0.28611388277147876], ["Remote Services", 0.12120372520322654], ["Command and Scripting Interpreter", 0.04981628336767742], ["External Remote Services", 0.027307169867055812], ["Communication Through Removable Media", 0.026963444171467687], ["Develop Capabilities", 0.02098158232699246]], "Operates as a file grabber": [["Data from Local System", 0.32501052004804365], ["File and Directory Discovery", 0.09919180752009372], ["Ingress Tool Transfer", 0.0608261347055911], ["Automated Collection", 0.054059483916182795], ["Data from Removable Media", 0.053706530442051474], ["Data from Network Shared Drive", 0.04839201779296936]], "the UPX packed sample": [["Obfuscated Files or Information", 0.2965327674019026], ["Deobfuscate/Decode Files or Information", 0.05346277005960425], ["Archive Collected Data", 0.029991381196091203], ["Obtain Capabilities", 0.02354384131098208], ["Ingress Tool Transfer", 0.022109927671165187], ["Masquerading", 0.020166049307008337]], "which unpacks": [["Deobfuscate/Decode Files or Information", 0.2286156614491412], ["Obfuscated Files or Information", 0.21652200429909416], ["Archive Collected Data", 0.045867691506465615], ["Command and Scripting Interpreter", 0.035244147912579515], ["Masquerading", 0.034991104925655346], ["Ingress Tool Transfer", 0.019431279193277966]], "brute forcing post-infection to automate local and global spreading attempts.": [["Brute Force", 0.3504597859694093], ["Valid Accounts", 0.04607999645111496], ["Steal or Forge Kerberos Tickets", 0.03141486377429974], ["Multi-Factor Authentication Interception", 0.020786144530437114], ["Remote Services", 0.018066441877544314], ["Drive-by Compromise", 0.015531885929067403]], "brute forcing": [["Brute Force", 0.648348945547775], ["Multi-Factor Authentication Interception", 0.026876877237550254], ["Steal or Forge Kerberos Tickets", 0.024343411269814638], ["Use Alternate Authentication Material", 0.01850641818174033], ["Modify Authentication Process", 0.010451828232911374], ["OS Credential Dumping", 0.00880351835262305]], "multiple levels of encoded commands,": [["Obfuscated Files or Information", 0.4735713432723212], ["Data Encoding", 0.1298795617676056], ["Deobfuscate/Decode Files or Information", 0.11202628307680938], ["Data Obfuscation", 0.0299243891117999], ["Encrypted Channel", 0.02716855795428665], ["Command and Scripting Interpreter", 0.0199024325353138]], "The multiple levels of Base64 encoding": [["Data Encoding", 0.39527770286799063], ["Obfuscated Files or Information", 0.2826194613550154], ["Deobfuscate/Decode Files or Information", 0.15475935787173217], ["Archive Collected Data", 0.03542111504937999], ["Data Obfuscation", 0.018645147228160814], ["Encrypted Channel", 0.014660591358936244]], "use of three base64 encoded echo commands": [["Obfuscated Files or Information", 0.3708147552983725], ["Data Encoding", 0.28614993905648817], ["Deobfuscate/Decode Files or Information", 0.07973756284486237], ["Data Obfuscation", 0.035776567153321254], ["Command and Scripting Interpreter", 0.020375585646830428], ["Archive Collected Data", 0.0185031853298349]], "encoded payload": [["Data Encoding", 0.4168539145455859], ["Obfuscated Files or Information", 0.2628470423445041], ["Deobfuscate/Decode Files or Information", 0.12715336672423125], ["Data Obfuscation", 0.02638623647117924], ["Encrypted Channel", 0.018023000800699678], ["Archive Collected Data", 0.015030873137129148]], "downloading itself from malicious servers": [["Ingress Tool Transfer", 0.5607283966341469], ["BITS Jobs", 0.03602857700264168], ["Command and Scripting Interpreter", 0.029776039718949095], ["Application Layer Protocol", 0.02654668578990521], ["Web Service", 0.021528690687090134], ["Stage Capabilities", 0.017244767995020494]], "attacker began adding the lwp-download command as a failover for wget and curl to enable downloading commands": [["Ingress Tool Transfer", 0.3443952361350999], ["Command and Scripting Interpreter", 0.08589306306885704], ["BITS Jobs", 0.045004374412300485], ["Multi-Stage Channels", 0.039253942215946525], ["Application Layer Protocol", 0.028934521297795373], ["Web Service", 0.028589422369664174]], "download, and configure": [["Ingress Tool Transfer", 0.32605263902033615], ["BITS Jobs", 0.05255512545545798], ["Command and Scripting Interpreter", 0.04467535986242363], ["Web Service", 0.035135925376545266], ["Obtain Capabilities", 0.029236802937985418], ["Stage Capabilities", 0.028896152594891488]], "process of downloading and setting persistence of some other file.": [["Ingress Tool Transfer", 0.1556701964731388], ["Data Staged", 0.11681003851984985], ["BITS Jobs", 0.0633382892526596], ["Scheduled Task/Job", 0.03716507454043493], ["Command and Scripting Interpreter", 0.03446669898909724], ["Hide Artifacts", 0.02210965391174696]], "downloading a specific payload": [["Ingress Tool Transfer", 0.5914679942271327], ["Command and Scripting Interpreter", 0.06441696829909155], ["BITS Jobs", 0.05710770682812117], ["Application Layer Protocol", 0.024913837459320576], ["Deobfuscate/Decode Files or Information", 0.01312766422595058], ["Web Service", 0.01111891691908373]], "decoded into a new script": [["Deobfuscate/Decode Files or Information", 0.5746578619966645], ["Obfuscated Files or Information", 0.21243883433451186], ["Command and Scripting Interpreter", 0.0358470473530567], ["Archive Collected Data", 0.0212351756549975], ["Data Encoding", 0.015460190643787106], ["Encrypted Channel", 0.006871078001065498]], "The payload contains two additional base64 encoded scripts": [["Obfuscated Files or Information", 0.5371836961895045], ["Deobfuscate/Decode Files or Information", 0.19086419359792262], ["Data Encoding", 0.10144184181531968], ["Data Obfuscation", 0.014717383686679882], ["Command and Scripting Interpreter", 0.01448922970573009], ["Archive Collected Data", 0.01108510839819397]], "operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.": [["Valid Accounts", 0.3432677518286184], ["Brute Force", 0.05592349370872401], ["External Remote Services", 0.04854279546760462], ["Account Manipulation", 0.046241893233529216], ["Modify Authentication Process", 0.039199674802990074], ["OS Credential Dumping", 0.027935803647785452]], "exploits known vulnerabilities in internet-facing applications": [["Exploit Public-Facing Application", 0.2426591158105542], ["Exploitation for Client Execution", 0.1944828015884715], ["Obtain Capabilities", 0.10932789941881674], ["Drive-by Compromise", 0.06369762575287828], ["Develop Capabilities", 0.06218422074372485], ["Stage Capabilities", 0.046393694852247064]], "MiniDump, \u201ca C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps\u201d": [["OS Credential Dumping", 0.6896728737187297], ["Unsecured Credentials", 0.09286409448078752], ["Credentials from Password Stores", 0.06965395664110796], ["Input Capture", 0.013799885029763063], ["Network Sniffing", 0.01138400365282016], ["Brute Force", 0.007179262049009467]], "Usernames": [["System Owner/User Discovery", 0.48041081178552164], ["Account Discovery", 0.12124769616409728], ["Gather Victim Identity Information", 0.029695440432348542], ["Brute Force", 0.016324416908142687], ["Establish Accounts", 0.015204930000319377], ["Compromise Accounts", 0.011992303984538991]], "and hostnames collected": [["Remote System Discovery", 0.2586309869045125], ["Automated Collection", 0.08518210964365008], ["System Network Configuration Discovery", 0.08334652680667788], ["System Information Discovery", 0.06968145173949904], ["Gather Victim Host Information", 0.03577520051561761], ["System Network Connections Discovery", 0.03424211376542997]], "It is used to connect to systems in the same network via SMB, to write a batch file to disk": [["Remote Services", 0.18554571832989752], ["Lateral Tool Transfer", 0.14880489152129084], ["Network Share Discovery", 0.04351167211060675], ["Communication Through Removable Media", 0.03556544551704857], ["Command and Scripting Interpreter", 0.026713647949378475], ["Taint Shared Content", 0.023214049727789274]], "to push batch files over SMB to other systems within an internal network.": [["Lateral Tool Transfer", 0.3698167801281211], ["Remote Services", 0.15578659163033298], ["Taint Shared Content", 0.08033326381590687], ["Valid Accounts", 0.030515214346421415], ["Communication Through Removable Media", 0.026030120594765584], ["Exploitation of Remote Services", 0.02038493005114473]], "write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string": [["Indicator Removal", 0.2029081023256951], ["Command and Scripting Interpreter", 0.11895785991040907], ["System Shutdown/Reboot", 0.11307507794494905], ["Data Destruction", 0.06739613553651702], ["Disk Wipe", 0.05292057658337517], ["Modify Registry", 0.03686222027066523]], "writing the batch file to disk and executing.": [["Command and Scripting Interpreter", 0.4296192288099117], ["Scheduled Task/Job", 0.09599758470342458], ["System Binary Proxy Execution", 0.04094455741422266], ["Indicator Removal", 0.02634247202189771], ["Masquerading", 0.02487055800438897], ["System Services", 0.020341976760035872]], "a batch file": [["Command and Scripting Interpreter", 0.6257588920491339], ["Scheduled Task/Job", 0.042647162728694496], ["System Binary Proxy Execution", 0.03441780242406711], ["System Services", 0.015612205063498035], ["Boot or Logon Autostart Execution", 0.015102201558282043], ["Masquerading", 0.014562300176489643]], "creates another batch file, system.bat,": [["Command and Scripting Interpreter", 0.41059130309027103], ["Scheduled Task/Job", 0.09539763189689514], ["System Binary Proxy Execution", 0.05637005485431465], ["Boot or Logon Autostart Execution", 0.04803733535722827], ["System Services", 0.04480788252005201], ["Masquerading", 0.028908336151897508]], "writes another batch file": [["Command and Scripting Interpreter", 0.4608359298600832], ["Scheduled Task/Job", 0.05939715825356365], ["System Binary Proxy Execution", 0.03567592816979275], ["Indicator Removal", 0.028706848804215517], ["Masquerading", 0.023455077882804935], ["System Services", 0.01937326251699307]], "the batch file in Figure 7, which Sandals creates on remote systems to launch": [["Command and Scripting Interpreter", 0.3541988595654273], ["Scheduled Task/Job", 0.12831560493321023], ["System Services", 0.07592196268676173], ["Boot or Logon Autostart Execution", 0.04241678952828684], ["System Binary Proxy Execution", 0.03847915006430074], ["Windows Management Instrumentation", 0.028146178695861595]], "both use batch files that run via the Windows command shell.": [["Command and Scripting Interpreter", 0.5272372953456496], ["Scheduled Task/Job", 0.054600229973265565], ["Windows Management Instrumentation", 0.03258954698147975], ["System Binary Proxy Execution", 0.028977767747760542], ["Masquerading", 0.021872118748561348], ["Boot or Logon Autostart Execution", 0.0186326294483909]], "ease of batch file execution.": [["Command and Scripting Interpreter", 0.6290774995333696], ["Scheduled Task/Job", 0.04535335336590256], ["System Binary Proxy Execution", 0.03369901616982866], ["System Services", 0.014945832829839566], ["Windows Management Instrumentation", 0.014665736714911039], ["Indirect Command Execution", 0.014580109717423479]], "write the batch file on the remote system.": [["Command and Scripting Interpreter", 0.25961685884824764], ["Remote Services", 0.12829621991098608], ["Scheduled Task/Job", 0.09945457535255399], ["System Services", 0.049241434746335064], ["Windows Management Instrumentation", 0.036245310381867485], ["Lateral Tool Transfer", 0.033984821599748964]], "it writes a batch file": [["Command and Scripting Interpreter", 0.41222898873201413], ["Indicator Removal", 0.0525561044417345], ["Scheduled Task/Job", 0.04836753866743675], ["Masquerading", 0.028939637528465675], ["System Binary Proxy Execution", 0.024172186334186763], ["Data Staged", 0.023809371519802346]], "lists the command line arguments accepted": [["Query Registry", 0.12009293935312504], ["Native API", 0.09932193343483706], ["Command and Scripting Interpreter", 0.09756478617355592], ["File and Directory Discovery", 0.04875868936654506], ["Virtualization/Sandbox Evasion", 0.04000128603621585], ["Software Discovery", 0.03856604069255292]], "deletes all files written to disk in the current working directory": [["Indicator Removal", 0.41421668758588737], ["Data Destruction", 0.1615313582225732], ["Disk Wipe", 0.10189076960960901], ["Inhibit System Recovery", 0.03202372696458756], ["File and Directory Discovery", 0.02551911945161019], ["System Shutdown/Reboot", 0.015704796253699364]], "then deletes the file.": [["Indicator Removal", 0.5558844670093414], ["Data Destruction", 0.14182833506906617], ["Inhibit System Recovery", 0.014961290806827069], ["Hide Artifacts", 0.014638565136805731], ["Disk Wipe", 0.014164450590874693], ["System Shutdown/Reboot", 0.013241751965704634]], "deletes the directory with the files causing the errors": [["Indicator Removal", 0.7277431946991074], ["Data Destruction", 0.06881792060811227], ["File and Directory Discovery", 0.01650020112457402], ["Disk Wipe", 0.013896471248111776], ["Inhibit System Recovery", 0.013515679529038432], ["Masquerading", 0.007070506491829906]], "recursively deletes all files": [["Indicator Removal", 0.5948864911571743], ["Data Destruction", 0.1395525595773019], ["Disk Wipe", 0.03204288967243292], ["Inhibit System Recovery", 0.02123983245317163], ["File and Directory Discovery", 0.01306148693757715], ["System Shutdown/Reboot", 0.011212309993037614]], "the file deletion functions": [["Indicator Removal", 0.6939128066502066], ["Data Destruction", 0.13158598798799387], ["Inhibit System Recovery", 0.014380457585136586], ["Disk Wipe", 0.013457623888888178], ["File and Directory Discovery", 0.00865198284658589], ["System Shutdown/Reboot", 0.006644136753628317]], "File deletion functions": [["Indicator Removal", 0.6829263654448855], ["Data Destruction", 0.13786746138699313], ["Disk Wipe", 0.013657206847912001], ["Inhibit System Recovery", 0.013599955541441852], ["File and Directory Discovery", 0.008145565107620822], ["System Shutdown/Reboot", 0.006963574279106951]], "then deletes the files.": [["Indicator Removal", 0.4649920229403826], ["Data Destruction", 0.1518716181744996], ["Disk Wipe", 0.03974837690263487], ["Inhibit System Recovery", 0.035171115465986266], ["System Shutdown/Reboot", 0.030483415621336406], ["Service Stop", 0.012422301674189206]], "the decoded command line parameter": [["Deobfuscate/Decode Files or Information", 0.4679485665804305], ["Obfuscated Files or Information", 0.24852677653830038], ["Data Encoding", 0.06892397688958056], ["Native API", 0.016988536354103495], ["Command and Scripting Interpreter", 0.01614336554477182], ["Encrypted Channel", 0.01193532395861649]], "The base64 string": [["Obfuscated Files or Information", 0.3196989762966963], ["Data Encoding", 0.28041098606614606], ["Deobfuscate/Decode Files or Information", 0.17669426094003293], ["Data Obfuscation", 0.024055412850407975], ["Archive Collected Data", 0.01935187000167174], ["Encrypted Channel", 0.01358702853366033]], "base64-encoded argument": [["Obfuscated Files or Information", 0.3892025841932081], ["Data Encoding", 0.3062734369173451], ["Deobfuscate/Decode Files or Information", 0.13809854398704044], ["Data Obfuscation", 0.02161036045591965], ["Archive Collected Data", 0.01936135526644214], ["Encrypted Channel", 0.013190840425853704]], "a base64 encoded argument": [["Obfuscated Files or Information", 0.41171545589112357], ["Data Encoding", 0.29427403404283903], ["Deobfuscate/Decode Files or Information", 0.12565471060866965], ["Data Obfuscation", 0.022414108773843016], ["Archive Collected Data", 0.01941334105693433], ["Encrypted Channel", 0.014390697166643382]], "It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.": [["File and Directory Discovery", 0.43681938603557], ["Peripheral Device Discovery", 0.06554815326986821], ["System Information Discovery", 0.04988042113780837], ["Network Share Discovery", 0.04192905956889236], ["Automated Collection", 0.030756099285157528], ["Data from Removable Media", 0.027479894230849632]], "Then it enters a for loop iterating over the drive list to build a recursive directory listing": [["File and Directory Discovery", 0.6688229464198193], ["Automated Collection", 0.04162024037554919], ["Data from Local System", 0.027596202212134935], ["Data from Network Shared Drive", 0.02755316493860096], ["Data from Removable Media", 0.021735768333026685], ["Data Staged", 0.019154577301351762]], "shows that the directory listing function": [["File and Directory Discovery", 0.8669796728882317], ["Data Staged", 0.011536117662616476], ["Data from Local System", 0.010654585971938434], ["Automated Collection", 0.010033677201199036], ["Data from Network Shared Drive", 0.006574773874312191], ["Hide Artifacts", 0.00574427665161918]], "Directory listing functions": [["File and Directory Discovery", 0.802211836927267], ["Automated Collection", 0.022773869119912873], ["Data Staged", 0.01973512156541847], ["Data from Local System", 0.01908141858085115], ["Data from Network Shared Drive", 0.010887079022828011], ["Network Share Discovery", 0.007953209404653768]], ", the GetSubDirectoryFileListRecursive function": [["File and Directory Discovery", 0.7971980292614702], ["Data from Local System", 0.0348240847621065], ["Automated Collection", 0.021671138456394907], ["Data Staged", 0.018145746001207837], ["Data from Network Shared Drive", 0.01138662050496046], ["Data from Removable Media", 0.008161273279990658]], "Recursive directory listing functions": [["File and Directory Discovery", 0.7519484486945781], ["Automated Collection", 0.033033859531446816], ["Data from Local System", 0.027358744479653273], ["Data Staged", 0.019413748131666683], ["Data from Network Shared Drive", 0.013841238849302806], ["Native API", 0.009125245122104076]], "and then self-deletes.": [["Indicator Removal", 0.34682766100869966], ["Data Destruction", 0.13952656575596165], ["Inhibit System Recovery", 0.038194174170265], ["Modify Cloud Compute Infrastructure", 0.024485086154765797], ["System Shutdown/Reboot", 0.022617022472391102], ["Hide Artifacts", 0.016433067997592955]], "bat deletes itself": [["Indicator Removal", 0.5692410653767115], ["Data Destruction", 0.0853994803609672], ["Command and Scripting Interpreter", 0.06945439022847306], ["System Shutdown/Reboot", 0.020528827505603964], ["Disk Wipe", 0.015106827165623874], ["Windows Management Instrumentation", 0.010407220495570003]], "attempts to clear file system cache memory, and self-deletes": [["Indicator Removal", 0.3596453097742234], ["Data Destruction", 0.08953388316041118], ["Disk Wipe", 0.052919991262244524], ["System Shutdown/Reboot", 0.04403947317257172], ["Inhibit System Recovery", 0.04212435678768451], ["Service Stop", 0.033491929232642624]], "that deletes the Fantasy wiper from disk and then deletes itself.": [["Indicator Removal", 0.19992205090164328], ["Disk Wipe", 0.18551338006133966], ["Data Destruction", 0.1322135391868578], ["Inhibit System Recovery", 0.1269394713465325], ["System Shutdown/Reboot", 0.08671641202450689], ["Modify Registry", 0.022157086443440256]], "creates a batch file in %WINDOWS%\\Temp called registry.bat.": [["Modify Registry", 0.4685946515997454], ["Boot or Logon Autostart Execution", 0.1693674982001871], ["Query Registry", 0.12460230004992953], ["Boot or Logon Initialization Scripts", 0.021546137977076368], ["Command and Scripting Interpreter", 0.021264478148689814], ["System Binary Proxy Execution", 0.01973618297190525]], "deletes the following registry keys:\nHKCR\\.EXE\nHKCR\\.dll\nHKCR\\*": [["Modify Registry", 0.46950624577792843], ["Indicator Removal", 0.1534915394541647], ["Query Registry", 0.10104783344696999], ["Boot or Logon Autostart Execution", 0.03667630607986472], ["Impair Defenses", 0.017931997367446488], ["Masquerading", 0.016193247091572664]], "Then it runs the following to attempt to clear file system cache memory:\n%windir%\\system32\\rundll32.exe": [["Indicator Removal", 0.29186364543892324], ["System Shutdown/Reboot", 0.05375643840711715], ["Service Stop", 0.046196631984501295], ["Data Destruction", 0.039978145089357264], ["Impair Defenses", 0.03175299117989282], ["Inhibit System Recovery", 0.02994633179326057]], "GetSubDirectoryFileListRecursive function": [["File and Directory Discovery", 0.7507981512690692], ["Data from Local System", 0.04470138899472647], ["Automated Collection", 0.027022144099430826], ["Data Staged", 0.02177976758543168], ["Data from Network Shared Drive", 0.014364001010165824], ["Data from Removable Media", 0.010172029572828336]], "uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs": [["Access Token Manipulation", 0.6101677492661369], ["Abuse Elevation Control Mechanism", 0.06144192682446817], ["Domain Policy Modification", 0.018916094160743226], ["Steal Application Access Token", 0.014745158228359749], ["Multi-Factor Authentication Interception", 0.01291538724134881], ["Permission Groups Discovery", 0.012826571022797663]], "operators attempted to capture cached credentials and then use them for lateral movement.": [["OS Credential Dumping", 0.1352348766152536], ["Unsecured Credentials", 0.13002146789382688], ["Credentials from Password Stores", 0.10377428174098377], ["Use Alternate Authentication Material", 0.05029051636733732], ["Valid Accounts", 0.043145411204416416], ["Forced Authentication", 0.038433280653005164]], "The actors used built-in Windows user account DefaultAccount.": [["Create Account", 0.24710327731971057], ["Account Discovery", 0.13111921875593108], ["Valid Accounts", 0.09328535667741632], ["Account Manipulation", 0.073304744979221], ["System Owner/User Discovery", 0.046376420145698975], ["Access Token Manipulation", 0.03740032073213075]], "and the built-in Windows user account  [T1078.001] to move laterally": [["Remote Services", 0.15038769995001378], ["Valid Accounts", 0.09771710902008107], ["Create Account", 0.04856539779166679], ["Abuse Elevation Control Mechanism", 0.03454364705376871], ["Access Token Manipulation", 0.033741265607240806], ["Remote Service Session Hijacking", 0.031404529039278685]], "HTTPS activity from IP address  to the organization\u2019s VMware server.": [["Application Layer Protocol", 0.23735422267976303], ["Non-Standard Port", 0.03733987829741311], ["Compromise Infrastructure", 0.036666433500111326], ["Gather Victim Network Information", 0.03562932997817891], ["Stage Capabilities", 0.035344041014296924], ["Proxy", 0.03158167627777453]], "Following HTTPS activity,": [["Application Layer Protocol", 0.2313654473198928], ["Browser Session Hijacking", 0.06043573720194554], ["Data Obfuscation", 0.053574017450130844], ["Impair Defenses", 0.03185173115152752], ["Non-Standard Port", 0.029131488819842066], ["Network Sniffing", 0.028710369880274464]], "outgoing HTTPS port 443 connections to  and  (the prior domain in reverse).": [["Non-Standard Port", 0.22881214363401542], ["Application Layer Protocol", 0.15920752187841625], ["Proxy", 0.09705944985349499], ["Protocol Tunneling", 0.06825652602056634], ["Data Obfuscation", 0.036247099212406035], ["Encrypted Channel", 0.028071546828907838]], "to download next stage and execute it\"": [["Ingress Tool Transfer", 0.5768396999290752], ["Command and Scripting Interpreter", 0.10543267548379079], ["BITS Jobs", 0.033427022590255276], ["Multi-Stage Channels", 0.028753970879817004], ["System Binary Proxy Execution", 0.012333321538458042], ["Scheduled Task/Job", 0.008441289488993767]], "The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok.": [["Lateral Tool Transfer", 0.1506686566162167], ["Remote Services", 0.12098909013306437], ["Ingress Tool Transfer", 0.08989493292404246], ["Command and Scripting Interpreter", 0.040635198986553926], ["Taint Shared Content", 0.026623970045904864], ["Communication Through Removable Media", 0.02049768592785222]], "The exclusion rule allowlisted the entire , enabling threat actors to download tools to the  without virus scans.": [["Impair Defenses", 0.1442537771040334], ["Ingress Tool Transfer", 0.10584584992422472], ["Obtain Capabilities", 0.052975798117561604], ["Software Discovery", 0.0483314256543708], ["Stage Capabilities", 0.04316463096980138], ["Subvert Trust Controls", 0.0337400781979759]], "that added an exclusion rule to Windows Defender": [["Impair Defenses", 0.44897116926264163], ["Execution Guardrails", 0.05428931274529191], ["Software Discovery", 0.046885165033262025], ["Obfuscated Files or Information", 0.02562855217434428], ["Hide Artifacts", 0.02317450476681033], ["Domain Policy Modification", 0.020001272401826486]], "the actors manually disabled Windows Defender via the Graphical User Interface (GUI)": [["Impair Defenses", 0.48153256364542674], ["Software Discovery", 0.03562882938243638], ["Windows Management Instrumentation", 0.030472243754269508], ["Domain Policy Modification", 0.023755283013357855], ["Modify Registry", 0.01947360558034198], ["Inhibit System Recovery", 0.016408242211877474]], "The actors added an exclusion rule to Windows Defender.": [["Impair Defenses", 0.5082129111942292], ["Software Discovery", 0.043903152962482435], ["Hide Artifacts", 0.033677832000124475], ["Execution Guardrails", 0.030161521889790228], ["Masquerading", 0.022947254549614094], ["Obfuscated Files or Information", 0.018774199684340527]], "The tool allowlisted the entire c:\\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\\drive.": [["File and Directory Discovery", 0.08611782258981299], ["Hide Artifacts", 0.05599798368127829], ["Masquerading", 0.04892051655032038], ["Impair Defenses", 0.03899035833084171], ["Indicator Removal", 0.032182609216500305], ["Data from Network Shared Drive", 0.029661506130295744]], "The actors manually disabled Windows Defender via the GUI.": [["Impair Defenses", 0.5090750486930737], ["Software Discovery", 0.046644600768448174], ["Windows Management Instrumentation", 0.03486580708512593], ["Masquerading", 0.0187594974369934], ["Domain Policy Modification", 0.017685375907039908], ["Subvert Trust Controls", 0.01720989655292849]], "The threat actors also moved laterally to the domain controller, compromised credentials,": [["Valid Accounts", 0.14714990622690755], ["OS Credential Dumping", 0.0751149223326855], ["Domain Policy Modification", 0.07113839152504037], ["Account Manipulation", 0.031558698429423764], ["Modify Authentication Process", 0.024435853278138978], ["Remote Services", 0.024255986262523618]], "the actors gained access to a VMware service account with administrator and system level access": [["Valid Accounts", 0.16633929793656785], ["Account Manipulation", 0.12699515925632196], ["Create Account", 0.11732285663652822], ["Account Discovery", 0.03442689839374996], ["Create or Modify System Process", 0.03303966108225892], ["Access Token Manipulation", 0.028029104173164083]], "In February 2022, the threat actors exploited Log4Shell [T1190] for initial access": [["Impair Defenses", 0.058796849472623196], ["Exploitation of Remote Services", 0.04412782586411365], ["Event Triggered Execution", 0.03953649665437038], ["Exploit Public-Facing Application", 0.03217822155964245], ["Access Token Manipulation", 0.029272179710809518], ["Use Alternate Authentication Material", 0.022945633015756643]], "The actors exploited Log4Shell for initial access to the organization\u2019s VMware Horizon server.": [["External Remote Services", 0.07178677930477002], ["Exploitation of Remote Services", 0.06646689623652294], ["Exploit Public-Facing Application", 0.04519150833307566], ["Valid Accounts", 0.030533783225414], ["Remote Services", 0.02738965882880046], ["Use Alternate Authentication Material", 0.02138964751690744]], "The exploit payload created a Scheduled Task": [["Scheduled Task/Job", 0.7145163844389298], ["Inter-Process Communication", 0.06152630310643639], ["Masquerading", 0.014345685728147841], ["System Services", 0.009868047436477023], ["Event Triggered Execution", 0.008438925843034626], ["Command and Scripting Interpreter", 0.008169980864140081]], "The Scheduled Task was named  to masquerade as a legitimate Windows task.": [["Scheduled Task/Job", 0.637669571564809], ["Masquerading", 0.0786416484390315], ["Inter-Process Communication", 0.05109167758329467], ["Process Discovery", 0.010539923841612363], ["Create or Modify System Process", 0.0087755461181695], ["Command and Scripting Interpreter", 0.008384754379991928]], "The actors\u2019 exploit payload created Scheduled Task RuntimeBrokerService.exe, which executed RuntimeBroker.exe daily as SYSTEM.": [["Scheduled Task/Job", 0.6577093232857288], ["Create or Modify System Process", 0.04191300801203104], ["Event Triggered Execution", 0.032793271033116134], ["Masquerading", 0.01818444411736993], ["Inter-Process Communication", 0.017797849411742374], ["System Services", 0.012864636013783796]], "the actors used RDP": [["Remote Services", 0.42978507828880413], ["Remote Access Software", 0.12696246305860387], ["Remote Service Session Hijacking", 0.039173605740429274], ["External Remote Services", 0.026319648383647094], ["Exploitation of Remote Services", 0.020430960815310074], ["Valid Accounts", 0.016254189895545133]], "the actors leveraged RDP to propagate to several hosts within the network.": [["Remote Services", 0.3979971042582165], ["Remote Access Software", 0.0731488532694709], ["Exploitation of Remote Services", 0.0725266592236845], ["Software Deployment Tools", 0.03235857751051158], ["Remote Service Session Hijacking", 0.03182076117347695], ["Remote System Discovery", 0.030886466822413267]], "The actors were able to proxy [T1090] RDP sessions,": [["Remote Services", 0.2659746906975927], ["Remote Service Session Hijacking", 0.17950115989368415], ["Proxy", 0.09599559683004277], ["Remote Access Software", 0.03807549135038804], ["External Remote Services", 0.0340571468643728], ["Exploitation of Remote Services", 0.024387411060943772]], "The actors used RDP to move laterally to multiple hosts on the network.": [["Remote Services", 0.4052909197520775], ["Remote Service Session Hijacking", 0.06447252854898176], ["Remote Access Software", 0.06311665246361046], ["Exploitation of Remote Services", 0.04485520432411216], ["Lateral Tool Transfer", 0.04117200781244674], ["Valid Accounts", 0.03171910033615223]], "used Ngrok to proxy RDP connections and to perform command and control.": [["Remote Services", 0.3662855280966578], ["Proxy", 0.07051316211214444], ["Remote Service Session Hijacking", 0.06685669919757348], ["Remote Access Software", 0.057295284970893964], ["External Remote Services", 0.03333864229214917], ["Command and Scripting Interpreter", 0.02799902499123871]], "a reverse proxy tool for proxying an internal service": [["Proxy", 0.544579134421565], ["Data Obfuscation", 0.02614826761812837], ["Adversary-in-the-Middle", 0.02488381847412433], ["Protocol Tunneling", 0.024642293031629153], ["Application Layer Protocol", 0.022495940600041026], ["Endpoint Denial of Service", 0.02070481919133757]], "Mimikatz \u2013 a credential theft tool.": [["OS Credential Dumping", 0.23017431035676714], ["Credentials from Password Stores", 0.14571260979194386], ["Valid Accounts", 0.07278463729962185], ["Brute Force", 0.05462048689934088], ["Modify Authentication Process", 0.04656830962944036], ["Unsecured Credentials", 0.04213649586089351]], "The threat actors then executed Mimikatz on VDI-KMS to harvest credentials": [["OS Credential Dumping", 0.25727024987951363], ["Unsecured Credentials", 0.12750561624158985], ["Credentials from Password Stores", 0.07074211260396131], ["Forced Authentication", 0.044376876534569495], ["Valid Accounts", 0.04163512376228618], ["Modify Authentication Process", 0.037826736317654985]], "Additionally, the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process": [["Impair Defenses", 0.33111843112034084], ["Process Discovery", 0.11059739184525426], ["Access Token Manipulation", 0.041190621143184065], ["Indicator Removal", 0.029036725136359205], ["Windows Management Instrumentation", 0.02723380684627768], ["Service Stop", 0.025910698898149835]], "The actors used Mimikatz": [["Masquerading", 0.04986244801505907], ["Video Capture", 0.043660014099113464], ["Stage Capabilities", 0.02168063813399403], ["Phishing", 0.02159978464816274], ["Obtain Capabilities", 0.021599239432118143], ["Remote Access Software", 0.02090394118732556]], "The actors were observed trying to dump LSASS process.": [["OS Credential Dumping", 0.2062952812860092], ["Native API", 0.07022446412913848], ["Process Discovery", 0.06693588480652687], ["File and Directory Discovery", 0.05777608852770262], ["Indicator Removal", 0.056890210009820745], ["Virtualization/Sandbox Evasion", 0.042419452075357175]], "The actors used Mimikatz to harvest credentials.": [["Gather Victim Identity Information", 0.0995839566434839], ["Brute Force", 0.06438499075159691], ["Phishing for Information", 0.05706722970881311], ["Unsecured Credentials", 0.051703199416347476], ["Valid Accounts", 0.05070688358203594], ["OS Credential Dumping", 0.05059551147225438]], "The actors were able to proxy": [["Proxy", 0.6264757454221138], ["Protocol Tunneling", 0.02973610450290036], ["Data Obfuscation", 0.0271956464744895], ["Fallback Channels", 0.026633677223815457], ["Application Layer Protocol", 0.02554004688171287], ["Compromise Infrastructure", 0.022980328095233926]], "The actors used Ngrok to proxy": [["Proxy", 0.46227343423883305], ["Application Layer Protocol", 0.05790929092559723], ["Protocol Tunneling", 0.03387508147423062], ["Fallback Channels", 0.033422898508266775], ["Data Obfuscation", 0.02900966686849492], ["Dynamic Resolution", 0.024677062693699767]], "The actors removed malicious file mde.ps1 from the dis.": [["Indicator Removal", 0.23612342064508263], ["Inhibit System Recovery", 0.057687218927073736], ["Impair Defenses", 0.054347156520436646], ["Modify Registry", 0.05394907039601136], ["System Shutdown/Reboot", 0.04247667665737421], ["Masquerading", 0.040491841894825735]], "When executed, mde.ps1 downloaded  from  and removed  from the disk": [["Indicator Removal", 0.11816295667261938], ["Command and Scripting Interpreter", 0.05233900437285024], ["Inhibit System Recovery", 0.04633386233904037], ["Hide Artifacts", 0.041693397374278254], ["OS Credential Dumping", 0.040139534072614835], ["Disk Wipe", 0.03499428328651728]], "send phishing emails with malicious HTML attachments to all addresses in the victim\u2019s mailbox.": [["Phishing", 0.4624579437183171], ["User Execution", 0.20145204744990958], ["Phishing for Information", 0.04888704363632831], ["Internal Spearphishing", 0.034280153119237135], ["Establish Accounts", 0.022748354584688605], ["Compromise Accounts", 0.02004441304817955]], "sending additional phishing emails to the victim\u2019s contacts": [["Phishing", 0.2996054485780759], ["Phishing for Information", 0.12180653252933259], ["Internal Spearphishing", 0.07618189386210003], ["Compromise Accounts", 0.07240119705147832], ["User Execution", 0.06418009553992719], ["Establish Accounts", 0.06237744878630257]], "phishing email": [["Phishing", 0.26372993238131687], ["Phishing for Information", 0.14669254434137427], ["Compromise Accounts", 0.07041724510561148], ["Internal Spearphishing", 0.06638945676195225], ["Establish Accounts", 0.048703486220612914], ["User Execution", 0.040358353365668675]], "starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification": [["Phishing", 0.15336485773425146], ["User Execution", 0.06976862754542444], ["Phishing for Information", 0.06579172731096614], ["Internal Spearphishing", 0.047705328667361935], ["Masquerading", 0.03720687347823172], ["Defacement", 0.03490770010001821]], "disseminate additional phishing emails to the victim\u2019s contacts.": [["Phishing", 0.24785154490300032], ["Phishing for Information", 0.10656463428592686], ["Compromise Accounts", 0.08936911788418203], ["User Execution", 0.07354563208940582], ["Internal Spearphishing", 0.06676561260999903], ["Defacement", 0.06374078171741865]], "constructs an email with a hardcoded subject and body and attaches the HTML file from the \u201cfb\u201d folder.": [["Phishing", 0.18457948861299003], ["Email Collection", 0.07331031338207802], ["User Execution", 0.06436684508778803], ["Office Application Startup", 0.054937641778077397], ["Application Layer Protocol", 0.03348192305244908], ["Phishing for Information", 0.03270325605818663]], "collect the victim\u2019s login credentials for various online accounts": [["Credentials from Password Stores", 0.22342439285408006], ["Unsecured Credentials", 0.14476000281694326], ["OS Credential Dumping", 0.12009783143439107], ["Brute Force", 0.05919305816733057], ["Input Capture", 0.03844191268817514], ["Gather Victim Identity Information", 0.02740723913478935]], "login credentials": [["Valid Accounts", 0.08849701620568921], ["Modify Authentication Process", 0.08552746046995079], ["Credentials from Password Stores", 0.08234556485897422], ["Brute Force", 0.07183780981381456], ["OS Credential Dumping", 0.06833755313743041], ["Unsecured Credentials", 0.06766612251707195]], "targets victim\u2019s login credentials": [["Credentials from Password Stores", 0.11331435110918041], ["Brute Force", 0.10174800807211226], ["OS Credential Dumping", 0.0817313017983196], ["Modify Authentication Process", 0.07717407193723172], ["Input Capture", 0.0765951920650739], ["Unsecured Credentials", 0.07592557501189488]], "credentials": [["Valid Accounts", 0.13539863268957925], ["Gather Victim Identity Information", 0.06588329815298331], ["Brute Force", 0.06098022855478701], ["Exploitation for Credential Access", 0.05195728869452128], ["Unsecured Credentials", 0.05059371537857168], ["Modify Authentication Process", 0.03548346735748234]], "attempt to compromise the victim\u2019s login credentials for webmail services": [["Email Collection", 0.08020486171186661], ["Use Alternate Authentication Material", 0.05991659570934683], ["Phishing for Information", 0.057092100495200464], ["Forge Web Credentials", 0.049145822685741095], ["Internal Spearphishing", 0.04693280795365374], ["Credentials from Password Stores", 0.044011260586978254]], "keystrokes": [["Input Capture", 0.5896945106302834], ["Clipboard Data", 0.02523228782657114], ["Remote Services", 0.018236853051652253], ["Encrypted Channel", 0.015607425737581554], ["Deobfuscate/Decode Files or Information", 0.009901926458842648], ["Credentials from Password Stores", 0.008443698494825309]], "logs keystrokes": [["Input Capture", 0.8836433810299491], ["Clipboard Data", 0.005723298559709922], ["Unsecured Credentials", 0.004905131405467924], ["Credentials from Password Stores", 0.004690076701321905], ["Network Sniffing", 0.00397113591004298], ["Screen Capture", 0.003316795202493859]], "logging keystrokes via polling and application hooks": [["Input Capture", 0.8811161454097999], ["Event Triggered Execution", 0.007804355492881124], ["Native API", 0.00599582449828183], ["Clipboard Data", 0.005344924786815508], ["Virtualization/Sandbox Evasion", 0.004263887123290814], ["Network Sniffing", 0.0035400231451579063]], "logging keystrokes": [["Input Capture", 0.8843908426771165], ["Clipboard Data", 0.006488732294425554], ["Credentials from Password Stores", 0.004190225048448319], ["Unsecured Credentials", 0.004082812236348485], ["Network Sniffing", 0.0031843841199924337], ["Screen Capture", 0.00317261678440079]], "operating system information": [["System Information Discovery", 0.892901768623391], ["Windows Management Instrumentation", 0.011855583408649291], ["Software Discovery", 0.009186602691715343], ["Virtualization/Sandbox Evasion", 0.008697500714474454], ["File and Directory Discovery", 0.0059749613668853545], ["Peripheral Device Discovery", 0.005870399690246876]], "system information,": [["System Information Discovery", 0.7641052504523052], ["Software Discovery", 0.03459059943520625], ["Windows Management Instrumentation", 0.027985991464154713], ["Virtualization/Sandbox Evasion", 0.013353388180513641], ["Peripheral Device Discovery", 0.011263010398366694], ["System Time Discovery", 0.008369131744726827]], "performs surveillance on the victim\u2019s machine by collecting system information such as hostnames, IPv4 address, operating system version, disk volume information, disk size and anti-virus software information, and gets the system\u2019s default language.": [["System Information Discovery", 0.8170139329274116], ["Virtualization/Sandbox Evasion", 0.02140298468570152], ["File and Directory Discovery", 0.013198551447936612], ["System Network Configuration Discovery", 0.012846074832152218], ["Automated Collection", 0.010745120629062096], ["Query Registry", 0.010055708390447922]], "using multiple hosts, including an Amazon Web Services (AWS) Elastic Compute Cloud (EC2) instance, accessed through its public URL, to host the malicious files.": [["Ingress Tool Transfer", 0.11164998235430595], ["Stage Capabilities", 0.07428636416538935], ["Acquire Infrastructure", 0.07266901213031603], ["Web Service", 0.06350404634186003], ["Server Software Component", 0.03283046357094606], ["Drive-by Compromise", 0.026197001131266075]], "requests a data stream from the C2 server through the URL": [["Application Layer Protocol", 0.2844159935742015], ["Exfiltration Over C2 Channel", 0.12015261396189854], ["Data Encoding", 0.07056984251484268], ["Web Service", 0.05985031368244016], ["Fallback Channels", 0.04369830780589956], ["Ingress Tool Transfer", 0.024242024166356405]], "hosted the PowerShell downloader script": [["Ingress Tool Transfer", 0.4564764281212027], ["Command and Scripting Interpreter", 0.2564573201906685], ["BITS Jobs", 0.025103239949151732], ["Web Service", 0.019182166811315685], ["System Binary Proxy Execution", 0.016019581832337433], ["Inter-Process Communication", 0.011954760522295368]], "hosted the ZIP file containing the payloads": [["Archive Collected Data", 0.35334193252445006], ["Obfuscated Files or Information", 0.14846548897563336], ["Deobfuscate/Decode Files or Information", 0.08418849470129479], ["Ingress Tool Transfer", 0.08346398595553425], ["Command and Scripting Interpreter", 0.03379308737822169], ["Automated Collection", 0.016922437493277133]], "downloads a RAR file.": [["Ingress Tool Transfer", 0.1781197942213114], ["Archive Collected Data", 0.07229176959782735], ["Data from Local System", 0.05368350620623494], ["Deobfuscate/Decode Files or Information", 0.04042374817981094], ["Data from Removable Media", 0.03720696542063604], ["Command and Scripting Interpreter", 0.034414994581510684]], "downloads the PowerShell downloader script from an attacker-controlled server": [["Ingress Tool Transfer", 0.5364531190083953], ["Command and Scripting Interpreter", 0.19963532043216373], ["BITS Jobs", 0.018452294981638813], ["Inter-Process Communication", 0.013521493646054348], ["Web Service", 0.013419912676015304], ["System Binary Proxy Execution", 0.01215505949877921]], "download a ZIP file": [["Ingress Tool Transfer", 0.26483366819456133], ["Archive Collected Data", 0.19205200750107035], ["Command and Scripting Interpreter", 0.047818555925782186], ["Deobfuscate/Decode Files or Information", 0.040824162249969126], ["BITS Jobs", 0.028716743998421394], ["Obfuscated Files or Information", 0.024098765690858125]], "downloading": [["Ingress Tool Transfer", 0.4339810328310365], ["BITS Jobs", 0.0735419079894816], ["Application Layer Protocol", 0.0316197798683965], ["Command and Scripting Interpreter", 0.026269869479461846], ["Web Service", 0.017144316748433218], ["Fallback Channels", 0.014907771007179037]], "download the payloads": [["Ingress Tool Transfer", 0.5632040702938327], ["Command and Scripting Interpreter", 0.06976078887248072], ["BITS Jobs", 0.06304560875198018], ["Deobfuscate/Decode Files or Information", 0.017448787916939216], ["Application Layer Protocol", 0.016367931783697273], ["Data from Local System", 0.013007364713484773]], "downloads a malicious ZIP file": [["Ingress Tool Transfer", 0.2979881789913541], ["Archive Collected Data", 0.1555716069064963], ["Command and Scripting Interpreter", 0.045900424142801544], ["Deobfuscate/Decode Files or Information", 0.04200686562866817], ["BITS Jobs", 0.03495407455690259], ["Obfuscated Files or Information", 0.028432841439363365]], "drops the DLL": [["Hijack Execution Flow", 0.23564380707223434], ["System Binary Proxy Execution", 0.11374443258288314], ["Process Injection", 0.0813803245012323], ["Shared Modules", 0.07130188502887462], ["Deobfuscate/Decode Files or Information", 0.03287887065776565], ["Masquerading", 0.032230442493887325]], "download the PowerShell downloader script from the attacker-controlled server": [["Ingress Tool Transfer", 0.5748725345313709], ["Command and Scripting Interpreter", 0.16694361043302336], ["BITS Jobs", 0.018125546973046785], ["System Binary Proxy Execution", 0.013632215628540098], ["Inter-Process Communication", 0.013295760948932318], ["Web Service", 0.012102939737597572]], "download and run the Horabot \u201cau\u201d using the URL": [["Ingress Tool Transfer", 0.12003428946860893], ["Command and Scripting Interpreter", 0.07917342319425245], ["Web Service", 0.042446409030826124], ["System Owner/User Discovery", 0.023588805664206326], ["System Network Configuration Discovery", 0.02353878962014625], ["Application Layer Protocol", 0.02311875375467776]], "downloading files from a URL": [["Ingress Tool Transfer", 0.47946536066331313], ["Application Layer Protocol", 0.05385061164928268], ["Command and Scripting Interpreter", 0.033946051874147856], ["Data from Local System", 0.02276724093355441], ["BITS Jobs", 0.017594412731525993], ["Web Service", 0.017472012905245134]], "downloads the contents of an HTML file stored in an attacker-controlled server": [["Ingress Tool Transfer", 0.28872898311506967], ["Browser Session Hijacking", 0.045356035817265376], ["Command and Scripting Interpreter", 0.04070992527142393], ["Application Layer Protocol", 0.033665680763035985], ["Stage Capabilities", 0.03337062450335556], ["Template Injection", 0.03212073979443621]], "a virtual private server (VPS) behind which the attacker has parked the actual command and control (C2) server": [["Compromise Infrastructure", 0.09352631422479278], ["Acquire Infrastructure", 0.07567265371035302], ["Fallback Channels", 0.06166752705731342], ["Multi-Stage Channels", 0.056982018312642595], ["Proxy", 0.049416433677852645], ["Server Software Component", 0.047199805753283954]], "domain name also resembled the legitimate Mexican Tax Agency domain, a tactic the attacker likely adopted to disguise malicious traffic.": [["Acquire Infrastructure", 0.1971787301061126], ["Compromise Infrastructure", 0.091719361887485], ["Dynamic Resolution", 0.06505892326584382], ["Masquerading", 0.049622931948872954], ["Gather Victim Network Information", 0.03407504652520565], ["Network Denial of Service", 0.02729830354442014]], "is a legitimate AutoIt interpreter.": [["Command and Scripting Interpreter", 0.3630841573321527], ["System Binary Proxy Execution", 0.0751006994113627], ["Native API", 0.04294576367026551], ["Boot or Logon Autostart Execution", 0.041268854356092316], ["Event Triggered Execution", 0.036761343590113134], ["Replication Through Removable Media", 0.03297156803790201]], "uses PowerShell downloader": [["Ingress Tool Transfer", 0.48854479972027565], ["Command and Scripting Interpreter", 0.1338669613658014], ["BITS Jobs", 0.035342300893054734], ["Data from Local System", 0.01747923995465919], ["Lateral Tool Transfer", 0.016155723783969272], ["Web Service", 0.014400568866140393]], "leads to payload delivery through the execution of a PowerShell downloader script": [["Ingress Tool Transfer", 0.4231440685821533], ["Command and Scripting Interpreter", 0.3312421895078385], ["System Binary Proxy Execution", 0.031786364057808526], ["BITS Jobs", 0.03031790465462851], ["Inter-Process Communication", 0.02187805594238215], ["Scheduled Task/Job", 0.010919932413591994]], "RAR file contains a batch file with a CMD extension": [["Command and Scripting Interpreter", 0.3447822644802233], ["System Binary Proxy Execution", 0.10024595850674445], ["Masquerading", 0.052780260810993074], ["Indirect Command Execution", 0.02737857082847275], ["Archive Collected Data", 0.02436999156972368], ["Native API", 0.024236820477406273]], "executes it through the PowerShell commands.": [["Command and Scripting Interpreter", 0.512470212281367], ["System Binary Proxy Execution", 0.10508025775406059], ["System Services", 0.07592628112258609], ["Scheduled Task/Job", 0.0661337036607076], ["Ingress Tool Transfer", 0.016789981632309436], ["Boot or Logon Autostart Execution", 0.015805203222106982]], "downloading and executing two other PowerShell scripts from a different attacker-controlled server.": [["Ingress Tool Transfer", 0.4471548762125437], ["Command and Scripting Interpreter", 0.24195962916615213], ["Multi-Stage Channels", 0.020932242896943776], ["Lateral Tool Transfer", 0.01686584391030604], ["Inter-Process Communication", 0.016136965736843905], ["System Binary Proxy Execution", 0.015444680491323089]], "PowerShell downloader script, which the attacker attempts to execute to re-infect the victim\u2019s machine,": [["Ingress Tool Transfer", 0.4401653927272157], ["Command and Scripting Interpreter", 0.21630016267415555], ["BITS Jobs", 0.03346523590614379], ["Scheduled Task/Job", 0.019008767959524945], ["Inter-Process Communication", 0.01093420242386104], ["Multi-Stage Channels", 0.010682815487518066]], "batch file downloads the PowerShell downloaderThe": [["Command and Scripting Interpreter", 0.36882571171524187], ["Ingress Tool Transfer", 0.20255817787078803], ["Automated Collection", 0.03553081493173159], ["BITS Jobs", 0.0176938494728228], ["Scheduled Task/Job", 0.017396226137300866], ["Data from Local System", 0.0167652570392397]], "a malicious batch file with a .cmd extension is downloaded to the user\u2019s machine.": [["Command and Scripting Interpreter", 0.4163224288355858], ["Ingress Tool Transfer", 0.1975700223480446], ["System Binary Proxy Execution", 0.04968449216776567], ["Scheduled Task/Job", 0.04368674233328738], ["Masquerading", 0.02139644804804306], ["Inter-Process Communication", 0.019534012143511848]], "executes an embedded PowerShell command to download the next-stage PowerShell script from the server and execute it on the victim\u2019s machine.": [["Command and Scripting Interpreter", 0.645451772551209], ["Ingress Tool Transfer", 0.16794849943632534], ["Scheduled Task/Job", 0.01755412587647628], ["System Binary Proxy Execution", 0.017121267074163695], ["Inter-Process Communication", 0.010466233689260054], ["System Services", 0.006822162617567251]], "creates two other malicious batch scripts with the extension .cmd in the folder \u201c/Users/Public.\u201d": [["Command and Scripting Interpreter", 0.355744000204186], ["Scheduled Task/Job", 0.09216027245681131], ["Boot or Logon Autostart Execution", 0.0394893258623191], ["System Binary Proxy Execution", 0.03753974909079363], ["Masquerading", 0.020945242681409168], ["System Services", 0.019383628206915887]], "executes one of the dropped batch files": [["Command and Scripting Interpreter", 0.410769792347724], ["System Binary Proxy Execution", 0.12203136209981745], ["Scheduled Task/Job", 0.06832878381476068], ["System Services", 0.03978581556465279], ["Indirect Command Execution", 0.02331791387433782], ["Masquerading", 0.023171726364694167]], "executes an embedded PowerShell command": [["Command and Scripting Interpreter", 0.8442923553132178], ["System Binary Proxy Execution", 0.018978681093078178], ["Indirect Command Execution", 0.012796980233546173], ["Native API", 0.01124034307812904], ["System Services", 0.011176080843992266], ["Windows Management Instrumentation", 0.00955453818287154]], "executes another dropped batch file,": [["Command and Scripting Interpreter", 0.3675068915886747], ["System Binary Proxy Execution", 0.12288294553154837], ["Scheduled Task/Job", 0.06908100537497189], ["System Services", 0.0416080874423559], ["Native API", 0.02918513401328738], ["Masquerading", 0.024549054871346256]], "executes a PowerShell command": [["Command and Scripting Interpreter", 0.8534883840508013], ["Indirect Command Execution", 0.012343552143765691], ["Windows Management Instrumentation", 0.01212926421445446], ["System Services", 0.011875282929392883], ["Scheduled Task/Job", 0.011497643241855293], ["System Binary Proxy Execution", 0.007805615437841085]], "contains the payload DLLs and a few legitimate executables and DLLs": [["Hijack Execution Flow", 0.1824796170603521], ["Software Discovery", 0.09006649244262784], ["Shared Modules", 0.0734439267915779], ["Native API", 0.058927815996679914], ["System Binary Proxy Execution", 0.05410537291157319], ["File and Directory Discovery", 0.02890205409027562]], "DLL sideloadingThis": [["Hijack Execution Flow", 0.4004063895982076], ["Shared Modules", 0.16357109979736037], ["System Binary Proxy Execution", 0.0895323376739809], ["Process Injection", 0.05044334716298792], ["Masquerading", 0.01691673059561782], ["Ingress Tool Transfer", 0.01673743229407002]], "sideloading to legitimate executables": [["Hijack Execution Flow", 0.3504459677329062], ["System Binary Proxy Execution", 0.11603921369552667], ["Shared Modules", 0.06800432713199049], ["Process Injection", 0.05213405441609723], ["Ingress Tool Transfer", 0.03867450667714923], ["Masquerading", 0.02794425367335741]], "run the payloads by sideloading them to the legitimate executables": [["Hijack Execution Flow", 0.2853698212401625], ["System Binary Proxy Execution", 0.16476985148308962], ["Shared Modules", 0.08538534485382485], ["Process Injection", 0.04975647655890847], ["Ingress Tool Transfer", 0.04252933897780476], ["Command and Scripting Interpreter", 0.037174069307528965]], "sideload a malicious DLL": [["Hijack Execution Flow", 0.4003560282906824], ["Shared Modules", 0.1556247252295062], ["System Binary Proxy Execution", 0.12949090007474004], ["Process Injection", 0.06116140706597825], ["Event Triggered Execution", 0.015381460141282074], ["Masquerading", 0.013810281399836456]], "sideload the DLL": [["Hijack Execution Flow", 0.3655752928404369], ["Shared Modules", 0.19192962955791712], ["System Binary Proxy Execution", 0.11565028853822992], ["Process Injection", 0.05391255430715079], ["Native API", 0.018013605445286067], ["Ingress Tool Transfer", 0.01653874007269248]], "sideloads the DLL to the AutoIt interpreter process": [["Hijack Execution Flow", 0.3501295111512233], ["Shared Modules", 0.1678876809101651], ["System Binary Proxy Execution", 0.13784840466120782], ["Process Injection", 0.058471136954982725], ["Boot or Logon Autostart Execution", 0.027499946745874332], ["Event Triggered Execution", 0.02609556649689188]], "enticing users to open the attached malicious HTML file": [["User Execution", 0.8707064189167746], ["Phishing", 0.02960818037487383], ["Template Injection", 0.012432429819774028], ["Stage Capabilities", 0.008425688307135165], ["Drive-by Compromise", 0.006456722573149277], ["Browser Session Hijacking", 0.004961638340773239]], "lures them to click an embedded malicious hyperlink which": [["User Execution", 0.8313386914358686], ["Phishing", 0.03586495274757996], ["Stage Capabilities", 0.016596624583580195], ["Drive-by Compromise", 0.01499483275416856], ["Phishing for Information", 0.014843186732165576], ["Internal Spearphishing", 0.007865030882751726]], "executed when the victim opens the contents of the file": [["User Execution", 0.10822742208487196], ["Native API", 0.08650649083365021], ["File and Directory Discovery", 0.07478972684692153], ["Deobfuscate/Decode Files or Information", 0.056768425822346674], ["Command and Scripting Interpreter", 0.04149572002291734], ["XSL Script Processing", 0.039003057324570295]], "user opens the CMD file,": [["Command and Scripting Interpreter", 0.4113883735202038], ["Indirect Command Execution", 0.05563336417316111], ["Boot or Logon Autostart Execution", 0.05514028991079587], ["Native API", 0.050010395984576746], ["System Binary Proxy Execution", 0.037153126858657536], ["Event Triggered Execution", 0.03339126814376345]], "an embedded URL is launched in the victim\u2019s browser,": [["User Execution", 0.13586296447120144], ["Stage Capabilities", 0.10408513059222688], ["Browser Session Hijacking", 0.09308741607235242], ["Drive-by Compromise", 0.05094382214551876], ["Server Software Component", 0.04436587993823832], ["Browser Extensions", 0.03271115402622466]], "has an embedded malicious URL": [["User Execution", 0.10787111131792461], ["Stage Capabilities", 0.09556013498243553], ["Drive-by Compromise", 0.06959381780647389], ["Phishing", 0.05354818446359539], ["Browser Session Hijacking", 0.037208246865191606], ["Dynamic Resolution", 0.03607720461460827]], "redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance.": [["User Execution", 0.09728465723913833], ["Stage Capabilities", 0.0765132726241928], ["Browser Session Hijacking", 0.07295844171160232], ["Server Software Component", 0.06842561359466447], ["Template Injection", 0.06132562304630068], ["Drive-by Compromise", 0.04680236158691985]], "configured to run the payloads in the startup folder of the victim\u2019s machine": [["Boot or Logon Autostart Execution", 0.26429997412874384], ["Boot or Logon Initialization Scripts", 0.19995220886484213], ["Create or Modify System Process", 0.10922989157391748], ["Event Triggered Execution", 0.04101195102894671], ["Scheduled Task/Job", 0.03625733128998398], ["Hijack Execution Flow", 0.034085057251570634]], "creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.": [["Boot or Logon Autostart Execution", 0.7140787526636422], ["Command and Scripting Interpreter", 0.029155818944006595], ["Boot or Logon Initialization Scripts", 0.024728849042922694], ["Masquerading", 0.02366706995939366], ["Office Application Startup", 0.02294150622877359], ["Event Triggered Execution", 0.021763762536359758]], "creates three more Windows shortcut files in the victim\u2019s machine startup folder,": [["Boot or Logon Autostart Execution", 0.8049406792072284], ["Boot or Logon Initialization Scripts", 0.03687924052912035], ["Event Triggered Execution", 0.01526812137196978], ["Masquerading", 0.012376510093628411], ["Modify Registry", 0.010524078752425952], ["Create or Modify System Process", 0.010375046104483211]], "files dropped in the Windows startup folder are run": [["Boot or Logon Autostart Execution", 0.21223610046933694], ["Indicator Removal", 0.08041689442795426], ["Boot or Logon Initialization Scripts", 0.07379395274161667], ["Create or Modify System Process", 0.05366047585697925], ["Masquerading", 0.05086307014245912], ["Hide Artifacts", 0.033517577859421596]], "launches several processes": [["Native API", 0.2124916896615633], ["Process Discovery", 0.11249210000557605], ["System Services", 0.10513367991312939], ["Process Injection", 0.07119168292064346], ["Access Token Manipulation", 0.04855962263691648], ["Create or Modify System Process", 0.04575779380027727]], "heavily obfuscated with random symbols that substitute the instructions during the run-time and base64-encoded strings.": [["Obfuscated Files or Information", 0.7695042940259034], ["Deobfuscate/Decode Files or Information", 0.07649837393296932], ["Data Encoding", 0.03128609560821689], ["Archive Collected Data", 0.014220805707337091], ["Data Obfuscation", 0.012907811492773032], ["Encrypted Channel", 0.007790943770764313]], "uses alphanumeric characters and the special character \u201c_\u201d to generate a random name and creates a folder with the random name in the root directory of the victim\u2019s machine.": [["Masquerading", 0.23476821125776143], ["Obfuscated Files or Information", 0.08341212066647136], ["Data Staged", 0.058273037155271254], ["Hide Artifacts", 0.03385760438860033], ["Dynamic Resolution", 0.0327534220711408], ["File and Directory Discovery", 0.02718239707679009]], "executes the compiled AutoIt script": [["System Binary Proxy Execution", 0.12559973601064825], ["Boot or Logon Autostart Execution", 0.0963073688223621], ["Command and Scripting Interpreter", 0.09586842288229014], ["Event Triggered Execution", 0.06767454121308288], ["Create or Modify System Process", 0.049806023123492194], ["Hijack Execution Flow", 0.0479840734599216]], "evade detection": [["Data Obfuscation", 0.10370032683654856], ["Masquerading", 0.09534044347103762], ["Hide Artifacts", 0.09074107258070786], ["Unused/Unsupported Cloud Regions", 0.08209259917025218], ["Obfuscated Files or Information", 0.07540176768883551], ["Execution Guardrails", 0.040900727979441415]], "encodes the email addresses in the \u201c.Outlook\u201d file to a data stream": [["Email Collection", 0.1975656362353191], ["Account Discovery", 0.08516562483309544], ["Exfiltration Over Alternative Protocol", 0.044273028728477264], ["Archive Collected Data", 0.03834155609997719], ["Automated Collection", 0.0357737259623116], ["Gather Victim Identity Information", 0.032512957902699174]], "decodes the base64-encoded strings and initializes them": [["Deobfuscate/Decode Files or Information", 0.4510125112323244], ["Obfuscated Files or Information", 0.22808579444780677], ["Data Encoding", 0.18336509925537994], ["Data Obfuscation", 0.017563920760346817], ["Archive Collected Data", 0.015155544163121887], ["Encrypted Channel", 0.012248429982801226]], "decrypts the encrypted": [["Deobfuscate/Decode Files or Information", 0.5594931008809754], ["Data Encrypted for Impact", 0.10872953767192757], ["Archive Collected Data", 0.05361242593706428], ["Obfuscated Files or Information", 0.04861483832027163], ["Encrypted Channel", 0.041910894900680395], ["Weaken Encryption", 0.03753006247239837]], "decryption function decrypts the URL pointing to the attacker-controlled server": [["Deobfuscate/Decode Files or Information", 0.28728380487968513], ["Encrypted Channel", 0.1011087251820483], ["Data Encoding", 0.09460038932299816], ["Obfuscated Files or Information", 0.05653352995520071], ["Exfiltration Over Alternative Protocol", 0.04413621648854764], ["Archive Collected Data", 0.04073751267510874]], "the malicious ZIP file is deleted.": [["Archive Collected Data", 0.2656312916591791], ["Indicator Removal", 0.1696654081787094], ["Deobfuscate/Decode Files or Information", 0.07057797330750128], ["Obfuscated Files or Information", 0.041908701881110975], ["Data Destruction", 0.0314776571023593], ["Masquerading", 0.02036418040592488]], "deleting the \u201cfb\u201d folder to cover its paths and avoid detection": [["Indicator Removal", 0.34773421108005376], ["Data Destruction", 0.059530930180494254], ["Hide Artifacts", 0.04085026112596811], ["Data Staged", 0.037548073006584685], ["Modify Cloud Compute Infrastructure", 0.01854399839921943], ["Masquerading", 0.018135523331124895]], "writes the path of the executable file, \u201c_upyqta2_Ji7.exe\u201d, to the class\u2019s registry key \u201cHKEY_CURRENT_USER\\software\\Classes\\ms-settings\\shell\\open\\command\u201d": [["Boot or Logon Autostart Execution", 0.31984804056437444], ["Hijack Execution Flow", 0.12734857927445453], ["Modify Registry", 0.0886452917502248], ["System Binary Proxy Execution", 0.07607568986288597], ["Query Registry", 0.0647699138552459], ["Masquerading", 0.052446263960437056]], "screenshot capturing": [["Screen Capture", 0.8516365689422377], ["Video Capture", 0.024256482386080816], ["Application Window Discovery", 0.014033580370837292], ["Input Capture", 0.0076910589130117744], ["Clipboard Data", 0.006491881223323715], ["Data from Local System", 0.004076057290692313]], "capturing screenshots,": [["Screen Capture", 0.8722943971067871], ["Video Capture", 0.02334864105899071], ["Application Window Discovery", 0.009114825530356023], ["Input Capture", 0.007959390955097527], ["Clipboard Data", 0.004877090438006311], ["Data from Local System", 0.0035589533682523137]], "capturing screenshots": [["Screen Capture", 0.8715887872744611], ["Video Capture", 0.02208223461338063], ["Application Window Discovery", 0.009680186527676654], ["Input Capture", 0.007714816871318067], ["Clipboard Data", 0.005181855709281786], ["Data from Local System", 0.003773177233024374]], "anti-virus software information": [["Software Discovery", 0.7820610627020869], ["Obtain Capabilities", 0.027315919472697597], ["Develop Capabilities", 0.017408947214681527], ["Obfuscated Files or Information", 0.016177239819818397], ["Supply Chain Compromise", 0.0076384099002587596], ["Windows Management Instrumentation", 0.007578022224068648]], "Checks for the existence of the anti-virus products such as AVG and Avast by checking for the DLLs avghookx.dll, avghooka.dll and snxhk.dll": [["Software Discovery", 0.658628226529651], ["Hijack Execution Flow", 0.0213570653802164], ["Windows Management Instrumentation", 0.020768286885446113], ["Obfuscated Files or Information", 0.020480347133152742], ["Query Registry", 0.016182222842085366], ["Virtualization/Sandbox Evasion", 0.015941163273063833]], "exfiltrated to the attacker-controlled server through an HTTP POST request to the URL": [["Exfiltration Over C2 Channel", 0.23573650381023264], ["Exfiltration Over Alternative Protocol", 0.2005678622766605], ["Application Layer Protocol", 0.04964408506173783], ["Archive Collected Data", 0.03812454805643651], ["Ingress Tool Transfer", 0.036256467643317025], ["Data Encoding", 0.0350275078324977]], "exfiltrates the email address to the C2 server using an HTTP POST request": [["Exfiltration Over C2 Channel", 0.20369406178303884], ["Email Collection", 0.13339012977979145], ["Exfiltration Over Alternative Protocol", 0.0786220494886544], ["Web Service", 0.06051150603861503], ["Application Layer Protocol", 0.04336541573749642], ["Scheduled Transfer", 0.024997881299677838]], "exfiltrate contacts\u2019 email addresses": [["Email Collection", 0.10997823351322636], ["Account Discovery", 0.07104286565682315], ["Establish Accounts", 0.04636355400404757], ["Exfiltration Over C2 Channel", 0.04608371169691984], ["Exfiltration Over Alternative Protocol", 0.04409225863679218], ["Gather Victim Identity Information", 0.035586016284619985]], "encoded email addresses are exfiltrated": [["Exfiltration Over Alternative Protocol", 0.13690123763322448], ["Email Collection", 0.10006931137420698], ["Archive Collected Data", 0.07524314164250634], ["Data Encoding", 0.0505459313675476], ["Exfiltration Over C2 Channel", 0.04800294845992808], ["Deobfuscate/Decode Files or Information", 0.036715926171637533]], "checking if a file on the victim\u2019s filesystem exists and gets the file\u2019s attributes, collecting size and version information,": [["File and Directory Discovery", 0.5771078421482991], ["System Information Discovery", 0.11312187709727621], ["Data from Local System", 0.026572983746521076], ["Automated Collection", 0.022579139555943532], ["Virtualization/Sandbox Evasion", 0.021874570260486458], ["Obfuscated Files or Information", 0.014292487248334233]], "looks for the Outlook data files from the victim profile\u2019s Outlook application data folder.": [["Email Collection", 0.37301894583115836], ["File and Directory Discovery", 0.06310634594541914], ["Data Staged", 0.04393193737609197], ["Data from Local System", 0.035327284759873574], ["Account Discovery", 0.03407144127135713], ["Automated Collection", 0.0319277905190903]], "enumerates all folders and emails in the victim\u2019s Outlook data file": [["File and Directory Discovery", 0.24523444938048963], ["Email Collection", 0.2352987169941798], ["Data from Local System", 0.05709615910998291], ["Automated Collection", 0.05562685233727105], ["Data Staged", 0.0469396203963458], ["Account Discovery", 0.030850194103458153]], "collect login data from the Google Chrome user profile folders": [["Browser Bookmark Discovery", 0.1779807925009824], ["Credentials from Password Stores", 0.11921228923479935], ["Data from Local System", 0.06274713043977642], ["System Owner/User Discovery", 0.05750359484219679], ["OS Credential Dumping", 0.033863148105145374], ["Data Staged", 0.03359622084521002]], "extracts email addresses from the emails\u2019 sender, recipients, CC and BCC fields.": [["Account Discovery", 0.37532603779646767], ["Email Collection", 0.11680909354736371], ["Gather Victim Identity Information", 0.09761416745377126], ["System Owner/User Discovery", 0.030871097098892426], ["Establish Accounts", 0.01900278811335539], ["Compromise Accounts", 0.015534001982011367]], "creating SQL queries to produce the database tables to store the stolen data": [["Data Staged", 0.2985426855194889], ["Data from Information Repositories", 0.0705223248503743], ["Data from Local System", 0.0685892255774783], ["Automated Collection", 0.050754602932855296], ["Archive Collected Data", 0.037155964107321617], ["Automated Exfiltration", 0.03217585890581227]], "added to the email address collection array.": [["Establish Accounts", 0.1617165803577014], ["Account Discovery", 0.12848600138264016], ["Email Collection", 0.08626828182612392], ["Account Manipulation", 0.0768112847928235], ["Compromise Accounts", 0.07541868851826299], ["Gather Victim Identity Information", 0.07090871277941867]], "writes the extracted email addresses from the array to a file called \u201c.Outlook\u201d created by the script in the roaming user profile\u2019s Microsoft application data folder.": [["Account Discovery", 0.3751397102524083], ["Email Collection", 0.12378095984701501], ["Gather Victim Identity Information", 0.038026127157688265], ["Automated Collection", 0.02892436379751085], ["Data Staged", 0.02473088483605956], ["Establish Accounts", 0.021546227803388152]], "Checks the registry keys to detect virtual environments such as VMWare, Virtual Box, Wine, Microsoft Hyper-V or Windows Virtual PC.": [["Virtualization/Sandbox Evasion", 0.37892612998423225], ["Hide Artifacts", 0.08067502587799459], ["System Information Discovery", 0.05212309639285136], ["Query Registry", 0.03891892564636507], ["Windows Management Instrumentation", 0.0378785541425869], ["Software Discovery", 0.03728121236332745]], "the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.": [["Windows Management Instrumentation", 0.588174813409718], ["Event Triggered Execution", 0.05839741725194516], ["Command and Scripting Interpreter", 0.04007435083575745], ["Remote Services", 0.024415413889906683], ["System Binary Proxy Execution", 0.022619035005862615], ["System Services", 0.015100305947608396]], "examples of the command line syntax used for the performance of this activity": [["Command and Scripting Interpreter", 0.5272358894479898], ["Automated Collection", 0.038367649789917156], ["Virtualization/Sandbox Evasion", 0.02084730723168461], ["Indirect Command Execution", 0.020627452372700354], ["Native API", 0.020272849385944272], ["Indicator Removal", 0.01581041941699382]], "adversary using Windows Batch files": [["Command and Scripting Interpreter", 0.49218762838418145], ["Scheduled Task/Job", 0.06067812493987283], ["System Binary Proxy Execution", 0.05585511227787537], ["Masquerading", 0.031610404959003795], ["Windows Management Instrumentation", 0.024878554945583834], ["Inter-Process Communication", 0.018372811268901033]], "performed via the following command-line syntax": [["Command and Scripting Interpreter", 0.4443502990686797], ["Indicator Removal", 0.029815500538392818], ["Automated Collection", 0.022943199211165197], ["Virtualization/Sandbox Evasion", 0.020792787437428878], ["Indirect Command Execution", 0.01991685587892231], ["OS Credential Dumping", 0.019335870968421175]], "the command-line syntax used": [["Command and Scripting Interpreter", 0.45947662664464095], ["Indirect Command Execution", 0.04177403440118284], ["Native API", 0.04153060665211648], ["Virtualization/Sandbox Evasion", 0.022404086498077753], ["Obfuscated Files or Information", 0.0185420284459728], ["File and Directory Discovery", 0.018350785821173186]], "command-line syntax was observed being used": [["Command and Scripting Interpreter", 0.40989720057947227], ["Indirect Command Execution", 0.08066349504584644], ["Native API", 0.05061573504502002], ["Virtualization/Sandbox Evasion", 0.03727930065690233], ["XSL Script Processing", 0.0181736255644702], ["Obfuscated Files or Information", 0.01421929185500693]], "the Windows Command Processor was used": [["Native API", 0.1461695710936352], ["System Information Discovery", 0.11786849580183854], ["Windows Management Instrumentation", 0.08853498133814974], ["Virtualization/Sandbox Evasion", 0.08600670696634709], ["Process Discovery", 0.05799036845790912], ["Command and Scripting Interpreter", 0.047614138868452616]], "attacker also used the \"proxychains\" utility, which is often employed to redirect network traffic": [["Proxy", 0.48670979428284883], ["Adversary-in-the-Middle", 0.05339163733384153], ["Data Obfuscation", 0.038697724390147174], ["Network Denial of Service", 0.03772489897238233], ["Application Layer Protocol", 0.03417715242152045], ["Protocol Tunneling", 0.02654108333996455]], "use of utilities such as proxychains": [["Proxy", 0.589615409710313], ["Fallback Channels", 0.02772772843507617], ["Application Layer Protocol", 0.027454136081385905], ["Data Obfuscation", 0.02011842838152126], ["Protocol Tunneling", 0.018777816550530384], ["Adversary-in-the-Middle", 0.01839791589182393]], "adversary leveraging a Windows Service to execute PowerShell to stay persistent in the environment.": [["Create or Modify System Process", 0.37278220064971784], ["System Services", 0.1887420297356892], ["Scheduled Task/Job", 0.0726156143495056], ["Command and Scripting Interpreter", 0.04043076881428374], ["Event Triggered Execution", 0.04033889894408813], ["Masquerading", 0.03357660768516345]], "The Windows service was configured with the following options:Service Type: user mode service Service Start Type": [["Create or Modify System Process", 0.4026566606153548], ["System Services", 0.1388517698519976], ["System Service Discovery", 0.13129633927957277], ["Masquerading", 0.055563140869130265], ["Service Stop", 0.028296553480942736], ["Hijack Execution Flow", 0.0257168243115058]], "the PowerShell being executed was Base64 encoded": [["Obfuscated Files or Information", 0.2886961910512533], ["Deobfuscate/Decode Files or Information", 0.23754609932049367], ["Data Encoding", 0.12997685291000652], ["Command and Scripting Interpreter", 0.07713900921862464], ["Native API", 0.018200590168163097], ["Data Obfuscation", 0.012766202771232618]], "The decoded PowerShell instructions": [["Command and Scripting Interpreter", 0.3188215288002911], ["Deobfuscate/Decode Files or Information", 0.16907144199703952], ["Obfuscated Files or Information", 0.13643363874148876], ["Native API", 0.02367001556502022], ["System Binary Proxy Execution", 0.01838287592578066], ["OS Credential Dumping", 0.0162648026156263]], "decrypting,": [["Deobfuscate/Decode Files or Information", 0.5617669711495056], ["Data Encrypted for Impact", 0.11400008055280439], ["Archive Collected Data", 0.05918438860890257], ["Weaken Encryption", 0.03772445366124295], ["Obfuscated Files or Information", 0.035635205371236274], ["Encrypted Channel", 0.025391590682394067]], "Disabling PowerShell logging": [["Impair Defenses", 0.6348972474475572], ["Indicator Removal", 0.10297691319956179], ["Data Staged", 0.018463010337737503], ["Modify Registry", 0.016548288908803888], ["Account Access Removal", 0.0087483875741016], ["Virtualization/Sandbox Evasion", 0.008619869200995113]], "Disabling this security control": [["Impair Defenses", 0.253752658658452], ["File and Directory Permissions Modification", 0.10152276150096709], ["Subvert Trust Controls", 0.07359285085440154], ["Modify Registry", 0.05921674797450566], ["Domain Policy Modification", 0.05741106394425533], ["Abuse Elevation Control Mechanism", 0.05255968095808991]], "to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities": [["Abuse Elevation Control Mechanism", 0.19653537457747008], ["Domain Policy Modification", 0.09211348105515792], ["File and Directory Permissions Modification", 0.08189524404537682], ["Exploitation for Privilege Escalation", 0.06342863300262082], ["Valid Accounts", 0.05871823740899863], ["Account Manipulation", 0.03683810682290623]], "attacker disabling Windows Defender": [["Impair Defenses", 0.4740639473770857], ["Software Discovery", 0.029821923189078284], ["Domain Policy Modification", 0.02849755517106344], ["Subvert Trust Controls", 0.025635151697691545], ["Modify System Image", 0.021833419580881433], ["Modify Registry", 0.017323292582973757]], "Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server": [["Deobfuscate/Decode Files or Information", 0.3919533615159064], ["Obfuscated Files or Information", 0.10010833835787138], ["Ingress Tool Transfer", 0.07862562392593642], ["Command and Scripting Interpreter", 0.03388080947726458], ["Archive Collected Data", 0.024416849168859667], ["Exfiltration Over Alternative Protocol", 0.022342032906366518]], "the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.": [["Remote Services", 0.49355719683029897], ["Remote Service Session Hijacking", 0.11596857206733241], ["Remote Access Software", 0.08627221054886837], ["Exploitation of Remote Services", 0.055021109716423815], ["Valid Accounts", 0.018289569772132905], ["External Remote Services", 0.014364615862194799]], "attacker also attempted to execute PowerShell scripts on remote systems in the environment while moving system-to-system": [["Remote Services", 0.21549485718545328], ["Remote Service Session Hijacking", 0.07634910160806849], ["Exploitation of Remote Services", 0.07102195534327654], ["Windows Management Instrumentation", 0.05901935846619121], ["Command and Scripting Interpreter", 0.05442310736337005], ["Valid Accounts", 0.053631235733823196]], "adversaries copied and executed the aforementioned PowerShell script on multiple systems across the environment": [["Command and Scripting Interpreter", 0.17384534288245332], ["System Services", 0.06796109575542167], ["Remote Services", 0.06311271494144076], ["Windows Management Instrumentation", 0.06250700890162422], ["Scheduled Task/Job", 0.0581868928367875], ["Lateral Tool Transfer", 0.05684357224669612]], "Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data": [["OS Credential Dumping", 0.30803120801883344], ["Query Registry", 0.0404239239517005], ["Automated Collection", 0.03627624654065386], ["Permission Groups Discovery", 0.027645619542137165], ["System Service Discovery", 0.02590760171298662], ["Windows Management Instrumentation", 0.022076218124886665]], "invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process": [["Process Injection", 0.36590365118740203], ["Process Discovery", 0.14154296630151325], ["Native API", 0.10147080998951784], ["OS Credential Dumping", 0.03658546594133895], ["System Binary Proxy Execution", 0.030859857079685676], ["Hijack Execution Flow", 0.02222379622208869]], "utilizing comsvcs.dll": [["System Binary Proxy Execution", 0.2413404190127149], ["Hijack Execution Flow", 0.20789492576812102], ["Shared Modules", 0.09718144458687879], ["Process Injection", 0.07757914148032424], ["Native API", 0.04043438705239395], ["Deobfuscate/Decode Files or Information", 0.02798256331035016]], "invoking comsvcs.dll with rundll32.exe,": [["System Binary Proxy Execution", 0.4477203994613043], ["Hijack Execution Flow", 0.171835645391615], ["Process Injection", 0.06443686971077245], ["Native API", 0.05738480571566827], ["Shared Modules", 0.04477058735550502], ["System Services", 0.03412469326312729]], "adversary was also observed remotely modifying the Windows Registry on remote systems": [["Modify Registry", 0.2799727894263466], ["Query Registry", 0.16585840548440237], ["Domain Policy Modification", 0.04705196112340388], ["Boot or Logon Autostart Execution", 0.04435445989444476], ["Windows Management Instrumentation", 0.03393643574461601], ["Indicator Removal", 0.029862959000965025]], "by modifying the Windows Registry on compromised systems.": [["Modify Registry", 0.199461972455128], ["Boot or Logon Autostart Execution", 0.17760829700617844], ["Masquerading", 0.04962323568069334], ["Query Registry", 0.03412310109618786], ["Event Triggered Execution", 0.029733868354400245], ["Modify System Image", 0.02545559361095167]], "the adversary attempting to exfiltrate sensitive information over SMB (TCP/445) directly from a compromised domain controller.": [["Exfiltration Over Alternative Protocol", 0.3112920815925275], ["Exfiltration Over C2 Channel", 0.11865369865708543], ["Automated Exfiltration", 0.027292631806108986], ["Lateral Tool Transfer", 0.02373370473518531], ["Scheduled Transfer", 0.019546092267540623], ["Archive Collected Data", 0.019372715257461526]], "threat actor is actively exploiting the so-called PrintNightmare vulnerability (CVE-2021-1675 / CVE-2021-34527) in Windows' print spooler service to spread laterally across a victim's network": [["Exploitation of Remote Services", 0.4547923439353699], ["Exploitation for Client Execution", 0.03684093939559248], ["Remote System Discovery", 0.03186772408289757], ["Remote Services", 0.027333594993541193], ["Software Deployment Tools", 0.025133364101462094], ["Lateral Tool Transfer", 0.022323719074687845]], "Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver\nweb shells": [["Exploitation for Client Execution", 0.2242374375477591], ["Exploit Public-Facing Application", 0.18429410362783885], ["Server Software Component", 0.13559839729833895], ["Stage Capabilities", 0.03187205326156311], ["Drive-by Compromise", 0.026160687156768545], ["Phishing", 0.02110091355913156]], "exploited the Microsoft SharePoint vulnerability\nCVE-2019-0604 to install web shells": [["Server Software Component", 0.24868560506443063], ["Exploitation for Client Execution", 0.11138436339233194], ["Exploit Public-Facing Application", 0.10078055646616917], ["Drive-by Compromise", 0.04482041996321447], ["Stage Capabilities", 0.043310555440195075], ["Browser Extensions", 0.02871254166091131]], "running native Windows commands on compromised servers,": [["Command and Scripting Interpreter", 0.6281284979960143], ["Remote Services", 0.05149217685179022], ["Windows Management Instrumentation", 0.03510971710885735], ["Ingress Tool Transfer", 0.01828921726904528], ["System Services", 0.01793373374340852], ["System Binary Proxy Execution", 0.015858889725262514]], "The operators made a consistent effort to\ndelete these tools and remove any residual forensic artifacts from\ncompromised systems.": [["Indicator Removal", 0.7208549363478393], ["Inhibit System Recovery", 0.03798076746932827], ["Data Destruction", 0.028000136390060056], ["Impair Defenses", 0.025564940579683938], ["Modify Registry", 0.010155322060539554], ["Service Stop", 0.00873942934837069]], "consistently cleaned up evidence of their intrusion after\ngaining access to a system": [["Indicator Removal", 0.56988987465059], ["Data Destruction", 0.047996138076504165], ["Inhibit System Recovery", 0.03651616784108427], ["Modify Cloud Compute Infrastructure", 0.030363314615796597], ["Impair Defenses", 0.027747802369720385], ["Disk Wipe", 0.0192533072205259]], "moved laterally and\ndeployed their signature malware": [["Subvert Trust Controls", 0.11791164943817024], ["Masquerading", 0.097545776536171], ["Compromise Client Software Binary", 0.03608467012828192], ["Stage Capabilities", 0.034101810143105454], ["Develop Capabilities", 0.027140600348478688], ["Obtain Capabilities", 0.02616620366468739]], "used this\naccess to deploy and remotely execute FOCUSFJORD on their primary target.": [["Remote Services", 0.03798238474404638], ["Stage Capabilities", 0.036218218027624746], ["Remote Access Software", 0.035029768397525314], ["Command and Scripting Interpreter", 0.03481752593967221], ["Exploitation of Remote Services", 0.026757285458824734], ["Software Deployment Tools", 0.021526365445948572]], "The operators deleted tools used for credential harvesting and\ninternal reconnaissance": [["Indicator Removal", 0.07582415220474656], ["OS Credential Dumping", 0.05825103744347018], ["Impair Defenses", 0.05156002033109626], ["Account Access Removal", 0.05000190160449751], ["Unsecured Credentials", 0.03402042369752773], ["Credentials from Password Stores", 0.033347572016902194]], "to delete any remaining FOCUSFJORD\nforensic evidence, including files on disk, configuration data\nencrypted in the registry, and related services and registry keys\nused for persistence.": [["Indicator Removal", 0.5757172036549946], ["Inhibit System Recovery", 0.08537317415550191], ["Data Destruction", 0.0815637121343939], ["Disk Wipe", 0.0473931549963058], ["Modify Registry", 0.021529572463153065], ["System Shutdown/Reboot", 0.016627941328960002]], "writes its encrypted C2\nconfiguration into the system\u2019s registry": [["Modify Registry", 0.4909748722937278], ["Deobfuscate/Decode Files or Information", 0.07015909574056957], ["Obfuscated Files or Information", 0.054244588564203625], ["Query Registry", 0.038499187049250934], ["Encrypted Channel", 0.02462382862867376], ["Unsecured Credentials", 0.022577634901708672]], "writes its configuration to registry,\nthis value is set to \u201cdefault\u201d and is later manually changed by the\nactor": [["Modify Registry", 0.5165592668024442], ["Boot or Logon Autostart Execution", 0.09083555973027088], ["Query Registry", 0.07164521078502818], ["Boot or Logon Initialization Scripts", 0.03187815939439591], ["Create or Modify System Process", 0.027215137403952074], ["Office Application Startup", 0.026349783997308623]], "the\noperators were able to access their primary target via RDP connections": [["Remote Services", 0.4430451958958206], ["Remote Access Software", 0.08294519034782954], ["External Remote Services", 0.0597435829401517], ["Remote Service Session Hijacking", 0.05448153655369684], ["Exploitation of Remote Services", 0.04146850094838082], ["Valid Accounts", 0.03292834498637658]], "operators were able to access their primary target via RDP connections\nfrom a trusted third party using stolen credentials": [["Valid Accounts", 0.32964613570890544], ["Remote Services", 0.15207979463452337], ["External Remote Services", 0.07761137037413679], ["Brute Force", 0.046964885204367694], ["Steal Application Access Token", 0.0200675182195621], ["Account Manipulation", 0.01949277112646697]], "configured to proxy C2 traffic": [["Proxy", 0.5263013756043684], ["Application Layer Protocol", 0.08990337957182326], ["Non-Application Layer Protocol", 0.04700092913018063], ["Data Obfuscation", 0.03935022297749075], ["Protocol Tunneling", 0.03628507058561901], ["Fallback Channels", 0.02992653523805984]], "used other victim networks to proxy their C2\ninstructions, likely to minimize the risk of detection and blend in\nwith normal network traffic.": [["Proxy", 0.2883292878037721], ["Application Layer Protocol", 0.13979781625963256], ["Data Obfuscation", 0.07116242068915506], ["Fallback Channels", 0.06507870500675686], ["Non-Application Layer Protocol", 0.05620799190890673], ["Encrypted Channel", 0.04026992385963074]], "acting as proxies to relay\ncommunications to their C2 servers.": [["Proxy", 0.46088078229682417], ["Application Layer Protocol", 0.08603992590259961], ["Compromise Infrastructure", 0.046306399955661715], ["Fallback Channels", 0.0433262678360606], ["Acquire Infrastructure", 0.02741168257232518], ["Protocol Tunneling", 0.027028298971969355]], "usually to the victim\u2019s domain name": [["Compromise Infrastructure", 0.1769418260837631], ["Acquire Infrastructure", 0.15728611316701024], ["Gather Victim Network Information", 0.060970918797324344], ["Dynamic Resolution", 0.042644517218358546], ["Web Service", 0.03664395343885654], ["Stage Capabilities", 0.02975204326940355]], "to read\nand decrypt those registry key values for proper execution.": [["Modify Registry", 0.4460867121704018], ["Query Registry", 0.24542928314524312], ["Boot or Logon Autostart Execution", 0.038289611026215975], ["Deobfuscate/Decode Files or Information", 0.03592972491227104], ["OS Credential Dumping", 0.019014234296145637], ["Unsecured Credentials", 0.01805924503666189]], "the malware needs to read\nand decrypt those registry key values": [["Modify Registry", 0.5248908259233627], ["Query Registry", 0.18884136850712457], ["Boot or Logon Autostart Execution", 0.03510364970297338], ["Deobfuscate/Decode Files or Information", 0.028694420368251164], ["System Binary Proxy Execution", 0.01869278704556122], ["Unsecured Credentials", 0.01647414216711901]], "to obfuscate the source of the\nactivity.": [["Obfuscated Files or Information", 0.23698646189188688], ["Data Obfuscation", 0.09548503542079399], ["Masquerading", 0.06318709306303157], ["Hide Artifacts", 0.0480482052145035], ["Impair Defenses", 0.03847222630588316], ["Data Encoding", 0.0306918683859625]], "a tool called \u201canti.exe\u201d\nto stop Windows Update service and terminate EDR and Antivirus\nrelated services.": [["Service Stop", 0.288803363448538], ["Impair Defenses", 0.20669827069196559], ["Masquerading", 0.06607314337627129], ["Indicator Removal", 0.0334847393654064], ["System Shutdown/Reboot", 0.03345007661056517], ["Create or Modify System Process", 0.016674505563772344]], "leverages\u00a0spear-phishing\u00a0and tries to trick the victims into opening malicious documents": [["User Execution", 0.648699826262727], ["Phishing", 0.18150728431133925], ["Internal Spearphishing", 0.020531375087124694], ["Phishing for Information", 0.019545587744719605], ["Template Injection", 0.01844045097392162], ["Drive-by Compromise", 0.012467489141570552]], "They used multiple malicious\u00a0PDFs\u00a0and\u00a0MS Office documents\u00a0during the campaign.": [["Phishing", 0.23494619598066055], ["User Execution", 0.11868774910599639], ["Template Injection", 0.059487416479577865], ["Drive-by Compromise", 0.03965264669385269], ["Defacement", 0.031960080031390684], ["Data Manipulation", 0.031196296393075144]], "they use tools such as\u00a0Mimikatz\u00a0to dump credentials.": [["OS Credential Dumping", 0.3104522038219177], ["Credentials from Password Stores", 0.25419232210300025], ["Unsecured Credentials", 0.20526435121611325], ["Input Capture", 0.025981682817167548], ["Brute Force", 0.018509179147294243], ["Network Sniffing", 0.014377134364878615]], "and remote monitoring software such as\u00a0ScreenConnect,\u00a0Remote Utilities, and\u00a0eHorus.": [["Remote Access Software", 0.27519287943890364], ["Screen Capture", 0.11409478878975536], ["Remote Services", 0.0645390027421539], ["Video Capture", 0.04972650183452922], ["Input Capture", 0.0438835999967084], ["Windows Management Instrumentation", 0.026044926213345376]], "they added a new tool for remote access,\u00a0Syncro, to their arsenal.": [["Remote Services", 0.3067635913287926], ["Remote Access Software", 0.27037856518989334], ["Lateral Tool Transfer", 0.061443138861049525], ["Communication Through Removable Media", 0.02812034779866895], ["Exploitation of Remote Services", 0.027189289358612603], ["Software Deployment Tools", 0.02236418719018842]], "It disguises itself as a legitimate Google Update executable.": [["Masquerading", 0.48936399479813536], ["Supply Chain Compromise", 0.03771522932774459], ["Subvert Trust Controls", 0.025010512806718767], ["Browser Extensions", 0.022012815459980618], ["Obfuscated Files or Information", 0.019724672984244608], ["Web Service", 0.015247567749381184]], "It collects the victim\u2019s username": [["System Owner/User Discovery", 0.8650656870736911], ["Account Discovery", 0.024229447865626044], ["System Information Discovery", 0.011184630453884866], ["Automated Collection", 0.004803272182189213], ["Native API", 0.003339035164559225], ["Input Capture", 0.003006709571889073]], "and IP address": [["System Network Configuration Discovery", 0.33102539115800633], ["Gather Victim Network Information", 0.10444839848950575], ["Dynamic Resolution", 0.03649696541487376], ["Remote System Discovery", 0.03585541607007122], ["System Information Discovery", 0.026199800571657456], ["Active Scanning", 0.026188195471119814]], "Domain fronting is another method for concealing communication between the endpoint and the command and control servers.": [["Proxy", 0.18061372830107084], ["Compromise Infrastructure", 0.08805088252363982], ["Data Obfuscation", 0.08184355585716517], ["Acquire Infrastructure", 0.07723584455160758], ["Dynamic Resolution", 0.06744599772195524], ["Application Layer Protocol", 0.030948877702689736]], "purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host": [["Compromise Infrastructure", 0.10753847513105033], ["Acquire Infrastructure", 0.0962660296961757], ["Dynamic Resolution", 0.09139860763972214], ["Proxy", 0.0772690806388671], ["Adversary-in-the-Middle", 0.026660223398753104], ["Data Obfuscation", 0.026252860034916888]], "masks your traffic to a certain website by masquerading it as a different domain.": [["Compromise Infrastructure", 0.14322515385294257], ["Acquire Infrastructure", 0.10469642354531519], ["Stage Capabilities", 0.07561324971184537], ["Proxy", 0.057563415126323854], ["Dynamic Resolution", 0.04884969407669907], ["Browser Session Hijacking", 0.04378229409984241]], "Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic": [["Compromise Infrastructure", 0.3349601246210575], ["Acquire Infrastructure", 0.31020652864244336], ["Dynamic Resolution", 0.04129159032652173], ["Stage Capabilities", 0.026804849868637196], ["Endpoint Denial of Service", 0.0198536709453579], ["Network Denial of Service", 0.01745682967864219]], "attackers have started using this technique to hide their malicious infrastructure behind legitimate domains": [["Acquire Infrastructure", 0.16348915989065269], ["Compromise Infrastructure", 0.1593901937205833], ["Stage Capabilities", 0.06317428437860999], ["Masquerading", 0.04225479757057848], ["Dynamic Resolution", 0.040786014539418526], ["Proxy", 0.03044256321164573]], "domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles": [["Acquire Infrastructure", 0.22475268446055277], ["Compromise Infrastructure", 0.18381647706332369], ["Domain Policy Modification", 0.07037060222802657], ["Dynamic Resolution", 0.05826671201607484], ["Domain Trust Discovery", 0.02145716837008639], ["Establish Accounts", 0.020690756194664785]], "Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.": [["Compromise Infrastructure", 0.19029933912253522], ["Acquire Infrastructure", 0.14151638361821198], ["Dynamic Resolution", 0.0745648732751277], ["Proxy", 0.06386088117998165], ["Application Layer Protocol", 0.03380382155485268], ["Stage Capabilities", 0.03224750053698802]], "Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.": [["System Network Configuration Discovery", 0.12237057843874746], ["Dynamic Resolution", 0.09530380117517254], ["Fallback Channels", 0.05578075280157596], ["Compromise Infrastructure", 0.053297037787603356], ["Acquire Infrastructure", 0.04029872413920876], ["Stage Capabilities", 0.03452499276080743]], "Setup a profile to facilitate domain fronting": [["Establish Accounts", 0.20296162169654733], ["Acquire Infrastructure", 0.11204661727046052], ["Create Account", 0.06878776418838149], ["Valid Accounts", 0.04357046945828806], ["Account Manipulation", 0.0336885576198774], ["Compromise Infrastructure", 0.033033456106850004]], "the legitimate website will forward the traffic through the CDN to the original destination according to the host header.": [["Compromise Infrastructure", 0.13667381508527954], ["Stage Capabilities", 0.10179211414586316], ["Acquire Infrastructure", 0.07859606724283853], ["Proxy", 0.05912555778223864], ["Web Service", 0.05882276197441352], ["Fallback Channels", 0.04844041287123992]], "domain fronting": [["Acquire Infrastructure", 0.4181313462760142], ["Compromise Infrastructure", 0.24579478376693195], ["Dynamic Resolution", 0.030902443380761153], ["Stage Capabilities", 0.029040758047401527], ["Establish Accounts", 0.014244924749831743], ["Domain Trust Discovery", 0.014203414091401738]], "malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs": [["Acquire Infrastructure", 0.2265258850841681], ["Compromise Infrastructure", 0.1449941341615983], ["Dynamic Resolution", 0.10921391663723705], ["Web Service", 0.050789841929060345], ["Fallback Channels", 0.03670025062919694], ["Application Layer Protocol", 0.027925955448829955]], "domain fronting appears to be used by threat actors.": [["Acquire Infrastructure", 0.4474822209889184], ["Compromise Infrastructure", 0.2745883612140791], ["Stage Capabilities", 0.028283991012027675], ["Establish Accounts", 0.01605761143513446], ["Dynamic Resolution", 0.014022199020432315], ["Drive-by Compromise", 0.012823690752335967]], "Attackers can use legitimate domains that are registered under the same CDN provider.": [["Compromise Infrastructure", 0.4223321579562512], ["Acquire Infrastructure", 0.2839298839802881], ["Stage Capabilities", 0.0499475198556406], ["Application Layer Protocol", 0.013649278308537365], ["Web Service", 0.01350916888802672], ["Drive-by Compromise", 0.012958269770619882]], "HTTP/HTTPS C2 traffic": [["Application Layer Protocol", 0.5366124221711471], ["Proxy", 0.06270906133704396], ["Non-Application Layer Protocol", 0.04607352093110239], ["Non-Standard Port", 0.04165423675502662], ["Data Obfuscation", 0.03774213832881945], ["Encrypted Channel", 0.03740320024980956]], "HTTP communication between the Beacon and the Cobalt Strike server": [["Application Layer Protocol", 0.38302592543786457], ["Fallback Channels", 0.09269314565114883], ["Non-Application Layer Protocol", 0.06641946354968674], ["Encrypted Channel", 0.03556822959475257], ["Non-Standard Port", 0.03260835838881767], ["Data Obfuscation", 0.02967811698562226]], "other compromised host running the parent HTTP Beacon": [["Application Layer Protocol", 0.10107117303939764], ["Fallback Channels", 0.0899309629218531], ["Adversary-in-the-Middle", 0.041300072471745185], ["System Network Configuration Discovery", 0.03853821131654958], ["Data Obfuscation", 0.03831930831131981], ["Endpoint Denial of Service", 0.033853344272309294]], "HTTP Parent Beacon": [["Application Layer Protocol", 0.16193467716658674], ["Fallback Channels", 0.05612046777851867], ["Dynamic Resolution", 0.04826599075026216], ["Data Obfuscation", 0.04141026185606906], ["System Network Configuration Discovery", 0.03691846098864855], ["Endpoint Denial of Service", 0.03199905524842868]], "customized for the HTTP-POST Block": [["Application Layer Protocol", 0.2568630860537469], ["Data Obfuscation", 0.056862187597063546], ["Exfiltration Over C2 Channel", 0.03643964024267493], ["Browser Session Hijacking", 0.032823420580707044], ["Data Encoding", 0.032720496480257696], ["Stage Capabilities", 0.024170272403241325]], "Encrypting and encoding the data with XOR mask and random key": [["Obfuscated Files or Information", 0.3403410184137334], ["Archive Collected Data", 0.13340759860373808], ["Encrypted Channel", 0.12613285962217408], ["Deobfuscate/Decode Files or Information", 0.08371959077331761], ["Data Encrypted for Impact", 0.06456264972960477], ["Data Encoding", 0.031600493925537265]], "threat actors use their beacon sessions to establish RDP access": [["Remote Services", 0.2809377627187033], ["Remote Service Session Hijacking", 0.13453953217596315], ["Remote Access Software", 0.06749677037922269], ["External Remote Services", 0.0521169290553763], ["Event Triggered Execution", 0.02132644800248276], ["Exploitation of Remote Services", 0.019016856370066875]], "attackers was to establish a Remote Desktop session": [["Remote Services", 0.3505321196840115], ["Remote Service Session Hijacking", 0.24458743406299593], ["Remote Access Software", 0.0822568455268262], ["External Remote Services", 0.024950558441957635], ["Exploitation of Remote Services", 0.013822532283495422], ["Event Triggered Execution", 0.012994970551869796]], "to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted": [["Remote Services", 0.5249500078019161], ["Remote Service Session Hijacking", 0.19608156045866304], ["Remote Access Software", 0.04535203068196896], ["External Remote Services", 0.013887516805959257], ["Command and Scripting Interpreter", 0.01119808802183028], ["Event Triggered Execution", 0.009860955966798805]], "attacker\u2019s Kali Linux host to RDP into our target\u2019s environment": [["Remote Services", 0.4587755888864995], ["Remote Service Session Hijacking", 0.10415750349070957], ["Remote Access Software", 0.09308326348977093], ["Exploitation of Remote Services", 0.03245403855963755], ["External Remote Services", 0.02534901236844593], ["Valid Accounts", 0.014448931170280383]], "RDP into the target host": [["Remote Services", 0.7394739921024202], ["Remote Access Software", 0.051368842459786894], ["Remote Service Session Hijacking", 0.045926345779463126], ["External Remote Services", 0.010261963185632123], ["Exploitation of Remote Services", 0.010223953705307568], ["Valid Accounts", 0.007790603185722022]], "Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session": [["Remote Services", 0.48409715825654853], ["Remote Access Software", 0.15644736964855693], ["Remote Service Session Hijacking", 0.08428948188167049], ["Event Triggered Execution", 0.01537483490345968], ["Exploitation of Remote Services", 0.013055276446087609], ["External Remote Services", 0.012131010187681559]], "SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon": [["Network Service Discovery", 0.15327610461271401], ["Traffic Signaling", 0.12481917623907138], ["Adversary-in-the-Middle", 0.04282154375420317], ["Non-Application Layer Protocol", 0.04070577997470085], ["Non-Standard Port", 0.03881400104126634], ["Dynamic Resolution", 0.03183225665348061]], "SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited": [["Network Service Discovery", 0.052302666396509885], ["Data from Configuration Repository", 0.04457857523742168], ["Adversary-in-the-Middle", 0.044239038073093116], ["Fallback Channels", 0.036716180329403436], ["Remote System Discovery", 0.024633003499844784], ["Impair Defenses", 0.023444176467838928]], "the SMB Beacon is communicating over the network with a parent Beacon using named pipes.": [["Adversary-in-the-Middle", 0.08607149269369696], ["Network Service Discovery", 0.05290985495612413], ["Network Sniffing", 0.052857651389884706], ["Non-Application Layer Protocol", 0.039059784798124234], ["Remote System Discovery", 0.03521069502281522], ["Network Share Discovery", 0.03202340744428762]], "can see the named pipe created that we specified on the Cobalt Strike interface when we created the SMB listener.": [["Network Sniffing", 0.051650451112787106], ["System Network Connections Discovery", 0.04193764157915478], ["Remote Services", 0.040224427131787026], ["Native API", 0.037760307021167804], ["Network Share Discovery", 0.03519378918672894], ["Network Service Discovery", 0.029358297037494006]], "RDP into the target host using reverse proxy": [["Proxy", 0.4366450245700781], ["Remote Services", 0.10623239872735395], ["Protocol Tunneling", 0.06200986757388353], ["External Remote Services", 0.0249827469929076], ["Remote Service Session Hijacking", 0.024777614835979258], ["Non-Application Layer Protocol", 0.016374426947165628]], "threat actors using reverse proxy": [["Proxy", 0.647527024624483], ["Application Layer Protocol", 0.034985228526999], ["Compromise Infrastructure", 0.029747053346283296], ["Protocol Tunneling", 0.020383549416207306], ["Fallback Channels", 0.018204130903293213], ["Data Obfuscation", 0.015734240259521432]], "a reverse proxy": [["Proxy", 0.6063462711128077], ["Application Layer Protocol", 0.05007960675268616], ["Protocol Tunneling", 0.0256356599779442], ["Fallback Channels", 0.022108015840080465], ["Compromise Infrastructure", 0.02106748108021168], ["Data Obfuscation", 0.017384146142424436]], "Reverse Proxy using Cobalt Strike Beacon": [["Proxy", 0.4719552151543232], ["Fallback Channels", 0.06962192563612217], ["Application Layer Protocol", 0.052676875135463305], ["Dynamic Resolution", 0.0391252960981568], ["Data Obfuscation", 0.03068355397992319], ["Protocol Tunneling", 0.025058484608155684]], "the ability to run a SOCKS proxy server on the team server.": [["Proxy", 0.6311158952451811], ["Protocol Tunneling", 0.06571499943362953], ["Application Layer Protocol", 0.028265106095569613], ["Non-Application Layer Protocol", 0.01616593059468026], ["Fallback Channels", 0.014550571923076046], ["External Remote Services", 0.01433495668750952]], "This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session": [["Traffic Signaling", 0.16834732390375715], ["Proxy", 0.07480297866500092], ["Adversary-in-the-Middle", 0.07264786297585855], ["Non-Application Layer Protocol", 0.04781194665543871], ["Non-Standard Port", 0.04727935046154757], ["Dynamic Resolution", 0.04571323696678324]], "attackers take advantage of this technique using proxychains": [["Proxy", 0.4263643323086112], ["Application Layer Protocol", 0.04101829185671074], ["Fallback Channels", 0.03679368387452111], ["Data Obfuscation", 0.03638172455422689], ["Adversary-in-the-Middle", 0.029928111770680256], ["Protocol Tunneling", 0.023299255523970434]], "employ proxychains from the attacker\u2019s Kali Linux host": [["Proxy", 0.5177787458866644], ["Adversary-in-the-Middle", 0.03936546785355934], ["Application Layer Protocol", 0.03060562468652945], ["Fallback Channels", 0.02505820967972462], ["Protocol Tunneling", 0.02340397525646929], ["Data Obfuscation", 0.022797331449967137]], "via reverse proxy.": [["Proxy", 0.5553515311534386], ["Application Layer Protocol", 0.0682739021498711], ["Fallback Channels", 0.030111991075232967], ["Protocol Tunneling", 0.029857564327366193], ["Compromise Infrastructure", 0.021180279646939908], ["Data Obfuscation", 0.01646473005860554]], "can be configured as a proxy": [["Proxy", 0.6684700648092984], ["Application Layer Protocol", 0.041633504113868784], ["Protocol Tunneling", 0.02227217817841997], ["Fallback Channels", 0.01943426230151796], ["Data Obfuscation", 0.012952380102429136], ["Compromise Infrastructure", 0.011889941856300958]], "threat actors use their beacon sessions to establish RDP access through a reverse proxy": [["Proxy", 0.3537095815732023], ["Remote Services", 0.06930443100073859], ["Remote Service Session Hijacking", 0.055294034132177296], ["External Remote Services", 0.0497369257619351], ["Protocol Tunneling", 0.040587720132238096], ["Steal Web Session Cookie", 0.020557315525660484]], "the victim\u2019s hostname is captured in this logon event": [["System Owner/User Discovery", 0.33189551704683024], ["System Information Discovery", 0.07509466871101836], ["Input Capture", 0.04558315648896532], ["OS Credential Dumping", 0.024964093928935695], ["Account Discovery", 0.02268245845801175], ["Access Token Manipulation", 0.022042065248244504]], "execute the command systeminfo on the compromised host.": [["System Information Discovery", 0.7247088959665456], ["Windows Management Instrumentation", 0.044331487285531164], ["Virtualization/Sandbox Evasion", 0.036349017992915865], ["Software Discovery", 0.028710089406750783], ["Process Discovery", 0.015310914876605217], ["System Network Configuration Discovery", 0.01234449271098946]], "it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.": [["Data Transfer Size Limits", 0.10354051535935917], ["Exfiltration Over C2 Channel", 0.0753109076142242], ["Fallback Channels", 0.0752574850682896], ["Application Layer Protocol", 0.06748312062696707], ["Web Service", 0.03786720644672158], ["Dynamic Resolution", 0.037126275704381505]], "which will then send the results to the C2 server": [["Exfiltration Over C2 Channel", 0.11029596777111007], ["Web Service", 0.10946942135544849], ["Automated Collection", 0.08349812476057245], ["Application Layer Protocol", 0.07174998084624037], ["Automated Exfiltration", 0.04476868075562734], ["Email Collection", 0.03919549382242783]], "SSL can be used to complicate command-and-control (C2) traffic analysis": [["Encrypted Channel", 0.15783077247560856], ["Data Obfuscation", 0.15334649014221788], ["Application Layer Protocol", 0.11643450350756325], ["Non-Standard Port", 0.05571305200030924], ["Proxy", 0.05496441841977803], ["Protocol Tunneling", 0.03669191682797326]], "replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header": [["Process Injection", 0.11765409988936236], ["Modify System Image", 0.08238619179229814], ["Subvert Trust Controls", 0.04866602368001028], ["Hijack Execution Flow", 0.04168141449549723], ["Obfuscated Files or Information", 0.03841649119203487], ["Rootkit", 0.03299958449217688]], "unpack any additional payloads,": [["Deobfuscate/Decode Files or Information", 0.3583079859891939], ["Obfuscated Files or Information", 0.17525805851508755], ["Command and Scripting Interpreter", 0.036567896583078394], ["Ingress Tool Transfer", 0.027305890593450014], ["Hijack Execution Flow", 0.026979853325966075], ["Masquerading", 0.018958131439156745]], "HTTPS and other protocols built on SSL have": [["Application Layer Protocol", 0.4330072230206206], ["Non-Standard Port", 0.07104911914858997], ["Encrypted Channel", 0.06855947690335876], ["Data Obfuscation", 0.04916919264603084], ["Protocol Tunneling", 0.040687486731599644], ["Exfiltration Over Alternative Protocol", 0.03899153283500865]], "service using HTTPS": [["Application Layer Protocol", 0.3695546178116526], ["Non-Standard Port", 0.1063990054036158], ["Data Obfuscation", 0.04103908361474688], ["Encrypted Channel", 0.03760763377435083], ["Endpoint Denial of Service", 0.022455069580500222], ["Exfiltration Over Alternative Protocol", 0.02120162959914247]], "SSL encrypted traffic": [["Encrypted Channel", 0.39887076808149907], ["Application Layer Protocol", 0.05851868963377665], ["Data Obfuscation", 0.05838232768154527], ["Non-Standard Port", 0.05223565128428724], ["Protocol Tunneling", 0.042787813393624516], ["Exfiltration Over Alternative Protocol", 0.03419436962245544]], "TLS encrypted data": [["Encrypted Channel", 0.23213685852067842], ["Data Encrypted for Impact", 0.10571580546496397], ["Archive Collected Data", 0.09673119334870647], ["Obfuscated Files or Information", 0.09357803762606065], ["Exfiltration Over Alternative Protocol", 0.0739969525685592], ["Deobfuscate/Decode Files or Information", 0.052846326254852236]], "detect when TLS connections are being initiated and log the symmetric keys generated for the SSL/TLS connection": [["Network Sniffing", 0.09925737917191074], ["System Network Connections Discovery", 0.07543776312972848], ["Encrypted Channel", 0.07154095483364135], ["Non-Standard Port", 0.042053306533575335], ["Data Obfuscation", 0.03951208432245117], ["Unsecured Credentials", 0.03836421194726653]], "decrypt TLS traffic,": [["Encrypted Channel", 0.42689524527279615], ["Data Obfuscation", 0.058404466112358354], ["Data Encoding", 0.05656881744840412], ["Deobfuscate/Decode Files or Information", 0.05632966346782761], ["Weaken Encryption", 0.05537670070832121], ["Exfiltration Over Alternative Protocol", 0.05012345258346132]], "decrypt network traffic": [["Encrypted Channel", 0.3380639741255309], ["Weaken Encryption", 0.11201329270753871], ["Exfiltration Over Alternative Protocol", 0.09079946066300092], ["Deobfuscate/Decode Files or Information", 0.0730485647920381], ["Data Encoding", 0.04934366992465418], ["Network Sniffing", 0.030282059839838518]], "decrypted": [["Deobfuscate/Decode Files or Information", 0.5815444827528823], ["Data Encrypted for Impact", 0.09388245313543182], ["Archive Collected Data", 0.05265220925111637], ["Obfuscated Files or Information", 0.043851778527999284], ["Weaken Encryption", 0.027627980471935706], ["Encrypted Channel", 0.023979427510364304]], "the decrypted HTTPS traffic.": [["Encrypted Channel", 0.23032007791559228], ["Exfiltration Over Alternative Protocol", 0.08182888402054823], ["Data Encoding", 0.0696866148895147], ["Data Obfuscation", 0.06797224325420252], ["Application Layer Protocol", 0.06539705988074529], ["Network Sniffing", 0.035341229587693576]], "encrypt": [["Data Encrypted for Impact", 0.25989187180671813], ["Obfuscated Files or Information", 0.18649329663311687], ["Archive Collected Data", 0.1073246480972187], ["Encrypted Channel", 0.09768188119356896], ["Deobfuscate/Decode Files or Information", 0.06237690872577533], ["Weaken Encryption", 0.03959714270197025]], "downloads the next stage from a public file storage service": [["Ingress Tool Transfer", 0.20909242142677947], ["Data Staged", 0.12067887985343309], ["Data from Local System", 0.09777856357529627], ["Data from Network Shared Drive", 0.04168635052593782], ["Exfiltration Over Web Service", 0.02807488145091146], ["Automated Collection", 0.027345460687400017]], "embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.": [["Command and Scripting Interpreter", 0.17189598691337743], ["Ingress Tool Transfer", 0.06116056370501695], ["User Execution", 0.06066155171813226], ["Virtualization/Sandbox Evasion", 0.03870008590519072], ["System Binary Proxy Execution", 0.035719340520998046], ["Inter-Process Communication", 0.030111755038998267]], "that embeds the Crypter with the payload.": [["Obfuscated Files or Information", 0.41924629637207045], ["Deobfuscate/Decode Files or Information", 0.1631365463918941], ["Encrypted Channel", 0.06435735924212915], ["Data Encrypted for Impact", 0.05066147798146886], ["Archive Collected Data", 0.04804876194690986], ["Weaken Encryption", 0.020678505978496086]], "the actor embeds the malicious code inside different legitimate codes.": [["Exploitation for Client Execution", 0.13112007090415065], ["Obfuscated Files or Information", 0.12513094276054637], ["Obtain Capabilities", 0.03766019868180175], ["Masquerading", 0.03635233405200585], ["Template Injection", 0.03381053389145174], ["Process Injection", 0.02830604833737749]], "which enables an HTTPS connection.": [["Application Layer Protocol", 0.3831796329482607], ["Proxy", 0.06352842450203736], ["Non-Standard Port", 0.0614393390277712], ["Protocol Tunneling", 0.04673664950915513], ["Encrypted Channel", 0.0323664961524425], ["Data Obfuscation", 0.03193140353291737]], "Once downloaded and executed, the malicious installer copies its compressed files into a newly created folder with a legitimate-looking name\u00a0 (i.e., IIS Application Health Monitor) in one of the following directory paths:": [["Masquerading", 0.1493742823760553], ["System Binary Proxy Execution", 0.06293142918855715], ["Obfuscated Files or Information", 0.055240670743445616], ["Data Staged", 0.047935451773292934], ["Ingress Tool Transfer", 0.044963092565209285], ["Indicator Removal", 0.039849734720673005]], "At first glance, the files within the directory may seem legitimate": [["File and Directory Discovery", 0.5265094317489697], ["Indicator Removal", 0.06346634903358982], ["Masquerading", 0.04776682431846763], ["Hide Artifacts", 0.04625973282389338], ["Data from Local System", 0.041391550461658745], ["Data Staged", 0.03846514488666106]], "Write a registry Run key": [["Boot or Logon Autostart Execution", 0.5463295772507732], ["Modify Registry", 0.18085213434693972], ["Query Registry", 0.049730366660641435], ["Boot or Logon Initialization Scripts", 0.02238767920801453], ["Event Triggered Execution", 0.02104296621956229], ["System Binary Proxy Execution", 0.020657232552796202]], "Write a.lnk file in the startup folder": [["Boot or Logon Autostart Execution", 0.5920399027159555], ["Boot or Logon Initialization Scripts", 0.10827870089755592], ["Create or Modify System Process", 0.04225477308024273], ["Modify Registry", 0.03730687261395103], ["Event Triggered Execution", 0.028582141851120856], ["Masquerading", 0.014980827917552684]], "registry run key persistence implementation": [["Boot or Logon Autostart Execution", 0.4499949037445261], ["Modify Registry", 0.2524340984396428], ["Query Registry", 0.05322861761555121], ["Boot or Logon Initialization Scripts", 0.02939858742232388], ["Event Triggered Execution", 0.02324339683015051], ["Account Manipulation", 0.015490140230393143]], "The Decryption Shellcode": [["Deobfuscate/Decode Files or Information", 0.7026830201059706], ["Obfuscated Files or Information", 0.10293968613343045], ["Data Encrypted for Impact", 0.027381598954831745], ["Encrypted Channel", 0.02457500667452073], ["Archive Collected Data", 0.013645809442504186], ["Execution Guardrails", 0.011358373458394746]], "The Decryption shellcode has three main tasks: first, it extracts the Loader shellcode and the payload, then it decrypts them, and finally, it transfers the execution to the decrypted Loader shellcode.": [["Deobfuscate/Decode Files or Information", 0.7484200245442734], ["Obfuscated Files or Information", 0.11328212989539783], ["Execution Guardrails", 0.012289919282298938], ["Encrypted Channel", 0.010348889420625628], ["Process Injection", 0.00912526905331654], ["Data Encrypted for Impact", 0.008571804484487617]], "Decryption shellcode execution flow": [["Deobfuscate/Decode Files or Information", 0.7831036667695037], ["Obfuscated Files or Information", 0.08847507606401127], ["Data Encrypted for Impact", 0.016275479693468552], ["Encrypted Channel", 0.01442673159963382], ["Execution Guardrails", 0.009608462806530273], ["Archive Collected Data", 0.007462316083371016]], "The Decryption shellcode": [["Deobfuscate/Decode Files or Information", 0.7026830201059706], ["Obfuscated Files or Information", 0.10293968613343045], ["Data Encrypted for Impact", 0.027381598954831745], ["Encrypted Channel", 0.02457500667452073], ["Archive Collected Data", 0.013645809442504186], ["Execution Guardrails", 0.011358373458394746]], "decrypts it using the denoted decryption key": [["Deobfuscate/Decode Files or Information", 0.7592539239949142], ["Data Encrypted for Impact", 0.0498863841410743], ["Archive Collected Data", 0.028989269273418234], ["Encrypted Channel", 0.022553984028301114], ["Obfuscated Files or Information", 0.022387626404701662], ["Weaken Encryption", 0.018455169286020662]], "the decrypted payload": [["Deobfuscate/Decode Files or Information", 0.6909053925252794], ["Obfuscated Files or Information", 0.07580455401752977], ["Data Encrypted for Impact", 0.035397351729608], ["Archive Collected Data", 0.030432275113322534], ["Encrypted Channel", 0.022794449853172163], ["Weaken Encryption", 0.017596884685921774]], "the decrypted payload address": [["Deobfuscate/Decode Files or Information", 0.4961761481953038], ["Obfuscated Files or Information", 0.07735427641908728], ["Encrypted Channel", 0.05610071795527822], ["Execution Guardrails", 0.02773226620328122], ["Data Encrypted for Impact", 0.026918818305626684], ["Weaken Encryption", 0.02529426443402412]], "An encrypted additional shellcode": [["Obfuscated Files or Information", 0.5409964078062748], ["Deobfuscate/Decode Files or Information", 0.128263878979938], ["Encrypted Channel", 0.08048164935220797], ["Data Encrypted for Impact", 0.036647710931061867], ["Execution Guardrails", 0.021020200163984662], ["Data Encoding", 0.01724284470202619]], "An encrypted payload": [["Obfuscated Files or Information", 0.3600413350375672], ["Encrypted Channel", 0.1323927032768731], ["Deobfuscate/Decode Files or Information", 0.11993678538806885], ["Data Encrypted for Impact", 0.07134179802646752], ["Archive Collected Data", 0.04957003814161403], ["Execution Guardrails", 0.034647207817838636]], "these are encrypted and split inside the XML.": [["Deobfuscate/Decode Files or Information", 0.25193700644429434], ["Obfuscated Files or Information", 0.2092805786105733], ["Archive Collected Data", 0.08508433666219287], ["Data Encoding", 0.03649645348454487], ["Unsecured Credentials", 0.028084691080387046], ["Exfiltration Over Alternative Protocol", 0.02026119440959473]], "the user will be encouraged to download a malicious installer": [["User Execution", 0.15520000643981519], ["Drive-by Compromise", 0.09411501712208831], ["Supply Chain Compromise", 0.07341052628129616], ["Ingress Tool Transfer", 0.054554790900598484], ["Command and Scripting Interpreter", 0.05346007344817686], ["System Binary Proxy Execution", 0.04661671572898747]], "deceive the user into thinking that the application has failed to execute, even as it silently continues the malicious execution in the background.": [["Masquerading", 0.10758251490388711], ["Process Injection", 0.0848760713780593], ["System Binary Proxy Execution", 0.06998841166434569], ["Event Triggered Execution", 0.06567305926467189], ["Hijack Execution Flow", 0.0628047460990846], ["Virtualization/Sandbox Evasion", 0.05460877055343589]], "shellcode is to inject the decrypted payload within the currently running process (itself).": [["Process Injection", 0.33563512321743183], ["Deobfuscate/Decode Files or Information", 0.2697163188108249], ["Obfuscated Files or Information", 0.14607623761490288], ["Native API", 0.032024964694582735], ["Encrypted Channel", 0.019548009424380196], ["Execution Guardrails", 0.013409094231294836]], "the Loader overwrites the current PE with the final payload\u2019s PE": [["Process Injection", 0.06641411734579794], ["Subvert Trust Controls", 0.03925627512399375], ["Pre-OS Boot", 0.038094455103897], ["Command and Scripting Interpreter", 0.03514679476405679], ["Modify System Image", 0.0337961027615379], ["Event Triggered Execution", 0.03182167984670574]], "It does so by copying the PE headers and each section according to the current executable\u2019s base address.": [["OS Credential Dumping", 0.10151401029948826], ["Process Injection", 0.07802700518887148], ["Native API", 0.07319799592460985], ["System Binary Proxy Execution", 0.04361262631590596], ["Masquerading", 0.03070440513743715], ["Hijack Execution Flow", 0.030257920002401722]], "the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER": [["OS Credential Dumping", 0.03479390309963517], ["Masquerading", 0.03257370108914047], ["Obfuscated Files or Information", 0.03252217662569504], ["Build Image on Host", 0.029106061673717317], ["Process Injection", 0.025969312692422288], ["Modify System Image", 0.02505287317257205]], "the import address table and relocation table of the newly injected PE.": [["OS Credential Dumping", 0.07140144849535521], ["Account Discovery", 0.05595445521825441], ["System Network Configuration Discovery", 0.04127375495444733], ["Unsecured Credentials", 0.039105202317218216], ["Remote System Discovery", 0.03201682751682467], ["Process Injection", 0.028805330856059796]], "the newly injected PE": [["Process Injection", 0.0481104927812597], ["Domain Policy Modification", 0.040357038605451236], ["Subvert Trust Controls", 0.03608835590696089], ["Unsecured Credentials", 0.026038249153211547], ["Access Token Manipulation", 0.026033448196992427], ["Obtain Capabilities", 0.024665536495333273]], "Loader removes evidence of injection by using the following methods:\nUpdate the LDR data table entry to match the injected PE.\nRemove the injected PE headers from memory.": [["Process Injection", 0.1845618302751592], ["Hijack Execution Flow", 0.06665365942135709], ["Subvert Trust Controls", 0.04580783533402156], ["Shared Modules", 0.036797582844815026], ["Pre-OS Boot", 0.03432391457918568], ["Rootkit", 0.030667104946709597]], "disable system defenses": [["Impair Defenses", 0.4651115186260778], ["Subvert Trust Controls", 0.039042497272170094], ["Modify System Image", 0.031990783161208805], ["Execution Guardrails", 0.027077730776883305], ["Domain Policy Modification", 0.022294617506797555], ["Exploitation for Defense Evasion", 0.022121901544052254]], "The process list checked is as follows": [["Process Discovery", 0.5084406082092241], ["Impair Defenses", 0.044452601791881624], ["Service Stop", 0.039112605594558994], ["System Service Discovery", 0.03622090271570978], ["Process Injection", 0.02927956875216324], ["Native API", 0.02282427860448376]], "The services running on the compromised system are checked against the following list": [["System Service Discovery", 0.5493587594013392], ["Cloud Service Discovery", 0.09765263830098928], ["Network Service Discovery", 0.051374718598307716], ["Process Discovery", 0.03625678794609255], ["Create or Modify System Process", 0.030553344295617554], ["Service Stop", 0.024996583552800464]], "The credentials also allow BlackCat to move laterally within the victim\u2019s system and/or network, often with administrative privileges.": [["Valid Accounts", 0.24926152785642738], ["Brute Force", 0.05563168269843525], ["OS Credential Dumping", 0.05266953066852593], ["Remote Services", 0.0502486394358136], ["Modify Authentication Process", 0.04493487578947573], ["Exploitation for Credential Access", 0.030388621351927915]], "the ransomware to deploy additional tools": [["Ingress Tool Transfer", 0.07715784509599519], ["Obtain Capabilities", 0.06925939068693843], ["Develop Capabilities", 0.05704605082293094], ["Command and Scripting Interpreter", 0.05563778289266938], ["Stage Capabilities", 0.039860337968122335], ["Supply Chain Compromise", 0.030368393248122936]], "such as Mimikatz": [["Web Service", 0.0810203636928215], ["Command and Scripting Interpreter", 0.03442954263969443], ["Ingress Tool Transfer", 0.03050072367534885], ["Acquire Infrastructure", 0.02872503538462425], ["Credentials from Password Stores", 0.025858097546527906], ["Server Software Component", 0.02277535243909106]], "utilizes a unique onion domain": [["Compromise Infrastructure", 0.1537823570599085], ["Acquire Infrastructure", 0.1526006510858039], ["Dynamic Resolution", 0.0657424359250755], ["Web Service", 0.05411829397836568], ["Application Layer Protocol", 0.03998821158875585], ["Stage Capabilities", 0.035818688382521655]], "Encrypted Multi-Hop Proxies": [["Proxy", 0.36044440657942], ["Encrypted Channel", 0.145384527689681], ["Protocol Tunneling", 0.08428120164755944], ["Application Layer Protocol", 0.04745634468293454], ["Data Obfuscation", 0.04170500351749316], ["Exfiltration Over Alternative Protocol", 0.02884000325166274]], "cyber actors use the VPS as well as small office and home office (SOHO) devices as operational nodes to evade detection.": [["Acquire Infrastructure", 0.14971511995265882], ["Compromise Infrastructure", 0.13384458430453003], ["Proxy", 0.07644272832521254], ["Dynamic Resolution", 0.033977123085086915], ["Stage Capabilities", 0.033167674630023875], ["Exploit Public-Facing Application", 0.0267632437304073]], "have been routinely observed using a VPS as an encrypted proxy.": [["Proxy", 0.23899937582853983], ["Encrypted Channel", 0.1623890397499656], ["Protocol Tunneling", 0.10460590838167717], ["Application Layer Protocol", 0.062236656180287384], ["Exfiltration Over Alternative Protocol", 0.03935953464899318], ["Data Obfuscation", 0.027638462551770365]], "Some of these nodes operate as part of an encrypted proxy service to prevent attribution by concealing their country of origin and TTPs": [["Acquire Infrastructure", 0.10869209783200695], ["Proxy", 0.08000904876780535], ["Dynamic Resolution", 0.05972658212255443], ["Compromise Infrastructure", 0.050855822786476226], ["Web Service", 0.050540514487025824], ["Stage Capabilities", 0.035957009537864466]], "cyber actors have been observed using a network of VPSs and small office and home office (SOHO) routers as part of their operational infrastructure to evade detection and host C2 activity": [["Proxy", 0.17553142909793698], ["Network Boundary Bridging", 0.06649444143412975], ["Compromise Infrastructure", 0.04257447061300352], ["Acquire Infrastructure", 0.037009998549030816], ["Adversary-in-the-Middle", 0.03654197039769462], ["Network Denial of Service", 0.03536523725862323]], "to locate certain files, paths,": [["File and Directory Discovery", 0.8119930371422265], ["Data from Local System", 0.021035500851831895], ["Data Staged", 0.017462190108036534], ["Automated Collection", 0.012155361902998051], ["Data from Network Shared Drive", 0.010660718304737615], ["Indicator Removal", 0.009233578702034232]], "cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities.": [["File and Directory Discovery", 0.19759505163111302], ["Data from Local System", 0.06275589154492386], ["Hide Artifacts", 0.037533975832687166], ["Data Staged", 0.025993820441620415], ["Network Share Discovery", 0.0252959537297926], ["Indicator Removal", 0.025159056667574304]], "IP address space": [["Dynamic Resolution", 0.10644617330517155], ["System Network Configuration Discovery", 0.08138372961215767], ["Gather Victim Network Information", 0.05647506538856387], ["Active Scanning", 0.037737175801008584], ["Acquire Infrastructure", 0.0365183237111109], ["Remote System Discovery", 0.034693598958797735]], "cyber actors have exploited known vulnerabilities in Internet-facing systems": [["Exploit Public-Facing Application", 0.22497556156088463], ["Compromise Infrastructure", 0.1157988293404687], ["Obtain Capabilities", 0.07750563262922255], ["Exploitation for Client Execution", 0.05685590825651542], ["Stage Capabilities", 0.04918190888743117], ["Develop Capabilities", 0.043157572169093245]], "exploit targeting a public-facing appliance vulnerability.": [["Exploitation for Client Execution", 0.13244017255301882], ["Exploitation of Remote Services", 0.09587728812812062], ["Obtain Capabilities", 0.08976867652354029], ["Exploit Public-Facing Application", 0.08400208003781316], ["Develop Capabilities", 0.07204914280170963], ["Exploitation for Privilege Escalation", 0.05784770984297268]], "Exploiting Internet accessible webservers using webshell small code injections against multiple code languages, including net, asp, apsx, php, japx, and cfm.": [["Exploit Public-Facing Application", 0.3050204426507262], ["Server Software Component", 0.144052206165606], ["Drive-by Compromise", 0.0690804648551972], ["Exploitation for Client Execution", 0.04911272455730444], ["Stage Capabilities", 0.038053313473703054], ["Template Injection", 0.021830188281515155]], "These emails may contain a malicious link or files that will provide the cyber actor access to the victim\u2019s device": [["Phishing", 0.2805859201366767], ["Email Collection", 0.1522008308304956], ["Compromise Accounts", 0.04674328344515865], ["Phishing for Information", 0.04366322795761831], ["Gather Victim Identity Information", 0.03186028123179241], ["User Execution", 0.031487511375868894]], "These emails may contain a malicious link or file that provide the cyber actor access to the victim\u2019s device": [["Phishing", 0.27315577296726834], ["Email Collection", 0.14954846196193414], ["Compromise Accounts", 0.04886720132776064], ["Phishing for Information", 0.04359535294847213], ["Internal Spearphishing", 0.033343978482037614], ["Gather Victim Identity Information", 0.03228721299391597]], "after the user clicks on the malicious link or opens the attachment.": [["User Execution", 0.6606812510772473], ["Phishing", 0.11418700052720548], ["Stage Capabilities", 0.020752504894241252], ["Template Injection", 0.009890001922682466], ["Office Application Startup", 0.0091504411671313], ["Ingress Tool Transfer", 0.008282778860953108]], "the user clicks on the malicious link or opens the attachment.": [["User Execution", 0.7586810153050704], ["Phishing", 0.10180106050744354], ["Stage Capabilities", 0.012171306558166301], ["Ingress Tool Transfer", 0.008467990104434851], ["Template Injection", 0.007432356711833405], ["Browser Session Hijacking", 0.004948133913843205]], "gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks.": [["Valid Accounts", 0.21691402958611183], ["Brute Force", 0.06647976044931368], ["Forge Web Credentials", 0.052571107433398455], ["Exploitation for Credential Access", 0.04834267671792575], ["Gather Victim Identity Information", 0.044230827646842816], ["Internal Spearphishing", 0.03884936391837648]], "cyber actors used valid accounts to log into a service specifically designed to accept remote connections,": [["Valid Accounts", 0.17330111832818018], ["External Remote Services", 0.12889954276960247], ["Brute Force", 0.048978326188711174], ["Create Account", 0.04319841426415615], ["Remote Services", 0.03216437695653171], ["Compromise Accounts", 0.02970079937903633]], "The actor may then perform actions as the logged-on user.": [["Access Token Manipulation", 0.18390205548811558], ["Abuse Elevation Control Mechanism", 0.10816078268292871], ["System Owner/User Discovery", 0.05390691736608492], ["Valid Accounts", 0.04025667128891063], ["Remote Services", 0.04005555020447967], ["Remote Service Session Hijacking", 0.03848101392195256]], "Using cmd.exe,": [["Command and Scripting Interpreter", 0.34170085912060066], ["System Binary Proxy Execution", 0.11675884655960321], ["Native API", 0.09246138403610772], ["Indirect Command Execution", 0.0429704112870725], ["Windows Management Instrumentation", 0.03453147509553791], ["System Services", 0.030173863133851567]], "Windows Command Shell": [["Command and Scripting Interpreter", 0.6559885362619796], ["Indirect Command Execution", 0.03591117522700231], ["Native API", 0.034972560288888135], ["System Binary Proxy Execution", 0.016640877037538557], ["Windows Management Instrumentation", 0.016543473948833574], ["File and Directory Discovery", 0.014719841122085145]], "or command line interface tools": [["Command and Scripting Interpreter", 0.34030856626508554], ["Indirect Command Execution", 0.02518664685943681], ["OS Credential Dumping", 0.02495395439687865], ["Ingress Tool Transfer", 0.023527565436875782], ["Screen Capture", 0.021870780049793523], ["Windows Management Instrumentation", 0.019231430916182794]], "executing malware shellcode and batch files": [["Command and Scripting Interpreter", 0.3905578660233677], ["System Binary Proxy Execution", 0.18381245020623843], ["Scheduled Task/Job", 0.05128339821982443], ["System Services", 0.049324781004623085], ["Indirect Command Execution", 0.024793995019707905], ["Native API", 0.023230575603969638]], "Employing Python scripts to exploit vulnerable servers.": [["Exploit Public-Facing Application", 0.1718051098278287], ["Exploitation for Client Execution", 0.10534649515827244], ["Exploitation of Remote Services", 0.0811585972904312], ["Obtain Capabilities", 0.055244572301233696], ["Develop Capabilities", 0.037768963183441966], ["Compromise Infrastructure", 0.03681306111866061]], "cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).": [["Remote Services", 0.20909585808138287], ["Valid Accounts", 0.12174539608799621], ["External Remote Services", 0.10756038275421208], ["Remote Access Software", 0.04253118602838872], ["Brute Force", 0.03834691906358735], ["Create Account", 0.03454710069031187]], "such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks.": [["Remote System Discovery", 0.1650871832102553], ["System Network Connections Discovery", 0.12466405330134869], ["System Network Configuration Discovery", 0.06494465979406952], ["Data from Configuration Repository", 0.05790559346777307], ["Scheduled Task/Job", 0.05672813635707908], ["Network Service Discovery", 0.037952318610299594]], "to establish new services to enable persistence.": [["Create or Modify System Process", 0.6713132477843521], ["System Services", 0.03436446103426237], ["Boot or Logon Autostart Execution", 0.03403276867032808], ["Scheduled Task/Job", 0.018307042007408736], ["Boot or Logon Initialization Scripts", 0.017640662956617044], ["Event Triggered Execution", 0.01712777910701949]], "cyber actors have also been observed modifying group policies for password exploitation.": [["Brute Force", 0.2137802539142947], ["Modify Authentication Process", 0.14719901925396647], ["Password Policy Discovery", 0.12499352073222636], ["Credentials from Password Stores", 0.05047366187315012], ["Valid Accounts", 0.0450645861805759], ["OS Credential Dumping", 0.03306458409378883]], "usage of Mimikatz": [["Command and Scripting Interpreter", 0.093927652945052], ["System Binary Proxy Execution", 0.04562513437554992], ["Event Triggered Execution", 0.04061714197493948], ["Masquerading", 0.03190569183744501], ["OS Credential Dumping", 0.027744903023986793], ["Remote Services", 0.02613288093385561]], "observed targeting the LSASS process or Active directory (NDST.DIT) for credential dumping.": [["OS Credential Dumping", 0.7800822202112041], ["Account Discovery", 0.03240140877875084], ["Credentials from Password Stores", 0.03087581995684623], ["Unsecured Credentials", 0.026577869950508173], ["Brute Force", 0.010166963597445552], ["System Owner/User Discovery", 0.00550584903013923]], "Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement.": [["Process Injection", 0.6620409472037355], ["Native API", 0.05202051922083508], ["Hide Artifacts", 0.03577603720483372], ["Masquerading", 0.03014312339960455], ["Hijack Execution Flow", 0.030028692969030595], ["System Binary Proxy Execution", 0.017691370504242698]], "Using shellcode that injects implants into newly created instances of the Service Host process (svchost)": [["Create or Modify System Process", 0.312946759356254], ["Process Injection", 0.31156678805993165], ["System Services", 0.1136869677285346], ["Native API", 0.02843269320220758], ["Access Token Manipulation", 0.026532979308214577], ["Hijack Execution Flow", 0.02509161902091381]], "were observed using the 7-Zip utility to unzip imported tools and malware files onto the victim device.": [["Archive Collected Data", 0.15019209301432587], ["Deobfuscate/Decode Files or Information", 0.1080591479978797], ["Obfuscated Files or Information", 0.05862563954009455], ["Data from Removable Media", 0.04740443626537778], ["Automated Collection", 0.028772638875950697], ["Masquerading", 0.02829590099078982]], "cyber actors have been observed deleting files using rm or del commands.": [["Indicator Removal", 0.6269383175717466], ["Data Destruction", 0.16469998441950617], ["Inhibit System Recovery", 0.024960621929846393], ["Disk Wipe", 0.019972271820382453], ["System Shutdown/Reboot", 0.010715278993936565], ["Service Stop", 0.008590837991204563]], "cyber actors were observed Base64 encoding files and command strings to evade security measures.": [["Obfuscated Files or Information", 0.5680200422069189], ["Data Encoding", 0.1600674151768563], ["Deobfuscate/Decode Files or Information", 0.08352990608165528], ["Data Obfuscation", 0.02456192949762386], ["Archive Collected Data", 0.023259699047221322], ["Masquerading", 0.01022974782760354]], "have been observed using Base-64 encoded commands": [["Obfuscated Files or Information", 0.5978734461492043], ["Deobfuscate/Decode Files or Information", 0.11991121700020152], ["Data Encoding", 0.053322058935786135], ["Encrypted Channel", 0.01954155326863689], ["System Information Discovery", 0.01449431594661024], ["Data Obfuscation", 0.011729312555878854]], "were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads.": [["System Binary Proxy Execution", 0.20363784849645855], ["System Script Proxy Execution", 0.1352324594250111], ["Hijack Execution Flow", 0.07634218635966836], ["Process Injection", 0.05159197055233061], ["Subvert Trust Controls", 0.04047724362224697], ["Native API", 0.04006606274319181]], "have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices.": [["Process Discovery", 0.6828381156855382], ["Windows Management Instrumentation", 0.027409896498229218], ["System Service Discovery", 0.022463524513801555], ["Software Discovery", 0.02006317351685391], ["System Information Discovery", 0.017007544798212846], ["Network Service Discovery", 0.01287722867598324]], "cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.": [["Modify Cloud Compute Infrastructure", 0.09080000523477322], ["Account Manipulation", 0.06932606241481182], ["Acquire Infrastructure", 0.06363348362154589], ["Valid Accounts", 0.0410371969734826], ["Compromise Infrastructure", 0.0381364857584278], ["Cloud Infrastructure Discovery", 0.03198839134640407]], "cyber actors used RDP": [["Remote Services", 0.4396064224105245], ["Remote Access Software", 0.0755216687226144], ["External Remote Services", 0.044779883004966485], ["Remote Service Session Hijacking", 0.039376968825397714], ["Exploitation of Remote Services", 0.025893406098336708], ["Valid Accounts", 0.02465220215020671]], "cyber actors have been observed using the mv command to export files into a location": [["Data from Local System", 0.13283972947232475], ["Data Staged", 0.08774776670587259], ["Indicator Removal", 0.04292585575661747], ["Ingress Tool Transfer", 0.040909432909735234], ["File and Directory Discovery", 0.04012587509562783], ["Lateral Tool Transfer", 0.03742360730351176]], "a downloader that downloads and executes a payload": [["Ingress Tool Transfer", 0.6386482272320568], ["Command and Scripting Interpreter", 0.10540338487664822], ["BITS Jobs", 0.06235623866645544], ["System Binary Proxy Execution", 0.021117033006518838], ["Deobfuscate/Decode Files or Information", 0.010937907124675707], ["Inter-Process Communication", 0.008656556680079764]], "cyber actors have been observed importing tools from GitHub or infected domains to victim networks": [["Stage Capabilities", 0.12986094215221217], ["Obtain Capabilities", 0.12039881137044427], ["Drive-by Compromise", 0.07696624238432209], ["Develop Capabilities", 0.06274966272602256], ["Acquire Infrastructure", 0.05081461918617614], ["Supply Chain Compromise", 0.046583027314727396]], "cyber actors used the Server Message Block (SMB) protocol to import tools into victim networks.": [["Lateral Tool Transfer", 0.13492043291278985], ["Remote Services", 0.09230520174607605], ["Exploitation of Remote Services", 0.0556844251049668], ["Proxy", 0.03243527070317938], ["Software Deployment Tools", 0.027060597871596707], ["Valid Accounts", 0.026945402214604647]], "it also tries to delete the wp-sale.js file": [["Indicator Removal", 0.5458831048597943], ["Data Destruction", 0.05840416646300809], ["Service Stop", 0.02285532354907256], ["Impair Defenses", 0.01936077449216162], ["System Shutdown/Reboot", 0.016317265105776198], ["Modify Registry", 0.01470357996621321]], "obfuscated PHP code (again using character code obfuscation):": [["Obfuscated Files or Information", 0.7261403676310636], ["Deobfuscate/Decode Files or Information", 0.05482888288222951], ["Data Encoding", 0.04285562034684755], ["Data Obfuscation", 0.023844426217109686], ["Encrypted Channel", 0.011394584506113605], ["Archive Collected Data", 0.009335569401922135]], "a heavily obfuscated script": [["Obfuscated Files or Information", 0.8323570942199584], ["Deobfuscate/Decode Files or Information", 0.06036849174355402], ["Archive Collected Data", 0.006902464539453789], ["Execution Guardrails", 0.006728505615356369], ["Command and Scripting Interpreter", 0.005856210191887229], ["Encrypted Channel", 0.0051534319223675035]], "obfuscated JavaScript code": [["Obfuscated Files or Information", 0.6469630851811945], ["Deobfuscate/Decode Files or Information", 0.08362028496275838], ["Data Encoding", 0.024802965564172157], ["Data Obfuscation", 0.020855603798526752], ["Encrypted Channel", 0.018396309264833016], ["Archive Collected Data", 0.010495814387357045]], "When decoded": [["Deobfuscate/Decode Files or Information", 0.5006495920523323], ["Data Encoding", 0.13293422227447985], ["Obfuscated Files or Information", 0.10400157334387367], ["Archive Collected Data", 0.03228025182119601], ["Encrypted Channel", 0.02453150561660528], ["Data Obfuscation", 0.016285962491761247]], "When decoded, a backdoor is revealed": [["Deobfuscate/Decode Files or Information", 0.6832607668172798], ["Obfuscated Files or Information", 0.11690364054074276], ["Data Encoding", 0.03906851113829176], ["Data Obfuscation", 0.013240491532793464], ["Encrypted Channel", 0.012945822227248865], ["Archive Collected Data", 0.011068712965533425]], "sent as a POST request": [["Application Layer Protocol", 0.19871543722921942], ["Exfiltration Over C2 Channel", 0.08053207077024985], ["Data Encoding", 0.05994152923023934], ["Exfiltration Over Alternative Protocol", 0.039609553923312335], ["Web Service", 0.03214484578619389], ["Use Alternate Authentication Material", 0.024496180831346505]], "This backdoor executes arbitrary PHP code sent in POST request parameters.": [["Application Layer Protocol", 0.07527211435452011], ["Exploit Public-Facing Application", 0.04600473293646768], ["Data Encoding", 0.04419335590178577], ["Use Alternate Authentication Material", 0.04352435040107493], ["Browser Session Hijacking", 0.035164802157914975], ["Data Obfuscation", 0.029828161451339024]], "actors disable antivirus software": [["Impair Defenses", 0.48544776026844555], ["Software Discovery", 0.19208353671038747], ["Obfuscated Files or Information", 0.02931601509636314], ["Subvert Trust Controls", 0.02491392316717594], ["Masquerading", 0.011930845324264638], ["Execution Guardrails", 0.010113194706529249]], "the threat actor deactivated antivirus protocols": [["Impair Defenses", 0.5916808955141291], ["Software Discovery", 0.06734343839675495], ["Subvert Trust Controls", 0.017268608923644426], ["Obfuscated Files or Information", 0.01623309951927741], ["Modify Registry", 0.010718208844431254], ["Indicator Removal", 0.010155290504794672]], "after receiving phishing emails containing malicious PDF documents\u00a0[T": [["Phishing", 0.3882809877064753], ["User Execution", 0.14963900822748413], ["Phishing for Information", 0.031733636031090445], ["Template Injection", 0.024869302959226795], ["Email Collection", 0.02330867670396822], ["Acquire Infrastructure", 0.023195992319301483]], "for initial access is RDP compromise.": [["Remote Services", 0.3769211575126343], ["Remote Access Software", 0.10991075911952689], ["External Remote Services", 0.06101027190220127], ["Valid Accounts", 0.039872704403238785], ["Exploitation of Remote Services", 0.039072537982635644], ["Remote Service Session Hijacking", 0.02310409471021053]], "actors often use RDP to move laterally across the network": [["Remote Services", 0.4907009847904862], ["Remote Access Software", 0.07261372389506496], ["Exploitation of Remote Services", 0.05013785499943833], ["Remote Service Session Hijacking", 0.049908617867380774], ["External Remote Services", 0.033624815135909106], ["Valid Accounts", 0.03161878856120173]], "download multiple tools\u00a0": [["Ingress Tool Transfer", 0.647516838697622], ["Command and Scripting Interpreter", 0.07916700770633917], ["BITS Jobs", 0.039117545520259214], ["Application Layer Protocol", 0.011578991757078109], ["Lateral Tool Transfer", 0.010525676091224205], ["Web Service", 0.010040816603484515]], "actors gain initial access through exploiting public-facing applications\u00a0": [["Drive-by Compromise", 0.21557497368549378], ["Exploit Public-Facing Application", 0.09424573087104875], ["Stage Capabilities", 0.04375542345835817], ["Compromise Infrastructure", 0.04172221868299663], ["Trusted Relationship", 0.04033301237060879], ["Obtain Capabilities", 0.03996317782008261]], "PsExec has also been used to aid lateral movement": [["Command and Scripting Interpreter", 0.15824219252818744], ["Remote Services", 0.12531652322412246], ["Native API", 0.06765652317109701], ["System Services", 0.04252492508450261], ["System Binary Proxy Execution", 0.0329773640881585], ["Lateral Tool Transfer", 0.02752042459918426]], "actors used a legitimate admin account to remotely log on to the domain controller": [["Valid Accounts", 0.354136486885742], ["Create Account", 0.06575645460427942], ["Remote Services", 0.06182746728697878], ["Account Manipulation", 0.0353438417601336], ["Modify Authentication Process", 0.03434958934002004], ["Account Discovery", 0.028467424668810734]], "by modifying Group Policy Objects": [["Domain Policy Modification", 0.22373771186607438], ["Modify Registry", 0.09513642752824333], ["File and Directory Permissions Modification", 0.08518618289126971], ["Abuse Elevation Control Mechanism", 0.06752222193085368], ["Impair Defenses", 0.057523087835033536], ["Create or Modify System Process", 0.033993610055931184]], "force a group policy update": [["Domain Policy Modification", 0.38499823188726995], ["Impair Defenses", 0.0765477256522975], ["Abuse Elevation Control Mechanism", 0.04098539400392049], ["Modify Registry", 0.04048424799288954], ["File and Directory Permissions Modification", 0.027978718932766565], ["Create or Modify System Process", 0.022594873848316085]], "delete files upon completion\u2014including": [["Indicator Removal", 0.752603842500797], ["Data Destruction", 0.07711670811563916], ["Disk Wipe", 0.012634799336215951], ["Inhibit System Recovery", 0.010826640292555579], ["System Shutdown/Reboot", 0.008838124265609204], ["Command and Scripting Interpreter", 0.007210548643126378]], "numerous batch (.bat) files on impacted systems": [["Command and Scripting Interpreter", 0.24988539887263947], ["Scheduled Task/Job", 0.07674963132504971], ["Masquerading", 0.04956742455908845], ["System Binary Proxy Execution", 0.04898459102405326], ["Indicator Removal", 0.03767371463893292], ["System Services", 0.02989980783272465]], "Batch files create a new admin user\u00a0": [["Create Account", 0.34143527500285265], ["Valid Accounts", 0.08735916073913055], ["Account Manipulation", 0.07393312178704399], ["Account Discovery", 0.04176245147687737], ["Abuse Elevation Control Mechanism", 0.039524865688135236], ["Command and Scripting Interpreter", 0.03441092356168595]], "which are typically transferred as an encrypted 7zip file.": [["Archive Collected Data", 0.4150945214182792], ["Exfiltration Over Alternative Protocol", 0.13673456688364913], ["Obfuscated Files or Information", 0.0472164537649777], ["Deobfuscate/Decode Files or Information", 0.03679164961938103], ["Exfiltration Over C2 Channel", 0.028875634856842507], ["Data Encrypted for Impact", 0.02431373807593131]], "These strings are passed to a decoding function where they are converted from hex to byte and XOR\u2019d with decimal 18.": [["Obfuscated Files or Information", 0.3048442940870637], ["Data Encoding", 0.22451484671229513], ["Deobfuscate/Decode Files or Information", 0.1873122700984608], ["Encrypted Channel", 0.036378582977802235], ["Data Obfuscation", 0.022788347677040643], ["Archive Collected Data", 0.017169723877068634]], "the decoded strings": [["Deobfuscate/Decode Files or Information", 0.556679947697495], ["Obfuscated Files or Information", 0.15375042872490002], ["Data Encoding", 0.124842172499929], ["Archive Collected Data", 0.014990108094660101], ["Encrypted Channel", 0.01247636867021821], ["Data Obfuscation", 0.012171518469229165]], "Once decoded": [["Deobfuscate/Decode Files or Information", 0.5571675148049164], ["Data Encoding", 0.13166425506733875], ["Obfuscated Files or Information", 0.0852150675906485], ["Archive Collected Data", 0.028047926844425586], ["Encrypted Channel", 0.021865123714112096], ["Data Obfuscation", 0.015976038971268897]], "Base64 decodes the payload content": [["Deobfuscate/Decode Files or Information", 0.3714698343769155], ["Data Encoding", 0.2891517338936314], ["Obfuscated Files or Information", 0.19374194043252607], ["Archive Collected Data", 0.021254938758761437], ["Data Obfuscation", 0.019110049300363648], ["Encrypted Channel", 0.013654616598643513]], "to decode the second buffer using key 58 3E 88 D0": [["Deobfuscate/Decode Files or Information", 0.45658512445130095], ["Obfuscated Files or Information", 0.08422762134549876], ["Encrypted Channel", 0.06311639144561529], ["Data Encoding", 0.04907898949701087], ["Data Obfuscation", 0.021539754607092967], ["Archive Collected Data", 0.018175832118262375]], "decoded by Shellcode": [["Deobfuscate/Decode Files or Information", 0.6368031986516621], ["Obfuscated Files or Information", 0.18925464280226795], ["Data Encoding", 0.04147887634755167], ["Encrypted Channel", 0.009498195686919994], ["Archive Collected Data", 0.008230323470256982], ["Native API", 0.007534728563547949]], "These strings are passed to a\nde-obfuscation function": [["Obfuscated Files or Information", 0.6042016719827955], ["Deobfuscate/Decode Files or Information", 0.20046137849326226], ["Data Encoding", 0.04894920503537611], ["Archive Collected Data", 0.015067851525242662], ["Data Obfuscation", 0.013229065767502065], ["Encrypted Channel", 0.008189049752387968]], "PowerShell de-obfuscation routine": [["Deobfuscate/Decode Files or Information", 0.3876072346647531], ["Obfuscated Files or Information", 0.3804961091711994], ["Archive Collected Data", 0.01877379249521753], ["Data Encoding", 0.010676849132924443], ["Data Obfuscation", 0.009920086055590752], ["Hide Artifacts", 0.009099280712115135]], "this shellcode is responsible for fetching Remcos RAT": [["Impair Defenses", 0.041186927374980385], ["Query Registry", 0.039161789657514996], ["Virtualization/Sandbox Evasion", 0.03539855562156646], ["Command and Scripting Interpreter", 0.03201931941529357], ["System Binary Proxy Execution", 0.030925901389125075], ["Deobfuscate/Decode Files or Information", 0.029794966963609736]], "used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers": [["Command and Scripting Interpreter", 0.2630957927825811], ["Native API", 0.06868130457342946], ["Ingress Tool Transfer", 0.06571305973147092], ["Obfuscated Files or Information", 0.062434356678852415], ["Process Injection", 0.052988058103818694], ["System Binary Proxy Execution", 0.04527248242297048]], "retrieves a decoy tax document and VBS script.": [["Deobfuscate/Decode Files or Information", 0.10025620074677194], ["Command and Scripting Interpreter", 0.057847316693458585], ["Template Injection", 0.05532729795563355], ["Office Application Startup", 0.05336472102159608], ["Obfuscated Files or Information", 0.045186869495836404], ["Hide Artifacts", 0.038635005329608854]], "copying the current process command line as a new argument": [["Process Injection", 0.2404339392106005], ["Native API", 0.2003554811535121], ["Process Discovery", 0.17296550827594354], ["Access Token Manipulation", 0.06578060373248205], ["System Services", 0.01943270636054548], ["OS Credential Dumping", 0.014851619080340066]], "full command line argument": [["Command and Scripting Interpreter", 0.39173851894740386], ["Indirect Command Execution", 0.17061973481623843], ["Native API", 0.0757908722029503], ["System Binary Proxy Execution", 0.027694005440123286], ["System Services", 0.017539934823665247], ["Obfuscated Files or Information", 0.013841841327775542]], "a single payload\npackage is retrieved that contains both the two-stage shellcode": [["Obfuscated Files or Information", 0.3138285797640794], ["Deobfuscate/Decode Files or Information", 0.08571341864226852], ["Command and Scripting Interpreter", 0.04310394976546957], ["Execution Guardrails", 0.04250082804194352], ["Hijack Execution Flow", 0.04006645113270244], ["Ingress Tool Transfer", 0.0398876877892152]], "highly obfuscated commands and encrypted shellcode.": [["Obfuscated Files or Information", 0.6932383836281202], ["Deobfuscate/Decode Files or Information", 0.055214813657301756], ["Encrypted Channel", 0.03930081753025643], ["Data Encoding", 0.020179964680811763], ["Execution Guardrails", 0.018024649328639415], ["Data Obfuscation", 0.014232094950918848]], "The PowerShell command contains various obfuscated strings": [["Obfuscated Files or Information", 0.7575306796424454], ["Deobfuscate/Decode Files or Information", 0.05921155344241576], ["Command and Scripting Interpreter", 0.01860785984673652], ["Data Encoding", 0.013362742507714364], ["Masquerading", 0.012114906391732027], ["Data Obfuscation", 0.009956187231095101]], "inject Remcos RAT into a legitimate Windows process such as ieinstal.exe.": [["Process Injection", 0.16329253235299795], ["Event Triggered Execution", 0.09156343567549095], ["System Binary Proxy Execution", 0.08228512530599102], ["Impair Defenses", 0.0513184821087491], ["Masquerading", 0.04624849975466566], ["Boot or Logon Autostart Execution", 0.04028707434668052]], "injecting it into ieinstall.exe": [["Process Injection", 0.18958851431557977], ["System Binary Proxy Execution", 0.1328009733846334], ["Boot or Logon Autostart Execution", 0.055334803775462876], ["Event Triggered Execution", 0.04656886083653578], ["Command and Scripting Interpreter", 0.04530494871121396], ["Masquerading", 0.042986334561035164]], "execution begins with the user clicking on a shortcut file": [["Boot or Logon Autostart Execution", 0.20029163618996484], ["User Execution", 0.10850788985716571], ["Command and Scripting Interpreter", 0.09047486814414127], ["Event Triggered Execution", 0.07185512644835357], ["Native API", 0.05614635393888494], ["System Binary Proxy Execution", 0.04991041762045326]], "executed by the user clicking a shortcut file": [["Boot or Logon Autostart Execution", 0.31339017193300966], ["User Execution", 0.13904687648343494], ["Command and Scripting Interpreter", 0.057889736819505405], ["Office Application Startup", 0.05692065870341635], ["Event Triggered Execution", 0.03964805961093173], ["Masquerading", 0.03214868667721251]], "enticing users to click on malicious shortcut files": [["User Execution", 0.9098671288130121], ["Phishing", 0.013121467195196471], ["Masquerading", 0.009241582455303946], ["Boot or Logon Autostart Execution", 0.008061716646956903], ["Office Application Startup", 0.005711331439278755], ["Drive-by Compromise", 0.0035294700533637395]], "checks if the system is 64-bit": [["System Information Discovery", 0.45353580364652596], ["Virtualization/Sandbox Evasion", 0.1329310927968719], ["Software Discovery", 0.04854759058965748], ["Obfuscated Files or Information", 0.031852893032665135], ["Execution Guardrails", 0.01954290991129721], ["Query Registry", 0.018292999092680978]], "remote access and surveillance features": [["Remote Access Software", 0.179961054856392], ["Video Capture", 0.0815825498478161], ["Software Deployment Tools", 0.04679757922817063], ["External Remote Services", 0.030948459436068717], ["Impair Defenses", 0.026994618334845975], ["Remote Services", 0.0221921719711898]], "screenshots": [["Screen Capture", 0.8268437209122743], ["Video Capture", 0.013558081657308358], ["Application Window Discovery", 0.009185282552799347], ["Data from Local System", 0.007756444159708909], ["Input Capture", 0.005431253833077447], ["Clipboard Data", 0.00489008840375047]], "highly obfuscated and contains junk code to impede analysis.": [["Obfuscated Files or Information", 0.7060892283773761], ["Deobfuscate/Decode Files or Information", 0.05784608532711503], ["Archive Collected Data", 0.017602965376760482], ["Execution Guardrails", 0.010212461520310905], ["Encrypted Channel", 0.010132389415037598], ["Hide Artifacts", 0.00933734856782986]], "The script concatenates hundreds of smaller strings into a single variable which ultimately builds and executes": [["Command and Scripting Interpreter", 0.33067169367319177], ["Obfuscated Files or Information", 0.20588460966377406], ["Native API", 0.04137960277037038], ["Automated Collection", 0.028064494047488515], ["Deobfuscate/Decode Files or Information", 0.021965509409704098], ["Masquerading", 0.015441069499741536]], "The payload would then be decrypted through XOR": [["Deobfuscate/Decode Files or Information", 0.657631767997299], ["Obfuscated Files or Information", 0.11391724640944892], ["Encrypted Channel", 0.03201213145125936], ["Archive Collected Data", 0.025745179204261802], ["Data Encrypted for Impact", 0.02419357390561888], ["Execution Guardrails", 0.018178403783257736]], "use a set of tools via remote desktop": [["Remote Services", 0.5268016457111007], ["Remote Access Software", 0.17405611840917676], ["Command and Scripting Interpreter", 0.032994791383270126], ["Remote Service Session Hijacking", 0.01682835729120689], ["Lateral Tool Transfer", 0.016519990970773772], ["Windows Management Instrumentation", 0.01599451019777138]], "the ransomware drops a batch file": [["Command and Scripting Interpreter", 0.20660175940124906], ["Indicator Removal", 0.07729127090466227], ["Masquerading", 0.06878655774751292], ["Data Encrypted for Impact", 0.06644310872148863], ["System Binary Proxy Execution", 0.043699378849687394], ["Scheduled Task/Job", 0.027591958045896505]], "to steal system information like machine details": [["System Information Discovery", 0.693605441598357], ["Windows Management Instrumentation", 0.030250979396456375], ["OS Credential Dumping", 0.02790608431496567], ["Virtualization/Sandbox Evasion", 0.017543550002938665], ["Automated Collection", 0.01676512980407099], ["Data from Configuration Repository", 0.01442560571033197]], "the payload most likely arrives by exploiting public-facing websites and domains.": [["Stage Capabilities", 0.12560368836184369], ["Drive-by Compromise", 0.09492688879516056], ["Phishing", 0.056690427718937134], ["Exploit Public-Facing Application", 0.053543135794883866], ["Ingress Tool Transfer", 0.03831388382478471], ["Obtain Capabilities", 0.03565222220089303]], "targeted vulnerabilities in Microsoft SQL (MS SQL) Server for initial access": [["Exploit Public-Facing Application", 0.28654771382349553], ["Exploitation of Remote Services", 0.06041142284202647], ["Obtain Capabilities", 0.053701468442765826], ["Exploitation for Client Execution", 0.0529738906092792], ["Server Software Component", 0.036672900277427235], ["Develop Capabilities", 0.03213850249795322]], "the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server": [["Deobfuscate/Decode Files or Information", 0.34968032454326065], ["Obfuscated Files or Information", 0.1472975337786576], ["Command and Scripting Interpreter", 0.14250784170411693], ["Ingress Tool Transfer", 0.05527089722871854], ["Archive Collected Data", 0.029038450174969196], ["Encrypted Channel", 0.015923300773659686]], "used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.": [["Impair Defenses", 0.2278900003192955], ["Indicator Removal", 0.2092135878257986], ["Software Discovery", 0.12925165354438242], ["Windows Management Instrumentation", 0.042795889750577465], ["Inhibit System Recovery", 0.028015562842010795], ["Modify Registry", 0.019959135547837223]], "to terminate security-related processes and services by dropping KILLAV": [["Impair Defenses", 0.30857589474095637], ["Service Stop", 0.23271266753593428], ["System Shutdown/Reboot", 0.04545604951732433], ["Indicator Removal", 0.02852300254198116], ["Process Injection", 0.015168877720597076], ["Create or Modify System Process", 0.014322556251806657]], "the threat actors who perform brute-force attacks on MS SQL Servers.": [["Brute Force", 0.2874803189437908], ["Exploit Public-Facing Application", 0.04841881830467145], ["Active Scanning", 0.04198198530956346], ["Gather Victim Identity Information", 0.03991367653167103], ["Steal or Forge Kerberos Tickets", 0.03469493540633098], ["Endpoint Denial of Service", 0.03311804876179675]], "executed a spam campaign with malicious OneNote file attachments,": [["Phishing", 0.45315315828959285], ["User Execution", 0.3236866987664068], ["Phishing for Information", 0.014978288330323027], ["Template Injection", 0.013722572339317781], ["Drive-by Compromise", 0.008516388710567828], ["Stage Capabilities", 0.007437394751621515]], "The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers": [["Email Collection", 0.14879166984934103], ["Compromise Infrastructure", 0.0960565751635516], ["Compromise Accounts", 0.04798985529639912], ["Acquire Infrastructure", 0.0449995430303738], ["Phishing", 0.042776394562775], ["Network Denial of Service", 0.029754106944801403]], "The malware implemented a series of Mimikatz modifications on closed-source tooling": [["Develop Capabilities", 0.10230308351328801], ["Obfuscated Files or Information", 0.09735707993223937], ["Obtain Capabilities", 0.06114566212976693], ["Compromise Client Software Binary", 0.044393802711581734], ["Subvert Trust Controls", 0.039974776548984514], ["Modify System Image", 0.03735611485712322]], "staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities": [["OS Credential Dumping", 0.5046339908243332], ["Access Token Manipulation", 0.05055884056648499], ["Modify Authentication Process", 0.04151145710218053], ["Abuse Elevation Control Mechanism", 0.029558845778238526], ["Credentials from Password Stores", 0.023755377597467684], ["Command and Scripting Interpreter", 0.01757498202961231]], "In order to steal credentials, the attackers employ custom modified versions of Mimikatz": [["Credentials from Password Stores", 0.17599205682276087], ["OS Credential Dumping", 0.16333603559014614], ["Unsecured Credentials", 0.11045143107532725], ["Modify Authentication Process", 0.058199507527468594], ["Brute Force", 0.04970943368028223], ["Forced Authentication", 0.04177781524093362]], "stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.": [["OS Credential Dumping", 0.3809406564339856], ["Credentials from Password Stores", 0.12567112402397965], ["Unsecured Credentials", 0.10622207769506464], ["Modify Authentication Process", 0.051111672631080976], ["Valid Accounts", 0.03474874729044984], ["Brute Force", 0.027936967395644666]], "Mimikatz publicly available code (top); strings from a Mimikatz modification": [["Obfuscated Files or Information", 0.35332633077264475], ["Masquerading", 0.05523222933816054], ["Deobfuscate/Decode Files or Information", 0.04890145515323559], ["Data Manipulation", 0.03138038086702085], ["OS Credential Dumping", 0.02052088212155385], ["Web Service", 0.018823452914103575]], "This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.": [["OS Credential Dumping", 0.5192997022633304], ["Credentials from Password Stores", 0.023254342966227446], ["System Binary Proxy Execution", 0.022522827897159443], ["Deobfuscate/Decode Files or Information", 0.02124982028608953], ["Unsecured Credentials", 0.019472919769016488], ["Native API", 0.017914119784828895]], "accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file": [["OS Credential Dumping", 0.481952991848503], ["Credentials from Password Stores", 0.05875416504478804], ["Input Capture", 0.0524522116715578], ["Unsecured Credentials", 0.028694762164864433], ["Data from Local System", 0.024686088104189596], ["Data Staged", 0.024119039873423034]], "of a Security Package into LSASS using RPC calls.": [["Software Discovery", 0.15566862713965784], ["Query Registry", 0.10230024922354104], ["Obfuscated Files or Information", 0.0416517760193125], ["OS Credential Dumping", 0.037308057853576694], ["Hijack Execution Flow", 0.03175511820676281], ["Unsecured Credentials", 0.026327474103716]], "steals credentials from LSASS": [["OS Credential Dumping", 0.47380685256139987], ["Unsecured Credentials", 0.12973316911114138], ["Credentials from Password Stores", 0.12376676559003637], ["Input Capture", 0.031490742462480306], ["Brute Force", 0.018531807944094435], ["Command and Scripting Interpreter", 0.014654506054361522]], "The threat actors used C:\\MS_DATA as their main working directory for storing malware and staging data for exfiltration": [["Data Staged", 0.3790616229353421], ["Indicator Removal", 0.059862248670693084], ["Data from Local System", 0.05647050078268974], ["File and Directory Discovery", 0.04779665795015747], ["Hide Artifacts", 0.03663711073571225], ["Archive Collected Data", 0.03371163576100192]], "and Remote Desktop user sessions.": [["Remote Services", 0.18625603235907323], ["Remote Service Session Hijacking", 0.12648104952395323], ["Remote Access Software", 0.06634592235553198], ["Event Triggered Execution", 0.03163007108598352], ["Account Access Removal", 0.03066221465020125], ["External Remote Services", 0.030456789382619448]], "\"cmd\"\u00a0 /c": [["Command and Scripting Interpreter", 0.27821598941458037], ["Indirect Command Execution", 0.13883129475240188], ["Native API", 0.0464956116570924], ["Boot or Logon Autostart Execution", 0.026939356929489098], ["File and Directory Discovery", 0.02362398736090109], ["System Binary Proxy Execution", 0.0223005603933724]], "cmd\"\u00a0 /c": [["Command and Scripting Interpreter", 0.13256741302750555], ["Indicator Removal", 0.12566834157900877], ["File and Directory Discovery", 0.05698326161749206], ["Indirect Command Execution", 0.05052392817328396], ["Masquerading", 0.03244365450961658], ["Native API", 0.029318778585137078]], "They also retrieve networking information, like network adapters, specific machines, and network services like\u00a0 Remote Desktop Protocol (RDP).": [["System Network Configuration Discovery", 0.33861727364773414], ["System Network Connections Discovery", 0.23644957740648878], ["Remote System Discovery", 0.08381353490412377], ["Data from Configuration Repository", 0.052069351792610026], ["System Information Discovery", 0.03217435616603753], ["Network Service Discovery", 0.02677920216206951]], "For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines.": [["Remote Services", 0.5147586339510035], ["Exploitation of Remote Services", 0.09567113576309867], ["Lateral Tool Transfer", 0.08499390993329371], ["Taint Shared Content", 0.04963431620772426], ["Valid Accounts", 0.027365701083416454], ["Network Share Discovery", 0.023028323662538003]], "and the PsExec Windows Sysinternals tool and net for lateral movement and exploration": [["Native API", 0.07594452359534379], ["Application Window Discovery", 0.06971771006088735], ["Boot or Logon Autostart Execution", 0.06921662514346769], ["Remote Services", 0.06554939113310061], ["Windows Management Instrumentation", 0.05840086984888226], ["Command and Scripting Interpreter", 0.038716608472583874]], "loads and executes the decrypted": [["Deobfuscate/Decode Files or Information", 0.7429307392173786], ["Data Encrypted for Impact", 0.043707669182080564], ["Obfuscated Files or Information", 0.039240437890779765], ["Archive Collected Data", 0.019647025307589567], ["Encrypted Channel", 0.013340417826212805], ["Weaken Encryption", 0.00935923174641416]], "pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm": [["Deobfuscate/Decode Files or Information", 0.4041080837219152], ["Obfuscated Files or Information", 0.2386029012959482], ["Data Encrypted for Impact", 0.08037765582868066], ["Encrypted Channel", 0.04972990657788825], ["Archive Collected Data", 0.030498629643246688], ["Weaken Encryption", 0.01881900242008164]], "pc.dll decrypts,": [["Deobfuscate/Decode Files or Information", 0.78544288666224], ["Obfuscated Files or Information", 0.06859862822341828], ["Data Encrypted for Impact", 0.022341942902904963], ["Archive Collected Data", 0.015190746063407697], ["Encrypted Channel", 0.011822103656747927], ["Weaken Encryption", 0.005342063577083656]], "Disabling Windows event logging in an attempt to evade detection": [["Impair Defenses", 0.47866989939376625], ["Indicator Removal", 0.11586209749485095], ["Hide Artifacts", 0.04656849650781793], ["Masquerading", 0.03775200652764835], ["Event Triggered Execution", 0.024493012292423268], ["Virtualization/Sandbox Evasion", 0.019744503107792265]], "In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself": [["Impair Defenses", 0.5877029037372917], ["Indicator Removal", 0.10090479003708687], ["Masquerading", 0.024230051365404272], ["Event Triggered Execution", 0.018434662615085414], ["Service Stop", 0.01621206086105289], ["Modify Registry", 0.014247596251026482]], "Injecting pc.dll into LSASS as a Security Package": [["Hijack Execution Flow", 0.2316602393706587], ["Process Injection", 0.11086646840461926], ["System Binary Proxy Execution", 0.09579174740655665], ["Shared Modules", 0.06806113161529358], ["Boot or Logon Autostart Execution", 0.0544272689298824], ["Obfuscated Files or Information", 0.03375458817894544]], "to execute malicious code in the context of LSASS.": [["Native API", 0.15273964298685014], ["System Binary Proxy Execution", 0.07630790609158544], ["Deobfuscate/Decode Files or Information", 0.06371424523964538], ["Obfuscated Files or Information", 0.051738984816853344], ["Command and Scripting Interpreter", 0.05038366019559442], ["OS Credential Dumping", 0.04365043529131777]], "enumerating the processes\u2019 threads,": [["Process Discovery", 0.7358772216005185], ["Process Injection", 0.02740531742101827], ["Native API", 0.021165682723710656], ["Virtualization/Sandbox Evasion", 0.01522085621724864], ["System Service Discovery", 0.013745918029541934], ["Windows Management Instrumentation", 0.011762144720263889]], "tasklist": [["Process Discovery", 0.3310352125273902], ["System Service Discovery", 0.0828357910092791], ["Masquerading", 0.05513066838009788], ["Scheduled Task/Job", 0.05472734007616806], ["Windows Management Instrumentation", 0.023138622520784767], ["Impair Defenses", 0.01779341806122338]], "informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package": [["Hijack Execution Flow", 0.17957435571751268], ["Process Injection", 0.128603537991834], ["System Binary Proxy Execution", 0.09178374032345468], ["Shared Modules", 0.0595502359364682], ["Obfuscated Files or Information", 0.04613061791235593], ["Boot or Logon Autostart Execution", 0.03859909999289598]], "embedded JavaScript Observed Notation (JSON)-based configuration to set parameters": [["Obfuscated Files or Information", 0.0787707336583963], ["Modify Registry", 0.05833841464216842], ["Command and Scripting Interpreter", 0.051603830596896674], ["Dynamic Resolution", 0.03329603009274815], ["Query Registry", 0.029315079239991215], ["Execution Guardrails", 0.02416268542502192]], "text-encoded in base64": [["Data Encoding", 0.3583642289597959], ["Obfuscated Files or Information", 0.32624062591848074], ["Deobfuscate/Decode Files or Information", 0.14987321591459238], ["Archive Collected Data", 0.026094785941251863], ["Data Obfuscation", 0.020237145575637088], ["Encrypted Channel", 0.01385022267954502]], "brute-force attacks": [["Brute Force", 0.614886505019862], ["Multi-Factor Authentication Interception", 0.02744237000058206], ["Steal or Forge Kerberos Tickets", 0.023138210084675818], ["Use Alternate Authentication Material", 0.020800445857951867], ["Modify Authentication Process", 0.01275934508859244], ["Endpoint Denial of Service", 0.012220163973289623]], "brute-forcing and compromising servers": [["Brute Force", 0.5198535950853904], ["Steal or Forge Kerberos Tickets", 0.02664777193566826], ["Endpoint Denial of Service", 0.02585458620015114], ["Use Alternate Authentication Material", 0.02062503893005372], ["Compromise Infrastructure", 0.018914477480800416], ["Exploit Public-Facing Application", 0.01693644629290076]], "Valid credentials": [["Valid Accounts", 0.09359060331301805], ["Modify Authentication Process", 0.0776581095954747], ["Brute Force", 0.0769883007084577], ["Forced Authentication", 0.059396776795505285], ["Exploitation for Credential Access", 0.05440806674523741], ["Input Capture", 0.0412905173413682]], "uploaded to the command-and-control (C&C) server,": [["Ingress Tool Transfer", 0.17850446493807237], ["Data from Local System", 0.09838345214400973], ["Automated Exfiltration", 0.06191010157862144], ["Data Staged", 0.05972353838116546], ["Web Service", 0.04230761625446234], ["Screen Capture", 0.039111424682224616]], "usually at port 5028/TCP": [["Non-Standard Port", 0.23351631746778265], ["Network Service Discovery", 0.1721134936489459], ["Non-Application Layer Protocol", 0.07073322192411828], ["System Network Connections Discovery", 0.06106867135866874], ["Traffic Signaling", 0.04650993111794599], ["Dynamic Resolution", 0.04437790411824144]], "use several highly obfuscated and underdevelopment custom loaders": [["Obfuscated Files or Information", 0.6728389006599684], ["Deobfuscate/Decode Files or Information", 0.05112398954297599], ["Hijack Execution Flow", 0.03237722807272935], ["Masquerading", 0.02312307852782526], ["System Binary Proxy Execution", 0.019700118460653795], ["Process Injection", 0.0184703036319349]], "malicious RAR archive": [["Archive Collected Data", 0.37441969114678636], ["Deobfuscate/Decode Files or Information", 0.08311411687385145], ["Obfuscated Files or Information", 0.047470007334030374], ["Automated Collection", 0.029877179084797967], ["Exfiltration Over C2 Channel", 0.02962040892531542], ["Masquerading", 0.024127549265270654]], "exploits CVE-2015-2291, an Intel driver vulnerability, to load a malicious driver designed to reduce the token integrity of Microsoft Defender.": [["Multi-Factor Authentication Interception", 0.10827339343327239], ["Access Token Manipulation", 0.09027734941778524], ["Subvert Trust Controls", 0.08953778347404444], ["Boot or Logon Autostart Execution", 0.030989594212688428], ["Pre-OS Boot", 0.03074446620522126], ["Masquerading", 0.027064281335413998]], "deploying a malicious kernel mode driver (\u201cbring your own vulnerable driver\u201d or BYOVD method) via exploiting a vulnerable Intel driver": [["Exploitation for Privilege Escalation", 0.15828352258223424], ["Pre-OS Boot", 0.09563224389479055], ["Subvert Trust Controls", 0.05415418535826582], ["Process Injection", 0.03663088378298501], ["Modify System Image", 0.03562412832618649], ["Exploitation of Remote Services", 0.033684134926353027]], "install an information stealer.": [["Data from Information Repositories", 0.11062067091003906], ["Automated Collection", 0.05693065423469151], ["Email Collection", 0.04254374035013835], ["Data from Local System", 0.03921243212778503], ["Cloud Service Dashboard", 0.03544312862076275], ["Web Service", 0.030811211062997022]], "stealer,": [["Masquerading", 0.028927752091687447], ["Access Token Manipulation", 0.02661910445188735], ["OS Credential Dumping", 0.022140330841815405], ["Deobfuscate/Decode Files or Information", 0.021041251791958964], ["Data from Network Shared Drive", 0.019595393341693287], ["Data from Local System", 0.017307694748450578]], "keylogger with logging capabilities using the Telegram API": [["Input Capture", 0.7675815731143201], ["Network Sniffing", 0.009303858806943913], ["Unsecured Credentials", 0.008757709660428842], ["Impair Defenses", 0.0068528703782795505], ["Encrypted Channel", 0.006758893391617279], ["Screen Capture", 0.006542251149670472]], "distributed to victims via phishing attempts": [["Phishing", 0.267351532011915], ["Phishing for Information", 0.1360271259427769], ["User Execution", 0.11604566894963829], ["Internal Spearphishing", 0.07822002133527559], ["Drive-by Compromise", 0.04551808941992125], ["Defacement", 0.034223499456391165]], "embedded binary files": [["Obfuscated Files or Information", 0.28197040744119417], ["Deobfuscate/Decode Files or Information", 0.06396363349254648], ["System Binary Proxy Execution", 0.057390071835355036], ["Hijack Execution Flow", 0.052334096144337115], ["Masquerading", 0.049334275745594056], ["User Execution", 0.046079265595495265]], "archive contains the files,": [["Archive Collected Data", 0.18218193811956374], ["Automated Collection", 0.1262791567959585], ["Data from Local System", 0.10848298311050175], ["Data Staged", 0.08574198359360101], ["File and Directory Discovery", 0.061325402420371544], ["Data from Network Shared Drive", 0.03394028776440774]], "deobfuscate, decompress,": [["Deobfuscate/Decode Files or Information", 0.40984133461628863], ["Archive Collected Data", 0.20214699222739888], ["Obfuscated Files or Information", 0.12461709467938666], ["Data Encrypted for Impact", 0.020742486629077406], ["Exfiltration Over Alternative Protocol", 0.017615294986172703], ["Hide Artifacts", 0.01395190203884589]], "decrypts strings": [["Deobfuscate/Decode Files or Information", 0.683944119444099], ["Obfuscated Files or Information", 0.0915747120499782], ["Data Encoding", 0.034184486086031585], ["Encrypted Channel", 0.030510774333977024], ["Data Encrypted for Impact", 0.024237341503373276], ["Archive Collected Data", 0.022582411121511426]], "deobfuscation, and decompression": [["Deobfuscate/Decode Files or Information", 0.4723206281952894], ["Obfuscated Files or Information", 0.16593106863961218], ["Archive Collected Data", 0.13918191093283533], ["Data Encrypted for Impact", 0.01519127365034754], ["Exfiltration Over Alternative Protocol", 0.014010210758113166], ["Hide Artifacts", 0.01140604434391329]], "decompressing": [["Archive Collected Data", 0.4482818982350181], ["Deobfuscate/Decode Files or Information", 0.21448240299261162], ["Obfuscated Files or Information", 0.07072153593268618], ["Exfiltration Over Alternative Protocol", 0.02033425599413358], ["Data Encrypted for Impact", 0.01848461588404508], ["Exfiltration Over C2 Channel", 0.012424149963810973]], "decompresses it using the GZipStream API,": [["Archive Collected Data", 0.4736642113201696], ["Deobfuscate/Decode Files or Information", 0.22676510800190586], ["Obfuscated Files or Information", 0.05316947442034172], ["Exfiltration Over Alternative Protocol", 0.024288720679126807], ["Data Encoding", 0.014307306618569441], ["Automated Collection", 0.013576857070398737]], "masquerades as a legitimate word document": [["Template Injection", 0.40543471681412785], ["Masquerading", 0.07986422358483729], ["Office Application Startup", 0.07250508109184109], ["User Execution", 0.06781238678909775], ["Phishing", 0.049893769323583054], ["Data Manipulation", 0.02073445270260428]], "legitimize the package in the eyes of the victim": [["Masquerading", 0.1603974831741205], ["Subvert Trust Controls", 0.15551756640664458], ["Supply Chain Compromise", 0.12378718552606513], ["Develop Capabilities", 0.05546417241327387], ["Obfuscated Files or Information", 0.05029012963241236], ["Obtain Capabilities", 0.04339241097440312]], "designed to lure unsuspecting victims into executing the loader.": [["Hijack Execution Flow", 0.08672559711071201], ["Masquerading", 0.06600307457501531], ["System Binary Proxy Execution", 0.06096037971038505], ["Shared Modules", 0.058611064869088285], ["Command and Scripting Interpreter", 0.04646259487505144], ["Obfuscated Files or Information", 0.040386290734470996]], "is executed by the victim": [["System Owner/User Discovery", 0.05794879356051318], ["Process Discovery", 0.04860712109524302], ["Event Triggered Execution", 0.044103764738216825], ["Virtualization/Sandbox Evasion", 0.04405119977979016], ["Execution Guardrails", 0.043011881047860336], ["System Location Discovery", 0.02831124057672377]], "utilizes Telegram for delivering payloads": [["Application Layer Protocol", 0.2400136906366913], ["Web Service", 0.08990591990230676], ["Data Obfuscation", 0.0488348237580517], ["Phishing", 0.032488606915177964], ["Encrypted Channel", 0.029995060859133414], ["Exfiltration Over Alternative Protocol", 0.026347690107801768]], "download": [["Ingress Tool Transfer", 0.35845279459367624], ["BITS Jobs", 0.07050270780735562], ["Application Layer Protocol", 0.03301568635180688], ["Obtain Capabilities", 0.026111117548700026], ["Command and Scripting Interpreter", 0.021896543712205386], ["Stage Capabilities", 0.019766011124458874]], "used to send program execution DEBUG and Telegram to deliver payloads and send commands.": [["Web Service", 0.11533909482174101], ["Application Layer Protocol", 0.09832052386514693], ["Data Obfuscation", 0.044118656420855044], ["Command and Scripting Interpreter", 0.03320799954701251], ["Inter-Process Communication", 0.03266537655640548], ["Non-Application Layer Protocol", 0.031095567935937016]], "downloads the next part": [["Ingress Tool Transfer", 0.47186095639718806], ["Command and Scripting Interpreter", 0.08589670102301672], ["BITS Jobs", 0.041882749539891], ["Multi-Stage Channels", 0.019091260947852982], ["Data Staged", 0.01653537798735038], ["Data Transfer Size Limits", 0.014526470243427366]], "utilizes Telegram for delivering payloads, sending commands, and receiving the payload heartbeat.": [["Application Layer Protocol", 0.0881974757965711], ["Web Service", 0.08481592548517816], ["Non-Application Layer Protocol", 0.06662762521668093], ["Data Obfuscation", 0.05224639733309972], ["Fallback Channels", 0.0385873943143258], ["Encrypted Channel", 0.03423438386611247]], "send commands.": [["Command and Scripting Interpreter", 0.2739072610500558], ["Web Service", 0.07687704266452229], ["System Services", 0.06007025744623084], ["Remote Services", 0.03443457718258718], ["Inter-Process Communication", 0.03148029851563302], ["Indirect Command Execution", 0.02561737715058928]], "sends a request to the attacker-controlled Telegram channel": [["Application Layer Protocol", 0.08364563742235212], ["Web Service", 0.07051506267861928], ["Data Obfuscation", 0.049954054245016005], ["Fallback Channels", 0.03434302549328207], ["Endpoint Denial of Service", 0.02958811019871577], ["Encrypted Channel", 0.027962484765923494]], "sends the message \"bot getted\" to the debug server.": [["Virtualization/Sandbox Evasion", 0.28102220389457044], ["Impair Defenses", 0.030633983732706115], ["System Owner/User Discovery", 0.02940690398722166], ["Process Discovery", 0.02736788770369673], ["System Information Discovery", 0.023610460840094563], ["Native API", 0.023147183082317318]], "accepts commands from a Telegram channel,": [["Web Service", 0.28678717937300524], ["Application Layer Protocol", 0.05853931515812723], ["Data Obfuscation", 0.02327891901931421], ["Fallback Channels", 0.023011338066005957], ["Encrypted Channel", 0.021018913794824186], ["Command and Scripting Interpreter", 0.019699428785407657]], "message to both the Debug server and the Telegram channel,": [["Web Service", 0.08566988685080396], ["Fallback Channels", 0.05750260855300069], ["Phishing", 0.024638080918729266], ["Impair Defenses", 0.02389417570351667], ["Defacement", 0.01948692757894211], ["Obtain Capabilities", 0.01902973320413872]], "sends a GET request to\u00a0 https://api[.]telegram[.]org/bot{token}/getUpdates to retrieve the command": [["Web Service", 0.09815481170065254], ["Steal or Forge Kerberos Tickets", 0.029067639744729003], ["Unsecured Credentials", 0.023450078517352677], ["Email Collection", 0.022657490130559878], ["Automated Collection", 0.022285020648342743], ["System Information Discovery", 0.021136283719266367]], "API hashing": [["Use Alternate Authentication Material", 0.17323692403472318], ["Obfuscated Files or Information", 0.09612265323180155], ["Data Encoding", 0.08688737514597508], ["Steal or Forge Kerberos Tickets", 0.059553604749396825], ["Adversary-in-the-Middle", 0.05349801254005049], ["Data Obfuscation", 0.03403314942807394]], "resolves hashed Windows APIs": [["Native API", 0.15484128377114373], ["Masquerading", 0.14221619282786196], ["Obfuscated Files or Information", 0.06323625033090263], ["Use Alternate Authentication Material", 0.05853992443094817], ["Deobfuscate/Decode Files or Information", 0.03357116879073997], ["Steal or Forge Kerberos Tickets", 0.023336196860156342]], "conceal the utilization of potentially suspicious APIs (functions) from static detection": [["Hijack Execution Flow", 0.16135960990171616], ["Obfuscated Files or Information", 0.07860461803646683], ["Rootkit", 0.0645092163920883], ["Hide Artifacts", 0.0436010626550472], ["Masquerading", 0.041671639680388776], ["Shared Modules", 0.03369497774908539]], "replacing the human-readable names of functions (such as \"CreateMutexW\") with a hash value,": [["Obfuscated Files or Information", 0.16746210072947681], ["Masquerading", 0.11379750799932918], ["Use Alternate Authentication Material", 0.08563314513702625], ["Adversary-in-the-Middle", 0.031095465521672118], ["Native API", 0.021396344283502632], ["Dynamic Resolution", 0.02120090951447315]], "used in the code to call the corresponding API function": [["Native API", 0.43874722292743296], ["Hijack Execution Flow", 0.033236386772495095], ["Shared Modules", 0.03270401008891977], ["System Services", 0.023729407193275848], ["Process Injection", 0.015879166496730584], ["Masquerading", 0.01540789245336831]], "employs dynamic API resolving to conceal its API imports": [["Hijack Execution Flow", 0.13864176708068485], ["Masquerading", 0.11748926848514554], ["Native API", 0.11600919409929966], ["Obfuscated Files or Information", 0.033780256626730155], ["Hide Artifacts", 0.031812255087740236], ["Shared Modules", 0.02985224401647669]], "storing the names or hashes of the APIs needed, then importing them dynamically at runtime.": [["Native API", 0.23978579513699638], ["Hijack Execution Flow", 0.08009619975819023], ["Masquerading", 0.035846482910809045], ["Obfuscated Files or Information", 0.031759487968623774], ["Shared Modules", 0.030533079350609657], ["Deobfuscate/Decode Files or Information", 0.019570652184464313]], "passes two arguments to the \"mw_resolveAPI\" function.": [["Native API", 0.1140611269899339], ["Masquerading", 0.08384958888515674], ["Dynamic Resolution", 0.040543553990402076], ["Event Triggered Execution", 0.039498419546763856], ["Access Token Manipulation", 0.029574790234202616], ["Adversary-in-the-Middle", 0.029064324555284703]], "resolves the given API hash and retrieves the address of an exported function": [["Native API", 0.08281281452775982], ["System Network Configuration Discovery", 0.07544523349595304], ["Adversary-in-the-Middle", 0.052618884956836275], ["Obfuscated Files or Information", 0.03930006275738411], ["Use Alternate Authentication Material", 0.03889749923845695], ["Dynamic Resolution", 0.032557285312690844]], "creating a hash for each export function name": [["Obfuscated Files or Information", 0.2544758140917476], ["Masquerading", 0.048210583462335706], ["Use Alternate Authentication Material", 0.041091317781095066], ["Subvert Trust Controls", 0.020783996426035917], ["Data Obfuscation", 0.0196662178719119], ["Deobfuscate/Decode Files or Information", 0.018757765185342428]], "string encryption,": [["Obfuscated Files or Information", 0.41807948935971484], ["Encrypted Channel", 0.11845740367511652], ["Deobfuscate/Decode Files or Information", 0.09723864289572509], ["Data Encoding", 0.0754349287016911], ["Archive Collected Data", 0.050268227360571516], ["Data Encrypted for Impact", 0.0488915389771473]], "irrelevant code": [["Obfuscated Files or Information", 0.18944889184553837], ["Masquerading", 0.06072811673196848], ["Hijack Execution Flow", 0.0407524936753246], ["Execution Guardrails", 0.02620854972412222], ["Deobfuscate/Decode Files or Information", 0.02521910434213414], ["Compromise Client Software Binary", 0.0210372449416433]], "LoadLibrary and GetProcAddress functions": [["Hijack Execution Flow", 0.2910768070829187], ["Shared Modules", 0.16764000760295034], ["Native API", 0.11876252135555153], ["System Binary Proxy Execution", 0.045976563098256165], ["File and Directory Discovery", 0.0414127404528312], ["Masquerading", 0.030705981147658018]], "Compressapi": [["Archive Collected Data", 0.4575762406322196], ["Obfuscated Files or Information", 0.2814976969485614], ["Deobfuscate/Decode Files or Information", 0.08312315817929591], ["Data Encoding", 0.012644996361256579], ["Data Encrypted for Impact", 0.0099070589841254], ["Exfiltration Over Alternative Protocol", 0.009888586958162193]], "GetTokenInformation API.": [["Access Token Manipulation", 0.1345213216380406], ["System Information Discovery", 0.09736625883988696], ["Native API", 0.061259851695021086], ["OS Credential Dumping", 0.05954613611894649], ["Multi-Factor Authentication Interception", 0.043369228248554215], ["Steal or Forge Kerberos Tickets", 0.03512924610375816]], "retrieves the MachineGuid of the infected system from the SOFTWARE\\Microsoft\\Cryptography\\MachineGuid registry key": [["Query Registry", 0.32922890074606986], ["System Information Discovery", 0.20430202770822906], ["Windows Management Instrumentation", 0.07317433303033151], ["Modify Registry", 0.030248638349992408], ["OS Credential Dumping", 0.02598906334348997], ["Software Discovery", 0.018583867351610963]], "retrieves the MachineGuid of the infected system from the \"SOFTWARE\\Microsoft\\Cryptography\\MachineGuid\" registry key.": [["System Information Discovery", 0.423408525065266], ["Query Registry", 0.13950507857354158], ["Windows Management Instrumentation", 0.0888167589820467], ["Software Discovery", 0.01775624975437199], ["OS Credential Dumping", 0.016576343417531527], ["Execution Guardrails", 0.015169271340585454]], "deletes the HKCU\\SOFTWARE\\Intel registry key and recreates it": [["Modify Registry", 0.4475365900865894], ["Query Registry", 0.09994090710920678], ["Boot or Logon Autostart Execution", 0.0923433712806725], ["Indicator Removal", 0.041441535090021714], ["Inhibit System Recovery", 0.022707081732054598], ["Windows Management Instrumentation", 0.01381616654016652]], "collects information about the .NET Framework Setup": [["Software Discovery", 0.1899811295701653], ["System Information Discovery", 0.11393260216188507], ["Query Registry", 0.09264951611377813], ["Windows Management Instrumentation", 0.07598940993396609], ["Native API", 0.039562497935174114], ["Virtualization/Sandbox Evasion", 0.023690256296271937]], "elevate its privileges by executing the mw_UAC_bypass function": [["Abuse Elevation Control Mechanism", 0.5452912525250535], ["Exploitation for Privilege Escalation", 0.0864021756338485], ["Access Token Manipulation", 0.06583354279898394], ["File and Directory Permissions Modification", 0.03769668043661156], ["Domain Policy Modification", 0.029059043628678203], ["Create or Modify System Process", 0.01504346810371975]], "Calling Local Windows RPC Servers from .NET": [["Remote Services", 0.179965856146562], ["Application Layer Protocol", 0.06172103942225462], ["Non-Application Layer Protocol", 0.05750875769389323], ["Native API", 0.054249131052667765], ["Command and Scripting Interpreter", 0.05119997653749462], ["Inter-Process Communication", 0.03349396690224596]], "bypass user account control (UAC) using only two remote procedure call (RPC) requests": [["Abuse Elevation Control Mechanism", 0.3180071967038253], ["Access Token Manipulation", 0.12892529165892347], ["Valid Accounts", 0.04029989651831698], ["Create Account", 0.024038669038690563], ["Command and Scripting Interpreter", 0.0223099017435608], ["Remote Services", 0.02158728558646857]], "executes an export function called \"Entry\" from UpdateTask.dll via rundll32.exe": [["Process Injection", 0.15839583252240966], ["System Binary Proxy Execution", 0.10920032221127346], ["Native API", 0.09284013893884155], ["Create or Modify System Process", 0.054450413076655324], ["System Services", 0.05328099278279857], ["Scheduled Task/Job", 0.04619292383759584]], "payload through rundll32.exe": [["System Binary Proxy Execution", 0.5718435623677011], ["Native API", 0.12297739458216532], ["Process Injection", 0.043970506930017514], ["Hijack Execution Flow", 0.04224048145749733], ["System Services", 0.02652160489862893], ["Command and Scripting Interpreter", 0.023848588741648278]], "disable Microsoft Defender": [["Impair Defenses", 0.5656397688306487], ["Software Discovery", 0.06020364799117908], ["Subvert Trust Controls", 0.02755063690234119], ["Masquerading", 0.014130263263253182], ["Windows Management Instrumentation", 0.013747645956213302], ["Domain Policy Modification", 0.013646280948263534]], "patch the integrity level of the Microsoft defender (MsMpEng.exe)\u00a0and forcibly reduce it from system to untrusted integrity.": [["Impair Defenses", 0.21891049311204305], ["Subvert Trust Controls", 0.11915692429070261], ["Software Discovery", 0.04206251306583393], ["Masquerading", 0.04006433934878677], ["Process Injection", 0.03462878946171938], ["Modify System Image", 0.027876506364974282]], "determine if it is running as an account with administrator privileges or simply as a regular user": [["System Owner/User Discovery", 0.33890592264637825], ["Account Discovery", 0.15523693054924576], ["Permission Groups Discovery", 0.1238983683462731], ["Abuse Elevation Control Mechanism", 0.029293016551503317], ["Access Token Manipulation", 0.024227063991429425], ["System Information Discovery", 0.020391723699555657]], "creating scheduled tasks": [["Scheduled Task/Job", 0.7915936776746328], ["Inter-Process Communication", 0.052420156260509436], ["Command and Scripting Interpreter", 0.015338737006568948], ["Masquerading", 0.014027286225961215], ["System Services", 0.006807678632655427], ["Create or Modify System Process", 0.005976429580790576]], "sets up its working directory": [["Masquerading", 0.10787641953457244], ["File and Directory Discovery", 0.09443604996840847], ["Data Staged", 0.08676516300577491], ["Hide Artifacts", 0.04810482550787407], ["Hijack Execution Flow", 0.04214925727002859], ["Indicator Removal", 0.03562073987562912]], "collect system information and steals user information": [["System Information Discovery", 0.5955392787249892], ["System Owner/User Discovery", 0.03767962037449376], ["Windows Management Instrumentation", 0.0347107784819868], ["OS Credential Dumping", 0.028947684629060583], ["Automated Collection", 0.019908901898225563], ["Data from Configuration Repository", 0.016177699606350515]], "tokens, and passwords from various web browsers and applications": [["Credentials from Password Stores", 0.4952752075434078], ["Unsecured Credentials", 0.07586429893777268], ["Browser Session Hijacking", 0.03963933672721745], ["Forge Web Credentials", 0.03952135011194069], ["Use Alternate Authentication Material", 0.027058260621580437], ["Input Capture", 0.025716179628878545]], "captures screenshots": [["Screen Capture", 0.8501212978257325], ["Video Capture", 0.030802162284892527], ["Application Window Discovery", 0.010088192723242904], ["Input Capture", 0.008014463587697696], ["Clipboard Data", 0.005275132265182968], ["Data from Local System", 0.004914933100712657]], "compressed and exfiltrated to the attacker via Telegram": [["Archive Collected Data", 0.44653193329355445], ["Exfiltration Over Alternative Protocol", 0.1145039424129403], ["Exfiltration Over C2 Channel", 0.056041371840097116], ["Obfuscated Files or Information", 0.046917959166653464], ["Deobfuscate/Decode Files or Information", 0.03829353397449538], ["Data Encoding", 0.017013632445143114]], "some strings, such as web browser paths and Geolocation API services URLs, are encrypted with the AES algorithm in cipher-block chaining (CBC) mode": [["Obfuscated Files or Information", 0.2691918846449741], ["Encrypted Channel", 0.17612070763197776], ["Data Encoding", 0.129961993036973], ["Deobfuscate/Decode Files or Information", 0.09676767459064875], ["Archive Collected Data", 0.02910637767219039], ["Weaken Encryption", 0.02446623345251136]], "gathers basic system information,": [["System Information Discovery", 0.73805957752556], ["Windows Management Instrumentation", 0.0399376830100413], ["Software Discovery", 0.03816778989994844], ["Virtualization/Sandbox Evasion", 0.02269578157746662], ["Query Registry", 0.013689099403684585], ["System Network Configuration Discovery", 0.01032305993371674]], "for the infected system by gathering the username and hostname": [["System Owner/User Discovery", 0.5314325448086044], ["System Information Discovery", 0.13931996032899596], ["Account Discovery", 0.058269342336758206], ["Remote System Discovery", 0.036960732715145876], ["System Network Configuration Discovery", 0.03647166808418849], ["System Network Connections Discovery", 0.015033965949794673]], "the malware then proceeds to gather basic system information, including username, computer name, and OS version,": [["System Information Discovery", 0.8463057749998285], ["System Owner/User Discovery", 0.01805966454738669], ["Windows Management Instrumentation", 0.013612213176524801], ["Query Registry", 0.009981085629754385], ["Software Discovery", 0.009605582160970181], ["System Network Configuration Discovery", 0.008920332184519611]], "System info, including both hardware and OS info.": [["System Information Discovery", 0.8090667399232692], ["Software Discovery", 0.022811130292588796], ["Windows Management Instrumentation", 0.020891378023025473], ["Virtualization/Sandbox Evasion", 0.014312494863344004], ["Peripheral Device Discovery", 0.013066596287879519], ["Query Registry", 0.010675412765512534]], "Collection of information about the system in HTML format": [["System Information Discovery", 0.16471970412613743], ["Gather Victim Host Information", 0.07930798027629386], ["Data from Information Repositories", 0.06331915958825343], ["Cloud Service Dashboard", 0.03892836835652182], ["Automated Collection", 0.031124166699262195], ["Gather Victim Network Information", 0.02732507219098857]], "and hostname": [["System Network Configuration Discovery", 0.18597424080331604], ["System Information Discovery", 0.16444364342758452], ["Remote System Discovery", 0.07910869711214844], ["System Owner/User Discovery", 0.042545490835215374], ["Dynamic Resolution", 0.030181498831207684], ["System Network Connections Discovery", 0.028415210167707983]], "gathers basic system information, which it then sends to the C2,": [["System Information Discovery", 0.6088332280858306], ["Automated Collection", 0.04165902283844024], ["System Network Configuration Discovery", 0.025208873843216028], ["Exfiltration Over C2 Channel", 0.02215205657646346], ["Virtualization/Sandbox Evasion", 0.02038370319825987], ["Windows Management Instrumentation", 0.016836438838893443]], "send a list of process names and IDs back to the C2": [["Process Discovery", 0.702842251040936], ["Process Injection", 0.024791595866655674], ["Native API", 0.024085166438210886], ["Impair Defenses", 0.01657256082588066], ["System Service Discovery", 0.014979095873042714], ["System Information Discovery", 0.013070893947357548]], "the system information gathered by Domino Backdoor and sent to the C2": [["System Information Discovery", 0.4264905538301927], ["Automated Collection", 0.06789334881424174], ["Data from Local System", 0.02790532863110064], ["Exfiltration Over C2 Channel", 0.026364326675202342], ["System Network Configuration Discovery", 0.021792421645786823], ["Data from Configuration Repository", 0.021045695143704447]], "in return receives an AES encrypted payload.": [["Encrypted Channel", 0.23232026072329345], ["Obfuscated Files or Information", 0.2118199774703274], ["Deobfuscate/Decode Files or Information", 0.16549092921415964], ["Data Encoding", 0.06000534866830458], ["Exfiltration Over Alternative Protocol", 0.042417845312304324], ["Archive Collected Data", 0.040835109310041744]], "uses a custom algorithm which XOR\u2019s multiple values together.": [["Encrypted Channel", 0.08237660477641298], ["Obfuscated Files or Information", 0.07595385176186074], ["Deobfuscate/Decode Files or Information", 0.05961705930156736], ["Command and Scripting Interpreter", 0.0200471463026001], ["Data Encrypted for Impact", 0.016927359820440482], ["Archive Collected Data", 0.015811349701403625]], "which is stored immediately before the encrypted config block.": [["Obfuscated Files or Information", 0.18430985380692938], ["Deobfuscate/Decode Files or Information", 0.09860397024544539], ["Modify Registry", 0.08911081068697896], ["Unsecured Credentials", 0.07784275808239098], ["Execution Guardrails", 0.049472657727821355], ["Query Registry", 0.03955451392317816]], "The malware generates a random 32-byte key, which it encrypts using the RSA key.": [["Encrypted Channel", 0.17930151316289134], ["Data Encrypted for Impact", 0.1703121517871762], ["Deobfuscate/Decode Files or Information", 0.14513475955537827], ["Obfuscated Files or Information", 0.10482869007429838], ["Weaken Encryption", 0.07161811627177339], ["Execution Guardrails", 0.03173916338899193]], "loading an encrypted payload from its resources": [["Deobfuscate/Decode Files or Information", 0.29837461059002657], ["Obfuscated Files or Information", 0.27737426627732725], ["Data Encrypted for Impact", 0.04024413788999236], ["Archive Collected Data", 0.030987521688867422], ["Execution Guardrails", 0.030573619604471806], ["Encrypted Channel", 0.02699895375863113]], "The Microsoft WinCrypt library is used for AES encryption and": [["Obfuscated Files or Information", 0.2694893179423654], ["Data Encrypted for Impact", 0.1655010059524361], ["Deobfuscate/Decode Files or Information", 0.11312995881734922], ["Encrypted Channel", 0.09873961760070109], ["Archive Collected Data", 0.08707482456486326], ["Weaken Encryption", 0.030244796974869165]], "the encrypted config.": [["Obfuscated Files or Information", 0.1350593462296058], ["Deobfuscate/Decode Files or Information", 0.10418664578696726], ["Modify Registry", 0.07312291052913979], ["Weaken Encryption", 0.06104403496986384], ["Data Encrypted for Impact", 0.053326217167979396], ["Execution Guardrails", 0.052334277527189756]], "be based on an encryption algorithm used previously in": [["Obfuscated Files or Information", 0.17454369646688045], ["Data Encrypted for Impact", 0.1481961339632326], ["Encrypted Channel", 0.13247718065854538], ["Weaken Encryption", 0.1257846702574271], ["Archive Collected Data", 0.08043360560275127], ["Deobfuscate/Decode Files or Information", 0.06615858277836714]], "by gathering the username and": [["System Owner/User Discovery", 0.7813546763094514], ["Account Discovery", 0.10265096418377066], ["Permission Groups Discovery", 0.007354342672558936], ["System Information Discovery", 0.005428808908862868], ["Automated Collection", 0.005369167386608302], ["Gather Victim Identity Information", 0.004486083083490179]], "to gather basic system information, including username,": [["System Information Discovery", 0.5422774979202195], ["System Owner/User Discovery", 0.2369759537926146], ["Account Discovery", 0.026804804332567066], ["Windows Management Instrumentation", 0.021293577815289306], ["System Network Configuration Discovery", 0.01072934442956993], ["Query Registry", 0.010260986031667405]], "is generated from the system username": [["System Owner/User Discovery", 0.7420872582252865], ["Account Discovery", 0.04900750036665458], ["Access Token Manipulation", 0.020563022279430167], ["System Information Discovery", 0.017037902124391584], ["Masquerading", 0.01138596449874809], ["Create Account", 0.009781196212178185]], "used a similar XOR-based algorithm as part of its encryption mechanisms during communication with the C2.": [["Encrypted Channel", 0.5745271416998742], ["Obfuscated Files or Information", 0.1076565576227307], ["Deobfuscate/Decode Files or Information", 0.06803349962349516], ["Data Encoding", 0.03924931822912395], ["Archive Collected Data", 0.02069897858479184], ["Exfiltration Over Alternative Protocol", 0.01947904434572212]], "then proceeds to gather basic system information, including username, computer name, and OS version, which it then encrypts using AES-256-CBC and the generated,": [["System Information Discovery", 0.31180588777203977], ["Obfuscated Files or Information", 0.11830658582814513], ["Deobfuscate/Decode Files or Information", 0.044814076097752405], ["Weaken Encryption", 0.03638663137706477], ["Execution Guardrails", 0.036109982354458746], ["Archive Collected Data", 0.03263178317321619]], "then sends the AES-encrypted system data.": [["Exfiltration Over Alternative Protocol", 0.1736350940625813], ["Encrypted Channel", 0.13296878797691697], ["Obfuscated Files or Information", 0.09276492401655771], ["Archive Collected Data", 0.09017418759606129], ["Deobfuscate/Decode Files or Information", 0.056846948934210155], ["Data Encoding", 0.0455620278354191]], "This data is then encrypted using AES and returned to the C2.": [["Archive Collected Data", 0.11636673687262869], ["Data Encoding", 0.11366568507870331], ["Encrypted Channel", 0.10436266609875847], ["Exfiltration Over C2 Channel", 0.10097141035469147], ["Deobfuscate/Decode Files or Information", 0.08756420111908726], ["Exfiltration Over Alternative Protocol", 0.0849297015338541]], "the decrypted config contains two pipe-delimited IP addresses": [["System Network Configuration Discovery", 0.10499680621880055], ["Dynamic Resolution", 0.07464143937411763], ["Encrypted Channel", 0.07132557220987477], ["Deobfuscate/Decode Files or Information", 0.059468178522913195], ["Obfuscated Files or Information", 0.03785478293329027], ["Weaken Encryption", 0.034076987101236154]], "and decrypts them using XOR and the key": [["Deobfuscate/Decode Files or Information", 0.7116881057174659], ["Data Encrypted for Impact", 0.05975381477533075], ["Archive Collected Data", 0.04350122365880042], ["Obfuscated Files or Information", 0.03255016416831776], ["Encrypted Channel", 0.02069569782986086], ["Weaken Encryption", 0.01141145072275229]], "The malware then proceeds to decrypt its configuration block,": [["Deobfuscate/Decode Files or Information", 0.5795250431548027], ["Obfuscated Files or Information", 0.09941880290620622], ["Data Encrypted for Impact", 0.049695085558542074], ["Weaken Encryption", 0.025787852620211167], ["Modify Registry", 0.0180875024648435], ["Execution Guardrails", 0.01798457481593011]], "The config is decrypted using XOR and a 16-byte key": [["Deobfuscate/Decode Files or Information", 0.5396918237266942], ["Obfuscated Files or Information", 0.09491591747723735], ["Modify Registry", 0.03895626328739263], ["Weaken Encryption", 0.03577049740939422], ["Unsecured Credentials", 0.025371647461576313], ["Execution Guardrails", 0.022508544125814885]], "A second config block, which is decrypted separately": [["Deobfuscate/Decode Files or Information", 0.2754009523426295], ["Obfuscated Files or Information", 0.18333550556938003], ["Data Encrypted for Impact", 0.05163335165315691], ["Weaken Encryption", 0.04079230011807732], ["Execution Guardrails", 0.037621487782678126], ["Modify Registry", 0.03447777675552801]], "The decrypted data consists of a 4 byte size": [["Deobfuscate/Decode Files or Information", 0.46579278502617727], ["Archive Collected Data", 0.11415342269635637], ["Obfuscated Files or Information", 0.07792395318130242], ["Data Encrypted for Impact", 0.04416256040448424], ["Encrypted Channel", 0.03997544219562607], ["Data Encoding", 0.0306768678332232]], "The malware then decrypts the received payload using AES and the shared key.": [["Deobfuscate/Decode Files or Information", 0.4275005987279494], ["Encrypted Channel", 0.16881844145273392], ["Obfuscated Files or Information", 0.05290529497823093], ["Exfiltration Over Alternative Protocol", 0.0439934386401189], ["Weaken Encryption", 0.043962721643117465], ["Data Encoding", 0.037141685598967154]], "which decrypts to the following 5 bytes": [["Deobfuscate/Decode Files or Information", 0.4748914624249837], ["Obfuscated Files or Information", 0.1011045899277539], ["Encrypted Channel", 0.07588176021944461], ["Data Encoding", 0.06806663022070893], ["Data Encrypted for Impact", 0.0375115859864919], ["Archive Collected Data", 0.037052806539637544]], "decrypting it using AES-256-CBC and a hardcoded key.": [["Deobfuscate/Decode Files or Information", 0.381250665284985], ["Data Encrypted for Impact", 0.10435735149293755], ["Weaken Encryption", 0.07718372276498518], ["Obfuscated Files or Information", 0.06624602264285773], ["Archive Collected Data", 0.06614255010183802], ["Encrypted Channel", 0.0576251828815039]], "The decrypted data consists of 4 bytes containing the payload size,": [["Deobfuscate/Decode Files or Information", 0.4994163242289843], ["Obfuscated Files or Information", 0.08860693845103741], ["Archive Collected Data", 0.06980067195381881], ["Encrypted Channel", 0.0361376597575006], ["Data Encoding", 0.035441318940109365], ["Data Encrypted for Impact", 0.026382432759733735]], "The Microsoft WinCrypt library is used for AES encryption and decryption by both": [["Deobfuscate/Decode Files or Information", 0.29358469764860096], ["Obfuscated Files or Information", 0.1643035713313513], ["Data Encrypted for Impact", 0.13022551070972427], ["Archive Collected Data", 0.09341434333203673], ["Encrypted Channel", 0.08424320131426884], ["Weaken Encryption", 0.03035740325627289]], "is decrypted using XOR and a 16-byte key": [["Deobfuscate/Decode Files or Information", 0.6299334194418728], ["Encrypted Channel", 0.07002868129041208], ["Obfuscated Files or Information", 0.06240966362324069], ["Data Encrypted for Impact", 0.06175395766852519], ["Weaken Encryption", 0.03144272577373654], ["Archive Collected Data", 0.023331270306394064]], "executes the decrypted shellcode": [["Deobfuscate/Decode Files or Information", 0.6816815323645088], ["Obfuscated Files or Information", 0.13388539482736303], ["Encrypted Channel", 0.017626693280588843], ["Data Encrypted for Impact", 0.015186478977015683], ["Execution Guardrails", 0.012354833864198196], ["Command and Scripting Interpreter", 0.009477630069670975]], "loads the resources using the API calls LdrFindResource_U and LdrAccessResource": [["Native API", 0.11512408819248507], ["Shared Modules", 0.10835779759696913], ["Hijack Execution Flow", 0.1032103591297429], ["System Binary Proxy Execution", 0.07415161986130124], ["System Services", 0.026413111254653156], ["Process Injection", 0.023771437736139406]], "and execute the file using CreateProcessA.": [["System Binary Proxy Execution", 0.2352038630620608], ["Native API", 0.2030810113102327], ["System Services", 0.06333349690903212], ["Process Injection", 0.05005715515728392], ["Command and Scripting Interpreter", 0.036332280018305546], ["Hijack Execution Flow", 0.03144303543293834]], "utilising similar API calls,": [["Native API", 0.20594293192942875], ["Cloud Service Dashboard", 0.11388110627460461], ["Web Service", 0.042704587260721724], ["Command and Scripting Interpreter", 0.034231611996981666], ["Application Layer Protocol", 0.03062545431869769], ["Ingress Tool Transfer", 0.02073153259160697]], "the malware enumerates the running processes on the system and compiles a list of process names and IDs.": [["Process Discovery", 0.8358962420839874], ["Native API", 0.01711957848886661], ["Software Discovery", 0.015723543282933662], ["System Service Discovery", 0.012130253299407147], ["System Information Discovery", 0.01204886205236843], ["Process Injection", 0.01176530513930527]], "enumerate running processes and send a list of process names and IDs back to the C2": [["Process Discovery", 0.8072657591035398], ["Process Injection", 0.01945981479310874], ["Native API", 0.01747146535125331], ["System Service Discovery", 0.013675852823447686], ["Impair Defenses", 0.008390753123667435], ["Access Token Manipulation", 0.007079340743752842]], "Enumerates running processes": [["Process Discovery", 0.8637064838931873], ["Native API", 0.01638045827047498], ["System Service Discovery", 0.013094728517390679], ["Process Injection", 0.011767365073891669], ["Windows Management Instrumentation", 0.0077063126717415754], ["Software Discovery", 0.007692821144734606]], "the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.": [["Process Injection", 0.4283912511090177], ["Native API", 0.061435239523678235], ["Shared Modules", 0.06141566881404945], ["Hijack Execution Flow", 0.052103284540475546], ["System Binary Proxy Execution", 0.026411743587915777], ["Command and Scripting Interpreter", 0.019977695564513512]], "It copies the headers, maps the individual PE sections,\u00a0 processes any relocations,\u00a0 loads the PE\u2019s imports, and then executes the PE from its internally specified entry point.": [["OS Credential Dumping", 0.06347119772493788], ["Process Injection", 0.05763129584702754], ["Native API", 0.05673254126159087], ["Command and Scripting Interpreter", 0.0333999309152761], ["System Binary Proxy Execution", 0.02436884323256515], ["Hijack Execution Flow", 0.023829480148013532]], "passes the PE payload to it, which the shellcode then loads and executes.": [["Native API", 0.12857271527567926], ["Process Injection", 0.10056217836274516], ["Command and Scripting Interpreter", 0.0751248353712528], ["System Binary Proxy Execution", 0.05220553069161881], ["Event Triggered Execution", 0.04162104594496516], ["Obfuscated Files or Information", 0.03958318439400375]], "Enumerate files on desktop": [["File and Directory Discovery", 0.8099214518968768], ["Data from Local System", 0.028501039427822634], ["Hide Artifacts", 0.012732458122653048], ["Automated Collection", 0.011958800451772524], ["Data from Network Shared Drive", 0.010540658232421618], ["Masquerading", 0.009216378423334974]], "Enumerates files under Steam application directory": [["File and Directory Discovery", 0.620407468481046], ["Masquerading", 0.03228953456645127], ["Query Registry", 0.027794040785274924], ["Data from Local System", 0.023183241650506857], ["Native API", 0.023100948386038853], ["Automated Collection", 0.01618199401350363]], "looping through entries under registry key": [["Query Registry", 0.4559303595665118], ["Modify Registry", 0.2708606792815537], ["Boot or Logon Autostart Execution", 0.055946100144572714], ["Command and Scripting Interpreter", 0.01459466722772816], ["Indicator Removal", 0.014009150560970183], ["System Binary Proxy Execution", 0.012428492897114321]], "waits for data collection tasks to complete,": [["Data Staged", 0.1020858424352254], ["Automated Collection", 0.05014883474767232], ["Automated Exfiltration", 0.04345154916986496], ["Virtualization/Sandbox Evasion", 0.036854575913127394], ["Command and Scripting Interpreter", 0.02828756788025036], ["Impair Defenses", 0.022697636255780466]], "creating a hash of the collected data, to which it then appends its current process id.": [["Process Discovery", 0.6023443832581966], ["Process Injection", 0.031605704814305614], ["System Information Discovery", 0.02257157153970253], ["Automated Collection", 0.021801089688888095], ["Native API", 0.02170472257722389], ["Virtualization/Sandbox Evasion", 0.016054088291714785]], "uploads data to the C2 via a HTTP POST request": [["Exfiltration Over C2 Channel", 0.297227055007407], ["Application Layer Protocol", 0.20352105456774952], ["Web Service", 0.04997201143744865], ["Ingress Tool Transfer", 0.04502095210445854], ["Data Encoding", 0.03493103926318497], ["Exfiltration Over Alternative Protocol", 0.02881604546459442]], "http/https data transfer": [["Application Layer Protocol", 0.5187333075764671], ["Exfiltration Over Alternative Protocol", 0.11251784099564018], ["Non-Standard Port", 0.03104794659591788], ["Fallback Channels", 0.028669369857660113], ["Encrypted Channel", 0.02675014466941068], ["Proxy", 0.025748977903726634]], "Self-delete after sending data": [["Indicator Removal", 0.1992820252319669], ["Data Destruction", 0.08596079185691446], ["Scheduled Transfer", 0.05440088854726059], ["Exfiltration Over Alternative Protocol", 0.05395243672254809], ["Exfiltration Over C2 Channel", 0.05320067772109126], ["Data Manipulation", 0.028087458244450022]], "It then attempts to connect to the C2 via TCP port 443": [["Application Layer Protocol", 0.19690311721544854], ["Non-Application Layer Protocol", 0.18266749022722767], ["Non-Standard Port", 0.14573735333935184], ["Encrypted Channel", 0.06707429076758659], ["Fallback Channels", 0.03892644211869379], ["Proxy", 0.03765813100013094]], "ranswomare for Windows can self-propagate in the local area network using the legitimate PsExec utility (contained in its body), which creates a temporary system service.": [["System Services", 0.32465569390066445], ["Scheduled Task/Job", 0.08929111436851461], ["Create or Modify System Process", 0.08363084212519148], ["System Binary Proxy Execution", 0.03582803084892493], ["Event Triggered Execution", 0.03547512391662492], ["Boot or Logon Autostart Execution", 0.032069413219237786]], "Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure.": [["Account Manipulation", 0.1551410222356167], ["Valid Accounts", 0.0831367656286514], ["Create Account", 0.0772087691497106], ["Establish Accounts", 0.058962403691253495], ["External Remote Services", 0.056397595211173206], ["Compromise Accounts", 0.04318991488077421]], "may use stolen legitimate accounts specified in the configuration data.": [["Create Account", 0.21489636596324493], ["Valid Accounts", 0.19051225592748977], ["Account Manipulation", 0.08072278581218946], ["Compromise Accounts", 0.052132077155184586], ["Modify Authentication Process", 0.03672258070985543], ["Establish Accounts", 0.03352436476476937]], "uses the command shell to run appropriate commands": [["Command and Scripting Interpreter", 0.758447266186606], ["Indirect Command Execution", 0.0598917973948719], ["System Services", 0.017080595591305744], ["Native API", 0.016121986937019998], ["System Binary Proxy Execution", 0.010731750827336527], ["Ingress Tool Transfer", 0.010210352837353179]], "an additional BAT file contained in the body of the ransomware.": [["Data Encrypted for Impact", 0.2764541848654968], ["Command and Scripting Interpreter", 0.10835201350208376], ["Masquerading", 0.05620394765208213], ["Deobfuscate/Decode Files or Information", 0.030728129659148982], ["System Binary Proxy Execution", 0.024522666987140267], ["Obfuscated Files or Information", 0.02236296884096083]], "The attackers may use wmic to obtain information and run various commands,": [["Windows Management Instrumentation", 0.3139591644842398], ["System Information Discovery", 0.05526952175514495], ["Data from Configuration Repository", 0.03402114139024828], ["OS Credential Dumping", 0.021811508392694953], ["Gather Victim Host Information", 0.02040978814604894], ["Software Discovery", 0.01890206779465274]], "They may also use the wmiexec module from Impacket to execute commands and move across the network.": [["Remote Services", 0.44364901993098416], ["Lateral Tool Transfer", 0.07329045118652795], ["Communication Through Removable Media", 0.047192740433812344], ["Remote Access Software", 0.04104709043829274], ["System Services", 0.03493542271778635], ["Exploitation of Remote Services", 0.03070759094688365]], "uses wmic to obtain the": [["Windows Management Instrumentation", 0.35655681645048365], ["System Information Discovery", 0.18157165934231112], ["OS Credential Dumping", 0.049202785079132276], ["Virtualization/Sandbox Evasion", 0.036237285847987875], ["Query Registry", 0.02105992774240035], ["Native API", 0.020017046188665677]], "ransomware uses Native API.": [["Data Encrypted for Impact", 0.24342559771610264], ["Deobfuscate/Decode Files or Information", 0.06273417874317595], ["Obfuscated Files or Information", 0.05242803351610278], ["Masquerading", 0.0404746650480584], ["Ingress Tool Transfer", 0.03193197363093625], ["Command and Scripting Interpreter", 0.029428055011470233]], "the function CreateProcessWithLogonW.": [["Event Triggered Execution", 0.1275067845655231], ["Access Token Manipulation", 0.08675712626434187], ["Boot or Logon Autostart Execution", 0.08301138598169175], ["Input Capture", 0.05405594799814605], ["Command and Scripting Interpreter", 0.048461309543500294], ["Native API", 0.04021406453297508]], "affiliates may exploit group policies, which results in a scheduled task being created (on each host) that launches the ransomware.": [["Scheduled Task/Job", 0.13985768982629254], ["Inter-Process Communication", 0.04182622180817764], ["Acquire Infrastructure", 0.03189755237481396], ["Masquerading", 0.030714952596485007], ["Software Deployment Tools", 0.02990140308226101], ["Data Encrypted for Impact", 0.027051815524140058]], "disabling security tools": [["Impair Defenses", 0.6105752121758414], ["Subvert Trust Controls", 0.03341528763288878], ["File and Directory Permissions Modification", 0.029314291591030273], ["Software Discovery", 0.022355091799493937], ["Modify Registry", 0.016119502370256437], ["Exploitation for Defense Evasion", 0.015459973654606468]], "To prevent being detected, the attackers end processes and services related to security and antivirus software.": [["Impair Defenses", 0.5626557463883278], ["Software Discovery", 0.1321922023625982], ["Virtualization/Sandbox Evasion", 0.02405964566923973], ["Masquerading", 0.018192337726576756], ["Process Discovery", 0.013982918415465994], ["Windows Management Instrumentation", 0.010562503389998586]], "To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.": [["Abuse Elevation Control Mechanism", 0.6185646266724389], ["Exploitation for Privilege Escalation", 0.05286125300986442], ["File and Directory Permissions Modification", 0.04140338082373707], ["Access Token Manipulation", 0.03946240220316388], ["Domain Policy Modification", 0.018489833907723043], ["Event Triggered Execution", 0.009101318493705088]], "Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.": [["Abuse Elevation Control Mechanism", 0.39918325015351425], ["Create Account", 0.094030486856232], ["Access Token Manipulation", 0.052931796285386176], ["Valid Accounts", 0.04505535265183474], ["Account Manipulation", 0.04031235862671365], ["Domain Policy Modification", 0.02868237269108815]], "decrypts configuration data as well as decrypts and unpacks the legitimate PsExec utility": [["Deobfuscate/Decode Files or Information", 0.5286006972551252], ["Obfuscated Files or Information", 0.07977272320023479], ["Modify Registry", 0.04360052365369197], ["OS Credential Dumping", 0.023336076150224462], ["Data Encrypted for Impact", 0.02308385569385349], ["Archive Collected Data", 0.022179952903987537]], "unpacks the legitimate PsExec utility": [["Command and Scripting Interpreter", 0.17275213948161464], ["System Binary Proxy Execution", 0.15355985129671865], ["System Services", 0.08906953048055039], ["Native API", 0.05012622001745491], ["Hijack Execution Flow", 0.047469495908302746], ["Indirect Command Execution", 0.037031703768850927]], "ransomware uses obfuscation.": [["Obfuscated Files or Information", 0.5054622754806242], ["Deobfuscate/Decode Files or Information", 0.10629601899566979], ["Data Encrypted for Impact", 0.09850944410386489], ["Masquerading", 0.02670438609528962], ["Archive Collected Data", 0.0233302170359186], ["Execution Guardrails", 0.021538794669558263]], "use a SoftPerfect Network Scanner executable renamed to svchost.exe.": [["Remote System Discovery", 0.2025401786063448], ["Network Service Discovery", 0.19561853729347914], ["System Network Connections Discovery", 0.14380028593296176], ["System Network Configuration Discovery", 0.11112888367377984], ["Network Share Discovery", 0.05071119971465844], ["Data from Configuration Repository", 0.03779864392177228]], "uses PsExec to modify the system registry parameter MaxMpxCt": [["Modify Registry", 0.19544032298691744], ["Query Registry", 0.07937285255699034], ["Boot or Logon Autostart Execution", 0.053106444928691], ["Create or Modify System Process", 0.05103666476319216], ["Impair Defenses", 0.04376745618953721], ["System Binary Proxy Execution", 0.03962859373960206]], "To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll).": [["OS Credential Dumping", 0.7162113979756496], ["Unsecured Credentials", 0.03208537780602402], ["Network Sniffing", 0.02736971981613888], ["Credentials from Password Stores", 0.015128302309128082], ["Steal or Forge Kerberos Tickets", 0.014755283991181305], ["Modify Authentication Process", 0.009075801315420613]], "To obtain authentication data from the registry and files, the attackers may use NirSoft utilities.": [["OS Credential Dumping", 0.44688258473245757], ["Unsecured Credentials", 0.18355203360748984], ["Credentials from Password Stores", 0.05509462776141672], ["Query Registry", 0.025623784511425118], ["Modify Authentication Process", 0.01999030274981254], ["Network Sniffing", 0.01629880994918522]], "The attackers enumerate drives, directories, and files": [["File and Directory Discovery", 0.746495547507589], ["Data from Local System", 0.039684974927168076], ["Data from Network Shared Drive", 0.022126911252262776], ["Network Share Discovery", 0.017381993984639743], ["Automated Collection", 0.015556620770896314], ["System Information Discovery", 0.014539055454013945]], "to search for sensitive information for exfiltration purposes.": [["Data from Information Repositories", 0.14138758143444105], ["Email Collection", 0.05752584546981818], ["Exfiltration Over C2 Channel", 0.04485878620458577], ["Data Staged", 0.04023182469304835], ["Automated Collection", 0.03584639212244863], ["Search Open Technical Databases", 0.03265916771903807]], "The attackers collect information from the local system for exfiltration purposes.": [["Exfiltration Over C2 Channel", 0.16940624537911753], ["Data Staged", 0.13487175325008713], ["Data from Local System", 0.07482935745750446], ["Archive Collected Data", 0.06004256526200045], ["Automated Exfiltration", 0.05645294696735242], ["Automated Collection", 0.04690778010782542]], "The attackers may use RDP to move across the network.": [["Remote Services", 0.3667302553848669], ["Exploitation of Remote Services", 0.09068620568495443], ["Valid Accounts", 0.054689208530898974], ["External Remote Services", 0.04172505475432676], ["Remote Access Software", 0.03257795753481829], ["Lateral Tool Transfer", 0.03180620414009668]], "uses wmic to obtain the UUID of the compromised host.": [["System Information Discovery", 0.37413567405692977], ["Windows Management Instrumentation", 0.08961065345196229], ["Virtualization/Sandbox Evasion", 0.03426196686645025], ["Peripheral Device Discovery", 0.030651196357705038], ["OS Credential Dumping", 0.0277075100294543], ["System Owner/User Discovery", 0.024703561808058275]], "enumerates all running processes": [["Process Discovery", 0.8592463311508584], ["Native API", 0.017148454818439345], ["System Service Discovery", 0.013943897627490999], ["Process Injection", 0.011949539239102826], ["Software Discovery", 0.008064527228406213], ["Windows Management Instrumentation", 0.007840389738864664]], ";Moving across the victim\u2019s network and deploying ransomware involves copying related tools to the host.": [["Lateral Tool Transfer", 0.19373495340116126], ["Ingress Tool Transfer", 0.1361985130980941], ["Remote Services", 0.04526719280734214], ["Communication Through Removable Media", 0.03350994537623449], ["Taint Shared Content", 0.03191721180815155], ["Software Deployment Tools", 0.028093911571563285]], "can self-propagate in the network by using the legitimate PsExec utility": [["System Services", 0.3140269441746707], ["Event Triggered Execution", 0.05032889976676095], ["Remote Services", 0.04832026823444756], ["System Binary Proxy Execution", 0.04260028874907032], ["Scheduled Task/Job", 0.04144454610413895], ["Boot or Logon Autostart Execution", 0.04005595289679533]], "to search for ones relating to security": [["Obtain Capabilities", 0.1619125602092763], ["Gather Victim Network Information", 0.05559161020354255], ["Search Open Technical Databases", 0.05308768273546159], ["Develop Capabilities", 0.042658568999843126], ["Gather Victim Host Information", 0.04032643098884403], ["Active Scanning", 0.039932128382800344]], "enumerates system services to search for ones relating to security": [["System Service Discovery", 0.5180439903402367], ["Cloud Service Discovery", 0.09523896008234106], ["Network Service Discovery", 0.04235596043383979], ["Software Discovery", 0.04003125896428694], ["Create or Modify System Process", 0.033914388275257626], ["Service Stop", 0.031000411729895688]], "Before exfiltration, the attackers may put collected data in 7Zip archives.": [["Archive Collected Data", 0.375646112402595], ["Data Staged", 0.08579211263218765], ["Exfiltration Over C2 Channel", 0.0702948991751383], ["Exfiltration Over Alternative Protocol", 0.058627894424017626], ["Data from Local System", 0.04020916739263168], ["Automated Exfiltration", 0.03480249153809149]], "Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS,": [["Application Layer Protocol", 0.35419240303885063], ["Protocol Tunneling", 0.0646581850319098], ["Proxy", 0.060894821696025635], ["Non-Standard Port", 0.04451292854959058], ["Exploit Public-Facing Application", 0.03356130197948892], ["Data Obfuscation", 0.02679190992746692]], "When the attackers use Cobalt Strike, the collected information may be sent via Cobalt Strike server communication channels.": [["Exfiltration Over C2 Channel", 0.24936575533091418], ["Automated Collection", 0.0647013469635743], ["Automated Exfiltration", 0.0394488748731803], ["Email Collection", 0.03341745430631485], ["Data Staged", 0.03149206640583693], ["Web Service", 0.02673292731518843]], "To remotely access the compromised infrastructure, the attackers may use the legitimate tools TeamViewer and ScreenConnect.": [["Remote Access Software", 0.4066234272663743], ["Remote Services", 0.16240017748375427], ["External Remote Services", 0.036098263554654744], ["Exploitation of Remote Services", 0.03476392606258314], ["Software Deployment Tools", 0.029267305208942128], ["Remote Service Session Hijacking", 0.021903531886910254]], "To remotely access the compromised infrastructure, the attackers may use Cobalt Strike, TeamViewer and ScreenConnect": [["Remote Access Software", 0.3371824487082546], ["Remote Services", 0.13625595455251183], ["External Remote Services", 0.05810411823025307], ["Exploitation of Remote Services", 0.044431034569500184], ["Software Deployment Tools", 0.03761605387320759], ["Remote Service Session Hijacking", 0.022810121766416183]], "which perform asymmetric/symmetric encryption of the C&C server communication channel.": [["Encrypted Channel", 0.49263625937205224], ["Weaken Encryption", 0.0912703219750912], ["Exfiltration Over Alternative Protocol", 0.05323747689708656], ["Obfuscated Files or Information", 0.033202289012721695], ["Data Encrypted for Impact", 0.02418253901270114], ["Non-Application Layer Protocol", 0.019572131503933204]], "the attackers copy tools necessary for deployment to the compromised host.": [["Ingress Tool Transfer", 0.09093217926336171], ["Stage Capabilities", 0.08886036586746046], ["Obtain Capabilities", 0.05185314319991723], ["Lateral Tool Transfer", 0.0396683147622935], ["Develop Capabilities", 0.03594594402015442], ["Software Deployment Tools", 0.03310609300767181]], "the malware executes\u00a0a command to delete itself from the system": [["Indicator Removal", 0.5959567219788148], ["Data Destruction", 0.062156536300188754], ["System Shutdown/Reboot", 0.04263805246696301], ["Inhibit System Recovery", 0.03100487594406962], ["Disk Wipe", 0.026347036821777386], ["Impair Defenses", 0.01601003813926998]], "delete key files": [["Indicator Removal", 0.6221256942748397], ["Data Destruction", 0.057614905714915086], ["Modify Registry", 0.038990866233953245], ["Inhibit System Recovery", 0.03304033938494424], ["Disk Wipe", 0.022072070460000134], ["System Shutdown/Reboot", 0.015987306540152253]], "attackers have been seen using several methods to distribute the wiper through the domain, like: domain Group Policy Object (GPO)": [["System Shutdown/Reboot", 0.10537705822503472], ["Data Destruction", 0.08779049020415325], ["Indicator Removal", 0.08386267839157963], ["Disk Wipe", 0.05649950402591146], ["Modify Registry", 0.04284257341865523], ["Inhibit System Recovery", 0.03453828459477772]], "installs the payload as a service": [["Create or Modify System Process", 0.42819717239884497], ["System Services", 0.2662088689650363], ["Hijack Execution Flow", 0.05095001296300508], ["System Binary Proxy Execution", 0.021523097762252565], ["Masquerading", 0.020358364206447245], ["System Service Discovery", 0.014410742616181808]], "sets a hardcoded list of system directories": [["File and Directory Discovery", 0.627443050380682], ["Data Staged", 0.028438902724366902], ["Data from Local System", 0.027978092605325477], ["Hide Artifacts", 0.025570598065059978], ["Indicator Removal", 0.01902705873260659], ["Automated Collection", 0.015713828913544198]], "system directories are targeted": [["File and Directory Discovery", 0.307547658298397], ["Indicator Removal", 0.069557998330324], ["Data Staged", 0.0633257746292234], ["Data from Local System", 0.04231251590246839], ["Hide Artifacts", 0.04007199804412676], ["Masquerading", 0.039377468680041765]], "enumerates their partitions.": [["File and Directory Discovery", 0.36115825109457916], ["System Information Discovery", 0.24069596813035743], ["Peripheral Device Discovery", 0.02640668783255341], ["Hide Artifacts", 0.021883864778446414], ["Data from Local System", 0.02127028954539938], ["Virtualization/Sandbox Evasion", 0.01869755979325863]], "an obfuscated .NET program.": [["Obfuscated Files or Information", 0.7324573595412869], ["Deobfuscate/Decode Files or Information", 0.08081111141761058], ["Archive Collected Data", 0.014460209295460756], ["Masquerading", 0.014170652135055316], ["Encrypted Channel", 0.010715416573721543], ["Data Encrypted for Impact", 0.010190557634082954]], "WMI": [["Windows Management Instrumentation", 0.7222258158220628], ["Event Triggered Execution", 0.0280676240000368], ["Pre-OS Boot", 0.01018689340472273], ["Remote Services", 0.009560171893557057], ["Peripheral Device Discovery", 0.007053921438290096], ["Multi-Factor Authentication Interception", 0.006960886443960886]], "to identify where the Operative System is stored in the disk": [["System Information Discovery", 0.4221192303965536], ["File and Directory Discovery", 0.10984640717928795], ["Disk Wipe", 0.03993345718166817], ["Virtualization/Sandbox Evasion", 0.03332222585728064], ["Data from Local System", 0.020822387521422858], ["Inhibit System Recovery", 0.01939993268688511]], "Application-level protocol": [["Non-Application Layer Protocol", 0.17611461858772862], ["Application Layer Protocol", 0.16073320104719813], ["Data Obfuscation", 0.06476866347907682], ["Protocol Tunneling", 0.06257366529423819], ["Non-Standard Port", 0.05425861443563288], ["Exfiltration Over Alternative Protocol", 0.05127267913452744]], "sends the output of ipconfig in a POST request": [["System Network Configuration Discovery", 0.7005626667615958], ["Dynamic Resolution", 0.017859761614733387], ["System Network Connections Discovery", 0.016775063314781787], ["System Information Discovery", 0.011058793152378158], ["Application Layer Protocol", 0.010806195176653322], ["Network Sniffing", 0.010531957864025866]], "the opening of a URL file extracted from the archive.": [["User Execution", 0.0863050620918641], ["Ingress Tool Transfer", 0.06218249126212548], ["Deobfuscate/Decode Files or Information", 0.05129646947506045], ["Masquerading", 0.04149545904237754], ["Template Injection", 0.03820450121695333], ["Phishing", 0.03706260181651218]], "output of ipconfig was sent to one of two addresses": [["System Network Configuration Discovery", 0.6307477390591516], ["Dynamic Resolution", 0.03967352772480939], ["Adversary-in-the-Middle", 0.027193269972140124], ["System Network Connections Discovery", 0.024969819524278507], ["Remote System Discovery", 0.011023447082830236], ["Fallback Channels", 0.01075750036107287]], "a GET request is sent to the C2 server.": [["Application Layer Protocol", 0.20754007118500642], ["Exfiltration Over C2 Channel", 0.10559689378030876], ["Web Service", 0.10037326921275713], ["Fallback Channels", 0.06359359385712107], ["Data Encoding", 0.044062797246605674], ["Ingress Tool Transfer", 0.028357340625355724]], "application-level messages from the server to the client is sent as the body of an HTTP response": [["Application Layer Protocol", 0.3020359255400971], ["Data Encoding", 0.1342609128694174], ["Data Obfuscation", 0.0863047944488945], ["Exfiltration Over C2 Channel", 0.028589702528626842], ["Web Service", 0.022798578767706943], ["Exfiltration Over Alternative Protocol", 0.020048630616079994]], "are sent using separate POST requests.": [["Application Layer Protocol", 0.20133064927712066], ["Exfiltration Over C2 Channel", 0.06564719593195681], ["Fallback Channels", 0.038534359764865356], ["Data Encoding", 0.03605567748674163], ["Exfiltration Over Alternative Protocol", 0.030844573602627882], ["Use Alternate Authentication Material", 0.026863754174237118]], "sends an HTTPS request": [["Application Layer Protocol", 0.6206400816656119], ["Non-Standard Port", 0.03808678211334937], ["Data Obfuscation", 0.03675531603996338], ["Encrypted Channel", 0.022481773635641873], ["Browser Session Hijacking", 0.02069480536236789], ["Exfiltration Over Alternative Protocol", 0.014882020518092997]], "same IP address was used as C2 server": [["Fallback Channels", 0.18848983238344597], ["Dynamic Resolution", 0.13971238121404667], ["Proxy", 0.07614813036395643], ["Application Layer Protocol", 0.04769956538799205], ["Web Service", 0.032886389206218745], ["Compromise Infrastructure", 0.030698922605610933]], "domains give attackers the ability to mask malicious traffic as legitimate activity within the company": [["Compromise Infrastructure", 0.2665411557860698], ["Acquire Infrastructure", 0.23333786497225326], ["Proxy", 0.03227616723516701], ["Stage Capabilities", 0.029846198176634628], ["Dynamic Resolution", 0.02697937570404984], ["Network Denial of Service", 0.025052212990441636]], "HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.": [["Application Layer Protocol", 0.3933017087112552], ["Proxy", 0.17744497928574832], ["Non-Application Layer Protocol", 0.0500740194346194], ["Non-Standard Port", 0.04624562783515468], ["Data Obfuscation", 0.029933526006527874], ["Protocol Tunneling", 0.029210844569904453]], "HTTP and HTTPS are supported": [["Application Layer Protocol", 0.6990392639297727], ["Non-Standard Port", 0.03841569626242032], ["Fallback Channels", 0.023534237080227206], ["Data Obfuscation", 0.018250571735441125], ["Encrypted Channel", 0.01544593964116518], ["Non-Application Layer Protocol", 0.01181411311057649]], "HTTP with long polling": [["Application Layer Protocol", 0.2809465332911044], ["Non-Application Layer Protocol", 0.059020204050625344], ["Fallback Channels", 0.047942803127259785], ["Non-Standard Port", 0.044764018099513546], ["Endpoint Denial of Service", 0.04149754596258596], ["Data Obfuscation", 0.03122093622278905]], "connect by sending a GET request to a URL from the configuration and provide a special cookie value": [["Steal Web Session Cookie", 0.17648480831559463], ["Use Alternate Authentication Material", 0.14843681520782168], ["Forge Web Credentials", 0.14724304143414227], ["Application Layer Protocol", 0.03743508268358199], ["Browser Extensions", 0.02141476018027246], ["Browser Session Hijacking", 0.01730142390730897]], "sends GET requests with pull operations.": [["Ingress Tool Transfer", 0.09346021094404858], ["Web Service", 0.053716864846806794], ["Data from Local System", 0.03723409930237862], ["Native API", 0.03410346437594828], ["Application Layer Protocol", 0.03400537722634569], ["Command and Scripting Interpreter", 0.031078139533205193]], "POST request with push operation": [["Application Layer Protocol", 0.09589053574835005], ["Exfiltration Over C2 Channel", 0.055729886574749525], ["Web Service", 0.03341215618846782], ["Fallback Channels", 0.031102938409598515], ["Exfiltration Over Alternative Protocol", 0.030188935403552466], ["Use Alternate Authentication Material", 0.027809681664784657]], "use HTTP/HTTPS for C2 connections": [["Application Layer Protocol", 0.6936741525077875], ["Non-Application Layer Protocol", 0.03294879881281714], ["Encrypted Channel", 0.03134147141656582], ["Proxy", 0.03031600656869376], ["Non-Standard Port", 0.030123275177349963], ["Data Obfuscation", 0.029414576002672735]], "An encrypted resume": [["Data Encrypted for Impact", 0.22331995112010855], ["Encrypted Channel", 0.06403457232908555], ["Obfuscated Files or Information", 0.060269812055548065], ["Archive Collected Data", 0.06015874329735035], ["Deobfuscate/Decode Files or Information", 0.054482991265797365], ["Execution Guardrails", 0.03143549872617532]], "archive": [["Archive Collected Data", 0.27041270064199147], ["Automated Collection", 0.07365008789181039], ["Data Staged", 0.07360449404710827], ["Exfiltration Over C2 Channel", 0.05086974691079796], ["Indicator Removal", 0.032129231246239225], ["Automated Exfiltration", 0.030269071790509063]], "archive contains a bait PDF document": [["Archive Collected Data", 0.15784027902913764], ["Template Injection", 0.06275341765321073], ["Automated Collection", 0.058571058924077234], ["Deobfuscate/Decode Files or Information", 0.04725520898273167], ["Data from Local System", 0.04161368518060952], ["Phishing", 0.036565302863358434]], "XOR encrypted with a 16-byte key": [["Deobfuscate/Decode Files or Information", 0.24478499169189133], ["Obfuscated Files or Information", 0.23686264653873212], ["Encrypted Channel", 0.18318374193854556], ["Data Encrypted for Impact", 0.08578234606396168], ["Weaken Encryption", 0.03940061806937818], ["Archive Collected Data", 0.03744503746791439]], "obfuscated with VMProtect": [["Obfuscated Files or Information", 0.6286097237376519], ["Deobfuscate/Decode Files or Information", 0.11929969952990335], ["Archive Collected Data", 0.05403544226913093], ["Hide Artifacts", 0.01910240192093819], ["Data Encrypted for Impact", 0.018133926994637017], ["Encrypted Channel", 0.010641595490000839]], "additional XOR encryption with the key": [["Encrypted Channel", 0.2171014493502923], ["Obfuscated Files or Information", 0.17925093172872134], ["Deobfuscate/Decode Files or Information", 0.15622356645885851], ["Data Encrypted for Impact", 0.12358585129081265], ["Weaken Encryption", 0.06046040265755476], ["Archive Collected Data", 0.04859658027925853]], "AES-128-CBC for encryption.": [["Encrypted Channel", 0.2770504932277999], ["Obfuscated Files or Information", 0.17352785583914837], ["Deobfuscate/Decode Files or Information", 0.07863474483418463], ["Weaken Encryption", 0.07739387330643227], ["Data Encrypted for Impact", 0.06860887296904629], ["Archive Collected Data", 0.05556545287309432]], "hashed with MD5": [["Obfuscated Files or Information", 0.15489802168014538], ["Use Alternate Authentication Material", 0.1293948751734256], ["Steal or Forge Kerberos Tickets", 0.048221666864211817], ["Data Encoding", 0.0410919686467991], ["Adversary-in-the-Middle", 0.04032772542296907], ["Encrypted Channel", 0.026360331441915654]], "use AES-128 in CFB mode as the encryption algorithm": [["Encrypted Channel", 0.28526912167481316], ["Obfuscated Files or Information", 0.21186699967729056], ["Deobfuscate/Decode Files or Information", 0.09696524194856006], ["Data Encrypted for Impact", 0.06693170451227706], ["Weaken Encryption", 0.043396154047173154], ["Archive Collected Data", 0.037992530883347295]], "encrypted with the algorithm": [["Obfuscated Files or Information", 0.21982696482941527], ["Encrypted Channel", 0.15267761671495433], ["Data Encrypted for Impact", 0.1372736207301237], ["Deobfuscate/Decode Files or Information", 0.1100299976704826], ["Archive Collected Data", 0.07729633817419129], ["Weaken Encryption", 0.06331194774332599]], "a RAR archive": [["Archive Collected Data", 0.27766926674449466], ["Automated Collection", 0.12282535427269538], ["Data from Local System", 0.06623247588851268], ["Exfiltration Over C2 Channel", 0.04689686716082732], ["Data Staged", 0.04140675688081172], ["Data from Information Repositories", 0.027324440598862618]], "distributed in a RAR archive": [["Archive Collected Data", 0.1652037132769302], ["Data Staged", 0.05118650690649533], ["Web Service", 0.037625882052060924], ["Exfiltration Over Alternative Protocol", 0.03492148600729399], ["Exfiltration Over Web Service", 0.03433011361177109], ["Exfiltration Over C2 Channel", 0.027401227752023742]], "ROR-13 hash": [["Use Alternate Authentication Material", 0.2210182416968019], ["Steal or Forge Kerberos Tickets", 0.08659675570046584], ["Obfuscated Files or Information", 0.0839428821226595], ["Adversary-in-the-Middle", 0.0626568657160506], ["Data Encoding", 0.044709285092593386], ["Encrypted Channel", 0.04204362535285838]], "re-encrypted and saved in the same location": [["Archive Collected Data", 0.29733522101400756], ["Deobfuscate/Decode Files or Information", 0.12385120829213674], ["Data Encrypted for Impact", 0.10122656656958116], ["Obfuscated Files or Information", 0.052255422717845564], ["Exfiltration Over Alternative Protocol", 0.03539695533601009], ["Hide Artifacts", 0.02221830764237574]], "encrypted header": [["Obfuscated Files or Information", 0.3349868433691228], ["Encrypted Channel", 0.10075281820303018], ["Deobfuscate/Decode Files or Information", 0.08873892328062963], ["Data Encoding", 0.06168456168597875], ["Archive Collected Data", 0.04394162827744967], ["Data Encrypted for Impact", 0.040264444578911825]], "encrypted Base64 string containing the session GUID": [["Obfuscated Files or Information", 0.2020636994851955], ["Deobfuscate/Decode Files or Information", 0.1157684899591608], ["Data Encoding", 0.08722264857991303], ["Encrypted Channel", 0.056666550934570147], ["Steal or Forge Kerberos Tickets", 0.03733557055843143], ["Data Obfuscation", 0.025653467525661083]], "compressed with GZip prior to encryption": [["Archive Collected Data", 0.5269005583399656], ["Obfuscated Files or Information", 0.17477715131207777], ["Deobfuscate/Decode Files or Information", 0.09248787478394176], ["Data Encrypted for Impact", 0.037294178143736256], ["Encrypted Channel", 0.014105796502807418], ["Exfiltration Over Alternative Protocol", 0.012651295429941865]], "are obfuscated with VMProtect": [["Obfuscated Files or Information", 0.6178796775279984], ["Deobfuscate/Decode Files or Information", 0.12840165056402664], ["Archive Collected Data", 0.050991697775429654], ["Hide Artifacts", 0.023823937780735053], ["Data Encrypted for Impact", 0.014563317331466276], ["Execution Guardrails", 0.008998779409135332]], "obfuscated": [["Obfuscated Files or Information", 0.6676319434000908], ["Deobfuscate/Decode Files or Information", 0.12574139938369477], ["Archive Collected Data", 0.0273679270732824], ["Data Encoding", 0.019407991911719463], ["Encrypted Channel", 0.013338169556140415], ["Data Obfuscation", 0.011600777484368456]], "obfuscated code": [["Obfuscated Files or Information", 0.8044670246046115], ["Deobfuscate/Decode Files or Information", 0.0773122407967019], ["Encrypted Channel", 0.010571703237756514], ["Data Obfuscation", 0.009265330106672914], ["Data Encoding", 0.008411990390012974], ["Execution Guardrails", 0.007857115446485463]], "is encrypted in the file": [["Deobfuscate/Decode Files or Information", 0.29526142305163494], ["Obfuscated Files or Information", 0.22051849295844064], ["Data Encrypted for Impact", 0.13725943102776714], ["Archive Collected Data", 0.08456054019784666], ["Encrypted Channel", 0.02170517618155762], ["Execution Guardrails", 0.013556890156827135]], "is re-encrypted": [["Deobfuscate/Decode Files or Information", 0.18545202076629863], ["Data Encrypted for Impact", 0.17137066442635376], ["Archive Collected Data", 0.08797840670684871], ["Weaken Encryption", 0.06533252508397162], ["Obfuscated Files or Information", 0.054955782912302735], ["Encrypted Channel", 0.040577280987508735]], "has been obfuscated with the same rel_jmp and fake-jb techniques": [["Obfuscated Files or Information", 0.729909212599564], ["Deobfuscate/Decode Files or Information", 0.06726348771220424], ["Data Obfuscation", 0.026833137573571128], ["Data Encoding", 0.024479464488645932], ["Archive Collected Data", 0.01652184100018133], ["Encrypted Channel", 0.014415445440517781]], "SFX archive": [["Archive Collected Data", 0.1791634382631013], ["Data Staged", 0.07558078801978368], ["Data from Local System", 0.06737993568875494], ["Automated Collection", 0.06666633514789787], ["Exfiltration Over C2 Channel", 0.04133122032136674], ["Exfiltration Over Web Service", 0.032287906619131085]], "RAR and SFX-RAR files": [["Archive Collected Data", 0.1631712343681137], ["Deobfuscate/Decode Files or Information", 0.10211211195674975], ["Obfuscated Files or Information", 0.0873847859591257], ["Masquerading", 0.07731600438627974], ["Hide Artifacts", 0.02169389959170714], ["Automated Collection", 0.021562699827800968]], "plus the folder": [["File and Directory Discovery", 0.22731660881001348], ["Data Staged", 0.14558597518526809], ["Data from Local System", 0.1015767707825945], ["Data from Network Shared Drive", 0.04613215854015675], ["Indicator Removal", 0.04342480513756704], ["Hide Artifacts", 0.04339902106634015]], "malicious archive,": [["Archive Collected Data", 0.2822055527774653], ["Deobfuscate/Decode Files or Information", 0.0748900946881259], ["Obfuscated Files or Information", 0.044722802269348716], ["Indicator Removal", 0.03493566010937838], ["Automated Collection", 0.03007201763247107], ["Ingress Tool Transfer", 0.02915411166944804]], "located in the data sections": [["Data Staged", 0.12882230410449624], ["File and Directory Discovery", 0.10759232909305518], ["Automated Collection", 0.08641746948143984], ["Data from Local System", 0.08574046504104918], ["Data from Information Repositories", 0.031125097825495596], ["Data from Network Shared Drive", 0.022106130117825817]], "shellcode is located in a PE file overlay.": [["Obfuscated Files or Information", 0.08171725374787275], ["Native API", 0.0738646013164928], ["Deobfuscate/Decode Files or Information", 0.04745661495604238], ["Query Registry", 0.04695934672745555], ["OS Credential Dumping", 0.03561507918504171], ["Event Triggered Execution", 0.033326681713041956]], "(encrypted) shellcode": [["Obfuscated Files or Information", 0.4702350380023658], ["Deobfuscate/Decode Files or Information", 0.2506266088765551], ["Encrypted Channel", 0.050985902138500495], ["Data Encoding", 0.027930656451692], ["Data Encrypted for Impact", 0.024361499440570013], ["Archive Collected Data", 0.01970614080164153]], "consists of two .exe files.": [["Masquerading", 0.2307362140251661], ["System Binary Proxy Execution", 0.1642460135203317], ["Hijack Execution Flow", 0.06810508329974257], ["Process Injection", 0.03279492079475409], ["Ingress Tool Transfer", 0.03182554524794851], ["Hide Artifacts", 0.02934320681875576]], "contains three identical executable files": [["Hijack Execution Flow", 0.12927006296225294], ["Masquerading", 0.11912123599587218], ["System Binary Proxy Execution", 0.10797456104721102], ["Ingress Tool Transfer", 0.04252479475156373], ["File and Directory Discovery", 0.042471003738915956], ["XSL Script Processing", 0.041860692315332446]], "contains just one file:": [["File and Directory Discovery", 0.2219170975563858], ["Indicator Removal", 0.07875748430261634], ["Hide Artifacts", 0.06470286379067215], ["Data Staged", 0.06235677413510633], ["Ingress Tool Transfer", 0.053728761846528174], ["Automated Collection", 0.05000444909988338]], "which is also embedded inside the CHM file": [["Hijack Execution Flow", 0.15297022375349764], ["Boot or Logon Autostart Execution", 0.08191012289300109], ["System Binary Proxy Execution", 0.0655827527377892], ["Masquerading", 0.05457557475753551], ["XSL Script Processing", 0.028765824105447153], ["File and Directory Discovery", 0.028337763228100592]], "three sections are extracted": [["Automated Collection", 0.09798370108062551], ["Data Staged", 0.05548818088948428], ["Data from Local System", 0.04658691856833394], ["Deobfuscate/Decode Files or Information", 0.04341749685164206], ["Data Manipulation", 0.03244799483790234], ["Command and Scripting Interpreter", 0.03233631678631602]], "malicious shortcuts": [["Boot or Logon Autostart Execution", 0.324560504165781], ["Masquerading", 0.042529422807901104], ["User Execution", 0.036499916543775976], ["Event Triggered Execution", 0.03361698945721268], ["Office Application Startup", 0.03086316175277893], ["Command and Scripting Interpreter", 0.024034893201940816]], "Web lnks with two shortcuts:": [["Web Service", 0.10104082164292702], ["Browser Bookmark Discovery", 0.04860767077046927], ["Credentials from Password Stores", 0.04489780261196947], ["Server Software Component", 0.040337826148830316], ["Stage Capabilities", 0.03719915572757483], ["Browser Session Hijacking", 0.030240150166677256]], "copies the payload to the folder C:\\Users\\Public\\Downloads": [["Ingress Tool Transfer", 0.48586325165728206], ["Data Staged", 0.047625280663767484], ["Command and Scripting Interpreter", 0.037823608900789084], ["Data from Local System", 0.03207539255104463], ["BITS Jobs", 0.030921231769779886], ["Lateral Tool Transfer", 0.01704650008007506]], "PDF documents with a CV and IELTS certificate": [["Template Injection", 0.1468272567664277], ["Phishing", 0.1005854431362249], ["Obtain Capabilities", 0.09996003904066518], ["Stage Capabilities", 0.05404125295468355], ["Develop Capabilities", 0.04934148687020738], ["User Execution", 0.04391656071665636]], "the folder C:\\Users\\Public": [["File and Directory Discovery", 0.2655395864045831], ["Data Staged", 0.12835216679268177], ["Data from Local System", 0.09292335922825268], ["Data from Network Shared Drive", 0.050928039080901495], ["Hide Artifacts", 0.030927579074096316], ["Indicator Removal", 0.029047699833336618]], "copied to the folder %appdata%\\Microsoft\\AddIns\\": [["Data Staged", 0.11038838012141085], ["Data from Local System", 0.07772897581386397], ["Ingress Tool Transfer", 0.056973749341792945], ["Masquerading", 0.05333921283706511], ["File and Directory Discovery", 0.05286246559311545], ["Data from Network Shared Drive", 0.032544834766843105]], "into the folder c:\\programdata": [["Masquerading", 0.08165832702470016], ["File and Directory Discovery", 0.07643465943196877], ["Data Staged", 0.06919948423605894], ["Hijack Execution Flow", 0.05711824873943084], ["Data from Local System", 0.042246450499848216], ["Hide Artifacts", 0.038203718335134924]], "folder c:\\programdata": [["File and Directory Discovery", 0.29526296012806547], ["Data Staged", 0.09025061035511556], ["Masquerading", 0.057010450793155865], ["Data from Local System", 0.04708952949423863], ["Hide Artifacts", 0.041019206631099106], ["Indicator Removal", 0.027034354736433425]], "trying to open either of the shortcuts": [["Boot or Logon Autostart Execution", 0.2548342705715117], ["Office Application Startup", 0.03937482279576229], ["Query Registry", 0.035799836865079065], ["Native API", 0.032016993762427476], ["File and Directory Discovery", 0.02560947741037063], ["Deobfuscate/Decode Files or Information", 0.025326106462999775]], "If the user opens it directly": [["User Execution", 0.13057417252289322], ["Office Application Startup", 0.07673014319658508], ["Native API", 0.06886828249962129], ["Event Triggered Execution", 0.05949741095778183], ["Masquerading", 0.04897586171879505], ["Hide Artifacts", 0.04484337212583949]], "tries to make users run malicious .lnk, .chm, and .exe files": [["System Binary Proxy Execution", 0.25003965839641523], ["Masquerading", 0.15761053433475092], ["User Execution", 0.08884119524510355], ["Boot or Logon Autostart Execution", 0.08407531394607269], ["Hijack Execution Flow", 0.07006026504740569], ["Event Triggered Execution", 0.04290987070685676]], "running a command that extracts a Base64-encoded CAB archive from the body of the LNK file,": [["Deobfuscate/Decode Files or Information", 0.3660631733979399], ["Obfuscated Files or Information", 0.17753340805298917], ["Archive Collected Data", 0.05035395385258394], ["Automated Collection", 0.0342588545273295], ["Data Encoding", 0.0311523751659114], ["OS Credential Dumping", 0.024914241458608388]], "archive is unpacked to a temporary folder.": [["Archive Collected Data", 0.27358378074396744], ["Data Staged", 0.08720786754768343], ["Indicator Removal", 0.07723938029727564], ["Deobfuscate/Decode Files or Information", 0.07130033187173376], ["Automated Collection", 0.0351764453196351], ["Obfuscated Files or Information", 0.02359679254281339]], "an extracted JS script": [["Command and Scripting Interpreter", 0.24855394156100272], ["Ingress Tool Transfer", 0.08577301968629841], ["Deobfuscate/Decode Files or Information", 0.07145440377929772], ["System Binary Proxy Execution", 0.03851790882952899], ["Obfuscated Files or Information", 0.028214001377265204], ["Template Injection", 0.025518782057328843]], "extract shellcode": [["Deobfuscate/Decode Files or Information", 0.34197463529759614], ["Obfuscated Files or Information", 0.24537532665246364], ["Native API", 0.06948911621435531], ["Command and Scripting Interpreter", 0.03350866738368797], ["OS Credential Dumping", 0.02185797252466409], ["System Binary Proxy Execution", 0.012460470178240871]], "decrypts the string": [["Deobfuscate/Decode Files or Information", 0.6577634153013394], ["Obfuscated Files or Information", 0.1022286804078768], ["Data Encoding", 0.044337495288256784], ["Encrypted Channel", 0.03515679187514055], ["Archive Collected Data", 0.0223213543027979], ["Data Encrypted for Impact", 0.02157768355599853]], "used for decryption:": [["Deobfuscate/Decode Files or Information", 0.5499119064628745], ["Data Encrypted for Impact", 0.09388859676684273], ["Archive Collected Data", 0.07882050925311157], ["Obfuscated Files or Information", 0.058743694881806], ["Encrypted Channel", 0.036150861396561824], ["Weaken Encryption", 0.027785622808765086]], "is unpacked": [["Obfuscated Files or Information", 0.1719911370131217], ["Deobfuscate/Decode Files or Information", 0.1329798628342002], ["Ingress Tool Transfer", 0.02882978931942037], ["Command and Scripting Interpreter", 0.02846508533946977], ["Masquerading", 0.028152397916565847], ["Indicator Removal", 0.026703511318503653]], "unpacks": [["Deobfuscate/Decode Files or Information", 0.2801471969280594], ["Obfuscated Files or Information", 0.1685289216739593], ["Archive Collected Data", 0.037670612217251674], ["Masquerading", 0.03465680916237946], ["Command and Scripting Interpreter", 0.03142752702093605], ["Indicator Removal", 0.021895337436987124]], "encrypted portion of the data is decrypted": [["Data Encrypted for Impact", 0.19223606313249741], ["Deobfuscate/Decode Files or Information", 0.1826743419569477], ["Archive Collected Data", 0.16809132290055115], ["Obfuscated Files or Information", 0.09843340989295213], ["Weaken Encryption", 0.04294000881921842], ["Encrypted Channel", 0.041918006383417826]], "is decrypted": [["Deobfuscate/Decode Files or Information", 0.5291506894266116], ["Data Encrypted for Impact", 0.11060484019085982], ["Obfuscated Files or Information", 0.04384770361856056], ["Archive Collected Data", 0.043522516460990146], ["Weaken Encryption", 0.03427745162957389], ["Encrypted Channel", 0.02860714453668374]], "decryption and decompression": [["Deobfuscate/Decode Files or Information", 0.5005088878578314], ["Archive Collected Data", 0.19442545790603885], ["Obfuscated Files or Information", 0.06898049552146147], ["Data Encrypted for Impact", 0.05119761116838198], ["Encrypted Channel", 0.02044839748526195], ["Weaken Encryption", 0.015028021133873156]], "decryption": [["Deobfuscate/Decode Files or Information", 0.6884672706023317], ["Data Encrypted for Impact", 0.06556477487399798], ["Archive Collected Data", 0.04870380928263675], ["Obfuscated Files or Information", 0.03489888802916109], ["Encrypted Channel", 0.024152308458470814], ["Weaken Encryption", 0.020687123620039535]], "decodes it into shellcode with Base64": [["Deobfuscate/Decode Files or Information", 0.5350322678855121], ["Obfuscated Files or Information", 0.20476259330703772], ["Data Encoding", 0.1427024732496114], ["Archive Collected Data", 0.01865787309063772], ["Data Obfuscation", 0.010580455418979071], ["Encrypted Channel", 0.009693826401085811]], "uses a custom PL format with encryption": [["Obfuscated Files or Information", 0.35470054156194114], ["Archive Collected Data", 0.09759745587588763], ["Deobfuscate/Decode Files or Information", 0.09233025050724705], ["Encrypted Channel", 0.08672516842141158], ["Data Encrypted for Impact", 0.08559421010250207], ["Data Encoding", 0.03310612560046746]], "adding itself to the startup folder": [["Boot or Logon Autostart Execution", 0.48453069925050296], ["Boot or Logon Initialization Scripts", 0.1455014903076613], ["Create or Modify System Process", 0.08966772722393845], ["Event Triggered Execution", 0.019459525989145843], ["Replication Through Removable Media", 0.019175270914803904], ["Office Application Startup", 0.0172210412786776]], "writes the file svchost.bat, which transfers control to winness.exe, to the startup folder": [["Boot or Logon Autostart Execution", 0.3972034141514394], ["Boot or Logon Initialization Scripts", 0.06215701226551749], ["Create or Modify System Process", 0.04738225119033478], ["Event Triggered Execution", 0.031076407467544018], ["Modify Registry", 0.02732536082209687], ["Masquerading", 0.026389060896626737]], "persists by means of a registry run key or a startup folder": [["Boot or Logon Autostart Execution", 0.6523699331012226], ["Boot or Logon Initialization Scripts", 0.0818492876525113], ["Modify Registry", 0.05201427668128279], ["Create or Modify System Process", 0.041431913684615566], ["Event Triggered Execution", 0.027309964822635313], ["Office Application Startup", 0.01857170901466152]], "adding a scheduler task,": [["Scheduled Task/Job", 0.8079701687557344], ["Inter-Process Communication", 0.039350046476707305], ["Masquerading", 0.01329524297816811], ["Create or Modify System Process", 0.009629070335999974], ["Command and Scripting Interpreter", 0.008826482281475399], ["System Services", 0.007003656379945752]], "creates a task with schtasks for persistence": [["Scheduled Task/Job", 0.7668508171405449], ["Inter-Process Communication", 0.027861285609732445], ["Create or Modify System Process", 0.027054013133651352], ["Masquerading", 0.012831543915419909], ["Boot or Logon Autostart Execution", 0.010422287975256366], ["Event Triggered Execution", 0.009433067711459289]], "that all three intermediate C2 servers": [["Fallback Channels", 0.369979030297952], ["Application Layer Protocol", 0.09651627643350388], ["Web Service", 0.08894877921157791], ["Proxy", 0.07196082894988934], ["Exfiltration Over C2 Channel", 0.030793608686143017], ["Dynamic Resolution", 0.029257340993045992]], "possible proxy servers (any indicated in the configuration plus system proxies) and C2 servers": [["Proxy", 0.49071111342551965], ["Application Layer Protocol", 0.07932757182420723], ["Fallback Channels", 0.06547843839428082], ["Compromise Infrastructure", 0.0249316788252856], ["Non-Application Layer Protocol", 0.019031106790865688], ["Protocol Tunneling", 0.018948806707595262]], "proxy server": [["Proxy", 0.5877842674834962], ["Fallback Channels", 0.038163282729731435], ["Application Layer Protocol", 0.03785179268752865], ["Compromise Infrastructure", 0.026147556340027352], ["Protocol Tunneling", 0.02089706076251459], ["Data Obfuscation", 0.013849998789331514]], "\u2013 proxy server address and credentials": [["Proxy", 0.21932998903887688], ["Application Layer Protocol", 0.05289419753041854], ["System Network Configuration Discovery", 0.0446748894228965], ["Network Sniffing", 0.04074644464327009], ["Steal Web Session Cookie", 0.03629833537158434], ["Browser Session Hijacking", 0.030310976757670693]], "collects and sends system information": [["System Information Discovery", 0.6966246341016201], ["Windows Management Instrumentation", 0.03809877451234465], ["Virtualization/Sandbox Evasion", 0.03504093227203863], ["System Network Configuration Discovery", 0.017308907975841503], ["Software Discovery", 0.01719139592400473], ["Automated Collection", 0.013059646759732617]], "OS uptime": [["System Time Discovery", 0.13072825682410566], ["Scheduled Task/Job", 0.09045183508249867], ["System Information Discovery", 0.05308037535801721], ["Indicator Removal", 0.03727368770509118], ["Virtualization/Sandbox Evasion", 0.03193833765954316], ["System Shutdown/Reboot", 0.023074983684866157]], "Operating system version and whether it is 32-bit or 64-bit": [["System Information Discovery", 0.8271427518378262], ["Software Discovery", 0.021648194291332124], ["Virtualization/Sandbox Evasion", 0.01881390129358404], ["Windows Management Instrumentation", 0.010762054995047107], ["Modify System Image", 0.009796142908003336], ["Query Registry", 0.008487783362437181]], "Computer name\nName of running module\nPID": [["Process Discovery", 0.28805545893373974], ["System Information Discovery", 0.13162376507596654], ["Windows Management Instrumentation", 0.07246426357940057], ["Native API", 0.04333569232193241], ["Virtualization/Sandbox Evasion", 0.029673069095141322], ["Access Token Manipulation", 0.02342307880863769]], "Shellcode version and whether it is 32-bit or 64-bit": [["System Information Discovery", 0.3622862290368343], ["Obfuscated Files or Information", 0.07646503779057529], ["Software Discovery", 0.06672509502474552], ["Virtualization/Sandbox Evasion", 0.05554419760071183], ["Query Registry", 0.03983917128088223], ["Native API", 0.036511246154356754]], "Whether the OS is 32-bit or 64-bit": [["System Information Discovery", 0.711485683061373], ["Virtualization/Sandbox Evasion", 0.045318027126729415], ["Software Discovery", 0.027787597366974812], ["Windows Management Instrumentation", 0.0129401687953604], ["Modify System Image", 0.011924946479001613], ["Obfuscated Files or Information", 0.010340627473392325]], "Computer name": [["System Information Discovery", 0.2812592735238526], ["Remote System Discovery", 0.08708376367932599], ["Masquerading", 0.08096687606275084], ["System Owner/User Discovery", 0.037423095393962644], ["System Network Configuration Discovery", 0.02484792355618105], ["Dynamic Resolution", 0.02300803182169836]], "collect information about the computer name and OS version and whether it is 32-bit or 64-bit": [["System Information Discovery", 0.904778535214856], ["Virtualization/Sandbox Evasion", 0.012845010083506102], ["Software Discovery", 0.009649802953635657], ["Windows Management Instrumentation", 0.008655074311166099], ["File and Directory Discovery", 0.006260722705134433], ["Query Registry", 0.0058695108352787425]], "Network adapter IP addresses\nMAC address of one of the adapters": [["System Network Configuration Discovery", 0.7004971501197621], ["Adversary-in-the-Middle", 0.032726571596923444], ["System Network Connections Discovery", 0.028754583084824266], ["Data from Configuration Repository", 0.018969929645135775], ["Remote System Discovery", 0.014823204075520475], ["Dynamic Resolution", 0.01116630974918635]], "List of IP addresses": [["System Network Configuration Discovery", 0.4435897290223369], ["Remote System Discovery", 0.11601193526530398], ["Gather Victim Network Information", 0.056891196236457484], ["System Network Connections Discovery", 0.050617179388456404], ["Network Service Discovery", 0.035270329245586506], ["Active Scanning", 0.03266513000829932]], "MAC addresses of network adapters": [["System Network Configuration Discovery", 0.4021427633462535], ["Adversary-in-the-Middle", 0.07362095746422581], ["Data from Configuration Repository", 0.059733168765130955], ["System Network Connections Discovery", 0.037698858788889573], ["Remote System Discovery", 0.032735604530989136], ["Peripheral Device Discovery", 0.022787849397321477]], "Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.": [["System Network Connections Discovery", 0.3016647403555933], ["Query Registry", 0.09448432621367484], ["System Network Configuration Discovery", 0.03829979315757791], ["Network Service Discovery", 0.029517811686946102], ["Windows Management Instrumentation", 0.018810297292941314], ["Software Discovery", 0.01775489643320451]], "collect information about the IP and MAC addresses of the infected machine": [["System Network Configuration Discovery", 0.7484469616515514], ["Remote System Discovery", 0.050818954483209215], ["System Network Connections Discovery", 0.03626058355611219], ["System Information Discovery", 0.020613101695164397], ["Data from Configuration Repository", 0.011697403397038297], ["Gather Victim Network Information", 0.010904328147104191]], "Username": [["System Owner/User Discovery", 0.3289063559647771], ["Masquerading", 0.024849620469869212], ["Access Token Manipulation", 0.022982127837062098], ["Account Discovery", 0.021510716801012134], ["Use Alternate Authentication Material", 0.0189108980796959], ["Create Account", 0.013227243661488539]], "Username and workgroup": [["System Owner/User Discovery", 0.21140666959736099], ["Remote Services", 0.11850435149247052], ["Account Discovery", 0.11345593185179366], ["Permission Groups Discovery", 0.07715976279525082], ["Create Account", 0.04561352454537511], ["Valid Accounts", 0.04521023329391254]], "collect information about the name of the current user": [["System Owner/User Discovery", 0.8801124080936702], ["Account Discovery", 0.0452883673031145], ["System Information Discovery", 0.012798349672553593], ["Permission Groups Discovery", 0.0057665408195041], ["System Network Configuration Discovery", 0.0025874986378652716], ["Native API", 0.002126200991198106]], "Transport-level protocol": [["Non-Application Layer Protocol", 0.23623389610311513], ["Application Layer Protocol", 0.1362934229494902], ["Protocol Tunneling", 0.08004184239818087], ["Encrypted Channel", 0.06892276501500114], ["Non-Standard Port", 0.05710400927423485], ["Data Obfuscation", 0.05655071747182203]], "Standard TCP connection": [["Non-Application Layer Protocol", 0.415966412590426], ["Non-Standard Port", 0.10709783915893352], ["Application Layer Protocol", 0.07992113993131149], ["Protocol Tunneling", 0.0550387998952879], ["Proxy", 0.039199562425292], ["Encrypted Channel", 0.029063429003779975]], "two TCP connections.": [["Non-Application Layer Protocol", 0.277149682880136], ["Proxy", 0.08419690899156868], ["Non-Standard Port", 0.06426347023602436], ["Fallback Channels", 0.06007967989272122], ["System Network Connections Discovery", 0.046520384755388465], ["Protocol Tunneling", 0.045256129720998683]], "Duplication of socket with TLS connection": [["Non-Application Layer Protocol", 0.16221015493133054], ["Non-Standard Port", 0.13770898229326822], ["Encrypted Channel", 0.0975144193039472], ["Data Obfuscation", 0.047710196666736156], ["Protocol Tunneling", 0.046209263317199316], ["Fallback Channels", 0.045525972505164276]], "establishes a TCP connection": [["Non-Application Layer Protocol", 0.3805936749510375], ["Non-Standard Port", 0.1032418875008724], ["Application Layer Protocol", 0.06443396601687254], ["Protocol Tunneling", 0.047839446061396756], ["Proxy", 0.045186236805890324], ["System Network Connections Discovery", 0.03684975016135679]], "messages are exchanged in the original TCP connection (without TLS encryption).": [["Non-Application Layer Protocol", 0.36435550381730947], ["Encrypted Channel", 0.1472549044896452], ["Application Layer Protocol", 0.09861193852545187], ["Non-Standard Port", 0.05378133888939893], ["Protocol Tunneling", 0.04050690968731572], ["Exfiltration Over Alternative Protocol", 0.03540654029658386]], "KCP protocol": [["Non-Application Layer Protocol", 0.13499749770681232], ["Encrypted Channel", 0.0970422760463976], ["Application Layer Protocol", 0.05761836977952185], ["Exfiltration Over Alternative Protocol", 0.053229004291804924], ["Fallback Channels", 0.0474602325207056], ["Data Obfuscation", 0.0438725907930122]], "uses KCP on top of a TCP connection": [["Non-Application Layer Protocol", 0.40549198250789875], ["Proxy", 0.05036261955195832], ["Non-Standard Port", 0.047303052431945776], ["Application Layer Protocol", 0.044176173936023626], ["Encrypted Channel", 0.04363194680114958], ["Protocol Tunneling", 0.043138115262294115]], "three ways to connect to the C2 server": [["Application Layer Protocol", 0.2557211841967426], ["Fallback Channels", 0.17488980321333333], ["Proxy", 0.07372795104765878], ["Non-Application Layer Protocol", 0.06131221136506165], ["Web Service", 0.05835099706762565], ["Dynamic Resolution", 0.025794045524356577]], "Transport protocol 3, port 8443\nTransport protocol 2, port 80\nTransport protocol 1, port 8080": [["Non-Standard Port", 0.37156886476408824], ["Application Layer Protocol", 0.08731250345656419], ["Traffic Signaling", 0.07066289094029465], ["Non-Application Layer Protocol", 0.06420550047947873], ["Protocol Tunneling", 0.04801250654744216], ["Dynamic Resolution", 0.03266904977972754]], "TcpConnector and TcpBindConnector are classes responsible for connecting over TCP as client and server": [["Non-Application Layer Protocol", 0.4340348527172579], ["Non-Standard Port", 0.07618319720094541], ["System Network Connections Discovery", 0.056565438539188065], ["Application Layer Protocol", 0.041126208197253135], ["Traffic Signaling", 0.03088858993402949], ["Protocol Tunneling", 0.02792136197600756]], "Transport protocols\nTCP": [["Non-Application Layer Protocol", 0.4610998085797025], ["Application Layer Protocol", 0.10465499091358554], ["Non-Standard Port", 0.0837892758448582], ["Protocol Tunneling", 0.04350175445617085], ["Encrypted Channel", 0.0421691978858688], ["Network Sniffing", 0.02738256749645172]], "RPC (Pipe)": [["Non-Application Layer Protocol", 0.0885826105239893], ["Network Sniffing", 0.08819325515616347], ["Command and Scripting Interpreter", 0.05330007900413653], ["Native API", 0.05048337555457052], ["Encrypted Channel", 0.04358092158426408], ["Application Layer Protocol", 0.03273854160112002]], "Network-level protocol": [["Non-Application Layer Protocol", 0.17729608894241974], ["Application Layer Protocol", 0.12914829599943145], ["Protocol Tunneling", 0.06940128808491032], ["Adversary-in-the-Middle", 0.0536448640218782], ["Encrypted Channel", 0.05176087137321767], ["Non-Standard Port", 0.04997458975820032]], "support for multiple transport protocols for connecting to C2 servers": [["Application Layer Protocol", 0.3374616684429602], ["Non-Application Layer Protocol", 0.17428713062975676], ["Encrypted Channel", 0.06469848730352545], ["Protocol Tunneling", 0.05973555050318355], ["Proxy", 0.05486014051389057], ["Data Obfuscation", 0.05165244371278898]], "use TCP and UDP for C2 connections": [["Non-Application Layer Protocol", 0.4855916309260515], ["Application Layer Protocol", 0.12156247768636724], ["Non-Standard Port", 0.04950958331405844], ["Proxy", 0.04752770095186997], ["Encrypted Channel", 0.04237242094794852], ["Protocol Tunneling", 0.0383542121950159]], "AES-128 is the encryption algorithm used.": [["Obfuscated Files or Information", 0.22266773476167198], ["Encrypted Channel", 0.16351969596526664], ["Deobfuscate/Decode Files or Information", 0.14137856698091072], ["Data Encrypted for Impact", 0.07599578627694076], ["Weaken Encryption", 0.05897745313361766], ["Archive Collected Data", 0.057110554857007216]], "encrypted with AES-256-CBC;": [["Encrypted Channel", 0.24507537478123145], ["Obfuscated Files or Information", 0.19064169992866495], ["Deobfuscate/Decode Files or Information", 0.12835460267093304], ["Data Encrypted for Impact", 0.06449635800705937], ["Archive Collected Data", 0.05999534918092803], ["Weaken Encryption", 0.059703480527604186]], "is encrypted in the standard way": [["Obfuscated Files or Information", 0.18494584402519346], ["Data Encrypted for Impact", 0.1731141912093372], ["Deobfuscate/Decode Files or Information", 0.11006797037473236], ["Encrypted Channel", 0.10005705608397482], ["Archive Collected Data", 0.08618954434737242], ["Weaken Encryption", 0.057939272281669264]], "encrypted in the backdoor's standard way,": [["Obfuscated Files or Information", 0.25426533625219294], ["Data Encrypted for Impact", 0.15485747166043684], ["Deobfuscate/Decode Files or Information", 0.10955014428084181], ["Encrypted Channel", 0.10028206266888004], ["Archive Collected Data", 0.06125539571502081], ["Weaken Encryption", 0.06023717596048186]], "data is encrypted in the standard way": [["Archive Collected Data", 0.16397522553067467], ["Data Encrypted for Impact", 0.15581037480784865], ["Obfuscated Files or Information", 0.14553850986995093], ["Deobfuscate/Decode Files or Information", 0.09514416158270655], ["Encrypted Channel", 0.08190504589082781], ["Weaken Encryption", 0.04536893530232888]], "uses AES for encrypting traffic in its backdoors": [["Encrypted Channel", 0.61026021874138], ["Weaken Encryption", 0.042908880484867344], ["Obfuscated Files or Information", 0.03210571760266749], ["Exfiltration Over Alternative Protocol", 0.028334683677195934], ["Data Obfuscation", 0.02507443935954526], ["Non-Application Layer Protocol", 0.021319858725533537]], "injectors": [["Process Injection", 0.5175687391017083], ["Shared Modules", 0.029160321493382286], ["Native API", 0.02656102035864919], ["Hijack Execution Flow", 0.018833138166341513], ["Obfuscated Files or Information", 0.017346979036103244], ["Command and Scripting Interpreter", 0.01675407442466719]], "run it in an active process": [["Native API", 0.2083835583864337], ["Process Injection", 0.14679852500022186], ["System Services", 0.09915608300699606], ["System Binary Proxy Execution", 0.06141418626330304], ["Process Discovery", 0.055238832597675695], ["Access Token Manipulation", 0.050295136018635965]], "running an arbitrary command in a CHM file via an ActiveX object": [["Command and Scripting Interpreter", 0.1781766434811027], ["System Binary Proxy Execution", 0.17204462028060427], ["Event Triggered Execution", 0.062152142412242324], ["Boot or Logon Autostart Execution", 0.048433120156279444], ["System Services", 0.046865179147615434], ["XSL Script Processing", 0.03760137157418718]], "runs in a new process": [["Process Injection", 0.31090280435825535], ["Native API", 0.13079269212102912], ["Access Token Manipulation", 0.10269320777424024], ["Process Discovery", 0.07962226956872498], ["System Services", 0.04019762161253311], ["Create or Modify System Process", 0.030766378616823138]], "is injected in a similar way": [["Process Injection", 0.2562312664496168], ["Command and Scripting Interpreter", 0.03023869979796519], ["Exploit Public-Facing Application", 0.02919113274062643], ["Shared Modules", 0.028940985916672612], ["Event Triggered Execution", 0.027900817566185437], ["Native API", 0.026432580847901708]], "injected into": [["Process Injection", 0.19270491667588166], ["Exploit Public-Facing Application", 0.04729490221871495], ["Command and Scripting Interpreter", 0.04604137449933185], ["Event Triggered Execution", 0.030186897201566636], ["Inter-Process Communication", 0.02335481674537714], ["Ingress Tool Transfer", 0.019758339465150182]], "Crosswalk and Metasploit injectors": [["Process Injection", 0.08420468613450593], ["Remote Services", 0.040942581233526926], ["Command and Scripting Interpreter", 0.03119477152058038], ["Hijack Execution Flow", 0.03084597936315118], ["Replication Through Removable Media", 0.029244913488788868], ["Ingress Tool Transfer", 0.028036981505025392]], "inject shellcode into the process": [["Process Injection", 0.617081494391583], ["Native API", 0.18592881157806262], ["Hijack Execution Flow", 0.019557230639808718], ["System Binary Proxy Execution", 0.01857662157000131], ["Access Token Manipulation", 0.01601507701927542], ["Event Triggered Execution", 0.011269121551264496]], "SeDebugPrivilege": [["Abuse Elevation Control Mechanism", 0.07821001027307299], ["Access Token Manipulation", 0.06601107364328006], ["Exploitation for Privilege Escalation", 0.06328483742944323], ["Domain Policy Modification", 0.05787910577000261], ["File and Directory Permissions Modification", 0.04602086527182857], ["Subvert Trust Controls", 0.028945687466225545]], "finds the API functions it needs": [["Native API", 0.4278750637236499], ["Cloud Service Dashboard", 0.04939541247438532], ["System Service Discovery", 0.024899457731722106], ["Query Registry", 0.02404308677447175], ["Software Discovery", 0.020454414914804507], ["File and Directory Discovery", 0.01658192511567636]], "Microsoft CryptoAPI": [["Data Encrypted for Impact", 0.14958904273543003], ["Deobfuscate/Decode Files or Information", 0.13644012371647665], ["Encrypted Channel", 0.13438351298202117], ["Weaken Encryption", 0.06824688872709336], ["Obfuscated Files or Information", 0.06403966052532203], ["Archive Collected Data", 0.03394902662338514]], "Cryptography API:": [["Deobfuscate/Decode Files or Information", 0.2025262327726878], ["Encrypted Channel", 0.1589666797117898], ["Obfuscated Files or Information", 0.08627073896831286], ["Data Encrypted for Impact", 0.058547635546284], ["Data Encoding", 0.04563830720879073], ["Weaken Encryption", 0.043602808336840826]], "via a ZwCreateSection call": [["Process Injection", 0.05544078177680363], ["Command and Scripting Interpreter", 0.05432954476870926], ["Native API", 0.04432092992113741], ["Event Triggered Execution", 0.02920185031972119], ["Deobfuscate/Decode Files or Information", 0.027481244036947752], ["Hide Artifacts", 0.0274812391609641]], "via ZwMapViewOfSection calls": [["Native API", 0.06731727480966831], ["File and Directory Discovery", 0.050882461385638914], ["Hide Artifacts", 0.030564252045409683], ["Application Window Discovery", 0.02820948275848199], ["Clipboard Data", 0.02691603466339161], ["Hijack Execution Flow", 0.0265894226857865]], "execute a method from the .NET assembly": [["Native API", 0.09886686904888976], ["System Binary Proxy Execution", 0.0831646722311517], ["Shared Modules", 0.06516337977852052], ["Process Injection", 0.052696034136037996], ["Event Triggered Execution", 0.046475079628712744], ["Hijack Execution Flow", 0.04624982686189064]], "HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations": [["Application Layer Protocol", 0.4465569775972245], ["Data Obfuscation", 0.025729936106480215], ["Fallback Channels", 0.024681259107042747], ["Data Encoding", 0.023140428048285814], ["Non-Standard Port", 0.020967206458288878], ["Non-Application Layer Protocol", 0.02087189198327833]], "RPCConnector and RPCBindConnector": [["Non-Application Layer Protocol", 0.1172354928649457], ["System Network Connections Discovery", 0.09484346391901474], ["Traffic Signaling", 0.05943991677515515], ["Remote Services", 0.055234998366006496], ["Non-Standard Port", 0.03653867524794574], ["Fallback Channels", 0.026304409137589548]], "TcpBindConnector and HttpBindConnector": [["Application Layer Protocol", 0.15948559295180784], ["Non-Application Layer Protocol", 0.14616529377823503], ["Non-Standard Port", 0.13761774365474505], ["System Network Connections Discovery", 0.05926275264461037], ["Traffic Signaling", 0.05311589118415272], ["Fallback Channels", 0.031260202830806556]], "TcpConnector/TcpBindConnector": [["Non-Application Layer Protocol", 0.302793520462303], ["System Network Connections Discovery", 0.10212154824328112], ["Traffic Signaling", 0.08693200573897285], ["Non-Standard Port", 0.07484335630443997], ["Application Layer Protocol", 0.029577963733085393], ["Protocol Tunneling", 0.029505864914881504]], "CreateThread": [["Process Injection", 0.25294102964511267], ["Native API", 0.12039574161518396], ["Process Discovery", 0.05179420868712111], ["Access Token Manipulation", 0.037496698794561106], ["Create or Modify System Process", 0.0272314809541585], ["System Binary Proxy Execution", 0.016272031161988713]], "uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process": [["Process Injection", 0.6323687478685222], ["Native API", 0.17686867820467855], ["System Binary Proxy Execution", 0.023324009430802768], ["Access Token Manipulation", 0.020236459561651002], ["Hijack Execution Flow", 0.0150522490041168], ["Event Triggered Execution", 0.013318302227477284]], "finds the PID of the target process": [["Process Discovery", 0.723826368840784], ["Native API", 0.06074568179756768], ["Access Token Manipulation", 0.0327797565831765], ["Process Injection", 0.025438344045849857], ["System Service Discovery", 0.01003235903407189], ["System Information Discovery", 0.009398365943600526]], "Current processes are checked": [["Process Discovery", 0.7557107594415271], ["Native API", 0.04079306591525378], ["System Service Discovery", 0.01850914231364412], ["Process Injection", 0.018028361636225336], ["Virtualization/Sandbox Evasion", 0.015599269703214494], ["Software Discovery", 0.014346428476010663]], "Name of running module\nPID": [["Process Discovery", 0.31613014230291664], ["Native API", 0.09272486712685611], ["Windows Management Instrumentation", 0.03870704978764035], ["Process Injection", 0.03810660632789557], ["Create or Modify System Process", 0.030690877682469943], ["Access Token Manipulation", 0.030640163357228124]], "injects shellcode into it": [["Process Injection", 0.31317946136491454], ["Obfuscated Files or Information", 0.08442146674002139], ["Native API", 0.08261460882466884], ["Hijack Execution Flow", 0.055454695897485], ["Command and Scripting Interpreter", 0.048633447643694185], ["System Binary Proxy Execution", 0.03829164065685563]], "injects shellcode into the processes explorer.exe, winlogon.exe, wmplayer.exe, svchost.exe, and spoolsv.exe": [["Process Injection", 0.5904812748895516], ["Native API", 0.08285297772778016], ["Event Triggered Execution", 0.03807029463988792], ["Hijack Execution Flow", 0.029950706123548766], ["System Binary Proxy Execution", 0.028429407305564192], ["Access Token Manipulation", 0.023484878584990095]], "archive was distributed": [["Archive Collected Data", 0.17770446809219312], ["Data Staged", 0.05537076874194613], ["Exfiltration Over C2 Channel", 0.04632348069977979], ["Indicator Removal", 0.04140713506438841], ["Deobfuscate/Decode Files or Information", 0.037516385399497816], ["Automated Collection", 0.03545457231727836]], "unpacks an HTML": [["Deobfuscate/Decode Files or Information", 0.17948354840695488], ["Obfuscated Files or Information", 0.10510047464827699], ["Template Injection", 0.07497004220568673], ["Command and Scripting Interpreter", 0.053410619584596405], ["Ingress Tool Transfer", 0.0227978943779032], ["Archive Collected Data", 0.0190914383104788]], "is unpacked from the CHM file.": [["Deobfuscate/Decode Files or Information", 0.12987758177644992], ["Masquerading", 0.07095185723399038], ["Hijack Execution Flow", 0.0645880097256608], ["Obfuscated Files or Information", 0.04999868793541319], ["Indicator Removal", 0.042725345462130915], ["System Binary Proxy Execution", 0.03271614921056333]], "unpacks three files": [["Deobfuscate/Decode Files or Information", 0.20154157446645488], ["Obfuscated Files or Information", 0.1426047395037816], ["Archive Collected Data", 0.11272951512585304], ["Command and Scripting Interpreter", 0.04349734156274263], ["Masquerading", 0.0362109696999485], ["Automated Collection", 0.03241619660535411]], "contents are unpacked": [["Deobfuscate/Decode Files or Information", 0.3197388216308888], ["Obfuscated Files or Information", 0.1621164660468599], ["Archive Collected Data", 0.05264252759195455], ["Command and Scripting Interpreter", 0.038119644249527136], ["Masquerading", 0.020213834125812638], ["Ingress Tool Transfer", 0.019995374328958312]], "SFX archiveWhen unpacked": [["Archive Collected Data", 0.2726872922341334], ["Deobfuscate/Decode Files or Information", 0.09603980232871043], ["Automated Collection", 0.05602062416614822], ["Data Staged", 0.055184997032538013], ["Obfuscated Files or Information", 0.049422461717714805], ["Indicator Removal", 0.03631193470590235]], "use VMProtect or custom packers for its malware": [["Archive Collected Data", 0.15405556603129983], ["Obfuscated Files or Information", 0.11600886900202716], ["Deobfuscate/Decode Files or Information", 0.10100560927567208], ["Hide Artifacts", 0.04426302985949375], ["Indicator Removal", 0.040012302573370816], ["Virtualization/Sandbox Evasion", 0.025474118153249594]], "can send system information": [["System Information Discovery", 0.7794950792115577], ["Virtualization/Sandbox Evasion", 0.02917105273536823], ["Windows Management Instrumentation", 0.02401830173408755], ["Software Discovery", 0.012972265473312683], ["System Network Configuration Discovery", 0.00792606481272747], ["System Time Discovery", 0.007902988534090775]], "is the library Funny.dll": [["Hijack Execution Flow", 0.22218195092932835], ["Shared Modules", 0.11353712292934878], ["System Binary Proxy Execution", 0.07212978961587119], ["Masquerading", 0.06894370163907929], ["Process Injection", 0.054179976879282714], ["Obfuscated Files or Information", 0.03612396867026883]], "dynamically loads the library": [["Shared Modules", 0.34925732893835126], ["Hijack Execution Flow", 0.2989682488051488], ["Native API", 0.027245103249881723], ["System Binary Proxy Execution", 0.026098688889292128], ["Process Injection", 0.026073636086473177], ["System Services", 0.014021723234939415]], "that contains the library mapistub.dll,": [["Hijack Execution Flow", 0.1080971142148019], ["Masquerading", 0.05854266626604036], ["Process Injection", 0.05385627023188115], ["Native API", 0.048336113299348775], ["Shared Modules", 0.047395084194141644], ["Obfuscated Files or Information", 0.040991593028869684]], "dynamically loaded from a Base64 constant defined in the main assembly.": [["Obfuscated Files or Information", 0.4459979659675364], ["Deobfuscate/Decode Files or Information", 0.17478005079710884], ["Shared Modules", 0.028473912081370286], ["Hijack Execution Flow", 0.028348206864983606], ["System Binary Proxy Execution", 0.027225128531716318], ["Native API", 0.024516763652102123]], "conditional jumps that never run are included": [["Virtualization/Sandbox Evasion", 0.1587951753523325], ["Execution Guardrails", 0.047693986343449214], ["Event Triggered Execution", 0.027005069566839218], ["Multi-Stage Channels", 0.025029401093809064], ["Hide Artifacts", 0.018795762664370164], ["Masquerading", 0.017694302817985997]], "obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).": [["Obfuscated Files or Information", 0.8145219267086832], ["Deobfuscate/Decode Files or Information", 0.043940725427169224], ["Data Obfuscation", 0.012167926609143707], ["Execution Guardrails", 0.011954203223114898], ["Encrypted Channel", 0.008317503037782012], ["Archive Collected Data", 0.008293031128386107]], "the file is deleted": [["Indicator Removal", 0.6259955299939681], ["Data Destruction", 0.10833268650334034], ["Inhibit System Recovery", 0.01915151814251327], ["Data Staged", 0.012699972734670505], ["File and Directory Discovery", 0.012282837750556197], ["Hide Artifacts", 0.010730284019415134]], "wiping traces of malware from the system": [["Indicator Removal", 0.6308241119181489], ["Inhibit System Recovery", 0.041832524520099675], ["Disk Wipe", 0.04006903593788102], ["Data Destruction", 0.03904394253558145], ["System Shutdown/Reboot", 0.03429468263652153], ["Impair Defenses", 0.020577962072758856]], "saved in the registry": [["Modify Registry", 0.49645627921823654], ["Boot or Logon Autostart Execution", 0.15804625839676417], ["Query Registry", 0.08138916508920024], ["Indicator Removal", 0.034600110835743984], ["Office Application Startup", 0.021760238353342388], ["Boot or Logon Initialization Scripts", 0.01581573924006838]], "passes control to a.bat.": [["Command and Scripting Interpreter", 0.2910239693838098], ["System Binary Proxy Execution", 0.16188007805265664], ["Native API", 0.06745514880481206], ["Indirect Command Execution", 0.04979524847243625], ["System Services", 0.04528242137256816], ["Event Triggered Execution", 0.026092212339798648]], "cleanup script": [["Indicator Removal", 0.7138310373110803], ["Command and Scripting Interpreter", 0.030682272757462808], ["Data Destruction", 0.028330176069553906], ["Modify Registry", 0.012829185768156687], ["System Shutdown/Reboot", 0.012794385863246565], ["Windows Management Instrumentation", 0.012527700425473357]], "uses cmd.exe and .bat files to run commands": [["Command and Scripting Interpreter", 0.6038809719143665], ["System Binary Proxy Execution", 0.07094737661827154], ["Indirect Command Execution", 0.0377849900479068], ["System Services", 0.02828864047771144], ["Boot or Logon Autostart Execution", 0.024466750288385943], ["Native API", 0.019863107894495607]], "sends phishing messages with malicious attachments": [["Phishing", 0.4846817145508954], ["User Execution", 0.2216471840919385], ["Phishing for Information", 0.0737870016574232], ["Internal Spearphishing", 0.03189088255320055], ["Defacement", 0.011178921403602236], ["Establish Accounts", 0.010602602114119454]], "persists on infected machines by creating new services": [["Create or Modify System Process", 0.6096315932447623], ["System Services", 0.1025791604040471], ["System Service Discovery", 0.025105966134191478], ["Scheduled Task/Job", 0.0208733346449118], ["Masquerading", 0.02067842408282524], ["Boot or Logon Autostart Execution", 0.017661138639752428]], "uses legitimate utilities to load DLLs": [["Hijack Execution Flow", 0.3602836208435269], ["Shared Modules", 0.2707163189320625], ["System Binary Proxy Execution", 0.12040400475206235], ["Process Injection", 0.039301645237471754], ["Native API", 0.02454868527326489], ["Event Triggered Execution", 0.011747991624538854]], "establish C2 connections via a peer-to-peer network of infected hosts": [["Proxy", 0.39973778019034006], ["Fallback Channels", 0.06641071685567887], ["Application Layer Protocol", 0.05697007207203171], ["Non-Application Layer Protocol", 0.036568798936930956], ["Web Service", 0.02566428151578217], ["Dynamic Resolution", 0.02557859802275187]], "support C2 connections via an external HTTP/SOCKS proxy": [["Proxy", 0.3837899457244648], ["Application Layer Protocol", 0.21423737160839204], ["Non-Application Layer Protocol", 0.07680118180885918], ["Protocol Tunneling", 0.06415837348620244], ["Data Obfuscation", 0.02562224188127496], ["Non-Standard Port", 0.025554413500220155]], "using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.": [["Create or Modify System Process", 0.23488710461258708], ["System Services", 0.10884691681741958], ["Event Triggered Execution", 0.08953953745350202], ["Masquerading", 0.03883149050602376], ["System Service Discovery", 0.030175303121638627], ["Scheduled Task/Job", 0.029594982754468164]], "abusing API calls in the Operating System.": [["Native API", 0.34027697102915566], ["Web Service", 0.03265422651522728], ["Cloud Service Dashboard", 0.026616964752585758], ["System Services", 0.025956561129452896], ["Hijack Execution Flow", 0.023498748928892706], ["Command and Scripting Interpreter", 0.019513522742011204]], "The malware also decrypts": [["Deobfuscate/Decode Files or Information", 0.7119386629333547], ["Obfuscated Files or Information", 0.05784455371148758], ["Data Encrypted for Impact", 0.05029278676606292], ["Archive Collected Data", 0.029229838048771908], ["Encrypted Channel", 0.023067481863422553], ["Data Encoding", 0.012133009926022037]], "the decryption routine": [["Deobfuscate/Decode Files or Information", 0.6563434919912892], ["Data Encrypted for Impact", 0.06700535487532756], ["Obfuscated Files or Information", 0.04504806680017493], ["Archive Collected Data", 0.041873532137098914], ["Encrypted Channel", 0.0336004166944308], ["Weaken Encryption", 0.024178864339015827]], "Decryption routine": [["Deobfuscate/Decode Files or Information", 0.6547528968485782], ["Data Encrypted for Impact", 0.07481286133027872], ["Archive Collected Data", 0.04108234719841975], ["Obfuscated Files or Information", 0.03848042201966687], ["Encrypted Channel", 0.0315692283416786], ["Weaken Encryption", 0.024062266944335282]], "the AES 256 decryption key of the payload": [["Deobfuscate/Decode Files or Information", 0.6025917369444694], ["Obfuscated Files or Information", 0.08276481870889284], ["Encrypted Channel", 0.05185634971427921], ["Data Encrypted for Impact", 0.03102950051758552], ["Execution Guardrails", 0.0264596371264846], ["Weaken Encryption", 0.02587781780267027]], "strings decoded when running": [["Deobfuscate/Decode Files or Information", 0.5098543646315951], ["Obfuscated Files or Information", 0.23598901155691043], ["Data Encoding", 0.09500349544634905], ["Encrypted Channel", 0.014215272656321581], ["Archive Collected Data", 0.01150616607328283], ["Data Obfuscation", 0.011038648553793284]], "to decrypt the payload from the .dat file using the AES-256-CTR decryption algorithm and starts to execute.": [["Deobfuscate/Decode Files or Information", 0.6602754917261204], ["Obfuscated Files or Information", 0.0947367880905451], ["Archive Collected Data", 0.05677893843772086], ["Data Encrypted for Impact", 0.05194253247391025], ["Encrypted Channel", 0.020680099358261074], ["Weaken Encryption", 0.008698643829416767]], "injects the payload in memory.": [["Process Injection", 0.5783609730454091], ["Obfuscated Files or Information", 0.04827150310325832], ["Hijack Execution Flow", 0.02880816822782183], ["Shared Modules", 0.02785983471665629], ["Deobfuscate/Decode Files or Information", 0.014869321732175762], ["Native API", 0.014766522804632812]], "The malware was injected into a SVCHOST process where a driver location pointed to the config file": [["Boot or Logon Autostart Execution", 0.10459434993532213], ["Modify Registry", 0.07760299531874855], ["Query Registry", 0.05802009098792724], ["Windows Management Instrumentation", 0.04550755398441318], ["Subvert Trust Controls", 0.036843798937162], ["Create or Modify System Process", 0.036351150448220404]], "injects it into a process.": [["Process Injection", 0.8024833819873993], ["Native API", 0.051313297485274696], ["Hijack Execution Flow", 0.01746477395854798], ["System Binary Proxy Execution", 0.011195258238626342], ["System Services", 0.008904714938453191], ["Create or Modify System Process", 0.008876232357631781]], "a process injection in one of the svchost processes": [["Process Injection", 0.7417310976777477], ["Native API", 0.07399206936235915], ["System Services", 0.01861445923864229], ["Hijack Execution Flow", 0.017681958861172967], ["Create or Modify System Process", 0.01551094465637042], ["Process Discovery", 0.014287721520361051]], "injected themselves into Windows Media Player": [["Process Injection", 0.06867287023651492], ["Replication Through Removable Media", 0.06218753554373783], ["Masquerading", 0.05809173192226217], ["Exfiltration Over Other Network Medium", 0.036367591601681896], ["Audio Capture", 0.0359220695149845], ["Event Triggered Execution", 0.025307926893269255]], "injected code in a process": [["Process Injection", 0.7350460362642223], ["Native API", 0.10446900654139658], ["Hijack Execution Flow", 0.016857084901676082], ["System Binary Proxy Execution", 0.013753174461264638], ["Event Triggered Execution", 0.009918361950136761], ["Process Discovery", 0.009771218591232173]], "the adversary had removed the payload file from the system.": [["Indicator Removal", 0.2769801781120837], ["Deobfuscate/Decode Files or Information", 0.08616817778442716], ["Ingress Tool Transfer", 0.03323978005180642], ["Masquerading", 0.02728594056844964], ["Obfuscated Files or Information", 0.026083928607804494], ["Impair Defenses", 0.02444188462962667]], "Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence": [["Indicator Removal", 0.23940883684890518], ["Data Manipulation", 0.06701710351689913], ["Modify Cloud Compute Infrastructure", 0.05035092689968984], ["Data Destruction", 0.03744732729112987], ["Impair Defenses", 0.02316685535729008], ["Defacement", 0.021233546002954757]], "Besides the use of Mimikatz to dump credentials,": [["OS Credential Dumping", 0.41655954465114636], ["Credentials from Password Stores", 0.19549413109893687], ["Unsecured Credentials", 0.17892772104650342], ["Input Capture", 0.027785698599971615], ["Brute Force", 0.01564569804391038], ["Network Sniffing", 0.015476958540320935]], "acquired through the use of Mimikatz, or creating LSASS dumps,": [["Data from Local System", 0.2148541505168391], ["OS Credential Dumping", 0.18220165412281003], ["File and Directory Discovery", 0.09795761563064931], ["Automated Collection", 0.0781474622579351], ["Data Staged", 0.03616532979150284], ["Data from Information Repositories", 0.02541384594773588]], "using Mimikatz and dumping lsass,": [["OS Credential Dumping", 0.2479299575225125], ["File and Directory Discovery", 0.15566325385229687], ["Data from Local System", 0.06833713256037238], ["Native API", 0.051495763310427004], ["Automated Collection", 0.041540780375962254], ["Data Staged", 0.03273830207175608]], "Using Mimikatz and dumping of lsass,": [["OS Credential Dumping", 0.2975924076907497], ["File and Directory Discovery", 0.10458452485548653], ["Data from Local System", 0.08063872052637294], ["Automated Collection", 0.04452525513140267], ["Native API", 0.03982624741254965], ["Data Staged", 0.03668695833947709]], "makes use of the technique \u201cDLL Sideloading\u201d": [["Hijack Execution Flow", 0.4498271738979877], ["Shared Modules", 0.16349866063430737], ["Process Injection", 0.06486189057016749], ["System Binary Proxy Execution", 0.06478355429268957], ["Ingress Tool Transfer", 0.014481448917407304], ["Native API", 0.014090418336286438]], "When the executable is run, the DLL next to it is loaded.": [["Hijack Execution Flow", 0.35507494046983823], ["Shared Modules", 0.2076853732303351], ["Native API", 0.0709021767483704], ["System Binary Proxy Execution", 0.06043105451862523], ["Process Injection", 0.059813874053911656], ["Event Triggered Execution", 0.024129544005081393]], "The dll is run using the command \u201crundll32.exe": [["Hijack Execution Flow", 0.2712775874723537], ["System Binary Proxy Execution", 0.18834552612727484], ["Shared Modules", 0.11838801383557637], ["Native API", 0.06575262569810238], ["Process Injection", 0.06015488885804501], ["System Services", 0.028974978121149342]], "The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.": [["Create or Modify System Process", 0.7090520776988863], ["System Services", 0.048142736038966245], ["Masquerading", 0.02165677710345529], ["Hijack Execution Flow", 0.020781592340205386], ["Boot or Logon Autostart Execution", 0.018379981665839096], ["Event Triggered Execution", 0.01723647384645079]], "The DLL embeds several obfuscated strings": [["Obfuscated Files or Information", 0.8201195567311056], ["Deobfuscate/Decode Files or Information", 0.06257359292893616], ["Masquerading", 0.012120988398447946], ["Data Encoding", 0.009458037651309627], ["Data Obfuscation", 0.008651646070641162], ["Process Injection", 0.008075362816027559]], "was to start a program as a service": [["System Services", 0.4304581102550444], ["Create or Modify System Process", 0.277253345921767], ["Hijack Execution Flow", 0.042335345674738505], ["System Service Discovery", 0.039210731392524796], ["Masquerading", 0.02761810185517414], ["Native API", 0.02393440855281106]], "The DLL is used to create a malicious service": [["Hijack Execution Flow", 0.2602627872767145], ["System Services", 0.12610432439851596], ["Process Injection", 0.09113791478519882], ["System Binary Proxy Execution", 0.08266451523784962], ["Create or Modify System Process", 0.07322408463850481], ["Shared Modules", 0.055911399380269025]], ". The name of the created service, \u201cSysmainUpdate\u201d, is usurping the name of the legitimate service \u201cSysMain\u201d which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.": [["Create or Modify System Process", 0.3797752415574272], ["System Services", 0.14809004482167004], ["Masquerading", 0.1289137616306925], ["Hijack Execution Flow", 0.04898630449354442], ["System Service Discovery", 0.047098463555503824], ["Service Stop", 0.02177695094868887]], "Adversary installed custom backdoor as a service": [["Create or Modify System Process", 0.3058940880339785], ["System Services", 0.11145040360247814], ["Hijack Execution Flow", 0.07869392909136937], ["Masquerading", 0.058935947998446266], ["System Service Discovery", 0.02821954988119226], ["Compromise Client Software Binary", 0.025976699747863114]], "Adversary launched backdoor and some tools as a Windows Service": [["Create or Modify System Process", 0.3098354715795088], ["System Services", 0.21201719651598705], ["Masquerading", 0.07327767454700435], ["System Service Discovery", 0.050732851400428755], ["Hijack Execution Flow", 0.050474176821146674], ["Event Triggered Execution", 0.018759327333948615]], "the command line dump of the memory:\ncmd /c": [["Virtualization/Sandbox Evasion", 0.09312119084203761], ["System Information Discovery", 0.0919600128652306], ["OS Credential Dumping", 0.07480593321898686], ["Process Discovery", 0.05243623978495551], ["Data from Local System", 0.048038291609376775], ["Automated Collection", 0.03884246741342235]], "When running the file from the command line,": [["Command and Scripting Interpreter", 0.1719160822091797], ["System Binary Proxy Execution", 0.06956324092521074], ["Native API", 0.059995606804704456], ["XSL Script Processing", 0.0558517244461656], ["Ingress Tool Transfer", 0.042349116139226636], ["Deobfuscate/Decode Files or Information", 0.041444048789745995]], "In some cases, batch (.bat) scripts were created": [["Command and Scripting Interpreter", 0.3648992866163571], ["Scheduled Task/Job", 0.1458760707375576], ["System Binary Proxy Execution", 0.04502160229423642], ["System Services", 0.043960812784755034], ["Boot or Logon Autostart Execution", 0.037856687911964], ["Event Triggered Execution", 0.0328944397538327]], "content in a batch script:": [["Command and Scripting Interpreter", 0.7661590059095504], ["System Binary Proxy Execution", 0.017628822416419877], ["Scheduled Task/Job", 0.013551942759607761], ["Inter-Process Communication", 0.012000232480103996], ["Automated Collection", 0.00926546161050675], ["Windows Management Instrumentation", 0.007273236199801371]], "the exfiltration of data on the system, such as OS, Processor (architecture),": [["System Information Discovery", 0.16607826122945388], ["Data from Local System", 0.0576616898344003], ["Virtualization/Sandbox Evasion", 0.05483829118617458], ["Disk Wipe", 0.05409513595090391], ["Windows Management Instrumentation", 0.03943846250231477], ["Automated Collection", 0.03152708336907931]], "WMI activity [T1546.003] was also observed to execute commands on the systems.": [["Windows Management Instrumentation", 0.7266414503009058], ["Event Triggered Execution", 0.05598623255996864], ["System Information Discovery", 0.009274384554057455], ["Virtualization/Sandbox Evasion", 0.00872019999944214], ["Pre-OS Boot", 0.007953342433147492], ["Peripheral Device Discovery", 0.006742928695453267]], "WMI was used for running commands on remote systems": [["Windows Management Instrumentation", 0.7340059138403772], ["Remote Services", 0.038190797717797584], ["Event Triggered Execution", 0.03367362943751904], ["Remote Access Software", 0.016102885650481517], ["Command and Scripting Interpreter", 0.015761260811365033], ["System Services", 0.01446625357972095]], "From a persistence point of view, scheduled tasks": [["Scheduled Task/Job", 0.7398755623986425], ["Create or Modify System Process", 0.03173571845382299], ["Inter-Process Communication", 0.023761522402184602], ["Event Triggered Execution", 0.01975407905068875], ["Boot or Logon Autostart Execution", 0.011184300614254093], ["Command and Scripting Interpreter", 0.009623320004896558]], "Adversary ran scheduled tasks for persistence of certain malware samples": [["Scheduled Task/Job", 0.7837351919323905], ["Inter-Process Communication", 0.021659154411088583], ["Create or Modify System Process", 0.016635617941579476], ["Event Triggered Execution", 0.011546939513336062], ["Masquerading", 0.010678034405388503], ["Command and Scripting Interpreter", 0.00941349732111632]], "and the use of valid accounts": [["Valid Accounts", 0.13221233287041181], ["Compromise Accounts", 0.1103067257288191], ["Create Account", 0.08855575298524333], ["Establish Accounts", 0.08598110021753996], ["Account Manipulation", 0.0515939543423537], ["Compromise Infrastructure", 0.03470725469998906]], "they were looking to get valid accounts.": [["Compromise Accounts", 0.1448223086958492], ["Establish Accounts", 0.11727515783469725], ["Gather Victim Identity Information", 0.07752443669038216], ["Account Discovery", 0.06663922284097733], ["Phishing for Information", 0.05637925753140716], ["Brute Force", 0.04249167522598481]], "the adversary gained credentials in the network": [["Valid Accounts", 0.24468838179901292], ["Brute Force", 0.07268989488340903], ["Modify Authentication Process", 0.06183996328790252], ["Exploitation for Credential Access", 0.036246044107286976], ["Forced Authentication", 0.033748066228689935], ["Gather Victim Identity Information", 0.030041332796148425]], "the files were exfiltrated over the backdoor": [["Data from Local System", 0.13685123535200336], ["Indicator Removal", 0.0685296838854335], ["Exfiltration Over Web Service", 0.05825140195427096], ["Inhibit System Recovery", 0.050438947941206215], ["File and Directory Discovery", 0.048106230325114754], ["Exfiltration Over C2 Channel", 0.04627661904474959]], "the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths": [["Exfiltration Over C2 Channel", 0.19631981097783638], ["Exfiltration Over Web Service", 0.08535428959920355], ["Data from Local System", 0.0836352500640137], ["Exfiltration Over Alternative Protocol", 0.07583141260098904], ["Archive Collected Data", 0.0709968674706906], ["Data Staged", 0.06984617526742926]], "malware exfiltrated data towards a C2": [["Exfiltration Over C2 Channel", 0.38400017204271186], ["Exfiltration Over Alternative Protocol", 0.09518753423043816], ["Automated Exfiltration", 0.057144710620635086], ["Scheduled Transfer", 0.055823124545700216], ["Archive Collected Data", 0.05126402876696993], ["Exfiltration Over Web Service", 0.03412011664624824]], "When the data was gathered on a local system using the backdoor": [["Data Staged", 0.24143172769572804], ["Data from Local System", 0.13346416499161876], ["Automated Collection", 0.08528236095340731], ["Exfiltration Over C2 Channel", 0.0631862491938035], ["Archive Collected Data", 0.04534516368032374], ["Automated Exfiltration", 0.03646537329475562]], "and the rar files were deleted": [["Indicator Removal", 0.2646790096667696], ["Inhibit System Recovery", 0.06503685097225814], ["Data Destruction", 0.06352039668331821], ["Archive Collected Data", 0.0327908046569298], ["Disk Wipe", 0.026805526251689533], ["Data from Local System", 0.02376022587922732]], "exfiltrated over HTTP using GET requests": [["Exfiltration Over Alternative Protocol", 0.2423065156170784], ["Exfiltration Over C2 Channel", 0.24037394093006592], ["Archive Collected Data", 0.05241184300469378], ["Data from Local System", 0.03755204546745153], ["Ingress Tool Transfer", 0.036441693888590115], ["Exfiltration Over Web Service", 0.034038725184170636]], "HTTP traffic to C2": [["Application Layer Protocol", 0.5064172845506234], ["Non-Application Layer Protocol", 0.05387989588043538], ["Fallback Channels", 0.04173313632977181], ["Proxy", 0.04122205195542627], ["Data Obfuscation", 0.030917079203882068], ["Encrypted Channel", 0.028443079287039603]], "The packet data was customized and sent through a POST request with several headers towards the C2.": [["Application Layer Protocol", 0.22792703997469296], ["Data Encoding", 0.10178484223493395], ["Non-Application Layer Protocol", 0.08620061321082514], ["Exfiltration Over C2 Channel", 0.0832527308776497], ["Data Obfuscation", 0.06290696757649651], ["Network Sniffing", 0.05124907010223892]], "The malware started to open up both UDP and TCP ports to connect with a C2 server": [["Non-Standard Port", 0.20918695941202453], ["Non-Application Layer Protocol", 0.20908665432448814], ["Traffic Signaling", 0.1016591972153305], ["Protocol Tunneling", 0.047104302541599266], ["Impair Defenses", 0.03948265160399937], ["Application Layer Protocol", 0.0393183023660396]], "the customized packet size using a XOR value.": [["Data Transfer Size Limits", 0.12759108970006808], ["Network Denial of Service", 0.05437373165062508], ["Non-Application Layer Protocol", 0.04956893817571993], ["Adversary-in-the-Middle", 0.04862825922372691], ["Data Obfuscation", 0.048372472299438155], ["Network Sniffing", 0.047563692216913214]], "Adversary exploited a web-facing server with application": [["Drive-by Compromise", 0.20492403543925894], ["Stage Capabilities", 0.11632175113419992], ["Compromise Infrastructure", 0.11090988717605087], ["Exploit Public-Facing Application", 0.10833288461120733], ["Server Software Component", 0.1064690453863375], ["Acquire Infrastructure", 0.03932250400117491]], "the actor established initial access by compromising the victim\u2019s web server": [["Server Software Component", 0.21531474132398679], ["Exploit Public-Facing Application", 0.11698631145819872], ["Drive-by Compromise", 0.0865921095036939], ["Stage Capabilities", 0.08299284087449997], ["Compromise Infrastructure", 0.07270000621626796], ["Forge Web Credentials", 0.027666073001050843]], "Tools were transferred to a compromised web-facing server": [["Stage Capabilities", 0.14430342954902983], ["Ingress Tool Transfer", 0.1349753755603756], ["Server Software Component", 0.058072943104891674], ["Compromise Infrastructure", 0.030679484599714153], ["Lateral Tool Transfer", 0.03011315016329213], ["Acquire Infrastructure", 0.02379730940420316]], "Adversary browsed several locations to search for the data they were after.": [["Data Staged", 0.09353106521661672], ["Active Scanning", 0.05097055512236412], ["Automated Collection", 0.049486256462436054], ["Data Manipulation", 0.04564849644144655], ["Data from Information Repositories", 0.04290708213556071], ["Data from Local System", 0.037164387453310924]], "used Rotten/Bad Potato to elevate user rights by abusing API calls in the Operating System.": [["Abuse Elevation Control Mechanism", 0.49866210487146484], ["Exploitation for Privilege Escalation", 0.08704388118149946], ["Access Token Manipulation", 0.05970080137548169], ["Domain Policy Modification", 0.02518245247047311], ["File and Directory Permissions Modification", 0.024636029772126984], ["Event Triggered Execution", 0.020134801991063236]], "including adding of registry keys": [["Modify Registry", 0.46814792966150737], ["Boot or Logon Autostart Execution", 0.1586612795248894], ["Query Registry", 0.05131398944920736], ["Create or Modify System Process", 0.02654277634063845], ["Boot or Logon Initialization Scripts", 0.018561301098310178], ["Domain Policy Modification", 0.017123752371697682]], "and lateral movement/execution of files": [["Hijack Execution Flow", 0.061646716135535046], ["Ingress Tool Transfer", 0.056808253418634845], ["Native API", 0.0553453562346102], ["System Binary Proxy Execution", 0.05347148098307503], ["Masquerading", 0.04815003578604973], ["File and Directory Discovery", 0.04663600558295401]], "the attackers would launch a lateral movement phase, using default Windows credentials": [["Valid Accounts", 0.17133383482792156], ["Remote Services", 0.09858862723960926], ["Credentials from Password Stores", 0.06737075530649697], ["Modify Authentication Process", 0.06612030276532296], ["Forced Authentication", 0.055849681179405794], ["Input Capture", 0.05570969376090106]], "run a network recognition process to find the IP address of each of the ATMs": [["System Network Configuration Discovery", 0.4124089852365206], ["Remote System Discovery", 0.1404075842896458], ["System Network Connections Discovery", 0.04500015246336482], ["Gather Victim Network Information", 0.030000407323285884], ["Network Service Discovery", 0.023750011107920292], ["Data from Configuration Repository", 0.019775166351779786]], "using a variety of encryption schemes and symmetric keys.": [["Data Encrypted for Impact", 0.15264038914072608], ["Obfuscated Files or Information", 0.12688996199807223], ["Encrypted Channel", 0.12008766585032288], ["Weaken Encryption", 0.07856025166611766], ["Archive Collected Data", 0.07637210353105892], ["Execution Guardrails", 0.05113483672000465]], "to install AnyDesk and provide remote access for the \u201ctechnician\u201d to install the malware.": [["Software Deployment Tools", 0.08250657992745458], ["Remote Access Software", 0.08048258174161829], ["Supply Chain Compromise", 0.06890476215229685], ["Command and Scripting Interpreter", 0.05005377872558152], ["Develop Capabilities", 0.0417761733301357], ["Obtain Capabilities", 0.03364729951836454]], "All captured information from the transaction is saved to an encrypted file placed in a directory previously set by the malware configuration": [["Archive Collected Data", 0.13285400531297697], ["Exfiltration Over Alternative Protocol", 0.06822231889802494], ["Data Staged", 0.065214777926532], ["Exfiltration Over C2 Channel", 0.05081402388574942], ["Automated Collection", 0.03355368934439551], ["Data Manipulation", 0.02857756793388926]], "Those files will later be sent to the malware C2 server": [["Data from Local System", 0.13787877253292244], ["Data Staged", 0.12512398575167274], ["Indicator Removal", 0.0965574155458613], ["Ingress Tool Transfer", 0.07534437552034141], ["Exfiltration Over C2 Channel", 0.05997060913387302], ["Automated Collection", 0.058700270429811026]], "Captured data stored in the uploader C2": [["Exfiltration Over C2 Channel", 0.1354064334161615], ["Data from Local System", 0.12604467366030572], ["Data Staged", 0.07323898835847972], ["Ingress Tool Transfer", 0.060401824733157264], ["Automated Collection", 0.054311040975542645], ["Automated Exfiltration", 0.052121989443613896]], "sending all cab files generated from the stolen transactions to the server": [["Automated Collection", 0.08282842188454699], ["Automated Exfiltration", 0.07503279051235037], ["Exfiltration Over C2 Channel", 0.06333919207890344], ["Exfiltration Over Alternative Protocol", 0.053040267485223794], ["Data Staged", 0.04586836342872244], ["Ingress Tool Transfer", 0.04436859260535486]], "StartSendScreen, StopSendScreen": [["Virtualization/Sandbox Evasion", 0.0987979071956186], ["Event Triggered Execution", 0.052862366083510706], ["Command and Scripting Interpreter", 0.04878703198015408], ["Screen Capture", 0.04577495665893863], ["Application Window Discovery", 0.03409642400902256], ["Input Capture", 0.033689320728504064]], "StartSendScreen\nStart screen capture\nStopSendScreen\nStop screen capture": [["Screen Capture", 0.5553270283501054], ["Video Capture", 0.10470023954842726], ["Input Capture", 0.02795344153573112], ["Application Window Discovery", 0.025502867091203515], ["Virtualization/Sandbox Evasion", 0.014623548557890009], ["Hide Artifacts", 0.014406289717817261]], "Download a file from the remote server": [["Ingress Tool Transfer", 0.7055872253969291], ["Command and Scripting Interpreter", 0.027248178689733695], ["Application Layer Protocol", 0.026217151971137102], ["Lateral Tool Transfer", 0.012820944645695775], ["Exfiltration Over C2 Channel", 0.010866590799990458], ["Exfiltration Over Alternative Protocol", 0.010713968401509903]], "StartDownload, StopDownload.": [["Indicator Removal", 0.1239146276645019], ["System Shutdown/Reboot", 0.11957813772829315], ["Service Stop", 0.05555667270599653], ["Command and Scripting Interpreter", 0.04374406706946085], ["Data Destruction", 0.028798454125811435], ["Rootkit", 0.028755068727213846]], "Shell\nExecute a specified command via CMD": [["Command and Scripting Interpreter", 0.6490268662665751], ["Indirect Command Execution", 0.11048918730251092], ["System Services", 0.029396483780365957], ["Native API", 0.01915037080226124], ["System Binary Proxy Execution", 0.015292418086817309], ["Scheduled Task/Job", 0.010591113401982002]], "the files are sent through an HTTP POST request.": [["Ingress Tool Transfer", 0.16104173023774665], ["Exfiltration Over C2 Channel", 0.08782946468561319], ["Exfiltration Over Alternative Protocol", 0.08016474472146357], ["Data from Local System", 0.06458905903071976], ["Archive Collected Data", 0.050010359246152845], ["Application Layer Protocol", 0.04893596868070204]], "Add the process to a startup registry key": [["Create or Modify System Process", 0.29593163414605905], ["Boot or Logon Autostart Execution", 0.12806205146150385], ["Process Injection", 0.055159707347565826], ["Access Token Manipulation", 0.039329719513190226], ["Event Triggered Execution", 0.039053244322125424], ["Masquerading", 0.031025708257077875]], "malicious OneNote documents to entice users to click on an embedded file to download and execute": [["User Execution", 0.7728908794400935], ["Template Injection", 0.03691636776560938], ["Phishing", 0.03612067785170413], ["Drive-by Compromise", 0.009557084940724844], ["Masquerading", 0.008947424841492446], ["Ingress Tool Transfer", 0.008711354797915846]], "a fake message to lure users to execute the HTA\u00a0 file\u00a0": [["User Execution", 0.28895646147138154], ["Office Application Startup", 0.08029627488682298], ["Masquerading", 0.058004453303366774], ["Defacement", 0.03740666473950685], ["Phishing", 0.031001613878006606], ["Subvert Trust Controls", 0.024603511433874976]], "Upon clicking the Open button, it drops the HTA file": [["Hide Artifacts", 0.11507918550306485], ["Indicator Removal", 0.09757857694871598], ["Modify Registry", 0.0659598626585691], ["Office Application Startup", 0.05733090245836213], ["Deobfuscate/Decode Files or Information", 0.03645622147213574], ["Masquerading", 0.032880084229020015]], "it prompts the user with a fake message to double-click on open to view the attachment.": [["User Execution", 0.5477826529282013], ["Phishing", 0.05889493146503166], ["Masquerading", 0.02496998662531293], ["Ingress Tool Transfer", 0.02470545381109054], ["File and Directory Discovery", 0.019160088291175492], ["Office Application Startup", 0.018925085262879036]], "The message above the \u2018Open\u2019 button instructs the user to \u201cdouble click\u201d in order to receive the attachment.": [["User Execution", 0.5281745955437848], ["Phishing", 0.09777981337666553], ["Ingress Tool Transfer", 0.0485981101629189], ["Office Application Startup", 0.02001132256817285], ["Masquerading", 0.015056357436231226], ["Command and Scripting Interpreter", 0.013632909065340659]], "The malicious document is delivered in either zip files or ISO images to the target through phishing emails.": [["Phishing", 0.3454770562876924], ["User Execution", 0.11359603890119106], ["Template Injection", 0.10910933106702152], ["Archive Collected Data", 0.03735307643993163], ["Obfuscated Files or Information", 0.03624725966690962], ["Stage Capabilities", 0.013597065725729754]], "the malware author used phishing emails to deliver malicious OneNote document either as attachment": [["Phishing", 0.40695915469526694], ["User Execution", 0.16099462211765228], ["Template Injection", 0.06571114276026324], ["Email Collection", 0.017369907624230668], ["Phishing for Information", 0.016475015974657052], ["Office Application Startup", 0.016375498841231087]], "Windows batch script": [["Command and Scripting Interpreter", 0.7232954287656891], ["Scheduled Task/Job", 0.03569833219985124], ["System Binary Proxy Execution", 0.01960954038034906], ["Windows Management Instrumentation", 0.01799589719375472], ["Indicator Removal", 0.009351700282745784], ["Inter-Process Communication", 0.008118734494031192]], "executes a batch file": [["Command and Scripting Interpreter", 0.5985483659583725], ["Scheduled Task/Job", 0.07512927621881135], ["System Binary Proxy Execution", 0.04422401493887466], ["System Services", 0.02628294820928516], ["Windows Management Instrumentation", 0.01651011872318724], ["Indirect Command Execution", 0.014293583012104349]], "the\u00a0malicious batch file": [["Command and Scripting Interpreter", 0.457112702814073], ["System Binary Proxy Execution", 0.09037881961144732], ["Scheduled Task/Job", 0.06027004114396496], ["Masquerading", 0.028271282112768897], ["System Services", 0.02287758671065209], ["Windows Management Instrumentation", 0.020301345382369728]], "Upon execution of the batch file": [["Command and Scripting Interpreter", 0.3974321798055493], ["Scheduled Task/Job", 0.09065622235957926], ["System Binary Proxy Execution", 0.05154423162389674], ["System Services", 0.02741485876524633], ["Boot or Logon Autostart Execution", 0.023950425315946298], ["Windows Management Instrumentation", 0.02323810630125585]], "launched by cmd.exe": [["System Binary Proxy Execution", 0.21462912576555723], ["Native API", 0.14328222054056394], ["Command and Scripting Interpreter", 0.09538906711003349], ["System Services", 0.07081977347113537], ["Hijack Execution Flow", 0.04937016828917409], ["Masquerading", 0.04831505506338228]], "batch file": [["Command and Scripting Interpreter", 0.5690730118370709], ["Scheduled Task/Job", 0.0534539570263922], ["System Binary Proxy Execution", 0.03138133571320145], ["Masquerading", 0.016034904271339374], ["Indicator Removal", 0.015569685092663236], ["System Services", 0.015219491583210997]], "Embedded Executable Objects In OneNote\u00a0\u00a0": [["Office Application Startup", 0.09988247574436601], ["User Execution", 0.07073027068202266], ["Hijack Execution Flow", 0.06571441929726848], ["Masquerading", 0.055513336814480035], ["XSL Script Processing", 0.047525948153914574], ["Native API", 0.04664659658276754]], "an embedded file gets executed by the user": [["System Binary Proxy Execution", 0.13727397478058775], ["User Execution", 0.10540795795254575], ["Native API", 0.057908743169366735], ["Process Injection", 0.05762709681554795], ["XSL Script Processing", 0.053283021574184374], ["Hijack Execution Flow", 0.04989882650919904]], "The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.": [["Data Staged", 0.05398186685680767], ["File and Directory Discovery", 0.05208740845242839], ["Data Manipulation", 0.04001840870149037], ["Data from Local System", 0.03875530953355939], ["Hide Artifacts", 0.035119234467935405], ["Archive Collected Data", 0.03502809603556807]], "Embedded data in Data object": [["Data Manipulation", 0.1066959926986501], ["Hide Artifacts", 0.04594016648365743], ["Obfuscated Files or Information", 0.032472968786806375], ["Archive Collected Data", 0.031214428162505737], ["Browser Session Hijacking", 0.031207391448889794], ["Command and Scripting Interpreter", 0.02951297659749291]], "OneNote file contains an embedded HTA\u00a0 attachment": [["User Execution", 0.1059390418862841], ["Template Injection", 0.08761050091436635], ["Phishing", 0.05916703447031942], ["Office Application Startup", 0.055163073048751045], ["Masquerading", 0.03198948946557747], ["File and Directory Discovery", 0.029209108326521793]], "The OneNote file with the embedded HTA file": [["Office Application Startup", 0.08778938504721402], ["File and Directory Discovery", 0.041833687194800934], ["Data Staged", 0.040059172265920845], ["Hide Artifacts", 0.033330993224764065], ["Masquerading", 0.02905376462779595], ["Template Injection", 0.027586156244917677]], "contains the \u201cwhoami\u201d command": [["System Owner/User Discovery", 0.7497198090809255], ["Account Discovery", 0.11118701334839373], ["Permission Groups Discovery", 0.008220778266264245], ["Access Token Manipulation", 0.0065939458477408805], ["System Information Discovery", 0.004815460011379563], ["Command and Scripting Interpreter", 0.004280606745063161]], "make use of\u00a0 the curl utility to download Qakbot and then execute it.": [["Web Service", 0.11790483652547797], ["Command and Scripting Interpreter", 0.08935555698558689], ["Ingress Tool Transfer", 0.039817110659857706], ["Application Layer Protocol", 0.03188961087756959], ["Deobfuscate/Decode Files or Information", 0.023774444793400698], ["Network Sniffing", 0.020188863081582856]], "The HTA file uses curl utility to download": [["Ingress Tool Transfer", 0.3046406099578135], ["Command and Scripting Interpreter", 0.04876049401861211], ["Application Layer Protocol", 0.04777555313939759], ["Data from Local System", 0.02796039041940819], ["Automated Collection", 0.027485314402610758], ["Web Service", 0.026599994680355836]], "Curl is used to download the malicious DLL file": [["Ingress Tool Transfer", 0.32220771482364496], ["BITS Jobs", 0.06664251702125068], ["Command and Scripting Interpreter", 0.06561947605795493], ["System Binary Proxy Execution", 0.060042096031829244], ["Application Layer Protocol", 0.03394781763347814], ["Deobfuscate/Decode Files or Information", 0.029532715124237836]], "The script will then execute the downloaded file": [["Ingress Tool Transfer", 0.580792287075041], ["Command and Scripting Interpreter", 0.20959701841060097], ["System Binary Proxy Execution", 0.027996481771021445], ["BITS Jobs", 0.01587787253071893], ["Scheduled Task/Job", 0.011124873694847241], ["User Execution", 0.01076588224803056]], "downloads the payload from the Internet and executes on the target system.": [["Ingress Tool Transfer", 0.5130021779831192], ["Command and Scripting Interpreter", 0.15391315533507904], ["BITS Jobs", 0.06180547076389933], ["System Binary Proxy Execution", 0.049023724870236304], ["Inter-Process Communication", 0.015536930409425284], ["Deobfuscate/Decode Files or Information", 0.012041600938061016]], "Powershell will be invoked and it fetch the Qakbot payload from Internet": [["Command and Scripting Interpreter", 0.2993194690748742], ["Ingress Tool Transfer", 0.04696972060913885], ["Web Service", 0.036613021725380245], ["Automated Collection", 0.021978731747980245], ["Deobfuscate/Decode Files or Information", 0.020552332108543448], ["Windows Management Instrumentation", 0.01891052903243849]], "use powershell to download the payload": [["Ingress Tool Transfer", 0.4593305386301478], ["Command and Scripting Interpreter", 0.27539477258793654], ["BITS Jobs", 0.0388445176907933], ["Deobfuscate/Decode Files or Information", 0.02140544922319146], ["System Binary Proxy Execution", 0.02030075544983931], ["Native API", 0.008309424233481752]], "executed by rundll32.exe.": [["System Binary Proxy Execution", 0.37290768918475153], ["Native API", 0.20695178707162892], ["System Services", 0.044979572639194415], ["Hijack Execution Flow", 0.04447338003255963], ["Masquerading", 0.030641892712041926], ["Event Triggered Execution", 0.02735423001982979]], "The script will then execute the downloaded file with Rundll32.exe": [["System Binary Proxy Execution", 0.2559096322564106], ["Command and Scripting Interpreter", 0.246087442703849], ["Ingress Tool Transfer", 0.2450998451185783], ["Native API", 0.034136521725279804], ["BITS Jobs", 0.0237228029881339], ["Scheduled Task/Job", 0.017034484780714905]], "execute it with rundll32.exe": [["System Binary Proxy Execution", 0.5455907138790628], ["Native API", 0.12694226722321114], ["System Services", 0.04911299845372739], ["Command and Scripting Interpreter", 0.028111045578082895], ["Hijack Execution Flow", 0.026336451642938494], ["Masquerading", 0.018686291967636773]], "Obfuscated HTA script": [["Obfuscated Files or Information", 0.8108268519383546], ["Deobfuscate/Decode Files or Information", 0.05447364146710387], ["Archive Collected Data", 0.010138325021877179], ["Encrypted Channel", 0.009981520428904805], ["Data Obfuscation", 0.009327785267591029], ["Data Encoding", 0.008173234085792572]], "The HTA file contains obfuscated script": [["Obfuscated Files or Information", 0.6404001786236456], ["Deobfuscate/Decode Files or Information", 0.1287050236303507], ["Hide Artifacts", 0.013993810637048661], ["System Binary Proxy Execution", 0.013587245175377944], ["Archive Collected Data", 0.01219750695147134], ["Masquerading", 0.011659895412347774]], "The obfuscated registry is then read by MSHTA and the obfuscated code is": [["Obfuscated Files or Information", 0.46041241332231053], ["Deobfuscate/Decode Files or Information", 0.16277441154427474], ["Modify Registry", 0.08108072723327678], ["Query Registry", 0.025199794458349148], ["System Binary Proxy Execution", 0.022668570581273313], ["Masquerading", 0.01969054477999899]], "with obfuscated content": [["Obfuscated Files or Information", 0.6542387647162629], ["Deobfuscate/Decode Files or Information", 0.04513937806500082], ["Data Encoding", 0.04389366218579295], ["Archive Collected Data", 0.03675872149039534], ["Data Obfuscation", 0.03640101631537592], ["Encrypted Channel", 0.01969648061719777]], "Deobfuscated HTA content": [["Obfuscated Files or Information", 0.33832753139062277], ["Deobfuscate/Decode Files or Information", 0.26727709708348907], ["Archive Collected Data", 0.036230187613582696], ["Data Encoding", 0.027054899336934408], ["Hide Artifacts", 0.02650445617542944], ["Indicator Removal", 0.024561104473541578]], "code is de-obfuscated": [["Obfuscated Files or Information", 0.5012690865253647], ["Deobfuscate/Decode Files or Information", 0.35213230559194364], ["Data Encoding", 0.01041455261032874], ["Data Obfuscation", 0.008345249098361417], ["Archive Collected Data", 0.0082531308311012], ["Encrypted Channel", 0.008123724046139464]], "Base64 Decoded instructions in dropper": [["Deobfuscate/Decode Files or Information", 0.4170714612277572], ["Obfuscated Files or Information", 0.40823263602276383], ["Data Encoding", 0.03556708521727302], ["Archive Collected Data", 0.015082368092320707], ["Data Obfuscation", 0.011116251534253545], ["Masquerading", 0.007295035355605275]], "The base64 decoded batch file": [["Deobfuscate/Decode Files or Information", 0.47367616099293813], ["Obfuscated Files or Information", 0.28913082219016867], ["Data Encoding", 0.06262439468619412], ["Archive Collected Data", 0.03539061170857595], ["Command and Scripting Interpreter", 0.011141843425081824], ["Data Obfuscation", 0.008997050624679015]], "then deletes the registry key": [["Modify Registry", 0.4013395100945684], ["Indicator Removal", 0.16948349993822234], ["Inhibit System Recovery", 0.04250686716148767], ["Boot or Logon Autostart Execution", 0.04100381755684427], ["Query Registry", 0.02989764798984803], ["System Shutdown/Reboot", 0.027950730533740642]], "creates a registry key in HKEY_CURRENT_USER\\SOFTWARE\\": [["Modify Registry", 0.4485810958385553], ["Boot or Logon Autostart Execution", 0.26399487349197787], ["Query Registry", 0.08687755290213461], ["System Binary Proxy Execution", 0.014797715079710932], ["Create or Modify System Process", 0.0131086372621543], ["Office Application Startup", 0.012087192064808615]], "A closer look at the document reveals the graphical elements are all images placed in a layered style by the malicious actor.": [["Screen Capture", 0.07730922152320471], ["Hide Artifacts", 0.06696026020845745], ["Masquerading", 0.041710258052458093], ["Build Image on Host", 0.03937632211979437], ["User Execution", 0.03262563973732755], ["Data Manipulation", 0.0278975083556753]], "enumerate files and folders": [["File and Directory Discovery", 0.8810920400046733], ["Data from Local System", 0.0236213277588282], ["Automated Collection", 0.010534668458016053], ["Data from Network Shared Drive", 0.00890264821314355], ["Data Staged", 0.007774743358218768], ["Hide Artifacts", 0.004534906823464803]], "It then performs SQL queries to retrieve files, file size, folders": [["File and Directory Discovery", 0.664984178546176], ["Data from Local System", 0.10464241804026198], ["Automated Collection", 0.0324045869977606], ["Data Staged", 0.028568649913090945], ["System Information Discovery", 0.020918849854769148], ["Data from Network Shared Drive", 0.015177987720902685]], "Many of the hosts used to support these second-stage operations hosted RDP services": [["Remote Services", 0.42436362049043397], ["Remote Access Software", 0.08766477504183233], ["Exploitation of Remote Services", 0.0380103148348465], ["External Remote Services", 0.037076317887384164], ["Remote Service Session Hijacking", 0.03511993534079836], ["System Network Connections Discovery", 0.017078768802248675]], "can run commands that will download files": [["Ingress Tool Transfer", 0.6975293394942366], ["Command and Scripting Interpreter", 0.09287112467449195], ["BITS Jobs", 0.018727667849375133], ["Application Layer Protocol", 0.017755946251696502], ["Data from Local System", 0.010712433367350109], ["Web Service", 0.008757601277838527]], "web shell with filenames that masquerade as human.aspx, which is a legitimate component of the MOVEit Transfer software.": [["Ingress Tool Transfer", 0.1715026194677001], ["Masquerading", 0.07133283692303893], ["Lateral Tool Transfer", 0.04990580797419896], ["Data from Local System", 0.04610519282875344], ["Stage Capabilities", 0.03804654081183282], ["Web Service", 0.03729932091004814]], "several POST requests": [["Application Layer Protocol", 0.09720576249784031], ["Exfiltration Over C2 Channel", 0.05530201489063666], ["Fallback Channels", 0.04303042457666631], ["Web Service", 0.036788417578290246], ["Browser Session Hijacking", 0.022741489466961747], ["Exfiltration Over Alternative Protocol", 0.022730571744136934]], "large volumes of files have been stolen from victims' MOVEit transfer systems.": [["Exfiltration Over Web Service", 0.09543587361446532], ["Data from Local System", 0.078714684674437], ["Transfer Data to Cloud Account", 0.05876575056279492], ["Data from Network Shared Drive", 0.045573863285803984], ["Data Staged", 0.04303509105336842], ["Automated Exfiltration", 0.03951237123501743]], "The threat actors also moved laterally to the domain controller, compromised credentials": [["Valid Accounts", 0.22543118301866683], ["OS Credential Dumping", 0.10045600703845046], ["Modify Authentication Process", 0.050490823423439045], ["Domain Policy Modification", 0.03861724320933217], ["Account Manipulation", 0.037513047890780686], ["Remote Services", 0.026215949774533343]], "implanted Ngrok reverse proxies": [["Proxy", 0.41570897484075064], ["Application Layer Protocol", 0.065446243362562], ["Fallback Channels", 0.04287795152904437], ["Dynamic Resolution", 0.036774521486755925], ["Protocol Tunneling", 0.025206999291830245], ["Adversary-in-the-Middle", 0.02259352142283916]], "The actors used Ngrok to proxy RDP connections and to perform command and control.": [["Remote Services", 0.3730071410054412], ["Remote Service Session Hijacking", 0.0747854585441623], ["Remote Access Software", 0.06581247155421915], ["Proxy", 0.06298400706293775], ["External Remote Services", 0.04155683231020141], ["Protocol Tunneling", 0.023134056773929632]], "the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organization\u2019s unpatched VMware Horizon server": [["Exploitation of Remote Services", 0.09527806523592813], ["Exploit Public-Facing Application", 0.07408707953323951], ["Impair Defenses", 0.03376364979227606], ["Exploitation for Client Execution", 0.03276641243480116], ["Exploitation for Privilege Escalation", 0.03116408885972305], ["Event Triggered Execution", 0.025190026615189258]], "added an exclusion rule to Windows Defender": [["Impair Defenses", 0.47544274768703443], ["Execution Guardrails", 0.062202891363742706], ["Software Discovery", 0.030906658629188587], ["Obfuscated Files or Information", 0.025596622406907757], ["Domain Policy Modification", 0.022653171825146076], ["Hide Artifacts", 0.022381332397082038]], "added an exclusion rule to Windows Defender.": [["Impair Defenses", 0.4761957252350124], ["Execution Guardrails", 0.04618563269510954], ["Hide Artifacts", 0.04163573356166908], ["Software Discovery", 0.035386033568693714], ["Obfuscated Files or Information", 0.021156634035764177], ["Masquerading", 0.01944938674158861]], "The tool allowlisted the entire c:\\drive, enabling the actors to bypass virus scans for tools": [["File and Directory Discovery", 0.1037412404593942], ["Hide Artifacts", 0.050750800625521404], ["Impair Defenses", 0.04977257624539135], ["Automated Collection", 0.04284421519206832], ["Indicator Removal", 0.03648099248364361], ["Data from Local System", 0.03314466834721426]], "The exclusion rule allowlisted the entire c:\\drive, enabling threat actors to download tools to the c:\\drive without virus scans.": [["Hide Artifacts", 0.0556909922572168], ["Impair Defenses", 0.05502430321483802], ["Ingress Tool Transfer", 0.0419647488274157], ["File and Directory Discovery", 0.036326664539331165], ["Data Staged", 0.03270052473562794], ["Masquerading", 0.03194988094669232]], "manually disabled Windows Defender via the Graphical User Interface (GUI)": [["Impair Defenses", 0.43432630464272026], ["Windows Management Instrumentation", 0.02929358294489713], ["Software Discovery", 0.028399498729788905], ["Domain Policy Modification", 0.023680335903500997], ["Modify Registry", 0.023326968418854014], ["Inhibit System Recovery", 0.023222105285025663]], "The Scheduled Task was named RuntimeBrokerService.exe": [["Scheduled Task/Job", 0.7104835028997895], ["Masquerading", 0.03694179744585881], ["Inter-Process Communication", 0.023929540389238568], ["Create or Modify System Process", 0.021632390914905368], ["System Services", 0.0163181340763518], ["System Binary Proxy Execution", 0.010220566468826799]], "created a Scheduled Task": [["Scheduled Task/Job", 0.8124438716558012], ["Inter-Process Communication", 0.04087829609702667], ["Masquerading", 0.015681763427001352], ["Command and Scripting Interpreter", 0.013096872123507014], ["System Services", 0.007430503364052649], ["Create or Modify System Process", 0.006547244832605844]], "The actors\u2019 exploit payload created Scheduled Task": [["Scheduled Task/Job", 0.7142184784571148], ["Inter-Process Communication", 0.0650831290332698], ["Masquerading", 0.01306409719146107], ["Command and Scripting Interpreter", 0.010069336670840286], ["Process Discovery", 0.008240922956355905], ["System Services", 0.008087985760489415]], "RDP sessions": [["Remote Services", 0.4164722525006535], ["Remote Service Session Hijacking", 0.22436041674694973], ["Remote Access Software", 0.039446607032768324], ["System Network Connections Discovery", 0.017603671463208497], ["External Remote Services", 0.01461251961814341], ["Access Token Manipulation", 0.013098022631315969]], "RDP connections": [["Remote Services", 0.6594316962066186], ["Remote Access Software", 0.051749704166269284], ["Remote Service Session Hijacking", 0.031356902282543446], ["External Remote Services", 0.022320264154484216], ["System Network Connections Discovery", 0.0181909618142063], ["Valid Accounts", 0.01258798613508547]], "and the built-in Windows user account DefaultAccount [T1078.001] to move laterally": [["Remote Services", 0.1017490767871155], ["Valid Accounts", 0.09513353129785292], ["Create Account", 0.05657389762932266], ["Account Discovery", 0.04594036325012389], ["Access Token Manipulation", 0.04179054784107259], ["Abuse Elevation Control Mechanism", 0.03772174715962672]], "the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process": [["Impair Defenses", 0.28043882378969054], ["Process Discovery", 0.09454457222516566], ["Access Token Manipulation", 0.06055426022724849], ["Process Injection", 0.03771983776931545], ["OS Credential Dumping", 0.02951066254540473], ["Indicator Removal", 0.02558959335768424]], "trying to dump LSASS process.": [["Process Discovery", 0.19188424875578622], ["OS Credential Dumping", 0.11734403165602128], ["Native API", 0.0935310115196], ["File and Directory Discovery", 0.06703054394228765], ["Virtualization/Sandbox Evasion", 0.04888787686011116], ["Process Injection", 0.03837315984994579]], "Ngrok \u2013 a reverse proxy tool for proxying an internal service out onto an Ngrok domain": [["Proxy", 0.34132633565047], ["Dynamic Resolution", 0.05945726097685864], ["Compromise Infrastructure", 0.05273153834895769], ["Endpoint Denial of Service", 0.03193279809736991], ["Application Layer Protocol", 0.030846435624636237], ["Acquire Infrastructure", 0.026598221461209125]], "The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network": [["Remote Services", 0.23824829259361732], ["Proxy", 0.13973319751689553], ["Remote Service Session Hijacking", 0.13406179437608642], ["Remote Access Software", 0.03872433113197367], ["External Remote Services", 0.0379990518282887], ["Exploitation of Remote Services", 0.029923824219491243]], "The actors downloaded the following tools": [["Ingress Tool Transfer", 0.24285956029989855], ["Command and Scripting Interpreter", 0.08182233902088985], ["BITS Jobs", 0.03628497746159629], ["Obtain Capabilities", 0.023979175316910857], ["Masquerading", 0.02259642863087498], ["Remote Access Software", 0.01982989375348868]], "to download next stage and execute it": [["Ingress Tool Transfer", 0.555376323965737], ["Command and Scripting Interpreter", 0.10606944329541614], ["Multi-Stage Channels", 0.03618073764967851], ["BITS Jobs", 0.03324392729045625], ["System Binary Proxy Execution", 0.012627326539389722], ["Native API", 0.008090115089223405]], "The exploit payload then downloaded mdeploy.text": [["Ingress Tool Transfer", 0.13089816181861227], ["Command and Scripting Interpreter", 0.09385238309278444], ["OS Credential Dumping", 0.05066916545843673], ["Deobfuscate/Decode Files or Information", 0.043702173633281716], ["Automated Collection", 0.03288710195130418], ["Virtualization/Sandbox Evasion", 0.027187666993540867]], "The actors downloaded malware and multiple tools to the network": [["Ingress Tool Transfer", 0.14698165405333094], ["Lateral Tool Transfer", 0.08555943235798706], ["Proxy", 0.02977534008155264], ["Command and Scripting Interpreter", 0.026368850237010646], ["Remote Services", 0.02486586900559254], ["Stage Capabilities", 0.02458067225338377]], "as outgoing HTTPS port 443 connections": [["Non-Standard Port", 0.2771280425618165], ["Application Layer Protocol", 0.17768280142497372], ["Proxy", 0.08859762356475112], ["Protocol Tunneling", 0.07214387036193085], ["Non-Application Layer Protocol", 0.03975671695772602], ["Data Obfuscation", 0.03383131530579113]], "removed mde.ps1 from the disk": [["Inhibit System Recovery", 0.19001286781538318], ["Disk Wipe", 0.17805400056973483], ["Indicator Removal", 0.12901821194140367], ["System Shutdown/Reboot", 0.05201213449502032], ["Data Destruction", 0.03657940275628487], ["Masquerading", 0.017682042203959775]], "$BASE64 encoded payload": [["Obfuscated Files or Information", 0.3806297980280606], ["Data Encoding", 0.31515575492350484], ["Deobfuscate/Decode Files or Information", 0.15136495986555035], ["Data Obfuscation", 0.02180290418186529], ["Archive Collected Data", 0.012932360787017368], ["Encrypted Channel", 0.009903452095711677]], "recording files to be uploaded when their download is requested by the C2 server.": [["Exfiltration Over C2 Channel", 0.1220420998594055], ["Ingress Tool Transfer", 0.09186229026043448], ["Data Staged", 0.07220967073834071], ["Archive Collected Data", 0.07162072192690475], ["Automated Collection", 0.05610132489745282], ["Automated Exfiltration", 0.055472882152011606]], "and uploads it back to the server.": [["Ingress Tool Transfer", 0.1239830389172103], ["Data from Local System", 0.07417726362956643], ["Automated Exfiltration", 0.058777802016290834], ["Exfiltration Over C2 Channel", 0.04387761719399787], ["Archive Collected Data", 0.04387069617147258], ["Data Staged", 0.039979405056112624]], "uploads it to the C2 server.": [["Exfiltration Over C2 Channel", 0.1498638143078615], ["Web Service", 0.08695518294569587], ["Ingress Tool Transfer", 0.07437466550764449], ["Automated Exfiltration", 0.06037740972281735], ["Archive Collected Data", 0.055152733606358924], ["Application Layer Protocol", 0.02934500466212683]], "sends it to the C2 server.": [["Exfiltration Over C2 Channel", 0.14259306685871564], ["Web Service", 0.09519690808973626], ["Application Layer Protocol", 0.06965123056281462], ["Ingress Tool Transfer", 0.04550830229524262], ["Automated Exfiltration", 0.04532308746737383], ["Data Encoding", 0.04318168720974187]], "Upload a recording file with a specified name to the C2 server.": [["Exfiltration Over C2 Channel", 0.16985658793381309], ["Audio Capture", 0.08848262394361174], ["Video Capture", 0.07848319099283693], ["Archive Collected Data", 0.04467378099371057], ["Ingress Tool Transfer", 0.03834538050890855], ["Automated Exfiltration", 0.03321343027611309]], "data to be exfiltrated to the C2 server": [["Exfiltration Over C2 Channel", 0.3891873451621163], ["Exfiltration Over Alternative Protocol", 0.06802099781538444], ["Automated Exfiltration", 0.0665850319573899], ["Archive Collected Data", 0.06516506745192217], ["Scheduled Transfer", 0.06189452062903788], ["Exfiltration Over Web Service", 0.04197723924734874]], "sends data to the C2 server": [["Application Layer Protocol", 0.264534044817682], ["Exfiltration Over C2 Channel", 0.1400143348952853], ["Web Service", 0.06818674074786087], ["Data Encoding", 0.0652331956890991], ["Fallback Channels", 0.05966723951496201], ["Scheduled Transfer", 0.04559210229965494]], "Sends the shellcode execution results to the C2 server": [["Command and Scripting Interpreter", 0.09843826955922215], ["System Information Discovery", 0.058695757801150425], ["Deobfuscate/Decode Files or Information", 0.05589772258205515], ["Automated Collection", 0.052388640258018836], ["Data Encoding", 0.039832082081352686], ["Obfuscated Files or Information", 0.03776963771161481]], "decrypts the next loader stage": [["Deobfuscate/Decode Files or Information", 0.6775373916663086], ["Obfuscated Files or Information", 0.07271090022932462], ["Data Encrypted for Impact", 0.04190942153386801], ["Archive Collected Data", 0.016637326807857917], ["Weaken Encryption", 0.01536247980726221], ["Execution Guardrails", 0.014640784464446435]], "Decrypts": [["Deobfuscate/Decode Files or Information", 0.6893719722967192], ["Data Encrypted for Impact", 0.06578233687555507], ["Archive Collected Data", 0.035064722622212746], ["Obfuscated Files or Information", 0.0337898305645197], ["Encrypted Channel", 0.02998177889686232], ["Weaken Encryption", 0.021093355418265874]], "decryption procedure": [["Deobfuscate/Decode Files or Information", 0.6319199704498443], ["Data Encrypted for Impact", 0.09361187939541442], ["Archive Collected Data", 0.04469244119547364], ["Obfuscated Files or Information", 0.029086475205261954], ["Encrypted Channel", 0.0281657566764721], ["Weaken Encryption", 0.027432688098978256]], "shellcode decrypts": [["Deobfuscate/Decode Files or Information", 0.7205774208121007], ["Obfuscated Files or Information", 0.09879083192684647], ["Encrypted Channel", 0.0261254756816466], ["Data Encrypted for Impact", 0.024179181877917663], ["Archive Collected Data", 0.014786331020250577], ["Data Encoding", 0.014541768439523301]], "After decrypting": [["Deobfuscate/Decode Files or Information", 0.507081735866239], ["Data Encrypted for Impact", 0.13223757351870272], ["Archive Collected Data", 0.06183468962118378], ["Weaken Encryption", 0.02638093150442098], ["Obfuscated Files or Information", 0.025863773707370946], ["Encrypted Channel", 0.022846120492052296]], "decrypts the Orchestrator": [["Deobfuscate/Decode Files or Information", 0.6557066128456887], ["Obfuscated Files or Information", 0.054559172897193156], ["Data Encrypted for Impact", 0.05261316959696394], ["Encrypted Channel", 0.03232358787259985], ["Weaken Encryption", 0.028333563388509043], ["Archive Collected Data", 0.01669944123352875]], "decodes the directory path": [["File and Directory Discovery", 0.20015717298091917], ["Deobfuscate/Decode Files or Information", 0.1287351058010086], ["Obfuscated Files or Information", 0.12351082455899239], ["Masquerading", 0.08326828296923959], ["Native API", 0.05678639486873381], ["Hijack Execution Flow", 0.027637891412894633]], "decrypts the hidden page": [["Deobfuscate/Decode Files or Information", 0.2950312527723749], ["Obfuscated Files or Information", 0.11696051789506932], ["Data Encrypted for Impact", 0.04310290636563953], ["Hide Artifacts", 0.031958581047728536], ["Encrypted Channel", 0.02781027429222216], ["Data Obfuscation", 0.02552718402013135]], "decrypting them on the fly.": [["Deobfuscate/Decode Files or Information", 0.39307503853478754], ["Archive Collected Data", 0.1413058524030378], ["Data Encrypted for Impact", 0.12588643185255127], ["Obfuscated Files or Information", 0.06123188643998331], ["Weaken Encryption", 0.02681360311921486], ["Exfiltration Over Alternative Protocol", 0.018883590920421713]], "decrypts it with XOR": [["Deobfuscate/Decode Files or Information", 0.7701035742410649], ["Data Encrypted for Impact", 0.04282660514840561], ["Obfuscated Files or Information", 0.0361625778059571], ["Encrypted Channel", 0.03162113976433255], ["Archive Collected Data", 0.02704263387803837], ["Weaken Encryption", 0.010187317443005875]], "Decrypts the Trojan with a XOR-based cipher": [["Deobfuscate/Decode Files or Information", 0.5348456234452049], ["Obfuscated Files or Information", 0.18417314700207052], ["Encrypted Channel", 0.06793346540642237], ["Data Encrypted for Impact", 0.03114731169342379], ["Weaken Encryption", 0.013757701871110285], ["Archive Collected Data", 0.010100160106148514]], "The decryption key": [["Deobfuscate/Decode Files or Information", 0.5800446041182599], ["Data Encrypted for Impact", 0.09979645295168847], ["Weaken Encryption", 0.05013735780470176], ["Encrypted Channel", 0.034293738788563836], ["Archive Collected Data", 0.029157156762394717], ["Obfuscated Files or Information", 0.027316705153284902]], "injects the Trojan loader into exe.": [["Process Injection", 0.3846402075004745], ["Hijack Execution Flow", 0.13038184880888504], ["System Binary Proxy Execution", 0.11857546077876012], ["Native API", 0.035064104423794026], ["Event Triggered Execution", 0.026972437782332277], ["Shared Modules", 0.02563188905654491]], "can be injected to processes": [["Process Injection", 0.8036539351068119], ["Native API", 0.058837961678915925], ["Process Discovery", 0.011662336918396337], ["Hijack Execution Flow", 0.009877131182864372], ["Create or Modify System Process", 0.009806403928560177], ["Access Token Manipulation", 0.007963393685986654]], "The malware injects the ProcessWorm into all processes running on the system": [["Process Injection", 0.5653765355173653], ["Process Discovery", 0.15858294134079132], ["Native API", 0.028292669417479526], ["Impair Defenses", 0.02461999218696698], ["Create or Modify System Process", 0.01789328899906475], ["Access Token Manipulation", 0.013426101630914266]], "injects itself into processes": [["Process Injection", 0.857065575459546], ["Native API", 0.03985207446763117], ["Hijack Execution Flow", 0.009455193874281446], ["Create or Modify System Process", 0.007320772231911951], ["System Services", 0.0062516088853132225], ["Access Token Manipulation", 0.0060573401034319805]], "injects the ProcessWorm if needed.": [["Process Injection", 0.7454081439064961], ["Native API", 0.059437852520294834], ["Process Discovery", 0.03648587535161712], ["Create or Modify System Process", 0.017530123680579338], ["Hijack Execution Flow", 0.009300663817697246], ["System Services", 0.008812094711023646]], "injects the ProcessWorm into processes": [["Process Injection", 0.7639897974967512], ["Native API", 0.057480216440923874], ["Process Discovery", 0.041028567212755454], ["Create or Modify System Process", 0.01570760367204983], ["Access Token Manipulation", 0.011925855680998038], ["System Services", 0.010168487293168953]], "is injected into all running processes.": [["Process Injection", 0.6135132569383298], ["Process Discovery", 0.05808113463106244], ["Native API", 0.04495248076448785], ["Event Triggered Execution", 0.019361083287634195], ["Hijack Execution Flow", 0.018911948251461728], ["Create or Modify System Process", 0.017901486925147418]], "injecting code": [["Process Injection", 0.34048994436855173], ["Shared Modules", 0.08242383798389354], ["Hijack Execution Flow", 0.06040146130705668], ["Obfuscated Files or Information", 0.04056856360976107], ["Event Triggered Execution", 0.02406714991086182], ["Native API", 0.02132866686415021]], "The injected Trojan loader": [["Process Injection", 0.2268290325325376], ["Shared Modules", 0.0747984537229242], ["Hijack Execution Flow", 0.0639562540363737], ["System Binary Proxy Execution", 0.05857559023929132], ["Ingress Tool Transfer", 0.051387100656785055], ["Command and Scripting Interpreter", 0.02528301200727399]], "collects specific system information": [["System Information Discovery", 0.7791841119648166], ["Virtualization/Sandbox Evasion", 0.03134264858217309], ["Windows Management Instrumentation", 0.029764248404452083], ["Software Discovery", 0.02101656799339905], ["Query Registry", 0.010462743955420167], ["System Network Configuration Discovery", 0.009556086339445656]], "Returns information about the machine\u2019s BIOS.": [["System Information Discovery", 0.4995017375166095], ["Virtualization/Sandbox Evasion", 0.0862460134766708], ["Windows Management Instrumentation", 0.044085859281850985], ["Query Registry", 0.03421209710167847], ["Peripheral Device Discovery", 0.02801587779751406], ["Software Discovery", 0.02711681370668855]], "Returns information about the operating system": [["System Information Discovery", 0.8968951839481233], ["Virtualization/Sandbox Evasion", 0.01646618238037415], ["File and Directory Discovery", 0.010220300475733383], ["Software Discovery", 0.008232658863185232], ["Windows Management Instrumentation", 0.007904779248035126], ["Query Registry", 0.007360231684628475]], "Overall available space\nSpace available to current user (may be less than overall available space due to quotas)\nDisk capacity": [["System Information Discovery", 0.23430308089688343], ["File and Directory Discovery", 0.14125032135345436], ["Network Share Discovery", 0.031937143490893244], ["Virtualization/Sandbox Evasion", 0.02767606772964568], ["Data Staged", 0.02447399866279394], ["Data from Local System", 0.02241261188664067]], "Returns information about the computer system": [["System Information Discovery", 0.8676157756482265], ["Virtualization/Sandbox Evasion", 0.015101995418149007], ["Windows Management Instrumentation", 0.013854249008309463], ["File and Directory Discovery", 0.008779767191179611], ["Software Discovery", 0.007893306320818805], ["System Network Configuration Discovery", 0.007577979839075157]], "checks if it is running on a 64-bit system": [["System Information Discovery", 0.41744962386247964], ["Virtualization/Sandbox Evasion", 0.149511359384431], ["Software Discovery", 0.0679010140512552], ["Obfuscated Files or Information", 0.02199949869450086], ["Native API", 0.018469630113852043], ["Windows Management Instrumentation", 0.018062860769496307]], "Returns OSVERSIONINFOEXW and SYSTEM_INFO structures": [["System Information Discovery", 0.8185578796634368], ["Query Registry", 0.02739252585066666], ["Software Discovery", 0.017611146831731147], ["File and Directory Discovery", 0.01750133838267394], ["Windows Management Instrumentation", 0.016696401958637724], ["Virtualization/Sandbox Evasion", 0.010783800938225362]], "the current process name": [["Process Discovery", 0.62645899595159], ["Native API", 0.10752726762905569], ["Process Injection", 0.041158304871113736], ["Access Token Manipulation", 0.01741204254580414], ["Masquerading", 0.01616011554298901], ["Windows Management Instrumentation", 0.015162953170147675]], "Returns the list of running processes": [["Process Discovery", 0.8730008757049844], ["Native API", 0.01588652025851068], ["System Service Discovery", 0.013252048414956004], ["Process Injection", 0.009326431052455817], ["Software Discovery", 0.007199282236430325], ["Windows Management Instrumentation", 0.007043279130968391]], "Returns ProcessDebugPort value returned by NtQueryInformationProcess for current process.": [["Process Discovery", 0.5901683040851385], ["Native API", 0.06916282799314316], ["System Information Discovery", 0.06051544613662794], ["Process Injection", 0.03759182352677125], ["Virtualization/Sandbox Evasion", 0.026821460159588865], ["Windows Management Instrumentation", 0.01809898503520963]], "Returns ProcessDebugObjectHandle value returned by NtQueryInformationProcess for current process": [["Process Discovery", 0.5576039648988882], ["Native API", 0.17756127999745921], ["Process Injection", 0.04934452655022915], ["System Information Discovery", 0.0272865254892375], ["Windows Management Instrumentation", 0.018141738112051546], ["Virtualization/Sandbox Evasion", 0.01534051698116196]], "Returns process names of the current process tree (i.e. the current process, the parent process, the grandparent process, etc.)": [["Process Discovery", 0.6416232152094146], ["Native API", 0.07285569994242012], ["Process Injection", 0.03346468503726187], ["System Information Discovery", 0.018647882473920584], ["File and Directory Discovery", 0.016432824833855827], ["Software Discovery", 0.014722690622087344]], "obtains the list of processes": [["Process Discovery", 0.8567164575141581], ["Native API", 0.017214530886736575], ["System Service Discovery", 0.016878924350042096], ["Process Injection", 0.010668116080354291], ["Windows Management Instrumentation", 0.00777846394558416], ["Software Discovery", 0.007364644706672861]], "extract specific information about running processes": [["Process Discovery", 0.85415510648245], ["Native API", 0.016579050023311736], ["System Service Discovery", 0.012686148455785504], ["Process Injection", 0.01020800377211941], ["System Information Discovery", 0.007970388761714475], ["Windows Management Instrumentation", 0.007941540329338989]], "regularly obtains the list of running processes.": [["Process Discovery", 0.8676116115838737], ["System Service Discovery", 0.016757272262969466], ["Native API", 0.013754894498878841], ["Process Injection", 0.008680376198985552], ["Software Discovery", 0.0074360636959000135], ["Windows Management Instrumentation", 0.007110069915124587]], "examines all the processes on the system": [["Process Discovery", 0.8167235414876888], ["System Service Discovery", 0.019624219647864323], ["Software Discovery", 0.016090169763429103], ["Native API", 0.012676751634466736], ["Windows Management Instrumentation", 0.01123330801415559], ["Process Injection", 0.010510560442395185]], "looks for specific processes": [["Process Discovery", 0.7982801073741497], ["Native API", 0.032674998162976615], ["System Service Discovery", 0.01828087682488591], ["Process Injection", 0.013895357662090668], ["Windows Management Instrumentation", 0.01179399804050775], ["Software Discovery", 0.009874208493428075]], "acquires handles for all running processes on the system, which results in either winlogon.exe or explorer.exe obtaining numerous process handles.": [["Process Discovery", 0.2846491535511415], ["Native API", 0.11803461104887253], ["Process Injection", 0.075773136377374], ["Access Token Manipulation", 0.07290731686329259], ["Application Window Discovery", 0.03501456774689186], ["Windows Management Instrumentation", 0.02859074172551552]], "When it detects a starting first (or a stopping last) instance of a process from the list": [["Process Discovery", 0.5092108370233801], ["Native API", 0.05492745904352092], ["Process Injection", 0.04246087587373824], ["Virtualization/Sandbox Evasion", 0.03631759325664576], ["System Service Discovery", 0.029714477624223662], ["Software Discovery", 0.023498542862525434]], "running processes": [["Process Discovery", 0.6346359497237415], ["Process Injection", 0.05058502831297693], ["Native API", 0.04842382562904467], ["Access Token Manipulation", 0.02330327249149846], ["Windows Management Instrumentation", 0.016825318410127212], ["System Service Discovery", 0.015400802203881599]], "a part of code from the .text section (roughly 8 KB) is overwritten with heavily obfuscated code": [["Obfuscated Files or Information", 0.6102770665939841], ["Deobfuscate/Decode Files or Information", 0.09907046093978979], ["Masquerading", 0.020206222642146637], ["Hide Artifacts", 0.018502424389334235], ["Data Obfuscation", 0.014577984043019533], ["Data Manipulation", 0.011096451073051718]], "obfuscated trampoline in the .text section.": [["Obfuscated Files or Information", 0.7876759812274657], ["Deobfuscate/Decode Files or Information", 0.032986303912591476], ["Data Obfuscation", 0.02317956147721088], ["Masquerading", 0.018805299533215337], ["Data Encoding", 0.012712612768500157], ["Encrypted Channel", 0.008441645033527448]], "This trampoline is protected with an obfuscator": [["Obfuscated Files or Information", 0.6522892893059579], ["Deobfuscate/Decode Files or Information", 0.10454020116949055], ["Data Obfuscation", 0.022469518277311952], ["Masquerading", 0.018489570952136263], ["Encrypted Channel", 0.014316169503761857], ["Execution Guardrails", 0.013317847607721867]], "obfuscated with FinSpy Mutator": [["Obfuscated Files or Information", 0.7779046450068429], ["Deobfuscate/Decode Files or Information", 0.04724054499741559], ["Archive Collected Data", 0.014684958056857648], ["Data Obfuscation", 0.014468833390482678], ["Encrypted Channel", 0.013822403990359257], ["Data Encoding", 0.010519967386183783]], "This module is an obfuscated shellcode.": [["Obfuscated Files or Information", 0.8036034828132852], ["Deobfuscate/Decode Files or Information", 0.06176415355224061], ["Process Injection", 0.011581598000350073], ["Encrypted Channel", 0.010462718538938227], ["Masquerading", 0.01009893746035452], ["Data Obfuscation", 0.008347234272564275]], "obfuscated DLL": [["Obfuscated Files or Information", 0.6831456135725669], ["Deobfuscate/Decode Files or Information", 0.09667428575989633], ["Process Injection", 0.030085832710631977], ["Hijack Execution Flow", 0.01878371400650517], ["Masquerading", 0.01755425466767384], ["System Binary Proxy Execution", 0.016730206055593538]], "obfuscated with FinSpy VM.": [["Obfuscated Files or Information", 0.7131717384125132], ["Deobfuscate/Decode Files or Information", 0.062323900433460096], ["Archive Collected Data", 0.024932121537619954], ["Hide Artifacts", 0.02430172859986704], ["Data Encrypted for Impact", 0.01418814048810149], ["Encrypted Channel", 0.010513770132832882]], "It is encrypted with a 256-byte RC4 key.": [["Deobfuscate/Decode Files or Information", 0.3043910487138574], ["Data Encrypted for Impact", 0.10914508411325663], ["Obfuscated Files or Information", 0.0974457824870423], ["Encrypted Channel", 0.0716813041800393], ["Weaken Encryption", 0.06676526251853653], ["Archive Collected Data", 0.06457163481638697]], "conceals memory areas that contain the Trojan components\u2019 code and data.": [["Hide Artifacts", 0.3785114437170648], ["Process Injection", 0.0818874829220985], ["Obfuscated Files or Information", 0.07392116409341899], ["Rootkit", 0.06054900138135597], ["Virtualization/Sandbox Evasion", 0.028325737635698314], ["Modify System Image", 0.027456306073817535]], "encrypts the Orchestrator\u2019s pages with a cipher based on XOR and ROL operations and assigns the PAGE_NOACCESS attribute to them": [["Obfuscated Files or Information", 0.2846973819434793], ["Encrypted Channel", 0.09886192977240864], ["Deobfuscate/Decode Files or Information", 0.0747681965160634], ["Data Encrypted for Impact", 0.05881619093023535], ["Execution Guardrails", 0.038579763010761096], ["Weaken Encryption", 0.02900156470247372]], "protected with an obfuscator": [["Obfuscated Files or Information", 0.7450145085319256], ["Deobfuscate/Decode Files or Information", 0.05815563600752729], ["Execution Guardrails", 0.01749001413460259], ["Data Obfuscation", 0.013357541650282108], ["Archive Collected Data", 0.012274493899037207], ["Encrypted Channel", 0.01214140804893217]], "An obfuscator similar to OLLVM is used to protect FinSpy": [["Obfuscated Files or Information", 0.7481570571146107], ["Deobfuscate/Decode Files or Information", 0.03973855616969389], ["Execution Guardrails", 0.021062886253753767], ["Masquerading", 0.012440359983605905], ["Data Obfuscation", 0.01141203367135602], ["Encrypted Channel", 0.011044304776433419]], "It is obfuscated with a protector resembling the open source OLLVM obfuscator.": [["Obfuscated Files or Information", 0.599799816761481], ["Deobfuscate/Decode Files or Information", 0.0944516641779701], ["Hide Artifacts", 0.0390542131799498], ["Archive Collected Data", 0.025041191232230035], ["Data Encrypted for Impact", 0.015917665888995798], ["Execution Guardrails", 0.015152278562989]], "The encrypted VFS file.": [["Data Encrypted for Impact", 0.1760083043906975], ["Deobfuscate/Decode Files or Information", 0.14075844855899958], ["Obfuscated Files or Information", 0.1053869328427235], ["Archive Collected Data", 0.09510580117433323], ["Hide Artifacts", 0.08521676665394572], ["File and Directory Discovery", 0.03651493835440982]], "The setup configuration file, which is encrypted with RC4": [["Modify Registry", 0.13936705825782006], ["Obfuscated Files or Information", 0.11749686184299522], ["Deobfuscate/Decode Files or Information", 0.11262682296885033], ["Data Encrypted for Impact", 0.035498402217172716], ["Unsecured Credentials", 0.03533607416749753], ["Execution Guardrails", 0.03368775406895583]], "an obfuscator resembling OLLVM or both these protectors": [["Obfuscated Files or Information", 0.7527710280091567], ["Deobfuscate/Decode Files or Information", 0.072643205832325], ["Hide Artifacts", 0.017726348576619717], ["Masquerading", 0.013649669347541875], ["Archive Collected Data", 0.01351514517803155], ["Execution Guardrails", 0.010213087311556082]], "a call to the CreateWindowExW": [["Application Window Discovery", 0.2176013862709125], ["Native API", 0.15728107250202802], ["Hide Artifacts", 0.08478612633269955], ["Event Triggered Execution", 0.046324996586998256], ["Process Injection", 0.041411322547993415], ["Command and Scripting Interpreter", 0.03172726333205155]], "the NtTerminateProcess and ExitProcess functions": [["Native API", 0.16967338933096585], ["Impair Defenses", 0.056189006418208474], ["Service Stop", 0.05526151966886203], ["Virtualization/Sandbox Evasion", 0.05293351338174364], ["Process Injection", 0.04102649289266178], ["Process Discovery", 0.03739401231079581]], "CreateFileW API.": [["Data Staged", 0.13027309354965635], ["Hide Artifacts", 0.08445262062123256], ["Masquerading", 0.0582722996331292], ["Native API", 0.052961711079591786], ["Archive Collected Data", 0.04691423498174119], ["File and Directory Discovery", 0.029172468918697198]], "API function": [["Native API", 0.2798835117169639], ["Cloud Service Dashboard", 0.054642534869569395], ["Web Service", 0.049872139122747496], ["System Services", 0.021501421997698004], ["Command and Scripting Interpreter", 0.017796541091756733], ["Application Layer Protocol", 0.01574156586459384]], "various WinAPI functions.": [["Native API", 0.1870117196000561], ["Windows Management Instrumentation", 0.09300456576839598], ["Masquerading", 0.05843535811799679], ["Command and Scripting Interpreter", 0.03784686769756386], ["System Information Discovery", 0.03739787836323774], ["OS Credential Dumping", 0.03614268110939994]], "low-level API functions (such as NtEnumerateValueKey or NtQuerySystemInformation)": [["Native API", 0.16402700335460263], ["Query Registry", 0.10969428841357073], ["System Information Discovery", 0.06734435911830257], ["OS Credential Dumping", 0.06593792008234553], ["Deobfuscate/Decode Files or Information", 0.04163077000231946], ["File and Directory Discovery", 0.034893984371993154]], "NtTestAlert function": [["Virtualization/Sandbox Evasion", 0.17135698112717518], ["System Information Discovery", 0.06059730758351635], ["Impair Defenses", 0.039198594280629155], ["Software Discovery", 0.03131614532718779], ["Masquerading", 0.02846814513254573], ["Execution Guardrails", 0.02587018253597682]], "call the NtTestAlert function": [["Virtualization/Sandbox Evasion", 0.22927898135186983], ["System Information Discovery", 0.058029117709487175], ["Software Discovery", 0.03160934941861871], ["Impair Defenses", 0.030337994563076055], ["System Time Discovery", 0.024463061015876718], ["Masquerading", 0.024189076510640665]], "CreateProcessInternalW API function": [["Native API", 0.6044711213034566], ["Process Injection", 0.16253285762873482], ["Access Token Manipulation", 0.028671924346873948], ["System Binary Proxy Execution", 0.02531022840423645], ["System Services", 0.019617482092419522], ["Hijack Execution Flow", 0.013514336181969285]], "\u00a0NtQueueAPCThread function": [["Process Injection", 0.17331271938291426], ["Native API", 0.08256562142292], ["Event Triggered Execution", 0.0551820018779123], ["Virtualization/Sandbox Evasion", 0.0536232814008884], ["System Binary Proxy Execution", 0.03170938791276104], ["Masquerading", 0.030808876406737084]], "KiUserExceptionDispatcher function": [["Steal or Forge Kerberos Tickets", 0.04036445328287384], ["Impair Defenses", 0.0376816133645817], ["Modify Cloud Compute Infrastructure", 0.03467816809678611], ["Abuse Elevation Control Mechanism", 0.031271978006507634], ["Access Token Manipulation", 0.02716193937629548], ["Event Triggered Execution", 0.024932049029540916]], "WinAPI file manipulation functions.": [["Masquerading", 0.21452331890724508], ["File and Directory Discovery", 0.0900424705555574], ["Native API", 0.06477860972096754], ["Hide Artifacts", 0.059415911554293856], ["Indicator Removal", 0.04537348582779092], ["Data Manipulation", 0.028769752656423068]], "calling API functions from this library": [["Native API", 0.38485122321845444], ["Shared Modules", 0.06933971072378929], ["Hijack Execution Flow", 0.06346797964711265], ["System Services", 0.0384354297094053], ["Process Injection", 0.01863228820536812], ["System Binary Proxy Execution", 0.013470310862739318]], "hooks the kernel\u2019s PsCreateSystemThread function": [["Process Injection", 0.31330273297125183], ["Create or Modify System Process", 0.07675779836472434], ["Rootkit", 0.04252040571242547], ["Native API", 0.04057197132253599], ["Virtualization/Sandbox Evasion", 0.03615267699278067], ["Event Triggered Execution", 0.028562073837891788]], "launches a slightly modified Metasploit Reverse HTTPS stager": [["Application Layer Protocol", 0.21552097277239962], ["Data Obfuscation", 0.09886040429116644], ["Browser Session Hijacking", 0.046968954152991016], ["Non-Standard Port", 0.03728851463809733], ["Encrypted Channel", 0.035920496203832114], ["Stage Capabilities", 0.03162251936897122]], "connects to a configured C2 server using HTTPS for communication.": [["Application Layer Protocol", 0.5777736870035665], ["Proxy", 0.05214752062620491], ["Encrypted Channel", 0.046155451281186484], ["Non-Application Layer Protocol", 0.03493329190674924], ["Non-Standard Port", 0.0345401532110236], ["Data Obfuscation", 0.030088584149274945]], "Makes an initial POST request to the C2 server": [["Application Layer Protocol", 0.2736046992272012], ["Exfiltration Over C2 Channel", 0.13267843488271436], ["Web Service", 0.06862822913968707], ["Fallback Channels", 0.06069503454783392], ["Data Encoding", 0.040142637755417314], ["Data Obfuscation", 0.021878855402391432]], "to the C2 server via a POST request.": [["Application Layer Protocol", 0.17141665000300416], ["Web Service", 0.160360048899893], ["Exfiltration Over C2 Channel", 0.15363182865127356], ["Fallback Channels", 0.033827399252434394], ["Scheduled Transfer", 0.029816535171667827], ["Email Collection", 0.022413022875862523]], "All communications between the server are encrypted with RC4": [["Encrypted Channel", 0.607299001516464], ["Exfiltration Over Alternative Protocol", 0.043627507095940724], ["Non-Application Layer Protocol", 0.03194510436721885], ["Data Obfuscation", 0.02397189320065531], ["Weaken Encryption", 0.023222369498467465], ["Data Encoding", 0.020778328727187354]], "encrypted with RC4": [["Encrypted Channel", 0.21518711987476064], ["Obfuscated Files or Information", 0.17807464912211], ["Deobfuscate/Decode Files or Information", 0.17533201832620818], ["Data Encrypted for Impact", 0.12101587289060327], ["Archive Collected Data", 0.060977431784789676], ["Execution Guardrails", 0.029761788589200092]], "A snippet of the RC4 key generation function": [["Encrypted Channel", 0.13964479637234944], ["Boot or Logon Autostart Execution", 0.10417177327908679], ["Deobfuscate/Decode Files or Information", 0.07205715555851239], ["Weaken Encryption", 0.03568145105238106], ["Modify Registry", 0.03405067250518974], ["Multi-Factor Authentication Interception", 0.033926132800182376]], "Returns the list of network adapter types, IP and MAC addresses assigned to them.": [["System Network Configuration Discovery", 0.6378183278403559], ["System Network Connections Discovery", 0.08060491014745094], ["Remote System Discovery", 0.036691223781804866], ["Data from Configuration Repository", 0.024934108867288418], ["System Information Discovery", 0.02199552484449557], ["Peripheral Device Discovery", 0.019075087660915525]], "Returns names of shortcuts in the Desktop directory.": [["File and Directory Discovery", 0.24637426952818298], ["Query Registry", 0.11938379264285695], ["Boot or Logon Autostart Execution", 0.05984160691006548], ["Native API", 0.0500819165520102], ["Application Window Discovery", 0.033340135016402574], ["Windows Management Instrumentation", 0.028639716653226507]], "Returns the path to the \u2018Program Files\u2019 folder.": [["File and Directory Discovery", 0.4650347205162725], ["Native API", 0.09181807360462782], ["Hijack Execution Flow", 0.05706924979566364], ["Masquerading", 0.05101432920874863], ["System Information Discovery", 0.025221595577465825], ["Query Registry", 0.020532012012077123]], "Returns the short form of the user\u2019s profile folder": [["File and Directory Discovery", 0.26321486050362575], ["System Owner/User Discovery", 0.09924130558844814], ["Account Discovery", 0.09829702336292358], ["Data Staged", 0.037843924224482045], ["Data from Local System", 0.03214399887598981], ["OS Credential Dumping", 0.021947087881480417]], "Returns the user\u2019s profile folder": [["File and Directory Discovery", 0.1826395019451535], ["Account Discovery", 0.10647379806944417], ["System Owner/User Discovery", 0.10401439281311202], ["Data from Local System", 0.048909116629684925], ["Data Staged", 0.03814463052767209], ["OS Credential Dumping", 0.028688797017957686]], "Returns the list of object names in the \\GLOBAL?? directory.": [["File and Directory Discovery", 0.36376683694706546], ["Native API", 0.04939614503998456], ["Query Registry", 0.03524643058852351], ["Automated Collection", 0.024838069589221638], ["Hide Artifacts", 0.021927574112636256], ["Data from Local System", 0.02180165997822948]], "Retrieve the list of files": [["File and Directory Discovery", 0.8040570521206675], ["Data from Local System", 0.044652840121577025], ["Automated Collection", 0.016954739860599956], ["Data from Network Shared Drive", 0.014695099923474233], ["Data Staged", 0.009485660787109775], ["Indicator Removal", 0.007249534987999638]], "gets the list of recent files": [["File and Directory Discovery", 0.4917504243461197], ["Indicator Removal", 0.09692730070630344], ["Automated Collection", 0.07386104726414194], ["Data from Local System", 0.06369972468642161], ["Data Staged", 0.04932458764659879], ["Data from Network Shared Drive", 0.013062442073634077]], "search, delete files.": [["Indicator Removal", 0.7890863079533587], ["Data Destruction", 0.05081539571091449], ["Inhibit System Recovery", 0.018114156653812746], ["Disk Wipe", 0.011248132170278256], ["System Shutdown/Reboot", 0.009258358520736927], ["Service Stop", 0.007769825227321563]], "file listings": [["File and Directory Discovery", 0.6299061300374431], ["Data from Local System", 0.04246642813228292], ["Automated Collection", 0.038844259782498676], ["Masquerading", 0.030643749303538192], ["Hide Artifacts", 0.024855645473071775], ["Data Staged", 0.0231128679542119]], "Create file listing recordings": [["Data Staged", 0.1411703523799613], ["Automated Collection", 0.12611077117103658], ["File and Directory Discovery", 0.1185036924161106], ["Data from Local System", 0.10624392076633796], ["Data from Removable Media", 0.04922684236593517], ["Indicator Removal", 0.0371977999143268]], "Returns the path to the user\u2019s temporary folder.": [["File and Directory Discovery", 0.46460469314774594], ["Data Staged", 0.08488616252507762], ["Native API", 0.038686644006145236], ["Hide Artifacts", 0.030085608149556835], ["Masquerading", 0.02393991153319378], ["Indicator Removal", 0.023775281230075277]], "Returns the current domain SID": [["System Network Configuration Discovery", 0.19178969566353815], ["System Owner/User Discovery", 0.11068710899319588], ["Remote System Discovery", 0.06570146352335114], ["System Information Discovery", 0.06531130842741535], ["Account Discovery", 0.06359463917142569], ["Permission Groups Discovery", 0.06159573935811524]], "Returns the current user\u2019s name": [["System Owner/User Discovery", 0.8690384917520207], ["Account Discovery", 0.03338292179375081], ["System Information Discovery", 0.012686778478558399], ["Native API", 0.005521068836886692], ["Access Token Manipulation", 0.003903268345922491], ["Permission Groups Discovery", 0.003648802563077309]], "Returns the current user\u2019s SID.": [["System Owner/User Discovery", 0.7002138829249749], ["Account Discovery", 0.10496093657740085], ["Access Token Manipulation", 0.03770626633447015], ["Permission Groups Discovery", 0.022626695620961392], ["OS Credential Dumping", 0.008217753481952342], ["System Information Discovery", 0.005258690414012443]], "WMI query": [["Windows Management Instrumentation", 0.8357270315709255], ["Event Triggered Execution", 0.016239393449766416], ["System Information Discovery", 0.010398487453572455], ["Query Registry", 0.009341274024717025], ["Peripheral Device Discovery", 0.006762395465399969], ["OS Credential Dumping", 0.005769558907915745]], "Creates a scheduled task that runs at system startup": [["Scheduled Task/Job", 0.6811413422016144], ["Create or Modify System Process", 0.06581619794095646], ["Boot or Logon Autostart Execution", 0.03742379925303273], ["Boot or Logon Initialization Scripts", 0.03161632273893721], ["Event Triggered Execution", 0.014736381267695043], ["System Services", 0.01468857858943369]], "The Task Scheduler launches it at system startup": [["Scheduled Task/Job", 0.696879330037514], ["Create or Modify System Process", 0.04871859097938099], ["Boot or Logon Autostart Execution", 0.02334509007479071], ["Event Triggered Execution", 0.014758596390081879], ["Masquerading", 0.014556971145413895], ["Inter-Process Communication", 0.013254786511268312]], "scheduled task properties": [["Scheduled Task/Job", 0.7651255349526701], ["Inter-Process Communication", 0.03722762756872177], ["Masquerading", 0.018583199328653006], ["Command and Scripting Interpreter", 0.009419922334681925], ["Create or Modify System Process", 0.008952311528190987], ["Domain Policy Modification", 0.006156955290685358]], "a DLL obfuscated with VMProtect.": [["Obfuscated Files or Information", 0.7132678725991959], ["Deobfuscate/Decode Files or Information", 0.09162685643534776], ["Hide Artifacts", 0.022674609987701575], ["Masquerading", 0.020420617195936887], ["Process Injection", 0.015600573546661193], ["Archive Collected Data", 0.01418344345083896]], "unpacking the Orchestrator": [["Deobfuscate/Decode Files or Information", 0.1561356374624795], ["Obfuscated Files or Information", 0.052133973710717665], ["Masquerading", 0.04689380020354786], ["Indicator Removal", 0.02530538929280891], ["Command and Scripting Interpreter", 0.023521140138956564], ["Create or Modify System Process", 0.023451356564057637]], "unpacks it with aPLib.": [["Deobfuscate/Decode Files or Information", 0.32518346673236037], ["Hijack Execution Flow", 0.09073585828897322], ["Obfuscated Files or Information", 0.08163322289555947], ["Masquerading", 0.040787165089483685], ["System Binary Proxy Execution", 0.03272234238092736], ["Shared Modules", 0.031277573178031315]], "Orchestrator is unpacked": [["Deobfuscate/Decode Files or Information", 0.11516627286710407], ["Obfuscated Files or Information", 0.04582278512924284], ["Masquerading", 0.03537631315611737], ["Create or Modify System Process", 0.034681942863116814], ["System Services", 0.034157432764912246], ["Ingress Tool Transfer", 0.028763664580979915]], "The Orchestrator (as well as plugins) are packed with aPLib and encrypted with AES.": [["Obfuscated Files or Information", 0.31908258365699727], ["Deobfuscate/Decode Files or Information", 0.14447355153248223], ["Encrypted Channel", 0.07882486678326443], ["Data Encrypted for Impact", 0.046465906936586684], ["Archive Collected Data", 0.03252293361559053], ["Weaken Encryption", 0.0277499486698136]], "unpacks with aPLib": [["Deobfuscate/Decode Files or Information", 0.28754559613854824], ["Obfuscated Files or Information", 0.1858017397879616], ["Hijack Execution Flow", 0.04787263051894338], ["Masquerading", 0.03362105305311755], ["Command and Scripting Interpreter", 0.03278591120328587], ["Native API", 0.02597241950120661]], "encrypted with XOR and compressed with aPLib.": [["Obfuscated Files or Information", 0.33728834034825944], ["Archive Collected Data", 0.33171394208444394], ["Deobfuscate/Decode Files or Information", 0.11075932695604326], ["Data Encrypted for Impact", 0.047183515638708345], ["Encrypted Channel", 0.020231261320755208], ["Exfiltration Over Alternative Protocol", 0.014076164552820038]], "unpacks it with aPLib": [["Deobfuscate/Decode Files or Information", 0.37892219763623625], ["Obfuscated Files or Information", 0.12008325709365142], ["Hijack Execution Flow", 0.04041509290542627], ["Masquerading", 0.034278831323169806], ["Archive Collected Data", 0.029520014020801615], ["Command and Scripting Interpreter", 0.02561476196327947]], "takes a screenshot": [["Screen Capture", 0.8758869682095909], ["Video Capture", 0.01666140899127665], ["Application Window Discovery", 0.009835108817802262], ["Input Capture", 0.0053065362165091], ["Clipboard Data", 0.004514313263082734], ["Hide Artifacts", 0.0034624521587010367]], "screen": [["Screen Capture", 0.22964784371488367], ["Remote Access Software", 0.03489420175248354], ["Application Window Discovery", 0.02770359230373093], ["Remote Services", 0.025055244437075904], ["Video Capture", 0.024121372191202323], ["Input Capture", 0.02408908925674004]], "take screenshots during, online conversations.": [["Screen Capture", 0.7161242791543352], ["Video Capture", 0.08680750355952876], ["Input Capture", 0.012615055165119357], ["Audio Capture", 0.009955886251353593], ["Application Window Discovery", 0.005792233922547343], ["Clipboard Data", 0.004496154055793024]], "Capture the screen area around mouse click locations": [["Screen Capture", 0.5933704053964827], ["Video Capture", 0.05529619470108109], ["Application Window Discovery", 0.04593984275317827], ["Input Capture", 0.033941533427723096], ["Clipboard Data", 0.022579876102959154], ["Virtualization/Sandbox Evasion", 0.010621663930115334]], "Take screenshots with a specified frame rate, and livestream or record them.": [["Screen Capture", 0.4918360934532951], ["Video Capture", 0.27485972649017293], ["Input Capture", 0.016151189712188818], ["Audio Capture", 0.013623519949045542], ["Archive Collected Data", 0.007549876620775182], ["Application Window Discovery", 0.006792457428353176]], "Commands are used to download and install plugins": [["Ingress Tool Transfer", 0.45374106875204817], ["Command and Scripting Interpreter", 0.14318390384650687], ["BITS Jobs", 0.06943314342890118], ["Browser Extensions", 0.020439101676357534], ["System Binary Proxy Execution", 0.016467340522723254], ["Multi-Stage Channels", 0.013969130775889101]], "Commands are used to download and run the Trojan Installer.": [["Ingress Tool Transfer", 0.23046695658392014], ["Command and Scripting Interpreter", 0.2212820128486258], ["BITS Jobs", 0.07153322689243909], ["System Binary Proxy Execution", 0.06493992242444024], ["Software Discovery", 0.028454707837989077], ["Browser Extensions", 0.0253059497142347]], "Upload, download": [["Ingress Tool Transfer", 0.4718943089774732], ["Exfiltration Over C2 Channel", 0.037727651032897], ["Data from Local System", 0.03592019320480224], ["Exfiltration Over Web Service", 0.03542905443990759], ["Exfiltration Over Alternative Protocol", 0.031249914511413675], ["Web Service", 0.02379833709973981]], "downloading and executing specific utilities": [["Ingress Tool Transfer", 0.5732342149339879], ["Command and Scripting Interpreter", 0.17488287403237388], ["BITS Jobs", 0.046988252916640265], ["System Binary Proxy Execution", 0.01910283985425389], ["Application Layer Protocol", 0.009791267408112644], ["Native API", 0.008753467292797884]], "downloads Security Shellcodes from the C2 server": [["Deobfuscate/Decode Files or Information", 0.15105446073451878], ["Obfuscated Files or Information", 0.1333330335823497], ["Command and Scripting Interpreter", 0.047449025180603545], ["Web Service", 0.0387924224408177], ["Unsecured Credentials", 0.03851564461772063], ["Ingress Tool Transfer", 0.030676810294409093]], "may save recording files in the working directory": [["Data Staged", 0.2618446465030706], ["Archive Collected Data", 0.054859900380737785], ["Video Capture", 0.044665071943160585], ["Automated Collection", 0.041554892224283976], ["Hide Artifacts", 0.039853883802803074], ["Data from Local System", 0.03869522463797086]], "stored in the working directory": [["Data Staged", 0.3697403319674889], ["File and Directory Discovery", 0.1508259387035727], ["Data from Local System", 0.0659391058236566], ["Hide Artifacts", 0.041247771501091206], ["Data from Network Shared Drive", 0.025357097831637913], ["Automated Collection", 0.018981993021094296]], "the malware\u2019s working directory": [["File and Directory Discovery", 0.46216183707743475], ["Masquerading", 0.05379973114645747], ["Data Staged", 0.03602571885946643], ["Indicator Removal", 0.03389370910777441], ["Hijack Execution Flow", 0.03152167549765521], ["Hide Artifacts", 0.022618326295210312]], "Once the working directory is prepared,": [["File and Directory Discovery", 0.24812863449723946], ["Data Staged", 0.0853422908287232], ["Masquerading", 0.05601301195833215], ["Native API", 0.035870093775264095], ["Hide Artifacts", 0.03556584870712861], ["Hijack Execution Flow", 0.029128363786268194]], "keylogs": [["Input Capture", 0.8370708374557855], ["Unsecured Credentials", 0.008669726083974125], ["Credentials from Password Stores", 0.008391625980586856], ["Clipboard Data", 0.005648855796023062], ["Screen Capture", 0.0053551585979880745], ["OS Credential Dumping", 0.004910286397797864]], "record keystrokes": [["Input Capture", 0.8424709402669533], ["Clipboard Data", 0.009457884963362523], ["Screen Capture", 0.007563340447436452], ["Video Capture", 0.006605687957243059], ["Credentials from Password Stores", 0.005023285546945266], ["Audio Capture", 0.005006219274105339]], "Delete a recording with a given filename from the system.": [["Indicator Removal", 0.5842774882382478], ["Data Destruction", 0.0710539716909127], ["Disk Wipe", 0.02457082362772778], ["Inhibit System Recovery", 0.016672250089699747], ["Data Staged", 0.014882939739276246], ["Archive Collected Data", 0.012020846242493985]], "Uninstall the backdoor.": [["Impair Defenses", 0.134662116748521], ["Indicator Removal", 0.08738671665941398], ["Inhibit System Recovery", 0.06458516969066233], ["Modify System Image", 0.050619347954176434], ["Modify Registry", 0.037760301029108434], ["Rootkit", 0.035513313039088744]], "wipes all the files and registry keys created by the backdoor": [["Indicator Removal", 0.3192892625254341], ["Modify Registry", 0.14949194821535652], ["Inhibit System Recovery", 0.10736808816304962], ["System Shutdown/Reboot", 0.04057915669925627], ["Disk Wipe", 0.03194143310465355], ["Query Registry", 0.03073850091966697]], "delete files.": [["Indicator Removal", 0.7198547520560933], ["Data Destruction", 0.08564688770914197], ["Disk Wipe", 0.018440362447819887], ["Inhibit System Recovery", 0.01776922397380592], ["System Shutdown/Reboot", 0.01616437333253226], ["Service Stop", 0.00917548563049419]], "creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.": [["Native API", 0.23793531011777475], ["Command and Scripting Interpreter", 0.10387374044716147], ["Process Injection", 0.09940562954542702], ["System Binary Proxy Execution", 0.03604863732711096], ["Event Triggered Execution", 0.02802187295063206], ["Inter-Process Communication", 0.021748477340865775]], "APC injections": [["Process Injection", 0.21324479064386534], ["Exploit Public-Facing Application", 0.029037455602781183], ["Event Triggered Execution", 0.0235645594659421], ["Obfuscated Files or Information", 0.01981301603487654], ["Inter-Process Communication", 0.01896892111678076], ["Hijack Execution Flow", 0.017877975634327685]], "The asynchronous procedure places a hook on the NtTestAlert function and then exits": [["Virtualization/Sandbox Evasion", 0.1810361220177555], ["Native API", 0.05074472088260664], ["Command and Scripting Interpreter", 0.04300381644114269], ["Impair Defenses", 0.02989954985902332], ["Process Discovery", 0.02477293910705256], ["Process Injection", 0.024274780944156728]], "will be loaded with the help of the APC injection loader.": [["Process Injection", 0.12216002602875753], ["Shared Modules", 0.10384158335853967], ["Hijack Execution Flow", 0.09712376846213291], ["System Binary Proxy Execution", 0.042078609654989434], ["Event Triggered Execution", 0.03406540738098988], ["Create or Modify System Process", 0.03193397486519709]], "the hooked process creation function clears a possible hook of the \u00a0NtQueueAPCThread function and then uses it to create an APC procedure in the new process.": [["Process Injection", 0.34010289908659025], ["Create or Modify System Process", 0.08334947673835916], ["Native API", 0.0696763449069753], ["Access Token Manipulation", 0.058675737906212444], ["Process Discovery", 0.03399048903838615], ["Masquerading", 0.02581560608861232]], "junk code created by the ProcessWorm loader": [["Process Injection", 0.4955276842641103], ["Native API", 0.1021031214552247], ["Process Discovery", 0.055022922909513494], ["Hijack Execution Flow", 0.044140906652038334], ["Create or Modify System Process", 0.02600905732174525], ["System Binary Proxy Execution", 0.02140773640259871]], "entries point to buffers of randomly generated junk code": [["Indicator Removal", 0.07201938957244308], ["Process Injection", 0.06774836196820948], ["Obfuscated Files or Information", 0.060300601774224076], ["Hide Artifacts", 0.058886751513262864], ["Data Manipulation", 0.046503417847370006], ["Data Staged", 0.037953259967998594]], "method names contain junk.": [["Masquerading", 0.17011279730014764], ["Native API", 0.1696671515036145], ["Hijack Execution Flow", 0.03125639309620577], ["Obfuscated Files or Information", 0.0295419485348036], ["System Services", 0.02083990974470964], ["Deobfuscate/Decode Files or Information", 0.013354678255110681]], "The executable is prepended with 0x4000 random bytes and encrypted with RC4": [["Obfuscated Files or Information", 0.5057744327171624], ["Deobfuscate/Decode Files or Information", 0.17068000592491922], ["Execution Guardrails", 0.026135782968873877], ["Process Injection", 0.023775648460512007], ["Masquerading", 0.01802668221424164], ["System Binary Proxy Execution", 0.017909860476029164]], "documents sent to the printer.": [["Data from Local System", 0.06970534342411304], ["Automated Collection", 0.05489241372254183], ["Template Injection", 0.052682175663410755], ["Phishing", 0.04518185194240475], ["Automated Exfiltration", 0.044503813755940085], ["Peripheral Device Discovery", 0.03696503195212654]], "Steal files which are printed by the victim": [["Data from Local System", 0.33423839776144576], ["Automated Collection", 0.07196887882023931], ["Data Staged", 0.06250039134395266], ["Data from Network Shared Drive", 0.05042920340311066], ["Ingress Tool Transfer", 0.04808369902009672], ["File and Directory Discovery", 0.035772795044139445]], "recently opened documents": [["File and Directory Discovery", 0.21052357391383877], ["Data from Local System", 0.10004972071849699], ["Hide Artifacts", 0.07124930301201714], ["Data Staged", 0.04557839004615597], ["Automated Collection", 0.036718385705586117], ["Data from Network Shared Drive", 0.036138580143730684]], "Uninstall a plugin from the machine": [["Indicator Removal", 0.5057684463178684], ["Impair Defenses", 0.059109319056861266], ["Modify Registry", 0.045106596755465155], ["Inhibit System Recovery", 0.01762077579361411], ["Service Stop", 0.016446896077326384], ["System Shutdown/Reboot", 0.01632462300755531]], "Sets up persistence by creating an entry in the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry key.": [["Boot or Logon Autostart Execution", 0.5489449797614249], ["Event Triggered Execution", 0.06390618920750468], ["Boot or Logon Initialization Scripts", 0.06286817660885083], ["Create or Modify System Process", 0.0594429873327542], ["Modify Registry", 0.05700141469662611], ["Office Application Startup", 0.02646168160090452]], "adds it to the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run key": [["Boot or Logon Autostart Execution", 0.7839005743574919], ["Modify Registry", 0.020034961179397223], ["Create or Modify System Process", 0.01880759759907492], ["Event Triggered Execution", 0.017233028183891826], ["Hijack Execution Flow", 0.01152103179911679], ["Query Registry", 0.010462931291959417]], "Bash script": [["Command and Scripting Interpreter", 0.8138652061938898], ["Scheduled Task/Job", 0.014807845127746572], ["Automated Collection", 0.00691904776530591], ["Native API", 0.006556863207652983], ["Virtualization/Sandbox Evasion", 0.005704124235407537], ["System Binary Proxy Execution", 0.005695996460994421]], "launched on every startup by rundll32.exe": [["Boot or Logon Autostart Execution", 0.26385370526617413], ["System Binary Proxy Execution", 0.13811160910151363], ["Create or Modify System Process", 0.12139601948287002], ["Event Triggered Execution", 0.09175988776375989], ["Hijack Execution Flow", 0.0537474023329534], ["Boot or Logon Initialization Scripts", 0.039803578067002555]], "creates a thread in the kernel that injects the next stage into winlogon.exe.": [["Process Injection", 0.13534160306195758], ["Event Triggered Execution", 0.11127891478268427], ["Boot or Logon Autostart Execution", 0.07091091818043573], ["Access Token Manipulation", 0.040520734055896616], ["Input Capture", 0.03663845524058706], ["Create or Modify System Process", 0.03310704309265522]], "A thread with trampoline shellcode is created inside exe.": [["Process Injection", 0.3503667540877937], ["Native API", 0.19311902357766267], ["System Binary Proxy Execution", 0.06129513843536851], ["Process Discovery", 0.03291899026765684], ["Event Triggered Execution", 0.0301996843191709], ["Access Token Manipulation", 0.027340560947748505]], "The victim downloads a Trojanized application and executes it.": [["User Execution", 0.14240498050602718], ["System Binary Proxy Execution", 0.12369469433200013], ["Ingress Tool Transfer", 0.10724471528927913], ["Process Injection", 0.049342569423828864], ["Command and Scripting Interpreter", 0.04020879955016709], ["Masquerading", 0.03268630774267794]], "we identified numerous legitimate applications backdoored": [["Compromise Client Software Binary", 0.13280278897789116], ["Software Discovery", 0.09408216525238769], ["Supply Chain Compromise", 0.0793986798091402], ["Obtain Capabilities", 0.04959186438364681], ["Develop Capabilities", 0.04639263648669797], ["Masquerading", 0.04612624982879131]], "TeamViewer": [["Remote Access Software", 0.48376411837051014], ["Remote Services", 0.14699611495593437], ["Communication Through Removable Media", 0.016117316570869452], ["Remote System Discovery", 0.014159969155318869], ["Software Deployment Tools", 0.013816303806228957], ["Exploitation of Remote Services", 0.011826665925950296]], "Cleans\u00a0 API functions potentially hooked by security solutions": [["Impair Defenses", 0.3651633604116364], ["Indicator Removal", 0.11328545913903003], ["Modify Registry", 0.025994828809872958], ["Subvert Trust Controls", 0.025365834728166056], ["Software Discovery", 0.021496723815449502], ["Modify Cloud Compute Infrastructure", 0.01992802715185091]], "attackers also exploited vulnerabilities such as PrintNightmare to escalate privileges": [["Exploitation for Privilege Escalation", 0.4977425990293167], ["Abuse Elevation Control Mechanism", 0.08540827023354718], ["Domain Policy Modification", 0.025556503187145214], ["Access Token Manipulation", 0.02367872213904556], ["Exploitation of Remote Services", 0.02366031886423479], ["Exploitation for Client Execution", 0.019571902161571893]], "Software vulnerabilities, such as PrintNightmare (CVE-2021-1675) and (CVE-2021-34527), may be exploited in an attempt to elevate privileges.": [["Exploitation for Privilege Escalation", 0.5314358797882738], ["Abuse Elevation Control Mechanism", 0.1464656507002502], ["Access Token Manipulation", 0.033346653697530815], ["Domain Policy Modification", 0.02374616339960548], ["Exploitation of Remote Services", 0.01603040415011184], ["Exploitation for Client Execution", 0.013732490327321056]], "has operated sites on the Tor network using the following .onion": [["Proxy", 0.1478686787757263], ["Compromise Infrastructure", 0.08795403336180325], ["Acquire Infrastructure", 0.08087736752723118], ["Web Service", 0.06301294307937054], ["Stage Capabilities", 0.05282832326759704], ["Application Layer Protocol", 0.022535256901541095]], "this key is typically obfuscated with AES 256 encryption.": [["Deobfuscate/Decode Files or Information", 0.20330539501614475], ["Obfuscated Files or Information", 0.1813825455923326], ["Encrypted Channel", 0.11894391530153808], ["Weaken Encryption", 0.09084304220031567], ["Data Encrypted for Impact", 0.05760639427269056], ["Execution Guardrails", 0.050301397807979306]], "encrypted PowerShell.": [["Obfuscated Files or Information", 0.2701967766320022], ["Data Encrypted for Impact", 0.15146935964678265], ["Deobfuscate/Decode Files or Information", 0.09312649501603935], ["Encrypted Channel", 0.0745160962619815], ["Command and Scripting Interpreter", 0.03845187518011443], ["Execution Guardrails", 0.03663154593557904]], "Upon execution, the ransomware binary deletes itself": [["Indicator Removal", 0.38458264881753645], ["Data Encrypted for Impact", 0.05754121095418862], ["Data Destruction", 0.05569088427575516], ["Command and Scripting Interpreter", 0.03652764111895832], ["Inhibit System Recovery", 0.033542738968570254], ["Masquerading", 0.03148054601333243]], "Creating the HKCU\\Software\\Zeppelin registry key": [["Modify Registry", 0.39700465531151213], ["Boot or Logon Autostart Execution", 0.23379467423018943], ["Query Registry", 0.12998331325356183], ["Create or Modify System Process", 0.01861491644597409], ["System Binary Proxy Execution", 0.016206462976069258], ["Domain Policy Modification", 0.012753559417405379]], "by modifying the Registry.": [["Modify Registry", 0.36387271945265], ["Boot or Logon Autostart Execution", 0.08817462196075028], ["Impair Defenses", 0.04032166140565585], ["Query Registry", 0.03621488828880261], ["Masquerading", 0.03380338892632948], ["Create or Modify System Process", 0.030375017635179306]], "valid credentials have been used by Vice Society to gain initial access.": [["Valid Accounts", 0.1410675857889291], ["Forge Web Credentials", 0.05899739639092067], ["External Remote Services", 0.05697659168412816], ["Exploitation for Credential Access", 0.05533106223877551], ["Brute Force", 0.04130547431742341], ["Use Alternate Authentication Material", 0.040529764169890924]], "Internet-facing applications and systems vulnerabilities can be exploited, such as PrintNightmare (CVE-2021-1675) and (CVE-2021-34527), to gain initial access.": [["Exploit Public-Facing Application", 0.3288360802921926], ["Exploitation for Client Execution", 0.10121543773432588], ["Drive-by Compromise", 0.059276299343745203], ["Stage Capabilities", 0.04419293702769729], ["Exploitation of Remote Services", 0.04044665160044543], ["Compromise Infrastructure", 0.03366999835629404]], "Batch files are used": [["Command and Scripting Interpreter", 0.49196545227033317], ["Scheduled Task/Job", 0.0733328019439238], ["Indicator Removal", 0.03255527957214883], ["System Binary Proxy Execution", 0.02535309441891047], ["Masquerading", 0.01946003745476966], ["Windows Management Instrumentation", 0.017108771275845883]], "features multiple flags that could be set as command line arguments": [["Indirect Command Execution", 0.13928613916049162], ["Command and Scripting Interpreter", 0.13811131798879442], ["Modify Registry", 0.057305193524624265], ["Obfuscated Files or Information", 0.031942625146708724], ["System Binary Proxy Execution", 0.029254404450599895], ["Boot or Logon Autostart Execution", 0.027895715725810538]], "Persistence is maintained after boot/reboot via malicious autostart registry keys.": [["Boot or Logon Autostart Execution", 0.318049553127395], ["Boot or Logon Initialization Scripts", 0.1875063100242035], ["Event Triggered Execution", 0.07084599062142591], ["Create or Modify System Process", 0.06297847487103198], ["Modify Registry", 0.04991345114670341], ["Pre-OS Boot", 0.04990167365398232]], "utilizes legitimate programs to side-load the group\u2019s own DLL to execute their payload.": [["Hijack Execution Flow", 0.41789815637804756], ["Shared Modules", 0.1549994542771803], ["System Binary Proxy Execution", 0.07014761636528932], ["Process Injection", 0.05349724096875689], ["Event Triggered Execution", 0.01937138035647051], ["Trusted Developer Utilities Proxy Execution", 0.015924046315604356]], "Malicious commands are executed via WMI as a means of \u201cliving off the land\u201d and avoiding detection.": [["Windows Management Instrumentation", 0.6141050700248196], ["Event Triggered Execution", 0.07834066996412663], ["Pre-OS Boot", 0.01469080408384697], ["Abuse Elevation Control Mechanism", 0.011472988170756482], ["Command and Scripting Interpreter", 0.009619170080616074], ["Masquerading", 0.009594100577570696]], "execute commands via scheduled tasks/jobs.": [["Scheduled Task/Job", 0.7887262852605976], ["Inter-Process Communication", 0.03416694524226425], ["Command and Scripting Interpreter", 0.03357379532969149], ["System Services", 0.015692378418633284], ["Masquerading", 0.00680943302538219], ["Create or Modify System Process", 0.005894587113592812]], "Files dropped in the victim\u2019s environment by Vice Society may have been altered to appear legitimate.": [["Masquerading", 0.18843458584357198], ["Indicator Removal", 0.17885279027255388], ["Hide Artifacts", 0.10974869448788473], ["Obfuscated Files or Information", 0.031011727085175536], ["Data Manipulation", 0.029572434566048206], ["Data from Local System", 0.024713422467104278]], "attempts to disable Windows Defender": [["Impair Defenses", 0.5024994404209896], ["Software Discovery", 0.03662479601261869], ["Windows Management Instrumentation", 0.025182832205313557], ["Domain Policy Modification", 0.020296527456912992], ["Subvert Trust Controls", 0.019459205970209902], ["Masquerading", 0.01829179250766589]], "Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices.": [["Impair Defenses", 0.34089265909931205], ["Software Discovery", 0.05212065262088724], ["Modify System Image", 0.040966682893986625], ["Exploitation for Defense Evasion", 0.032812856806262274], ["Subvert Trust Controls", 0.03179600180112419], ["Pre-OS Boot", 0.02699244133801486]], "utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service.": [["OS Credential Dumping", 0.543770308648605], ["Unsecured Credentials", 0.1639280011029686], ["Credentials from Password Stores", 0.07909598648063437], ["Network Sniffing", 0.01521235259950224], ["Password Policy Discovery", 0.015159901166110896], ["Brute Force", 0.011620372622895728]], "RDP is used by the group for lateral movement.": [["Remote Services", 0.6449865747850914], ["Remote Access Software", 0.08406768433270508], ["Remote Service Session Hijacking", 0.037608775384249914], ["Exploitation of Remote Services", 0.025027091344256066], ["External Remote Services", 0.01327931029639228], ["Valid Accounts", 0.01175408186562322]], "Lateral tool transfers have been used to move tools and files from one compromised system to another, including SMB and RDP.": [["Lateral Tool Transfer", 0.39245307891898784], ["Remote Services", 0.21466198595062566], ["Taint Shared Content", 0.046596902858441085], ["Communication Through Removable Media", 0.03647007379838046], ["Exploitation of Remote Services", 0.01609904214671976], ["Replication Through Removable Media", 0.014259874424278224]], "to exfiltrate data to external C2 servers.": [["Exfiltration Over C2 Channel", 0.25046624967617126], ["Exfiltration Over Alternative Protocol", 0.09824435700947456], ["Exfiltration Over Web Service", 0.09551457954736751], ["Archive Collected Data", 0.06197380585372808], ["Automated Exfiltration", 0.05140043780606746], ["Scheduled Transfer", 0.051347078558941335]], "to exfiltrate data directly to C2 servers.": [["Exfiltration Over C2 Channel", 0.315796378798827], ["Exfiltration Over Alternative Protocol", 0.1076314673866666], ["Exfiltration Over Web Service", 0.07768255067552098], ["Scheduled Transfer", 0.05415128267305227], ["Archive Collected Data", 0.05404076947309328], ["Automated Exfiltration", 0.0536134338153923]], "Tools such as SystemBC and proprietary backdoors are known to be used": [["OS Credential Dumping", 0.06566992691959175], ["Rootkit", 0.0469813712399013], ["Windows Management Instrumentation", 0.04191892585299333], ["Modify System Image", 0.03387069567462543], ["Command and Scripting Interpreter", 0.030971898479313368], ["Virtualization/Sandbox Evasion", 0.02819416986636198]], "Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses.": [["Process Injection", 0.542386402500008], ["Native API", 0.07306778521405644], ["Process Discovery", 0.05115284576409572], ["Access Token Manipulation", 0.026465642004816537], ["Hijack Execution Flow", 0.02421010872105558], ["Impair Defenses", 0.021824382985783233]], "malware is designed to steal sensitive information from victims' systems,": [["Data from Local System", 0.10161652109482085], ["Exfiltration Over C2 Channel", 0.07405839257598305], ["Archive Collected Data", 0.056211654990817234], ["Email Collection", 0.04149596144553715], ["Exfiltration Over Alternative Protocol", 0.03609158346587785], ["Data Staged", 0.03272329549457836]], "attackers used an innocent-looking email to lure victims into opening an attachment.": [["User Execution", 0.44773416463008436], ["Phishing", 0.35949826406252705], ["Phishing for Information", 0.03586542856556288], ["Internal Spearphishing", 0.013486260653209094], ["Email Collection", 0.007006351814233061], ["Compromise Accounts", 0.005997183709147848]], "we found the original email that included a ZIP file attached, which contained an ISO file.": [["Ingress Tool Transfer", 0.05297636325369792], ["Obfuscated Files or Information", 0.04926923483807965], ["Phishing", 0.04648487386587635], ["Archive Collected Data", 0.03743714264144439], ["Exfiltration Over C2 Channel", 0.03636415809991177], ["Masquerading", 0.024083933857161764]], "sample uses obfuscation": [["Obfuscated Files or Information", 0.7628305936054226], ["Deobfuscate/Decode Files or Information", 0.04877821370293893], ["Data Obfuscation", 0.0231937928546635], ["Data Encoding", 0.017596496090486247], ["Archive Collected Data", 0.013402990979866348], ["Execution Guardrails", 0.011115621235629643]], "This file is an obfuscated .NET file": [["Obfuscated Files or Information", 0.574172062675267], ["Deobfuscate/Decode Files or Information", 0.21634806500678253], ["Masquerading", 0.02417559572372402], ["Archive Collected Data", 0.023168996024849696], ["Data Encrypted for Impact", 0.01463346275169885], ["Hide Artifacts", 0.014468229795635869]], "only uses one code obfuscation technique: API hashing.": [["Obfuscated Files or Information", 0.8139076950130312], ["Deobfuscate/Decode Files or Information", 0.05137387858458557], ["Data Encoding", 0.013548895486557437], ["Data Obfuscation", 0.013419144239867195], ["Masquerading", 0.008670211821397468], ["Execution Guardrails", 0.008365247930476123]], "Payload\nObfuscation": [["Obfuscated Files or Information", 0.7748145606353701], ["Deobfuscate/Decode Files or Information", 0.06453703157460888], ["Data Encoding", 0.029888772753166787], ["Data Obfuscation", 0.02055132671781866], ["Execution Guardrails", 0.014833434627464588], ["Encrypted Channel", 0.007638579752041748]], "each data byte in the HTTP based C2 communication,": [["Data Encoding", 0.2554469481984047], ["Application Layer Protocol", 0.13668636617888832], ["Exfiltration Over C2 Channel", 0.07441711882618951], ["Non-Application Layer Protocol", 0.06261098054926238], ["Encrypted Channel", 0.050594819725140856], ["Data Obfuscation", 0.04456199174044822]], "submitted to the C2 server through HTTP protocol using the POST method.": [["Application Layer Protocol", 0.31644325256032774], ["Exfiltration Over C2 Channel", 0.1266290511372514], ["Web Service", 0.07939842232101907], ["Data Encoding", 0.048636953670669975], ["Fallback Channels", 0.02991812514606153], ["Exfiltration Over Alternative Protocol", 0.02455719057721711]], "the HTTP C2 Communication section.": [["Application Layer Protocol", 0.5992501538444589], ["Non-Application Layer Protocol", 0.05773587403016761], ["Fallback Channels", 0.03700612223279504], ["Web Service", 0.02188521275688962], ["Encrypted Channel", 0.02037567847656917], ["Exfiltration Over C2 Channel", 0.01992965255654757]], "HTTP C2 Communication": [["Application Layer Protocol", 0.5975155110978327], ["Non-Application Layer Protocol", 0.10163649546968238], ["Fallback Channels", 0.038414273656323154], ["Encrypted Channel", 0.03737158713861827], ["Non-Standard Port", 0.02538248461883926], ["Data Encoding", 0.020269711028077373]], "to the C2 through the HTTP protocol.": [["Application Layer Protocol", 0.597403874810134], ["Non-Application Layer Protocol", 0.039245912170871616], ["Exfiltration Over C2 Channel", 0.038096776590795196], ["Fallback Channels", 0.03071299867609267], ["Data Encoding", 0.030140035702082586], ["Proxy", 0.022573181935342867]], "can be found in the two bytes of the HTTP payload": [["Data Encoding", 0.23095858411350764], ["Application Layer Protocol", 0.149419153496368], ["Data Obfuscation", 0.05312204541134086], ["System Network Configuration Discovery", 0.046207276495161625], ["Network Sniffing", 0.03499277587152584], ["Deobfuscate/Decode Files or Information", 0.026499052740922714]], "shows a HTTP POST request and its corresponding message body.": [["Application Layer Protocol", 0.23455555377618914], ["Data Encoding", 0.08246466647825816], ["Exfiltration Over C2 Channel", 0.06749963225241498], ["Data Obfuscation", 0.04705783868326203], ["Web Service", 0.033785083766681705], ["Network Sniffing", 0.02861119109385001]], "the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header.": [["Data Encoding", 0.1695018770718255], ["Application Layer Protocol", 0.13782791066287806], ["Data Obfuscation", 0.10082908802166733], ["Use Alternate Authentication Material", 0.03633839046312171], ["Adversary-in-the-Middle", 0.025824913185995557], ["Encrypted Channel", 0.025715293852618157]], "HTTP POST request (type 27 / data exfiltration).": [["Exfiltration Over C2 Channel", 0.20834348555432336], ["Exfiltration Over Alternative Protocol", 0.1535307101164378], ["Application Layer Protocol", 0.07026039987539462], ["Data Encoding", 0.06380115742909988], ["Archive Collected Data", 0.02858089883210731], ["Scheduled Transfer", 0.023872430417409145]], "then uploads this information to an attacker-controlled machine via HTTP POST.": [["Exfiltration Over C2 Channel", 0.196362133695047], ["Data from Local System", 0.04346574766832903], ["Web Service", 0.04051190637397515], ["Automated Exfiltration", 0.03932823190712408], ["Archive Collected Data", 0.035231813471610605], ["Data Staged", 0.03494742831352407]], "exfiltrates information to the C2 through the HTTP protocol.": [["Exfiltration Over C2 Channel", 0.4424063285420315], ["Exfiltration Over Alternative Protocol", 0.1307254912772821], ["Automated Exfiltration", 0.0378668206459441], ["Scheduled Transfer", 0.03758913246859278], ["Application Layer Protocol", 0.029374337587768935], ["Archive Collected Data", 0.025754443208408688]], "an ISO file opener that mounts and opens the file with a simple double-click.": [["Data from Removable Media", 0.10176396022867344], ["Masquerading", 0.059965526083657066], ["File and Directory Discovery", 0.058363673754779695], ["Hide Artifacts", 0.05582008938582498], ["Replication Through Removable Media", 0.04719214748976084], ["Exfiltration Over Physical Medium", 0.027725885810974682]], "To the victim, the opening process simply looks like a regular directory.": [["File and Directory Discovery", 0.19992718708875565], ["Native API", 0.14201195225887445], ["Masquerading", 0.12337668948993297], ["Hide Artifacts", 0.11390009741796292], ["Process Injection", 0.05316775987863394], ["Hijack Execution Flow", 0.02526550061317691]], "obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code.": [["Obfuscated Files or Information", 0.614533256102485], ["Deobfuscate/Decode Files or Information", 0.1338719197295482], ["Masquerading", 0.028002044442051295], ["Process Injection", 0.027502501669581174], ["Hide Artifacts", 0.017169031732461964], ["System Binary Proxy Execution", 0.012537564691965028]], "process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.": [["Process Injection", 0.6886317882653078], ["Native API", 0.04247005510281003], ["Hijack Execution Flow", 0.029491696549660995], ["System Binary Proxy Execution", 0.028816513347821832], ["Event Triggered Execution", 0.01995571507451538], ["Access Token Manipulation", 0.016628050422653685]], "use this technique to retrieve export functions from loaded libraries": [["Shared Modules", 0.13930344702648903], ["Hijack Execution Flow", 0.12541928391155502], ["Native API", 0.06001099566767316], ["Ingress Tool Transfer", 0.043212991880814025], ["Deobfuscate/Decode Files or Information", 0.03777313389441512], ["System Binary Proxy Execution", 0.021535531166986595]], "the corresponding APIs in the appropriate library.": [["Native API", 0.12899056048690413], ["Credentials from Password Stores", 0.044045225816642435], ["Cloud Service Dashboard", 0.037676194736014176], ["Deobfuscate/Decode Files or Information", 0.0334211065072132], ["Data from Local System", 0.032216498059567715], ["Automated Collection", 0.028613201947244846]], "via the MoveFileExW or CopyFileW Windows API.": [["Lateral Tool Transfer", 0.05828387050164328], ["Hide Artifacts", 0.05540576476732193], ["Masquerading", 0.04669579479534846], ["Data from Local System", 0.041202965066750925], ["Exfiltration Over Physical Medium", 0.04076677861639754], ["Replication Through Removable Media", 0.03628367372153987]], "Then, it creates and sets a new value for the registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.": [["Boot or Logon Autostart Execution", 0.5274006295147043], ["Modify Registry", 0.16083718819923118], ["Query Registry", 0.040655030468772106], ["Create or Modify System Process", 0.03268737898756758], ["Event Triggered Execution", 0.022965104620830647], ["System Binary Proxy Execution", 0.02145337100224338]], "In order to establish persistence on the targeted host, the malware starts by saving a copy of itself in a new folder in the %APPDATA% directory": [["Boot or Logon Autostart Execution", 0.11915086549107207], ["Scheduled Task/Job", 0.06654711989473118], ["Data Staged", 0.06320447766031069], ["Create or Modify System Process", 0.06000064667021016], ["Boot or Logon Initialization Scripts", 0.05222248427338596], ["Event Triggered Execution", 0.04710767210707167]], "searches for and exfiltrates the following information:\nOS architecture\nBuilt-in admin\nDomain host name\nHostname\nLocal admin\nOperating system\nScreen resolution": [["System Information Discovery", 0.7125912740841339], ["Windows Management Instrumentation", 0.027084906888142763], ["Query Registry", 0.018430892331842585], ["Application Window Discovery", 0.01660405858144536], ["System Network Configuration Discovery", 0.016011374147374722], ["Virtualization/Sandbox Evasion", 0.013195848302737446]], "Username information": [["System Owner/User Discovery", 0.6810416158405882], ["Account Discovery", 0.10273732744954997], ["Gather Victim Identity Information", 0.01866560641827931], ["Phishing for Information", 0.009917917927746236], ["System Information Discovery", 0.009566367339865484], ["Establish Accounts", 0.00822863453044984]], "Exfiltrate keylogger data": [["Input Capture", 0.10789795225075094], ["Archive Collected Data", 0.06929993156324353], ["Data Staged", 0.06026540454033125], ["Data from Local System", 0.056109089292971974], ["Automated Exfiltration", 0.048397668788093116], ["OS Credential Dumping", 0.042834556013814896]], "Keylogger database": [["Input Capture", 0.6996043255318642], ["Credentials from Password Stores", 0.030749434330939168], ["Unsecured Credentials", 0.028784013608917323], ["OS Credential Dumping", 0.01224482780924632], ["Network Sniffing", 0.00928279633548185], ["Automated Collection", 0.008792918267182266]], "can use additional payload types": [["Obfuscated Files or Information", 0.2073972353934303], ["Command and Scripting Interpreter", 0.056607355294564767], ["Ingress Tool Transfer", 0.04275742403898383], ["Deobfuscate/Decode Files or Information", 0.03702616551378589], ["Execution Guardrails", 0.03341688428425645], ["Data Encoding", 0.030865646687617036]], "Exfiltrate screenshots": [["Screen Capture", 0.5978651703726858], ["Data from Local System", 0.04272451081995081], ["Archive Collected Data", 0.025942526229410987], ["Hide Artifacts", 0.01661823007010177], ["Data Staged", 0.015933067320367617], ["Automated Exfiltration", 0.015557068604360005]], "Potential hidden files": [["Hide Artifacts", 0.4651398826617004], ["File and Directory Discovery", 0.09585315452105167], ["Masquerading", 0.05779887103287577], ["Indicator Removal", 0.055759888182850194], ["Data Staged", 0.031391493696478825], ["Obfuscated Files or Information", 0.026292350655179913]], "It collects sensitive data from web browsers,": [["Credentials from Password Stores", 0.11082981850554832], ["Browser Session Hijacking", 0.07953324237099413], ["Data from Local System", 0.06207972984752631], ["Exfiltration Over C2 Channel", 0.04941010338055594], ["Browser Bookmark Discovery", 0.039775717561852296], ["Archive Collected Data", 0.036748450526131744]], "These functions are made to steal credentials from different types of applications and services on the Windows operating system:\nBrowsers: Safari, Internet Explorer, Firefox and Chromium-based browsers": [["Credentials from Password Stores", 0.6548636604234489], ["Unsecured Credentials", 0.06168826985692639], ["OS Credential Dumping", 0.04531743978885045], ["Input Capture", 0.03648344605668669], ["Browser Session Hijacking", 0.020630958284238884], ["Forced Authentication", 0.01590932361025013]], "adopting publicly disclosed proof-of-concept (POC) code shortly after it is released to exploit vulnerabilities in internet-facing applications.": [["Obtain Capabilities", 0.1585497365957994], ["Exploitation for Client Execution", 0.15566181851682587], ["Develop Capabilities", 0.10682488148495452], ["Exploit Public-Facing Application", 0.09313065769841117], ["Exploitation of Remote Services", 0.060256815747976894], ["Drive-by Compromise", 0.04272712943100296]], "their initial exploitation of vulnerable internet-facing applications,": [["Drive-by Compromise", 0.13236327626345695], ["Exploit Public-Facing Application", 0.10389479046043536], ["Stage Capabilities", 0.09644959278246681], ["Compromise Infrastructure", 0.09254445486085798], ["Obtain Capabilities", 0.07322992686477323], ["Develop Capabilities", 0.07014421690938516]], "continues to use older vulnerabilities, especially Log4Shell, to compromise unpatched devices": [["Exploitation of Remote Services", 0.1104550857361185], ["Exploitation for Privilege Escalation", 0.07993142953478471], ["Exploitation for Client Execution", 0.06402388017294434], ["Modify System Image", 0.05558468290975966], ["Impair Defenses", 0.04496779122633681], ["Pre-OS Boot", 0.0400361326432853]], "After gaining initial access to an organization by exploiting a vulnerability with a public POC,": [["Trusted Relationship", 0.18938566409549176], ["Obtain Capabilities", 0.08875325714960779], ["Drive-by Compromise", 0.06327611050991455], ["Exploit Public-Facing Application", 0.04860127422810832], ["Develop Capabilities", 0.037247043818875954], ["Exploitation for Privilege Escalation", 0.03456589215118436]], "as several adversaries are exploiting CVE-2022-47966 for initial access.\nApache Log4j2 (aka Log4Shell)": [["Impair Defenses", 0.15051871441693643], ["Data Staged", 0.03945064006526306], ["Indicator Removal", 0.03269873423118483], ["Exploit Public-Facing Application", 0.025813545283273367], ["Input Capture", 0.02333085088042396], ["System Owner/User Discovery", 0.02096172013406953]], "enable RDP connections.": [["Remote Services", 0.6107249282092282], ["Remote Access Software", 0.0868464252159286], ["Remote Service Session Hijacking", 0.02479920791159608], ["Exploitation of Remote Services", 0.02353917361616244], ["External Remote Services", 0.014233314892558411], ["Event Triggered Execution", 0.009124736388107504]], "can use the Active Directory database to access credentials for users\u2019 accounts.": [["OS Credential Dumping", 0.27170863890861574], ["Unsecured Credentials", 0.17234573681097348], ["Credentials from Password Stores", 0.15629485059852688], ["Valid Accounts", 0.066963401691914], ["Brute Force", 0.03671000379135654], ["Account Discovery", 0.025333419007956662]], "credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,": [["Valid Accounts", 0.2832578582146636], ["Brute Force", 0.1427846467608762], ["Modify Authentication Process", 0.05690719760986185], ["Gather Victim Identity Information", 0.03582676991253503], ["OS Credential Dumping", 0.03392837531019056], ["Credentials from Password Stores", 0.022229829519901635]], "The actors could also gain access to other systems where individuals may have reused their passwords.": [["Brute Force", 0.3371701988687422], ["Modify Authentication Process", 0.07410885799648574], ["Valid Accounts", 0.05857631403815525], ["Credentials from Password Stores", 0.05160873720320553], ["Password Policy Discovery", 0.04094155235546514], ["Unsecured Credentials", 0.02926949975332575]], "to persist in target environments and deploy additional tools.": [["Boot or Logon Autostart Execution", 0.11666800119496004], ["Event Triggered Execution", 0.0609710237751511], ["Scheduled Task/Job", 0.05503200533354278], ["Server Software Component", 0.049793182388899765], ["Command and Scripting Interpreter", 0.04693507299140276], ["Create or Modify System Process", 0.04121983260558074]], "backdoor with the ability to download and run additional tools": [["Ingress Tool Transfer", 0.183537025565748], ["Command and Scripting Interpreter", 0.07677106240277076], ["Compromise Client Software Binary", 0.05810556847546431], ["BITS Jobs", 0.05672439525068591], ["Multi-Stage Channels", 0.04790135439588339], ["Obtain Capabilities", 0.033890387540854466]], "Scheduled Task Creation or": [["Scheduled Task/Job", 0.7973166385264596], ["Inter-Process Communication", 0.04055599984761206], ["Masquerading", 0.015197924525476912], ["Command and Scripting Interpreter", 0.012560727650291356], ["Create or Modify System Process", 0.010266223948615327], ["System Services", 0.007052879044990651]], "Remote Task Creation/Update using Schtasks Process": [["Scheduled Task/Job", 0.4664360128038616], ["Inter-Process Communication", 0.04899628097677396], ["Access Token Manipulation", 0.03703011422775825], ["Process Discovery", 0.03307333422872632], ["Masquerading", 0.03243507869213197], ["System Services", 0.026716243482669363]], "the group crafts bespoke phishing emails, often purporting to contain information on security policies that affect countries in the Middle East, to deliver weaponized documents to individuals of interest.": [["Phishing", 0.20681279623918863], ["Phishing for Information", 0.08928574732990498], ["Internal Spearphishing", 0.050618850116603754], ["Gather Victim Identity Information", 0.0467558110578439], ["User Execution", 0.04000503083265081], ["Search Open Websites/Domains", 0.039789613416601]], "can read files,": [["File and Directory Discovery", 0.20867397185759787], ["Data from Local System", 0.12302865752056678], ["Native API", 0.06453007108450576], ["Ingress Tool Transfer", 0.061006009746275326], ["Data from Network Shared Drive", 0.04433221346586553], ["Data from Removable Media", 0.04272560011354757]], "gather information on an infected host, and send details back to the attackers.": [["Gather Victim Host Information", 0.0915316290397829], ["Active Scanning", 0.06696769071718439], ["Gather Victim Network Information", 0.055867095935007514], ["Exfiltration Over C2 Channel", 0.05324654171069186], ["Automated Collection", 0.045768020200401084], ["Data from Configuration Repository", 0.03067025860572789]], "Commands executed by WMI on new hosts": [["Windows Management Instrumentation", 0.740870664957758], ["Event Triggered Execution", 0.041026626798503316], ["Command and Scripting Interpreter", 0.010533439527987708], ["Remote Services", 0.009081792534060659], ["Boot or Logon Autostart Execution", 0.007601792895281255], ["Boot or Logon Initialization Scripts", 0.007384673352629601]], "script to deobfuscate the control flow of shellcode": [["Obfuscated Files or Information", 0.42760662967883606], ["Deobfuscate/Decode Files or Information", 0.35750098226003635], ["Process Injection", 0.01346865548218926], ["Native API", 0.012662450635787739], ["Modify Registry", 0.011405995294547704], ["Command and Scripting Interpreter", 0.010495804328924005]], "Malware immediately decrypts the third layer": [["Deobfuscate/Decode Files or Information", 0.5857821707824337], ["Data Encrypted for Impact", 0.07150050802166602], ["Obfuscated Files or Information", 0.05320206597224294], ["Encrypted Channel", 0.04635325249729441], ["Weaken Encryption", 0.0394722711251112], ["Archive Collected Data", 0.03822570369126476]], "it decrypts the c2 URL": [["Deobfuscate/Decode Files or Information", 0.2853780782778589], ["Data Encoding", 0.2826663498286914], ["Encrypted Channel", 0.10694345137431918], ["Data Obfuscation", 0.03422194388078182], ["Obfuscated Files or Information", 0.033146314554813636], ["Archive Collected Data", 0.02131066136520956]], "Use NtQueryInformationProcess API": [["Native API", 0.347006001597256], ["System Information Discovery", 0.12282953592432723], ["File and Directory Discovery", 0.05693247400776885], ["Process Discovery", 0.048438130978927324], ["Query Registry", 0.03448691757066706], ["Windows Management Instrumentation", 0.033997886905557884]], "It decrypts an encrypted payload,": [["Deobfuscate/Decode Files or Information", 0.6390002351405778], ["Obfuscated Files or Information", 0.0765402237932512], ["Data Encrypted for Impact", 0.05114057573115995], ["Archive Collected Data", 0.042728533949297084], ["Encrypted Channel", 0.04268324266213183], ["Weaken Encryption", 0.023483206563366447]], "Payload decryption function.": [["Deobfuscate/Decode Files or Information", 0.6341444499581741], ["Obfuscated Files or Information", 0.13024427373724434], ["Archive Collected Data", 0.037654850298762324], ["Encrypted Channel", 0.026891448833924556], ["Data Encrypted for Impact", 0.026178719782690804], ["Data Encoding", 0.020432838310209794]], "the payload decryption key": [["Deobfuscate/Decode Files or Information", 0.6853700472211954], ["Obfuscated Files or Information", 0.05370599350038438], ["Encrypted Channel", 0.032962294758596494], ["Data Encrypted for Impact", 0.029778715696261376], ["Weaken Encryption", 0.028569033717539105], ["Execution Guardrails", 0.028511590385818013]], "deobfuscated code of GuLoader\u2019s shellcode.": [["Obfuscated Files or Information", 0.43668147619536285], ["Deobfuscate/Decode Files or Information", 0.37571693112507476], ["Process Injection", 0.018232783388172125], ["Native API", 0.010033789597088082], ["Execution Guardrails", 0.009798470284435196], ["Hide Artifacts", 0.008446629768497912]], "using stack to decrypt strings": [["Deobfuscate/Decode Files or Information", 0.5534651357549508], ["Obfuscated Files or Information", 0.1709498313784744], ["Encrypted Channel", 0.050717554716662935], ["Data Encrypted for Impact", 0.02878802223076547], ["Archive Collected Data", 0.0282314665415944], ["Data Encoding", 0.016882722547122482]], "script to restore deobfuscate control flow.": [["Deobfuscate/Decode Files or Information", 0.4091141807290941], ["Obfuscated Files or Information", 0.11927808335956082], ["Indicator Removal", 0.038071332832520115], ["Modify Registry", 0.03350612016848028], ["Archive Collected Data", 0.024747241393000458], ["Inhibit System Recovery", 0.016107209351684193]], "control flow obfuscation": [["Obfuscated Files or Information", 0.7501114360334564], ["Deobfuscate/Decode Files or Information", 0.04975399610474039], ["Data Obfuscation", 0.024647537010073932], ["Execution Guardrails", 0.01631045962908671], ["Masquerading", 0.010694306391008263], ["Process Injection", 0.009366598569861082]], "encrypted shellcode\u2019s file": [["Obfuscated Files or Information", 0.39667204142963747], ["Deobfuscate/Decode Files or Information", 0.2545065776619243], ["Data Encrypted for Impact", 0.10485764212437838], ["Archive Collected Data", 0.06415329747060385], ["Encrypted Channel", 0.02621586467961984], ["Execution Guardrails", 0.009880005051996162]], "encrypted payload from c2.": [["Encrypted Channel", 0.2658208208683507], ["Deobfuscate/Decode Files or Information", 0.16952797416484436], ["Obfuscated Files or Information", 0.14077000514598043], ["Data Encoding", 0.12516489926700058], ["Archive Collected Data", 0.03807061986016125], ["Exfiltration Over Alternative Protocol", 0.031147950731479045]], "obfuscated arithmetic value calculations": [["Obfuscated Files or Information", 0.5945144643815657], ["Encrypted Channel", 0.036514515926222714], ["Deobfuscate/Decode Files or Information", 0.031385077439061604], ["Data Encrypted for Impact", 0.019831515641865336], ["Data Obfuscation", 0.01722499037903619], ["Execution Guardrails", 0.01526654983964447]], "an encrypted payload": [["Obfuscated Files or Information", 0.3600413350375672], ["Encrypted Channel", 0.1323927032768731], ["Deobfuscate/Decode Files or Information", 0.11993678538806885], ["Data Encrypted for Impact", 0.07134179802646752], ["Archive Collected Data", 0.04957003814161403], ["Execution Guardrails", 0.034647207817838636]], "shellcode control flow obfuscation": [["Obfuscated Files or Information", 0.8105526683077601], ["Deobfuscate/Decode Files or Information", 0.060689976713061235], ["Data Obfuscation", 0.01067762385445334], ["Execution Guardrails", 0.010553496202164883], ["Process Injection", 0.0077299945380482574], ["Data Encoding", 0.006380071790126407]], "control flow obfuscation.": [["Obfuscated Files or Information", 0.7321352910454623], ["Deobfuscate/Decode Files or Information", 0.04091183831108441], ["Data Obfuscation", 0.026376266861608207], ["Masquerading", 0.01786050146921438], ["Execution Guardrails", 0.015272789616879213], ["Process Injection", 0.01143590777712546]], "Unpacking of GuLoader\u2019s shellcodes.": [["Deobfuscate/Decode Files or Information", 0.4038310433976271], ["Obfuscated Files or Information", 0.2398448657515574], ["Hijack Execution Flow", 0.03427871101097329], ["Native API", 0.031729494727239016], ["Command and Scripting Interpreter", 0.02564126807873919], ["System Binary Proxy Execution", 0.021790292001396986]], "packed using NSIS installer.": [["System Binary Proxy Execution", 0.09280411901060835], ["Obfuscated Files or Information", 0.06254589195437295], ["Ingress Tool Transfer", 0.0542637724155846], ["Masquerading", 0.05031869542157642], ["BITS Jobs", 0.04436898514728492], ["Command and Scripting Interpreter", 0.03578636540077088]], "UNPACKING GULOADER\u2019S SHELLCODE": [["Deobfuscate/Decode Files or Information", 0.410727349545454], ["Obfuscated Files or Information", 0.1881621784978606], ["Hijack Execution Flow", 0.05105420075360964], ["Command and Scripting Interpreter", 0.027932771684796496], ["Native API", 0.026485075092338987], ["System Binary Proxy Execution", 0.026428861067496486]], "It then calls CallWindowProcW API.": [["Application Window Discovery", 0.24266103610469494], ["Native API", 0.17208669066943783], ["Event Triggered Execution", 0.04641517959349771], ["Input Capture", 0.033869803779546015], ["Hide Artifacts", 0.032818900449796226], ["Masquerading", 0.02677213454775136]], "Uses EnumWindows API": [["Application Window Discovery", 0.24240308271706684], ["Native API", 0.23853428595953166], ["Hide Artifacts", 0.044289690864416094], ["Masquerading", 0.03524594602791522], ["Process Injection", 0.031154685441700185], ["Event Triggered Execution", 0.02973039460960295]], "Uses EnumDeviceDrivers and GetDeviceDriverBaseNameA APIs.": [["Peripheral Device Discovery", 0.26846513594002475], ["System Information Discovery", 0.20207038955037016], ["Virtualization/Sandbox Evasion", 0.05199780676382253], ["Windows Management Instrumentation", 0.03618758996673333], ["Native API", 0.03188968217862612], ["Query Registry", 0.025988041735338186]], "Uses MsiEnumProductsA and MsiGetProductInfoA APIs.": [["Native API", 0.14783225350252308], ["Automated Collection", 0.07105685189930894], ["OS Credential Dumping", 0.05818890649935599], ["File and Directory Discovery", 0.047184460083522006], ["Deobfuscate/Decode Files or Information", 0.04517802901737753], ["Data from Local System", 0.03512763897807573]], "Uses OpenSCManagerA and EnumServicesStatusA APIs.": [["Native API", 0.16738817336037878], ["Query Registry", 0.13756963040619466], ["System Service Discovery", 0.04902261980864848], ["Masquerading", 0.03484744641243102], ["Hijack Execution Flow", 0.031099679559019093], ["System Information Discovery", 0.029274457087475912]], "Uses NtSetInformationThread API": [["Native API", 0.13061396497060182], ["System Information Discovery", 0.11191661973718901], ["Virtualization/Sandbox Evasion", 0.06367560430050802], ["Process Injection", 0.043087538110216116], ["OS Credential Dumping", 0.03706346573050887], ["Windows Management Instrumentation", 0.036339652180634764]], "DbgBreakPoint and DbgUiRemoteBreakin API": [["Data Manipulation", 0.062277787037850786], ["Event Triggered Execution", 0.06021323574534054], ["Native API", 0.05099058746750479], ["Deobfuscate/Decode Files or Information", 0.031209616147704546], ["Command and Scripting Interpreter", 0.029313086089900506], ["Service Stop", 0.021968975068452013]], "it starts payload execution using the ZwCreateThreadEx API.": [["Process Injection", 0.12625628852302476], ["Native API", 0.12372372982846935], ["Event Triggered Execution", 0.07840151957662521], ["System Binary Proxy Execution", 0.050536840420621114], ["Hijack Execution Flow", 0.04280404042801977], ["Command and Scripting Interpreter", 0.03646529256189523]], "call RtlAddVectoredExceptionHandler API": [["Native API", 0.13801027876398028], ["Process Injection", 0.040212213806146424], ["Deobfuscate/Decode Files or Information", 0.03787296899196585], ["Masquerading", 0.02923746431146392], ["System Binary Proxy Execution", 0.026409572113666163], ["Virtualization/Sandbox Evasion", 0.02620308472551229]], "This shellcode has complex obfuscation, consisting of junk code": [["Obfuscated Files or Information", 0.8363174228785772], ["Deobfuscate/Decode Files or Information", 0.053931153285281766], ["Encrypted Channel", 0.007999653693964529], ["Execution Guardrails", 0.007618944502946185], ["Data Obfuscation", 0.006982538435931135], ["Process Injection", 0.00621060914973293]], "dynamic API resolution": [["Dynamic Resolution", 0.19834723987827207], ["Native API", 0.07297203031561504], ["Masquerading", 0.05347438398514008], ["Adversary-in-the-Middle", 0.026718153743525944], ["Hijack Execution Flow", 0.02436586134838598], ["Web Service", 0.021994933280299753]], "use process hollowing to inject decrypted payload into child process and resolves its Import Address Table.": [["Process Injection", 0.7306648168421955], ["Native API", 0.05995060396148499], ["Hijack Execution Flow", 0.026395336744311524], ["Deobfuscate/Decode Files or Information", 0.014267186796493216], ["Process Discovery", 0.01290048778767734], ["Obfuscated Files or Information", 0.012420736739871329]], "DLL sideloading,": [["Hijack Execution Flow", 0.40442266783287933], ["Shared Modules", 0.14775769015170614], ["System Binary Proxy Execution", 0.07750534846230622], ["Process Injection", 0.05262960764489683], ["Ingress Tool Transfer", 0.019323653756013467], ["Event Triggered Execution", 0.019108431297246962]], "program first sideloads u2ec.dll, which then loads the payload file usb.ini": [["Replication Through Removable Media", 0.12851918757334102], ["System Binary Proxy Execution", 0.12104676825074578], ["Native API", 0.06555070472735196], ["Shared Modules", 0.061610048794427996], ["Hijack Execution Flow", 0.04812831678469653], ["Boot or Logon Autostart Execution", 0.03372669588673677]], "malware rzlog4cpp.dll is sideloaded": [["Hijack Execution Flow", 0.3363497724537424], ["System Binary Proxy Execution", 0.13926377538918452], ["Process Injection", 0.07349585802186691], ["Shared Modules", 0.044973662543457096], ["Event Triggered Execution", 0.03489379168522985], ["Masquerading", 0.02621698895692403]], "which is used for the first sideloading.": [["Ingress Tool Transfer", 0.13121256140059864], ["Hijack Execution Flow", 0.07164811319256494], ["Obfuscated Files or Information", 0.028341250109372232], ["System Binary Proxy Execution", 0.028222742586883294], ["Hide Artifacts", 0.027413401569491198], ["Process Injection", 0.027155186492621962]], "including the use of DLL sideloading": [["Hijack Execution Flow", 0.31344733822797355], ["Shared Modules", 0.1981749329275658], ["System Binary Proxy Execution", 0.09462225942881135], ["Process Injection", 0.06122863473597032], ["Native API", 0.027182010010289626], ["Ingress Tool Transfer", 0.018072717315434642]], "Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.": [["Hijack Execution Flow", 0.4013368158829411], ["System Binary Proxy Execution", 0.10723437629077913], ["Process Injection", 0.07407332321204217], ["Shared Modules", 0.03744872117260819], ["Event Triggered Execution", 0.029765465173742456], ["Masquerading", 0.023454502451144044]], "First-stage legitimate executable for DLL sideloading": [["Hijack Execution Flow", 0.4267964325554046], ["Shared Modules", 0.13065600733698934], ["System Binary Proxy Execution", 0.1040762689270288], ["Process Injection", 0.052430776970287335], ["Native API", 0.01545313900667513], ["Event Triggered Execution", 0.01481304256314433]], "Second-stage legitimate executable for DLL sideloading": [["Hijack Execution Flow", 0.45369231876018506], ["Shared Modules", 0.11749458252654836], ["System Binary Proxy Execution", 0.09859418993994268], ["Process Injection", 0.05579203346043842], ["Native API", 0.015334283840057562], ["Ingress Tool Transfer", 0.014732847689981322]], "files have XOR-encrypted content to prevent detection": [["Obfuscated Files or Information", 0.3108404753396939], ["Data Encrypted for Impact", 0.13731926102775677], ["Deobfuscate/Decode Files or Information", 0.11167605936828355], ["Archive Collected Data", 0.08365080838165456], ["Hide Artifacts", 0.0682639877532864], ["Execution Guardrails", 0.028378864945511454]], "contains another payload that is XOR-encrypted": [["Obfuscated Files or Information", 0.3985618060319508], ["Deobfuscate/Decode Files or Information", 0.19063328493559442], ["Encrypted Channel", 0.11832849762634012], ["Data Encrypted for Impact", 0.04782582334351799], ["Archive Collected Data", 0.03797640735788618], ["Execution Guardrails", 0.03306636630684017]], "applies obfuscation techniques": [["Obfuscated Files or Information", 0.7751801874432898], ["Deobfuscate/Decode Files or Information", 0.044201659197433116], ["Data Obfuscation", 0.018808018800687037], ["Data Encoding", 0.014226310663470687], ["Execution Guardrails", 0.013324913344715908], ["Archive Collected Data", 0.011552295963220641]], "\u00a0reads the encrypted configuration filecan": [["Deobfuscate/Decode Files or Information", 0.22239215361029324], ["Obfuscated Files or Information", 0.21680298356843103], ["File and Directory Discovery", 0.067340046631401], ["Data Encrypted for Impact", 0.045744645849661494], ["Archive Collected Data", 0.03718614948657102], ["OS Credential Dumping", 0.03378069458090601]], "an encrypted configuration.": [["Obfuscated Files or Information", 0.1753133300481476], ["Data Encrypted for Impact", 0.15193479862954617], ["Encrypted Channel", 0.09514968824346666], ["Weaken Encryption", 0.07246071484398844], ["Execution Guardrails", 0.07062260667666072], ["Archive Collected Data", 0.04915167778461939]], "the logging strings are encrypted with a single byte in XOR operations as": [["Obfuscated Files or Information", 0.31501508530584277], ["Deobfuscate/Decode Files or Information", 0.14247024159246996], ["Data Encoding", 0.12037394565906544], ["Encrypted Channel", 0.07948570830039639], ["Archive Collected Data", 0.0388133103326027], ["Data Obfuscation", 0.025066895364996053]], "and obfuscation mechanisms.": [["Obfuscated Files or Information", 0.6378949851772127], ["Data Obfuscation", 0.026533315141460165], ["Data Encoding", 0.025998334724803264], ["Deobfuscate/Decode Files or Information", 0.0258570251598864], ["Execution Guardrails", 0.021527116140330437], ["Archive Collected Data", 0.014058647663075002]], "an increasing number of obfuscations are being adopted to thwart static analysis.": [["Obfuscated Files or Information", 0.6415487193651007], ["Deobfuscate/Decode Files or Information", 0.0327822698019471], ["Hijack Execution Flow", 0.020141553898992456], ["Virtualization/Sandbox Evasion", 0.01339712332380286], ["Develop Capabilities", 0.013070116914435081], ["Execution Guardrails", 0.011865548598691782]], "containing one-byte XOR encrypted sections": [["Obfuscated Files or Information", 0.5953693607940993], ["Deobfuscate/Decode Files or Information", 0.1748651288664365], ["Encrypted Channel", 0.05959696980581286], ["Data Encrypted for Impact", 0.029761641502443887], ["Archive Collected Data", 0.023195348551826735], ["Data Encoding", 0.012972236003318073]], "will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.": [["Deobfuscate/Decode Files or Information", 0.7096608693976454], ["Obfuscated Files or Information", 0.09443048980688482], ["Data Encrypted for Impact", 0.03248145746047832], ["Archive Collected Data", 0.03121787784488776], ["Encrypted Channel", 0.008783756455151554], ["Execution Guardrails", 0.0074378346805115386]], "after decrypting the frData member in": [["Deobfuscate/Decode Files or Information", 0.43622187396588047], ["Data Encrypted for Impact", 0.08778806497175387], ["Archive Collected Data", 0.08496111123867753], ["Obfuscated Files or Information", 0.06888505940846269], ["Encrypted Channel", 0.02242450156963057], ["Weaken Encryption", 0.021476744130074506]], "It will then decrypt the encrypted payload with the predefined RC4 key": [["Deobfuscate/Decode Files or Information", 0.6301659797740039], ["Encrypted Channel", 0.0588274396139294], ["Obfuscated Files or Information", 0.053504985263258], ["Data Encrypted for Impact", 0.04522611050831086], ["Weaken Encryption", 0.03600924677448101], ["Archive Collected Data", 0.03041167038376595]], "After decryption, it then checks if the first byte of the decrypted payload": [["Deobfuscate/Decode Files or Information", 0.5887156312026596], ["Obfuscated Files or Information", 0.08056305605012337], ["Data Encrypted for Impact", 0.04850852654700052], ["Encrypted Channel", 0.03636622390214208], ["Execution Guardrails", 0.031216810897015897], ["Archive Collected Data", 0.021148394335915206]], "After this is decrypted,": [["Deobfuscate/Decode Files or Information", 0.48009404379379567], ["Data Encrypted for Impact", 0.12168735180346772], ["Archive Collected Data", 0.062014676260545576], ["Obfuscated Files or Information", 0.04596527569515075], ["Weaken Encryption", 0.03422194486407763], ["Encrypted Channel", 0.03253994758339101]], "The malware will continue to read and decrypt goopdate": [["Deobfuscate/Decode Files or Information", 0.5531689527940075], ["Obfuscated Files or Information", 0.09738318484619848], ["Archive Collected Data", 0.050293260326210024], ["Data Encrypted for Impact", 0.046096156421975856], ["Encrypted Channel", 0.01804945159004325], ["Data Encoding", 0.012792545392657628]], "C&C traffic of the PUBLOAD HTTP variant": [["Application Layer Protocol", 0.19540273003527778], ["Data Obfuscation", 0.048819644413440486], ["Endpoint Denial of Service", 0.04223198070501404], ["Network Denial of Service", 0.039463373484011084], ["Fallback Channels", 0.03709232898655929], ["Non-Standard Port", 0.031451515730923446]], "it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices": [["Application Layer Protocol", 0.16836562397232321], ["Non-Application Layer Protocol", 0.09547876432058262], ["Web Service", 0.04648293640022069], ["Fallback Channels", 0.043543248936054914], ["Adversary-in-the-Middle", 0.03213174440622459], ["Encrypted Channel", 0.025781588856360293]], "malware that communicates over the MQTT protocol.": [["Non-Application Layer Protocol", 0.27197080462130774], ["Application Layer Protocol", 0.1999815494100715], ["Encrypted Channel", 0.07213500900884845], ["Non-Standard Port", 0.05301462466683115], ["Data Obfuscation", 0.04001142030369789], ["Protocol Tunneling", 0.03933625694957656]], "Command codes in the PUBLOAD HTTP variant": [["Ingress Tool Transfer", 0.13875213499159356], ["Application Layer Protocol", 0.13343103075025434], ["Data Obfuscation", 0.04123083833507989], ["Web Service", 0.03637172642422543], ["Template Injection", 0.033638728238986865], ["Command and Scripting Interpreter", 0.033462367976102005]], "HTTP variant": [["Application Layer Protocol", 0.5592444717452478], ["Data Obfuscation", 0.045086084545785554], ["Non-Standard Port", 0.03544547928363445], ["Data Encoding", 0.028334553799809398], ["Fallback Channels", 0.02651443631742575], ["Endpoint Denial of Service", 0.019222688318627425]], "The data in the HTTP body is the same as the past variant,": [["Application Layer Protocol", 0.20168739274913486], ["Data Encoding", 0.15628181863686935], ["Exfiltration Over C2 Channel", 0.06137697285248826], ["Data Obfuscation", 0.057062267283255245], ["Network Sniffing", 0.029851194847899463], ["Fallback Channels", 0.024154796605635596]], "supports data upload": [["Ingress Tool Transfer", 0.16133677833281285], ["Data from Local System", 0.08341323542174392], ["Exfiltration Over Web Service", 0.07590058098887766], ["Exfiltration Over C2 Channel", 0.06557176414226784], ["Exfiltration Over Alternative Protocol", 0.04062872816401662], ["Data Staged", 0.036946341117780376]], "the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server": [["Deobfuscate/Decode Files or Information", 0.1146677799801194], ["Masquerading", 0.10214640839588754], ["Archive Collected Data", 0.09412601838740775], ["Ingress Tool Transfer", 0.0788862735883071], ["System Binary Proxy Execution", 0.0722951651345378], ["Obfuscated Files or Information", 0.0489744963712391]], "PowerShell downloading malware": [["Ingress Tool Transfer", 0.4295075327798319], ["Command and Scripting Interpreter", 0.24099169907055665], ["BITS Jobs", 0.03681270760646675], ["Application Layer Protocol", 0.013734531931627327], ["System Binary Proxy Execution", 0.013594828947441824], ["Web Service", 0.010972842089958591]], "The certutil.exe program downloads the WinRAR binary": [["Deobfuscate/Decode Files or Information", 0.10773254206367067], ["Masquerading", 0.08631150013853209], ["Ingress Tool Transfer", 0.07508282503842625], ["Subvert Trust Controls", 0.06971723674916441], ["Archive Collected Data", 0.04939975177843407], ["Unsecured Credentials", 0.04090485775906764]], "the threat actors used PowerShell to download multiple malware and archives from the server": [["Ingress Tool Transfer", 0.35098219808223174], ["Command and Scripting Interpreter", 0.15521680486644754], ["Data from Local System", 0.04304966436542538], ["Automated Collection", 0.030847081874734148], ["Data Staged", 0.027933637652696536], ["BITS Jobs", 0.021357083244110595]], "command execution.": [["Command and Scripting Interpreter", 0.39864724137209995], ["Indirect Command Execution", 0.09783494346221984], ["System Services", 0.04915416590968874], ["Scheduled Task/Job", 0.03307340140199177], ["Inter-Process Communication", 0.02803571631401631], ["Event Triggered Execution", 0.027560294720795627]], "its shell open command.": [["Native API", 0.09496087481904911], ["Command and Scripting Interpreter", 0.054659825525178486], ["File and Directory Discovery", 0.05370723653276605], ["Boot or Logon Autostart Execution", 0.040442189091937204], ["Event Triggered Execution", 0.03961017493720073], ["Hijack Execution Flow", 0.0369240831035192]], "create a reverse shell.": [["Command and Scripting Interpreter", 0.1434766437897102], ["Masquerading", 0.0629812482195995], ["Hijack Execution Flow", 0.039569115122243], ["Indicator Removal", 0.0312941644971731], ["Compromise Client Software Binary", 0.02885248790358461], ["Deobfuscate/Decode Files or Information", 0.023158938065012912]], "It will then create a reverse shell via ncat.exe to the server": [["Command and Scripting Interpreter", 0.20180746364129606], ["Native API", 0.05117353377045902], ["Masquerading", 0.048056712844808946], ["Ingress Tool Transfer", 0.045635544299470844], ["Remote Services", 0.04286921613385529], ["System Binary Proxy Execution", 0.031057818595597062]], "backdoor that is capable of executing commands": [["Command and Scripting Interpreter", 0.36799646649829165], ["Indirect Command Execution", 0.1013407871011604], ["Event Triggered Execution", 0.03133925962062819], ["Boot or Logon Autostart Execution", 0.0281246156600424], ["System Services", 0.02750367611009052], ["Compromise Client Software Binary", 0.025186861550536163]], "including adding more command-line arguments": [["Command and Scripting Interpreter", 0.12672309834388043], ["Indirect Command Execution", 0.09900513902220176], ["Modify Registry", 0.047788832299818826], ["Modify System Image", 0.03876995073032475], ["Boot or Logon Autostart Execution", 0.028888624680380882], ["Obfuscated Files or Information", 0.028281658562474405]], "also supports command-line arguments,": [["Command and Scripting Interpreter", 0.35837765069036004], ["Indirect Command Execution", 0.11210716019813177], ["Native API", 0.06822994798083208], ["System Binary Proxy Execution", 0.02457647679786158], ["System Services", 0.015974920437984635], ["XSL Script Processing", 0.015871935698453795]], "we discovered several tools used for UAC bypass in Windows 10.": [["Abuse Elevation Control Mechanism", 0.6098369381659553], ["Access Token Manipulation", 0.03282695547251692], ["Exploitation for Privilege Escalation", 0.024168840780658497], ["Domain Policy Modification", 0.021264469137858195], ["File and Directory Permissions Modification", 0.014428018409679593], ["System Binary Proxy Execution", 0.013690829642833108]], "HackTool.Win32.ABPASS is a tool used to bypass UAC in Windows 10.": [["Abuse Elevation Control Mechanism", 0.6071176304260263], ["Access Token Manipulation", 0.04410265024433665], ["Use Alternate Authentication Material", 0.023654052013555145], ["File and Directory Permissions Modification", 0.018644203174697317], ["Valid Accounts", 0.01422217084386612], ["Boot or Logon Autostart Execution", 0.012641770202731767]], "HackTool.Win32.CCPASS is another tool that is also used for Windows 10 UAC bypass": [["Abuse Elevation Control Mechanism", 0.5253544475552967], ["Use Alternate Authentication Material", 0.04504352023802557], ["Access Token Manipulation", 0.04449941995235806], ["Valid Accounts", 0.022226304040024906], ["OS Credential Dumping", 0.016961482205884004], ["Boot or Logon Autostart Execution", 0.016742784328479914]], "This service has the highest privileges that can be abused for Windows 10 UAC bypass.": [["Abuse Elevation Control Mechanism", 0.5664420686805595], ["Access Token Manipulation", 0.04059919043628955], ["Domain Policy Modification", 0.03324391457360793], ["Exploitation for Privilege Escalation", 0.03200834605764188], ["System Binary Proxy Execution", 0.018017686986962562], ["File and Directory Permissions Modification", 0.015078571137018805]], "UAC bypass will be executed via the AppInfo RPC service.": [["Abuse Elevation Control Mechanism", 0.6709093985978943], ["Access Token Manipulation", 0.0580028995498974], ["Exploitation for Privilege Escalation", 0.02551750991070049], ["Domain Policy Modification", 0.017472247999916143], ["File and Directory Permissions Modification", 0.014212287531923173], ["Event Triggered Execution", 0.012066916680469851]], "UAC Bypass via the CMSTPLUA COM interface": [["Abuse Elevation Control Mechanism", 0.7242182612027481], ["Access Token Manipulation", 0.03621112484400536], ["Exploitation for Privilege Escalation", 0.016217068728317817], ["Domain Policy Modification", 0.014241576626718632], ["Event Triggered Execution", 0.010917598220972389], ["System Binary Proxy Execution", 0.01060812856922888]], "UAC Bypass via the AppInfo RPC service": [["Abuse Elevation Control Mechanism", 0.5763060831933472], ["Access Token Manipulation", 0.09116325640945687], ["Create or Modify System Process", 0.025180814171198766], ["System Binary Proxy Execution", 0.02097789968100917], ["Exploitation for Privilege Escalation", 0.01938987336861611], ["Event Triggered Execution", 0.01719185348054219]], "UAC bypass will be executed": [["Abuse Elevation Control Mechanism", 0.6481671463077047], ["Access Token Manipulation", 0.04142657754852148], ["Domain Policy Modification", 0.02535938033625424], ["Exploitation for Privilege Escalation", 0.0241954382494375], ["File and Directory Permissions Modification", 0.01565416195879355], ["Event Triggered Execution", 0.014561517655965268]], "UAC bypass is executed via token manipulation.": [["Access Token Manipulation", 0.40513736067531564], ["Abuse Elevation Control Mechanism", 0.2741218357102525], ["Use Alternate Authentication Material", 0.036539397494990404], ["Domain Policy Modification", 0.024046399399275217], ["Multi-Factor Authentication Interception", 0.021360419574479757], ["Steal Application Access Token", 0.01798119853383757]], "UAC bypass is executed": [["Abuse Elevation Control Mechanism", 0.6518559372926591], ["Access Token Manipulation", 0.046698021366580196], ["Domain Policy Modification", 0.024007688354385517], ["Exploitation for Privilege Escalation", 0.02283141176125633], ["File and Directory Permissions Modification", 0.015384803958991793], ["Event Triggered Execution", 0.013473270026912324]], "net user <username>": [["System Owner/User Discovery", 0.3984099248041564], ["Account Discovery", 0.29662596218110104], ["Create Account", 0.05452203640473444], ["Permission Groups Discovery", 0.027706465206513344], ["Valid Accounts", 0.018554758097657567], ["Access Token Manipulation", 0.018303298744231162]], "and the following data is written into registry:": [["Modify Registry", 0.46545216754770236], ["Query Registry", 0.22614997829636677], ["Boot or Logon Autostart Execution", 0.06963598336623064], ["Indicator Removal", 0.03623959640355014], ["OS Credential Dumping", 0.011809933287740363], ["Boot or Logon Initialization Scripts", 0.01155470486523111]], "Registry keys changed": [["Modify Registry", 0.5756304801431308], ["Boot or Logon Autostart Execution", 0.09894705574530682], ["Query Registry", 0.07755743433450417], ["Impair Defenses", 0.01734415610759734], ["Indicator Removal", 0.017299649375827342], ["Domain Policy Modification", 0.015553837573399945]], "It creates a new Shell in the registry.": [["Boot or Logon Autostart Execution", 0.12569514637428078], ["Command and Scripting Interpreter", 0.0763140956061978], ["Event Triggered Execution", 0.07206613600034678], ["Modify Registry", 0.05304728661997195], ["Create or Modify System Process", 0.0486179951681839], ["Access Token Manipulation", 0.03938618114151162]], "it installs itself to %programdata% and then sets the registry run key for persistence.": [["Boot or Logon Autostart Execution", 0.4102552352135782], ["Modify Registry", 0.13286957877831992], ["Create or Modify System Process", 0.06426494889388266], ["Boot or Logon Initialization Scripts", 0.04723582098327065], ["Event Triggered Execution", 0.025844895674895924], ["Query Registry", 0.02549693225713902]], "It invokes the undocumented API UserAssocSet to update the file association.": [["Masquerading", 0.09688639999029647], ["Modify Registry", 0.07475345285360856], ["Boot or Logon Autostart Execution", 0.05748661153436814], ["File and Directory Permissions Modification", 0.054169429858270744], ["Event Triggered Execution", 0.04725940543319547], ["Query Registry", 0.0382261432474592]], "strings and the APIs used by": [["Obfuscated Files or Information", 0.25182801851397835], ["Deobfuscate/Decode Files or Information", 0.09607864386751647], ["Data Encoding", 0.07399230691889082], ["Native API", 0.07161587451529879], ["Masquerading", 0.02945610191473762], ["System Information Discovery", 0.016753343665035555]], "It installs itself by creating an InstallSvc service": [["Create or Modify System Process", 0.16271513807797489], ["System Binary Proxy Execution", 0.10901554658346142], ["Boot or Logon Autostart Execution", 0.06188918287997739], ["BITS Jobs", 0.037643863417894906], ["Masquerading", 0.03712255246349272], ["Scheduled Task/Job", 0.03143997156385303]], "creating aservice called InstallSvc": [["System Binary Proxy Execution", 0.17629810269552598], ["Create or Modify System Process", 0.15069443303700367], ["Command and Scripting Interpreter", 0.06560865952396785], ["System Services", 0.05205917434625992], ["Hijack Execution Flow", 0.03861004123120562], ["Boot or Logon Autostart Execution", 0.03351375540496424]], "Creates a service": [["System Services", 0.39039691255706405], ["Create or Modify System Process", 0.3806295480969632], ["System Service Discovery", 0.043666750345767884], ["Masquerading", 0.017590712098012436], ["Hijack Execution Flow", 0.012917814521624639], ["Native API", 0.01146626787162264]], "which is injected to conduct backdoor behaviors.": [["Process Injection", 0.0791069943825141], ["Hijack Execution Flow", 0.041357454511791576], ["Event Triggered Execution", 0.03847223448517665], ["Obfuscated Files or Information", 0.029672763147965735], ["Software Discovery", 0.028941575742694025], ["Compromise Client Software Binary", 0.026686487947393374]], "and inject it into winver.exe for the next-stage payload": [["Process Injection", 0.24109804772940954], ["System Binary Proxy Execution", 0.22185641894620703], ["Hijack Execution Flow", 0.06858848644862933], ["Native API", 0.05718496792607838], ["Command and Scripting Interpreter", 0.04210699404557565], ["Event Triggered Execution", 0.03672343107148264]], "It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.": [["System Binary Proxy Execution", 0.24161211326698204], ["Process Injection", 0.16821646576158472], ["Hijack Execution Flow", 0.16193365194874085], ["Native API", 0.057405534950560895], ["Shared Modules", 0.047744410923752444], ["Obfuscated Files or Information", 0.02276343218399338]], "It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).": [["Non-Application Layer Protocol", 0.28649000769264504], ["Application Layer Protocol", 0.11767172489184113], ["Encrypted Channel", 0.03914321512176769], ["Non-Standard Port", 0.03799555547950706], ["Protocol Tunneling", 0.03363478909696795], ["Exfiltration Over Alternative Protocol", 0.02664884884893303]], "Delete file": [["Indicator Removal", 0.7704266378744882], ["Data Destruction", 0.09757554531667001], ["Disk Wipe", 0.010056087210857817], ["Inhibit System Recovery", 0.00809872374976257], ["System Shutdown/Reboot", 0.006350252753663585], ["Masquerading", 0.00553387321656404]], "Keystrokes and windows monitoring": [["Input Capture", 0.8106921449546497], ["Application Window Discovery", 0.012144369124903267], ["Clipboard Data", 0.01023118489704055], ["Virtualization/Sandbox Evasion", 0.0082098396427481], ["Native API", 0.007867833955922453], ["Event Triggered Execution", 0.007686743722906201]], "Monitor keystrokes and windows": [["Input Capture", 0.8178377131628272], ["Application Window Discovery", 0.02356906527412374], ["Screen Capture", 0.012043433657207645], ["Clipboard Data", 0.010056123210783963], ["Virtualization/Sandbox Evasion", 0.009157072919718102], ["Native API", 0.007765359686035799]], "Keylogging": [["Input Capture", 0.8745521679853931], ["Clipboard Data", 0.007098711052589075], ["Credentials from Password Stores", 0.005645060814521013], ["Screen Capture", 0.004853383381197705], ["Event Triggered Execution", 0.003345014990694936], ["Unsecured Credentials", 0.0033174420523192924]], "will check if the running processes": [["Process Discovery", 0.7798565816758534], ["Native API", 0.030658614466927525], ["System Service Discovery", 0.02046541284222147], ["Software Discovery", 0.01969559315103973], ["Virtualization/Sandbox Evasion", 0.015839580611113548], ["Windows Management Instrumentation", 0.013818051655133562]], "will check if the process avp.exe exists.": [["Process Discovery", 0.23352730665393845], ["Virtualization/Sandbox Evasion", 0.10792688241329769], ["Software Discovery", 0.10120131133006195], ["Native API", 0.1008926200297712], ["System Information Discovery", 0.0677757390929181], ["Windows Management Instrumentation", 0.06132132647538617]], "It sets up a run key for via the command C:\\ProgramData\\GoogleUpdate\\googleupdate.exe work for persistence.": [["Boot or Logon Autostart Execution", 0.42002659000687315], ["Event Triggered Execution", 0.07414473518562095], ["Create or Modify System Process", 0.05568261039043751], ["Scheduled Task/Job", 0.04859247500761985], ["Office Application Startup", 0.04749327635947633], ["Modify Registry", 0.040544346040115316]], "It sets up a run key for the command C:\\programdata\\netsky\\netsky.exe online for persistence.": [["Boot or Logon Autostart Execution", 0.558710487091959], ["Event Triggered Execution", 0.08461947081126742], ["Create or Modify System Process", 0.045781779013228836], ["Masquerading", 0.02890480026793065], ["Modify Registry", 0.028241115247129214], ["Scheduled Task/Job", 0.02634843993719135]], "Sets Run Key with \u201cwork/online\u201d": [["Boot or Logon Autostart Execution", 0.2574240670571916], ["Event Triggered Execution", 0.04973335852622091], ["Scheduled Task/Job", 0.030658834375561654], ["Remote Services", 0.02982390488650413], ["Office Application Startup", 0.029104980175657644], ["Input Capture", 0.02506224429051675]], "It installs itself by creating aservice called InstallSvc which will trigger \u201cC:\\programdata\\netsky\\netsky.exe online\u201d.": [["System Binary Proxy Execution", 0.17145621772750652], ["Boot or Logon Autostart Execution", 0.10721915321157031], ["Masquerading", 0.06695957370906086], ["Hijack Execution Flow", 0.04780720260031907], ["Create or Modify System Process", 0.04774057134239764], ["Event Triggered Execution", 0.04513851766505835]], "malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.": [["Data Encrypted for Impact", 0.15884274543838903], ["Deobfuscate/Decode Files or Information", 0.105040718204802], ["Weaken Encryption", 0.10350474599889826], ["Obfuscated Files or Information", 0.0831111560624454], ["Encrypted Channel", 0.08221594824677743], ["Execution Guardrails", 0.0481688138317715]], "Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string": [["Obfuscated Files or Information", 0.34680605279129983], ["Archive Collected Data", 0.27255866219150926], ["Deobfuscate/Decode Files or Information", 0.16963527456151906], ["Data Encrypted for Impact", 0.047449371290032454], ["Encrypted Channel", 0.02012320144805034], ["Execution Guardrails", 0.01112822608536176]], "is another example of custom malware used for packing files;": [["Obfuscated Files or Information", 0.38706794960511554], ["Archive Collected Data", 0.10516669228957821], ["Data Staged", 0.03297354479367419], ["Hide Artifacts", 0.025818669064722508], ["Masquerading", 0.02558969779522795], ["Command and Scripting Interpreter", 0.022188613018814668]], "Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.": [["Phishing", 0.08941044145138181], ["User Execution", 0.05559201152771701], ["Email Collection", 0.054362653076628305], ["Template Injection", 0.051949601637893854], ["Archive Collected Data", 0.04576911119769757], ["Phishing for Information", 0.04191509240682438]], "that had the remote desktop service enabled.": [["Remote Services", 0.4530457391533336], ["Remote Access Software", 0.18616514643418403], ["Remote System Discovery", 0.03589984408925108], ["Remote Service Session Hijacking", 0.022793766460272376], ["Exploitation of Remote Services", 0.021140962382230077], ["System Network Connections Discovery", 0.01706089271272379]], "and the creation of a schedule task.": [["Scheduled Task/Job", 0.7289527504105027], ["Inter-Process Communication", 0.035238756288644486], ["Create or Modify System Process", 0.018728407009702488], ["Masquerading", 0.016115453302735373], ["Event Triggered Execution", 0.010974428299111756], ["Command and Scripting Interpreter", 0.009587056402418134]], "conceal its true code through either encryption or compression": [["Obfuscated Files or Information", 0.7068274199917078], ["Deobfuscate/Decode Files or Information", 0.052444678488813304], ["Archive Collected Data", 0.044985787880220965], ["Data Encoding", 0.016652952022675374], ["Hide Artifacts", 0.01448913938147015], ["Encrypted Channel", 0.014477942654967036]], "make the malicious payload smaller and avoid detection based on static malware analysis techniques": [["Obfuscated Files or Information", 0.5726791933550806], ["Execution Guardrails", 0.03469584024594257], ["Virtualization/Sandbox Evasion", 0.02207385411149943], ["Impair Defenses", 0.015082750421761769], ["Develop Capabilities", 0.014893314364327904], ["Exploitation for Client Execution", 0.014491279012377414]], "UPX is an open-source packing algorithm": [["Obfuscated Files or Information", 0.4082666110429884], ["Archive Collected Data", 0.050469713610888124], ["Acquire Infrastructure", 0.01596466971097984], ["Data Transfer Size Limits", 0.013755347265492842], ["Data Staged", 0.013225631522969725], ["Command and Scripting Interpreter", 0.013018063379921773]], "MPRESS is a free packer.": [["Archive Collected Data", 0.16392871759043492], ["Obfuscated Files or Information", 0.10889320931331237], ["Ingress Tool Transfer", 0.055287968917735325], ["Masquerading", 0.03730828933129123], ["Data Staged", 0.033170608113875295], ["Automated Collection", 0.029795812631509145]], "Andromeda is a custom packer": [["Obfuscated Files or Information", 0.17612362239116697], ["Masquerading", 0.08127884826123186], ["Ingress Tool Transfer", 0.05424611296302602], ["System Binary Proxy Execution", 0.043987407708755824], ["BITS Jobs", 0.03222805207372552], ["Hijack Execution Flow", 0.026211132216703587]], "compress (and if it has the functionality of a crypter also encrypts) the original executable, which is saved in one of the sections of the final packed file.": [["Obfuscated Files or Information", 0.40185623940461934], ["Archive Collected Data", 0.19008546599453446], ["Deobfuscate/Decode Files or Information", 0.09802907649592618], ["Hide Artifacts", 0.020868956662438765], ["Masquerading", 0.015481981026142237], ["Data Encrypted for Impact", 0.014828634225693919]], "entry point of the original file is relocated, and so is the Import Address Table (IAT).": [["Data Manipulation", 0.07214497733984233], ["Masquerading", 0.053223689331149175], ["Data Staged", 0.0474538280519352], ["Hide Artifacts", 0.04312796596273168], ["Indicator Removal", 0.04157910556994333], ["Data from Local System", 0.03531547843905379]], "change the final payload\u2019s section names,": [["Masquerading", 0.2590377703792844], ["Obfuscated Files or Information", 0.07107115832631006], ["Hijack Execution Flow", 0.05625839047070886], ["Data Manipulation", 0.03395024512885093], ["Process Injection", 0.03351179334312161], ["Hide Artifacts", 0.0286026353874175]], "have very few imports as they don\u2019t rely on external libraries": [["Hijack Execution Flow", 0.1799105491517252], ["Shared Modules", 0.09081436931495444], ["Native API", 0.04888811201081306], ["Process Injection", 0.04088385654103116], ["Obfuscated Files or Information", 0.032503838860031116], ["Ingress Tool Transfer", 0.03086290093736089]], "allocate memory, change permissions, read the encrypted/packed chunk of code, decrypt it, load it to the allocated memory space and execute it": [["Deobfuscate/Decode Files or Information", 0.37141746151443045], ["Obfuscated Files or Information", 0.18210769195005888], ["Process Injection", 0.06777894718944157], ["Data Encrypted for Impact", 0.038650574313252785], ["Archive Collected Data", 0.031184273973982646], ["Weaken Encryption", 0.017611419444352492]], "use system calls": [["Native API", 0.4314610745698913], ["Hijack Execution Flow", 0.05011984066865736], ["Shared Modules", 0.04197653554541413], ["System Services", 0.039555925204241185], ["Event Triggered Execution", 0.024506162548803414], ["Process Injection", 0.02445487198177417]], "VirtualAlloc used for allocating memory in the current process": [["Process Injection", 0.45174310358666087], ["Virtualization/Sandbox Evasion", 0.05646333607952923], ["Native API", 0.051444487438482296], ["Process Discovery", 0.03239101497905567], ["Hide Artifacts", 0.01675738813368036], ["Impair Defenses", 0.010886741138472829]], "VirtualProtect changes the permissions of the given virtual address.": [["Process Injection", 0.096809360739858], ["File and Directory Permissions Modification", 0.07123758943843018], ["Impair Defenses", 0.06174673176571144], ["Hide Artifacts", 0.04108469271262888], ["Virtualization/Sandbox Evasion", 0.030224055850210332], ["Abuse Elevation Control Mechanism", 0.02984943095394293]], "RtlDecompressBuffer decompresses the provided buffer.": [["Deobfuscate/Decode Files or Information", 0.2987432038120814], ["Archive Collected Data", 0.1777038525494985], ["Obfuscated Files or Information", 0.07569793520409684], ["Hide Artifacts", 0.02785735906471244], ["Process Injection", 0.01996645252765093], ["Exfiltration Over Alternative Protocol", 0.018280338296579917]], "CreateProcessInternalW creates a new process.": [["Process Injection", 0.3405336279182225], ["Native API", 0.19242537852835118], ["Access Token Manipulation", 0.09591731072013762], ["Process Discovery", 0.05684578484189194], ["Create or Modify System Process", 0.04648967098481526], ["System Services", 0.02451851369053775]], "can create a new threat with the malicious unpacked payload.": [["Obfuscated Files or Information", 0.15705326450107826], ["Ingress Tool Transfer", 0.05020827350666013], ["Execution Guardrails", 0.04038590639331168], ["Subvert Trust Controls", 0.03719131318292576], ["Masquerading", 0.03183216802217161], ["Phishing", 0.031119180315394405]], "initial code usually called a stub, decrypts or decompresses the real code": [["Deobfuscate/Decode Files or Information", 0.43119275236961263], ["Obfuscated Files or Information", 0.30018014221419215], ["Execution Guardrails", 0.014742763598744235], ["Hide Artifacts", 0.010686526675414742], ["Archive Collected Data", 0.01056648393606333], ["Masquerading", 0.009799160867758077]], "stub is a small part of code that implements the decompression (and decryption) of the originally packed file": [["Deobfuscate/Decode Files or Information", 0.4313990254372497], ["Archive Collected Data", 0.198409134516845], ["Obfuscated Files or Information", 0.16496214321059802], ["Data Encrypted for Impact", 0.02275858072003504], ["Hide Artifacts", 0.013344342432121244], ["Exfiltration Over Alternative Protocol", 0.007608117362931268]], "the payload of the malware can be part of the loader\u2019s file": [["Hijack Execution Flow", 0.13765472025823958], ["System Binary Proxy Execution", 0.11154827982263689], ["Shared Modules", 0.10918726840089128], ["Ingress Tool Transfer", 0.07551716581255048], ["Obfuscated Files or Information", 0.05496109015443519], ["Process Injection", 0.048115373751190654]], "strongly indicates that it contains another component that is dropped/loaded.": [["Virtualization/Sandbox Evasion", 0.11441338809988578], ["Software Discovery", 0.05397799018597285], ["Hide Artifacts", 0.051708973782605604], ["Rootkit", 0.03999809597338642], ["Indicator Removal", 0.03514022407164038], ["Query Registry", 0.03178926094520723]], "it can be downloaded from a remote location (by the loader, also known as a Downloader).": [["Ingress Tool Transfer", 0.6554830053952216], ["BITS Jobs", 0.035946001868517215], ["Command and Scripting Interpreter", 0.02380303743640113], ["System Binary Proxy Execution", 0.018340243418182363], ["Data from Local System", 0.011584115434597416], ["Deobfuscate/Decode Files or Information", 0.010945555747408346]], "VirtualProtect changes the permissions of the given virtual address": [["Process Injection", 0.10706737843624453], ["File and Directory Permissions Modification", 0.0633454021875103], ["Impair Defenses", 0.05828231019689999], ["Exploitation for Privilege Escalation", 0.0328274374463459], ["Access Token Manipulation", 0.031976292029248746], ["Hide Artifacts", 0.031794211475908295]], "CreateProcessInternalW creates a new process": [["Process Injection", 0.33793557922309175], ["Native API", 0.2251365029952659], ["Access Token Manipulation", 0.08999713453970938], ["Process Discovery", 0.062293603358091656], ["Create or Modify System Process", 0.036063999696814925], ["System Services", 0.020148806401017027]], "not see them in the imported function list, and they not even be part of the strings in the sample.": [["Obfuscated Files or Information", 0.0817227346676727], ["Hijack Execution Flow", 0.07515400186177025], ["Masquerading", 0.06077440033238221], ["Native API", 0.05046937040961031], ["Deobfuscate/Decode Files or Information", 0.03233462869704897], ["XSL Script Processing", 0.028900109642003333]], "try to hide these system calls": [["Rootkit", 0.17523339053740467], ["Impair Defenses", 0.15398276106583056], ["Hide Artifacts", 0.056928466844496525], ["Virtualization/Sandbox Evasion", 0.053014014782186966], ["Hijack Execution Flow", 0.040641463914957036], ["Masquerading", 0.04061520918477946]], "function and the corresponding library are dynamically loaded at runtime \u2013 also known as explicit linking": [["Hijack Execution Flow", 0.37009439738633876], ["Shared Modules", 0.22264250111481368], ["Native API", 0.040959277141049515], ["Process Injection", 0.029153671529250188], ["Masquerading", 0.02243305208512944], ["System Binary Proxy Execution", 0.015944202914922483]], "this executable then downloads and executes additional payloads": [["Ingress Tool Transfer", 0.46827280033495416], ["Command and Scripting Interpreter", 0.14740922961985792], ["System Binary Proxy Execution", 0.13200667839073651], ["BITS Jobs", 0.04928361798213768], ["Native API", 0.0227789616617601], ["Masquerading", 0.011852989406196255]], "This executable binary insecurely downloads and executes additional payloads from the Internet.": [["Ingress Tool Transfer", 0.5066923001004444], ["BITS Jobs", 0.09603872301218258], ["Command and Scripting Interpreter", 0.0520562047514675], ["System Binary Proxy Execution", 0.03685327517215263], ["Application Layer Protocol", 0.02025429491528855], ["Stage Capabilities", 0.016528521460027777]], "Downloading and running further executables": [["Ingress Tool Transfer", 0.5546734505278802], ["Command and Scripting Interpreter", 0.09242007415703078], ["BITS Jobs", 0.07302350685401018], ["System Binary Proxy Execution", 0.06527203815677153], ["Native API", 0.02134361976905735], ["Masquerading", 0.009090972058171491]], "It downloads and runs an executable payload": [["Ingress Tool Transfer", 0.5280015679104776], ["Command and Scripting Interpreter", 0.17145891667482505], ["BITS Jobs", 0.06352805141587033], ["System Binary Proxy Execution", 0.06048660715490971], ["Native API", 0.01649565780581463], ["Deobfuscate/Decode Files or Information", 0.008102164273172412]], "This is a Windows Native Binary executable embedded inside of UEFI firmware binary": [["Pre-OS Boot", 0.10189499136910254], ["Masquerading", 0.07007803691602972], ["System Binary Proxy Execution", 0.04409762396681883], ["Peripheral Device Discovery", 0.039699489860172986], ["Modify System Image", 0.03526773811017458], ["Virtualization/Sandbox Evasion", 0.0339811655297753]], "This Windows executable is embedded into UEFI firmware": [["Pre-OS Boot", 0.15558838434460198], ["Windows Management Instrumentation", 0.04990116667789792], ["Masquerading", 0.04874990850515925], ["Boot or Logon Autostart Execution", 0.0449610802888209], ["System Binary Proxy Execution", 0.042963823313109405], ["Modify System Image", 0.040683831148780825]], "the embedded Windows executable": [["System Binary Proxy Execution", 0.20731608851650954], ["Native API", 0.14785901303270435], ["Process Injection", 0.08596492062839035], ["Hijack Execution Flow", 0.060036575074394076], ["Masquerading", 0.04644728206250382], ["Event Triggered Execution", 0.03879586704042052]], "an embedded executable": [["System Binary Proxy Execution", 0.171746772687275], ["Process Injection", 0.12411924541344002], ["Hijack Execution Flow", 0.1105535984024975], ["Native API", 0.0897198530855599], ["Shared Modules", 0.043376453396726335], ["Event Triggered Execution", 0.03328247999645795]], "This executable uses the Windows Native API": [["Native API", 0.5091949270473777], ["System Binary Proxy Execution", 0.16449310001668635], ["Masquerading", 0.036313653654775464], ["Command and Scripting Interpreter", 0.03236661308532055], ["XSL Script Processing", 0.02444219820595964], ["Hijack Execution Flow", 0.020261898048938538]], "It then sets registry entries": [["Modify Registry", 0.5259683934569978], ["Boot or Logon Autostart Execution", 0.1307220498812934], ["Query Registry", 0.07500540187714184], ["Boot or Logon Initialization Scripts", 0.018759407800315424], ["Indicator Removal", 0.0168999266570523], ["Create or Modify System Process", 0.015520388952711663]], "to run this executable as a Windows Service.": [["System Services", 0.41664654086079644], ["Create or Modify System Process", 0.2753415525517481], ["Masquerading", 0.041039150349273586], ["System Binary Proxy Execution", 0.03873628234748866], ["Hijack Execution Flow", 0.02590040775657731], ["System Service Discovery", 0.025847772040927162]], "when using the HTTPS-enabled options": [["Application Layer Protocol", 0.38103481634022174], ["Browser Session Hijacking", 0.05313942545539482], ["Data Obfuscation", 0.0487376501712461], ["Non-Standard Port", 0.04335704817548233], ["Stage Capabilities", 0.03377980385789488], ["Encrypted Channel", 0.031043843912785495]], "implants made their native Windows executables look like legitimate update tools.": [["Masquerading", 0.24641313911283927], ["Supply Chain Compromise", 0.09856409861246511], ["Ingress Tool Transfer", 0.03097057635324487], ["Subvert Trust Controls", 0.025884080761245286], ["Modify System Image", 0.024902017925935518], ["Exploitation for Privilege Escalation", 0.024373004522552904]], "the Windows payload was named \u201cIntelUpdater.exe\u201d": [["Masquerading", 0.11971437186349143], ["System Binary Proxy Execution", 0.09371025004289169], ["Windows Management Instrumentation", 0.06284234258543452], ["Event Triggered Execution", 0.05262017417327392], ["Native API", 0.043767431522267586], ["Process Injection", 0.03551383471153381]], "Capturing screenshots": [["Screen Capture", 0.8715887872744611], ["Video Capture", 0.02208223461338063], ["Application Window Discovery", 0.009680186527676654], ["Input Capture", 0.007714816871318067], ["Clipboard Data", 0.005181855709281786], ["Data from Local System", 0.003773177233024374]], "Real-time screen monitoring": [["Screen Capture", 0.32879830006958094], ["Application Window Discovery", 0.09962754016602211], ["Input Capture", 0.09625049197106929], ["Virtualization/Sandbox Evasion", 0.04297972850139081], ["Video Capture", 0.041761500731598414], ["Remote Access Software", 0.020381794365612247]], "a legitimate tool which is frequently used by bad actors for malicious purposes in ways similar to TeamViewer": [["Remote Access Software", 0.49501316090625996], ["Remote Services", 0.08419999116628554], ["Software Deployment Tools", 0.01935393491117597], ["Exploitation of Remote Services", 0.018356728315036715], ["Communication Through Removable Media", 0.014175675302958077], ["Remote System Discovery", 0.011973410107913975]], "NetSupport Manager, used maliciously or otherwise, provides full and complete control over the target device.": [["Network Boundary Bridging", 0.22293526233675418], ["Traffic Signaling", 0.15852716525518312], ["Impair Defenses", 0.047619315656895984], ["Adversary-in-the-Middle", 0.04294811792925521], ["Dynamic Resolution", 0.028620384668321532], ["System Network Connections Discovery", 0.02219710131258314]], "As NetSupport Manager is a legitimate tool that has a long history of development, it is highly attractive to attackers as it can be relied on to work \u2018out of the box\u2019.": [["Network Service Discovery", 0.07762565655513756], ["System Network Connections Discovery", 0.07381324257948513], ["Dynamic Resolution", 0.04973178883475521], ["Traffic Signaling", 0.04805184986492625], ["Network Boundary Bridging", 0.04031511919778833], ["Proxy", 0.03637550796508761]], "has been observed in multiple ISO files masquerading as legitimate software,": [["Masquerading", 0.1974908593046392], ["Supply Chain Compromise", 0.08555623176801637], ["Subvert Trust Controls", 0.0745919069203146], ["Obfuscated Files or Information", 0.07276829908850306], ["Hide Artifacts", 0.03984110698536135], ["Execution Guardrails", 0.021973265279531053]], "The RAT installation is disguised to look similar to a Google Chrome installation.": [["Browser Extensions", 0.09192037348440829], ["Masquerading", 0.08980409137052695], ["Stage Capabilities", 0.04266718643085843], ["Browser Session Hijacking", 0.04087491675273341], ["Credentials from Password Stores", 0.03123568041571761], ["Hide Artifacts", 0.02775610393675989]], "RAT installer disguised as Google Chrome setup": [["Browser Extensions", 0.19799233460177923], ["Command and Scripting Interpreter", 0.06983716105022682], ["Drive-by Compromise", 0.03616224804426323], ["Stage Capabilities", 0.0346833557606565], ["Ingress Tool Transfer", 0.02613463847329852], ["Masquerading", 0.025389589116972738]], "threat actors are able to masquerade the dropper or installer": [["Masquerading", 0.15546603272373274], ["Hijack Execution Flow", 0.07693415881668651], ["System Binary Proxy Execution", 0.06103657307021988], ["Rootkit", 0.04014532027498457], ["Event Triggered Execution", 0.03226675329700696], ["Create or Modify System Process", 0.030711313516665093]], "The sample is obfuscated via the Babadeda crypter.": [["Obfuscated Files or Information", 0.44829638307869846], ["Deobfuscate/Decode Files or Information", 0.23955361217197793], ["Archive Collected Data", 0.07014508459578858], ["Data Encoding", 0.025624402920267388], ["Data Encrypted for Impact", 0.021993320619753447], ["Encrypted Channel", 0.017125364283785784]], "a base64 encoded string is used to specify various parameters": [["Obfuscated Files or Information", 0.3898830091454215], ["Data Encoding", 0.3671944988120891], ["Deobfuscate/Decode Files or Information", 0.0812018363351111], ["Data Obfuscation", 0.021102566996961288], ["Archive Collected Data", 0.017676289813976998], ["Encrypted Channel", 0.014603285295692743]], "Base64 encoded RAT execution command": [["Obfuscated Files or Information", 0.5203491585024489], ["Deobfuscate/Decode Files or Information", 0.21100842770331046], ["Data Encoding", 0.10606112043993667], ["Data Obfuscation", 0.016063911754205788], ["Archive Collected Data", 0.011614656300452565], ["Encrypted Channel", 0.010357768581517683]], "Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.": [["Boot or Logon Autostart Execution", 0.4057324894733582], ["Create or Modify System Process", 0.07714538383872356], ["Event Triggered Execution", 0.07465774269824661], ["Boot or Logon Initialization Scripts", 0.045982083197247316], ["Hijack Execution Flow", 0.03645951335657655], ["Modify Registry", 0.03635425101036227]], "Persistence via Scheduled Task": [["Scheduled Task/Job", 0.7023066543319133], ["Create or Modify System Process", 0.0371080639523108], ["Event Triggered Execution", 0.0277474874810922], ["Inter-Process Communication", 0.024495523835457354], ["Boot or Logon Autostart Execution", 0.023303860797010297], ["Command and Scripting Interpreter", 0.019236839257667802]], "In addition, the sample generates a scheduled task with multiple triggers.": [["Scheduled Task/Job", 0.7843626571059881], ["Inter-Process Communication", 0.037582115437753506], ["Command and Scripting Interpreter", 0.01468402861238641], ["Masquerading", 0.012423829530529501], ["Create or Modify System Process", 0.011486286817652808], ["System Services", 0.007915099293194571]], "Network adapter details are pulled via GetAdaptersAddresses": [["System Network Configuration Discovery", 0.6951745103407622], ["System Network Connections Discovery", 0.04873833788604831], ["Data from Configuration Repository", 0.046907747518412105], ["Remote System Discovery", 0.020220952855069717], ["System Information Discovery", 0.01449873722245697], ["Windows Management Instrumentation", 0.008802671337360854]], "Additional data is gleaned via WMI queries": [["Windows Management Instrumentation", 0.537504375395313], ["OS Credential Dumping", 0.0530940870271004], ["System Information Discovery", 0.04426539148299509], ["Event Triggered Execution", 0.023988564686437883], ["Query Registry", 0.021845949692941683], ["Peripheral Device Discovery", 0.014015955888038247]], "SELECT * FROM Win32_ComputerSystem": [["System Information Discovery", 0.6865220482122044], ["File and Directory Discovery", 0.0615062056096124], ["Virtualization/Sandbox Evasion", 0.028899619196384667], ["Windows Management Instrumentation", 0.028197528169921573], ["Peripheral Device Discovery", 0.02089368746069799], ["Query Registry", 0.013682209104027683]], "all running processes are enumerated and logged via EnumProcesses (32-bit processes).": [["Process Discovery", 0.8248004117300355], ["Process Injection", 0.01713081230368327], ["Native API", 0.013424817106761768], ["System Service Discovery", 0.012729296354331733], ["Virtualization/Sandbox Evasion", 0.008422368391594267], ["Impair Defenses", 0.007763351162281424]], "has the ability to drop and execute additional components.": [["Rootkit", 0.0770813751105875], ["Command and Scripting Interpreter", 0.056306395611797545], ["Process Injection", 0.04442823478263268], ["Hide Artifacts", 0.043350739947213265], ["Indicator Removal", 0.03693776876585278], ["Event Triggered Execution", 0.035328799183857104]], "These files are all self-deleted after launch": [["Indicator Removal", 0.6435253459600356], ["Data Destruction", 0.05579899645580844], ["Inhibit System Recovery", 0.04566226138430276], ["Data Staged", 0.018991737978137285], ["File and Directory Discovery", 0.01680016739520381], ["Hide Artifacts", 0.0161736313341577]], "threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software.": [["Remote Access Software", 0.177155328014501], ["User Execution", 0.08463841145320954], ["Develop Capabilities", 0.05362394213808577], ["Obtain Capabilities", 0.03942059572973439], ["Remote Services", 0.037586420655428936], ["Software Deployment Tools", 0.02784651889099341]], "decoded command": [["Deobfuscate/Decode Files or Information", 0.5090326454768592], ["Obfuscated Files or Information", 0.18396393771663366], ["Data Encoding", 0.06322877517410391], ["Encrypted Channel", 0.023816145749895844], ["Command and Scripting Interpreter", 0.014857921762553121], ["Archive Collected Data", 0.014567934418182193]], "Downloads the miner and watcher.": [["BITS Jobs", 0.10416964847118966], ["Ingress Tool Transfer", 0.08814243409152916], ["Command and Scripting Interpreter", 0.04482976232331657], ["Scheduled Task/Job", 0.04063587827452907], ["Automated Collection", 0.03917528991295115], ["Deobfuscate/Decode Files or Information", 0.03773211254706848]], "then a malware downloader is uploaded to the device": [["Ingress Tool Transfer", 0.3001697648601429], ["Data from Removable Media", 0.04644713812675476], ["Replication Through Removable Media", 0.039165361759162014], ["BITS Jobs", 0.03172857155452839], ["Command and Scripting Interpreter", 0.027352648669544247], ["Exfiltration Over Physical Medium", 0.017816751958711706]], "Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning.": [["Impair Defenses", 0.16756502217764355], ["Hide Artifacts", 0.07065549080707456], ["Masquerading", 0.04504119456160088], ["Windows Management Instrumentation", 0.03615657903554722], ["Indicator Removal", 0.02896884184247328], ["Execution Guardrails", 0.02571251910796685]], "its \u201cintelligent\u201d way of brute forcing: it checks the prompt and, based on the prompt, it selects the appropriate credentials.": [["Brute Force", 0.6321469685154747], ["Multi-Factor Authentication Interception", 0.03550799337960484], ["Modify Authentication Process", 0.026962386251290126], ["OS Credential Dumping", 0.019744984048850944], ["Input Capture", 0.019299683409061855], ["Use Alternate Authentication Material", 0.018590894318261927]], "This method speeds up the brute forcing process": [["Brute Force", 0.5734219413921331], ["Steal or Forge Kerberos Tickets", 0.028792463934860683], ["Multi-Factor Authentication Interception", 0.027708360683715624], ["Use Alternate Authentication Material", 0.01676761598187551], ["Modify Authentication Process", 0.015889986123901297], ["OS Credential Dumping", 0.014612533592618101]], "\u201cintelligent brute forcing\u201d": [["Brute Force", 0.6267120372947775], ["Multi-Factor Authentication Interception", 0.03207838885224821], ["Steal or Forge Kerberos Tickets", 0.027094886649228288], ["Use Alternate Authentication Material", 0.018858126133565224], ["Modify Authentication Process", 0.012966652510378722], ["Data Encrypted for Impact", 0.008546801478058488]], "then determines the processor architecture": [["System Information Discovery", 0.45662779577568496], ["Virtualization/Sandbox Evasion", 0.2041323473762287], ["Software Discovery", 0.03537514850487847], ["Execution Guardrails", 0.018272703289465016], ["Modify System Image", 0.01668144605798648], ["Windows Management Instrumentation", 0.016044874516221094]], "Is able to steal/gather information on CPU type, screen resolution": [["System Information Discovery", 0.7062949252609672], ["Virtualization/Sandbox Evasion", 0.060694675106321413], ["Windows Management Instrumentation", 0.025207714166284253], ["Software Discovery", 0.013912620670505492], ["Gather Victim Host Information", 0.013591568662079407], ["System Network Configuration Discovery", 0.012631029312718773]], "The downloading of the actual malware is done via a variety of possible commands (for example, wget, curl, tftp and ftpget).": [["Ingress Tool Transfer", 0.6371890127899723], ["Command and Scripting Interpreter", 0.046009726862855385], ["BITS Jobs", 0.03865264194562415], ["Application Layer Protocol", 0.01820161065920175], ["Data from Local System", 0.014900417914896859], ["Web Service", 0.010770033142411034]], "via the shell \u201cecho\u201d commands.": [["Command and Scripting Interpreter", 0.26054995415665766], ["Native API", 0.05712662627619176], ["Virtualization/Sandbox Evasion", 0.041111214048489005], ["System Information Discovery", 0.03037293183739085], ["File and Directory Discovery", 0.024299908733939765], ["Input Capture", 0.02185999280128732]], "keystroke": [["Input Capture", 0.5557862768468539], ["Clipboard Data", 0.032586174089903254], ["Encrypted Channel", 0.02077574907378357], ["Remote Services", 0.019032501001653976], ["Deobfuscate/Decode Files or Information", 0.012251574728154973], ["Boot or Logon Autostart Execution", 0.010868583285499197]], "download a malicious file": [["Ingress Tool Transfer", 0.6963741055173353], ["Command and Scripting Interpreter", 0.038008257704640135], ["BITS Jobs", 0.03513658096024944], ["Application Layer Protocol", 0.01581422139417477], ["System Binary Proxy Execution", 0.007751673601925439], ["Data from Local System", 0.006777217372682123]], "executes a malicious script": [["Command and Scripting Interpreter", 0.43589854916400417], ["System Binary Proxy Execution", 0.11431698269462887], ["System Services", 0.03849688559715978], ["Scheduled Task/Job", 0.033979114425459186], ["Inter-Process Communication", 0.03376828934829009], ["User Execution", 0.033385990252064734]], "JavaScript is the module that has to be manually executed by the victim,": [["Command and Scripting Interpreter", 0.18145285491692517], ["Ingress Tool Transfer", 0.0532556205806798], ["User Execution", 0.047419401174333416], ["System Binary Proxy Execution", 0.0432125111451067], ["Browser Extensions", 0.03588568320505467], ["Server Software Component", 0.03326255692334301]], "zip archive": [["Archive Collected Data", 0.6845266258835273], ["Obfuscated Files or Information", 0.027512556730290048], ["Deobfuscate/Decode Files or Information", 0.02524421864826464], ["Automated Collection", 0.023483034977203707], ["Data Staged", 0.019408291797148616], ["Exfiltration Over Alternative Protocol", 0.017611403601643746]], "comes with an embedded PE payload": [["Obtain Capabilities", 0.06943070641315781], ["Develop Capabilities", 0.06595680289071994], ["Subvert Trust Controls", 0.05449512991391269], ["Process Injection", 0.04059618437591735], ["Exploitation for Credential Access", 0.025577939214176268], ["Obfuscated Files or Information", 0.024642940049669933]], "PE is stored as a Base64 encoded string": [["Obfuscated Files or Information", 0.15223757911825228], ["Data Encoding", 0.14177971706583795], ["Deobfuscate/Decode Files or Information", 0.08637408141387405], ["Unsecured Credentials", 0.07146322984269406], ["OS Credential Dumping", 0.04021068679154277], ["Data Obfuscation", 0.024758444812465526]], "stored as a list of registry keys, yet we also observed a variant in which similar content was written into a TXT file.": [["Query Registry", 0.2770465822245955], ["Modify Registry", 0.21454331394726486], ["OS Credential Dumping", 0.05851662486309295], ["Unsecured Credentials", 0.05427931829737323], ["Indicator Removal", 0.027532080297230917], ["Boot or Logon Autostart Execution", 0.027310202687619873]], "obfuscated Powershell script that runs another Base64 obfuscated layer that finally decodes the .NET payload.": [["Obfuscated Files or Information", 0.5933557782226342], ["Deobfuscate/Decode Files or Information", 0.24465232432494752], ["Data Encoding", 0.028398183383817766], ["Archive Collected Data", 0.023241415962614403], ["Data Obfuscation", 0.010578896246865315], ["Encrypted Channel", 0.009267590544932768]], "embedded inside as a base64 encoded buffer": [["Obfuscated Files or Information", 0.3731788615708975], ["Data Encoding", 0.2629893419340133], ["Deobfuscate/Decode Files or Information", 0.11238890090901266], ["Data Obfuscation", 0.03558935986048739], ["Archive Collected Data", 0.029664324810394067], ["Process Injection", 0.01157540794800287]], "In its resources we can find another PE": [["Obtain Capabilities", 0.15677938029834798], ["Develop Capabilities", 0.0577593592851141], ["Stage Capabilities", 0.04575304444733664], ["Acquire Infrastructure", 0.041534847261816256], ["Gather Victim Identity Information", 0.024758541521187085], ["Establish Accounts", 0.021188004248233885]], "been obfuscated in order to hide its real intentions": [["Obfuscated Files or Information", 0.7287509151249238], ["Deobfuscate/Decode Files or Information", 0.08419198794272086], ["Masquerading", 0.02011788365288984], ["Data Obfuscation", 0.018732805017954785], ["Hide Artifacts", 0.016768339884559235], ["Archive Collected Data", 0.012102933512413806]], "Base64 encoded string, and in the other as a hexadecimal string": [["Data Encoding", 0.3629218640851625], ["Obfuscated Files or Information", 0.323068088376006], ["Deobfuscate/Decode Files or Information", 0.1312829835887301], ["Data Obfuscation", 0.0225387629161751], ["Archive Collected Data", 0.021007197664046927], ["Encrypted Channel", 0.019937817200411396]], "PE file was encoded as an obfuscated hexadecimal string.": [["Obfuscated Files or Information", 0.4280198507734428], ["Deobfuscate/Decode Files or Information", 0.18047308040282434], ["Data Encoding", 0.060519332737327035], ["Archive Collected Data", 0.021028663820198648], ["Masquerading", 0.017698226714236247], ["Unsecured Credentials", 0.017097212460423266]], "Base64 encoded script": [["Obfuscated Files or Information", 0.529436989861752], ["Deobfuscate/Decode Files or Information", 0.20963630831673274], ["Data Encoding", 0.11160065691457063], ["Archive Collected Data", 0.014730648728868114], ["Command and Scripting Interpreter", 0.013863138891289071], ["Data Obfuscation", 0.012270741190337466]], "Base64": [["Obfuscated Files or Information", 0.345673020722489], ["Data Encoding", 0.20026167454570562], ["Deobfuscate/Decode Files or Information", 0.17590556658139705], ["Data Obfuscation", 0.02688009088847681], ["Archive Collected Data", 0.026281992617331495], ["Encrypted Channel", 0.020115510395538987]], "obfuscated by XOR": [["Obfuscated Files or Information", 0.7151712034682123], ["Deobfuscate/Decode Files or Information", 0.12528750409032902], ["Encrypted Channel", 0.018031098867227605], ["Archive Collected Data", 0.01495999620010289], ["Hide Artifacts", 0.01006504553982472], ["Data Obfuscation", 0.010041619661423983]], "three layers where one decodes content for the next": [["Deobfuscate/Decode Files or Information", 0.15777166944744278], ["Obfuscated Files or Information", 0.12295674179493588], ["Archive Collected Data", 0.0748285071803816], ["Data Encoding", 0.06215162258588702], ["Data Obfuscation", 0.05384343328642425], ["Exfiltration Over Alternative Protocol", 0.04371462797781415]], "decodes the next element:": [["Deobfuscate/Decode Files or Information", 0.5073664266558714], ["Obfuscated Files or Information", 0.11920379996677162], ["Data Encoding", 0.08969661675240755], ["Encrypted Channel", 0.03613977064624883], ["Archive Collected Data", 0.027402820173706745], ["Data Obfuscation", 0.024389153981254533]], "deobfuscates and runs another block of code": [["Deobfuscate/Decode Files or Information", 0.49389978162436565], ["Obfuscated Files or Information", 0.27369126701549984], ["Archive Collected Data", 0.027437077244757392], ["Hide Artifacts", 0.010311436230599614], ["Process Injection", 0.009461908787868453], ["Data Encrypted for Impact", 0.009125283478318478]], "deobfuscate it.": [["Deobfuscate/Decode Files or Information", 0.359235088355194], ["Obfuscated Files or Information", 0.1408683733365933], ["Archive Collected Data", 0.10285002743176591], ["Hide Artifacts", 0.02726314381901051], ["Exfiltration Over Alternative Protocol", 0.02566050624127958], ["Data Encrypted for Impact", 0.024416993448755114]], "decodes it": [["Deobfuscate/Decode Files or Information", 0.5130437712728823], ["Data Encoding", 0.13252830961979828], ["Obfuscated Files or Information", 0.07724694020705242], ["Archive Collected Data", 0.04495068626427369], ["Encrypted Channel", 0.024127154267958882], ["Exfiltration Over Alternative Protocol", 0.01545438170067311]], "deobfuscate the file": [["Deobfuscate/Decode Files or Information", 0.4850257439119157], ["Obfuscated Files or Information", 0.14354137952900275], ["Archive Collected Data", 0.07609078115466786], ["Data Encrypted for Impact", 0.03158174754317157], ["Indicator Removal", 0.025344992145913625], ["Hide Artifacts", 0.014801707938680676]], "decoding": [["Deobfuscate/Decode Files or Information", 0.555137628658082], ["Data Encoding", 0.1209105014844714], ["Obfuscated Files or Information", 0.071813879335849], ["Archive Collected Data", 0.032612752099377224], ["Encrypted Channel", 0.023804646233644342], ["Data Obfuscation", 0.01647725737707573]], "Decoded content": [["Deobfuscate/Decode Files or Information", 0.4991676110879505], ["Data Encoding", 0.172503542799433], ["Obfuscated Files or Information", 0.08952172486391381], ["Archive Collected Data", 0.03846477379796825], ["Data Obfuscation", 0.021985557090227363], ["Encrypted Channel", 0.01808041293941009]], "deobfuscates": [["Deobfuscate/Decode Files or Information", 0.5085788799183059], ["Obfuscated Files or Information", 0.18327700772364258], ["Archive Collected Data", 0.054310996966896924], ["Data Encoding", 0.01880662404154027], ["Data Encrypted for Impact", 0.015633316246336945], ["Exfiltration Over Alternative Protocol", 0.01402350135235395]], "was decoded": [["Deobfuscate/Decode Files or Information", 0.5134713920631313], ["Data Encoding", 0.15690661529121136], ["Obfuscated Files or Information", 0.08591077896968312], ["Encrypted Channel", 0.026672766385643167], ["Archive Collected Data", 0.02375028893999563], ["Data Obfuscation", 0.017387699633436827]], "decoding the base64-encoded content,": [["Deobfuscate/Decode Files or Information", 0.4129972752995533], ["Data Encoding", 0.2722016219798828], ["Obfuscated Files or Information", 0.15198922125182424], ["Archive Collected Data", 0.03305006058771258], ["Data Obfuscation", 0.020870692967697325], ["Encrypted Channel", 0.012648281237753271]], "decompressed": [["Deobfuscate/Decode Files or Information", 0.4659215916512715], ["Archive Collected Data", 0.22843579383291307], ["Obfuscated Files or Information", 0.0815114208490249], ["Exfiltration Over Alternative Protocol", 0.016243060957123544], ["Data Encoding", 0.011243783466211101], ["Data Encrypted for Impact", 0.009665448791723527]], "reading/writing registry keys": [["Modify Registry", 0.4348399409660578], ["Query Registry", 0.24238279327092482], ["Boot or Logon Autostart Execution", 0.12737468295885787], ["System Binary Proxy Execution", 0.016226877221622138], ["Event Triggered Execution", 0.00997343215704556], ["Office Application Startup", 0.00860687960898448]], "written to the registry, as a list of keys.": [["Query Registry", 0.38435165649403], ["Modify Registry", 0.2872063980982906], ["Boot or Logon Autostart Execution", 0.06315695977013781], ["Unsecured Credentials", 0.03532537870305026], ["Indicator Removal", 0.017305901336802505], ["OS Credential Dumping", 0.016547820332205674]], "JavaScript fetched from the C2 server": [["Web Service", 0.08027151941442104], ["Command and Scripting Interpreter", 0.07141143349398833], ["Browser Session Hijacking", 0.06070114567749102], ["Ingress Tool Transfer", 0.05818872769434464], ["Application Layer Protocol", 0.04886108475350319], ["Deobfuscate/Decode Files or Information", 0.030696931087424828]], "downloaded code chunk": [["Ingress Tool Transfer", 0.20087549831992846], ["Deobfuscate/Decode Files or Information", 0.14318457891826308], ["Obfuscated Files or Information", 0.09357562920734544], ["BITS Jobs", 0.05680415056445576], ["Command and Scripting Interpreter", 0.02814629770645334], ["Web Service", 0.026522996377434018]], "GET request with C2 server": [["Application Layer Protocol", 0.31137629079369067], ["Exfiltration Over C2 Channel", 0.10535621876877453], ["Fallback Channels", 0.06645067099235828], ["Web Service", 0.06630853884813698], ["Data Encoding", 0.04077256314253853], ["Non-Application Layer Protocol", 0.024924425491681296]], "Process Hollowing \u2013 one of the classic methods of PE injection": [["Process Injection", 0.35939544462333955], ["Native API", 0.036694491083616984], ["Command and Scripting Interpreter", 0.02365370199089281], ["Exploit Public-Facing Application", 0.01571873151999964], ["Obfuscated Files or Information", 0.015165716106570743], ["Event Triggered Execution", 0.013241470723632711]], "PE injection, manual loading into the parent process": [["Process Injection", 0.6803206497327736], ["Native API", 0.0857937192989799], ["Hijack Execution Flow", 0.03037369863709022], ["Access Token Manipulation", 0.02071734505933953], ["System Binary Proxy Execution", 0.020427265626092414], ["Event Triggered Execution", 0.01864812667047071]], "fetches IcedID from a remote resource": [["Access Token Manipulation", 0.15581325275854888], ["Steal or Forge Kerberos Tickets", 0.09007053691147794], ["System Owner/User Discovery", 0.034645187528391214], ["Event Triggered Execution", 0.028502942191001527], ["Use Alternate Authentication Material", 0.024900579121475804], ["Windows Management Instrumentation", 0.01708750249259668]], "Malicious OneNote attachment": [["User Execution", 0.18075437667162067], ["Phishing", 0.17300838295508142], ["Template Injection", 0.07463864653451094], ["Office Application Startup", 0.037440890677981974], ["Masquerading", 0.03339943193143083], ["Ingress Tool Transfer", 0.024201462351953817]], "The \u201cForked\u201d version of the malware loader first appeared in February 2023, distributed directly through thousands of personalized invoice-themed phishing emails.": [["User Execution", 0.15492986177793247], ["Phishing", 0.08503564699520616], ["Office Application Startup", 0.04376627311761376], ["Drive-by Compromise", 0.03956545010462285], ["Masquerading", 0.03667169641224825], ["Obfuscated Files or Information", 0.035041485102205776]], "These messages used Microsoft\u00a0OneNote attachments\u00a0(.one) to execute a malicious HTA file": [["User Execution", 0.15504770310816407], ["Phishing", 0.09246356484445738], ["Office Application Startup", 0.07121412014281596], ["Template Injection", 0.05846978880030804], ["Masquerading", 0.03808570086197821], ["Obfuscated Files or Information", 0.03043168360202469]], "string-decryption code": [["Deobfuscate/Decode Files or Information", 0.6432208192330224], ["Obfuscated Files or Information", 0.1473427453326824], ["Encrypted Channel", 0.03269290806989306], ["Data Encoding", 0.02802685050870292], ["Archive Collected Data", 0.024531800545710254], ["Data Encrypted for Impact", 0.019786058027450357]], "sending basic host info to the C2": [["Exfiltration Over C2 Channel", 0.14553579427869787], ["Application Layer Protocol", 0.12163987588178601], ["Web Service", 0.10559605838210685], ["System Information Discovery", 0.0682366006805564], ["Dynamic Resolution", 0.04624783973191148], ["Fallback Channels", 0.03742491187436871]], "took place over an unencrypted HTTP channel, the network traffic was plainly visible.": [["Network Sniffing", 0.12371144747220103], ["Application Layer Protocol", 0.11000535466342672], ["Data Obfuscation", 0.09259273269249962], ["Encrypted Channel", 0.07005391358356815], ["Non-Application Layer Protocol", 0.05690783667898315], ["Non-Standard Port", 0.054850314603797704]], "When the user double clicks or opens the lnk file,": [["Boot or Logon Autostart Execution", 0.25056539355538093], ["Office Application Startup", 0.05973081384333557], ["Masquerading", 0.05434395204505851], ["User Execution", 0.04673404920670339], ["Event Triggered Execution", 0.04301546945088132], ["Modify Registry", 0.03312559179143045]], "lures the user to open a document.lnk file which will execute the malicious DLL loader": [["System Binary Proxy Execution", 0.23604199182117672], ["Hijack Execution Flow", 0.1786549221006264], ["Shared Modules", 0.08217777215717668], ["Boot or Logon Autostart Execution", 0.05585600102959208], ["User Execution", 0.04686257174258151], ["Event Triggered Execution", 0.04014311683088689]], "The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks": [["Deobfuscate/Decode Files or Information", 0.07209125719480816], ["Ingress Tool Transfer", 0.07198294210356483], ["Obfuscated Files or Information", 0.07045864919358757], ["Command and Scripting Interpreter", 0.06571426114481893], ["Archive Collected Data", 0.0489602105676076], ["OS Credential Dumping", 0.03675216796430599]], "starts a hidden file in the directory": [["Hide Artifacts", 0.5514028826260711], ["Masquerading", 0.12946512122952217], ["Indicator Removal", 0.021517034643546908], ["File and Directory Discovery", 0.020662305943906976], ["Obfuscated Files or Information", 0.020164718923183517], ["Data Staged", 0.018804675008397057]], "then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).": [["Process Injection", 0.7971319598925494], ["Native API", 0.05007904009261498], ["System Binary Proxy Execution", 0.014297640124208895], ["Hijack Execution Flow", 0.01198500083223386], ["Event Triggered Execution", 0.010429560161219943], ["Access Token Manipulation", 0.0062878110800842395]], "From these injected processes,": [["Process Injection", 0.5875441878462999], ["Process Discovery", 0.1165813864947283], ["Native API", 0.09784231276329523], ["Create or Modify System Process", 0.014935397220494011], ["Access Token Manipulation", 0.013364317552086986], ["System Services", 0.010004063225101369]], "the different processes they injected into": [["Process Injection", 0.3742861327092288], ["Process Discovery", 0.27767926250026786], ["Native API", 0.0920238165697827], ["Windows Management Instrumentation", 0.01732666423431758], ["Software Discovery", 0.014910520365021029], ["Virtualization/Sandbox Evasion", 0.014144136293022126]], "a process where Cobalt Strike was injected into": [["Process Injection", 0.3162498651989338], ["Event Triggered Execution", 0.03380649832553579], ["Command and Scripting Interpreter", 0.03208014105445547], ["Native API", 0.027648022540405996], ["Scheduled Task/Job", 0.026760955860039477], ["System Services", 0.024482539842318816]], "The process injection technique was used multiple times to inject into different processes": [["Process Injection", 0.8104569509278547], ["Native API", 0.056228566389879275], ["Process Discovery", 0.01313917893025948], ["Hijack Execution Flow", 0.010594668587058167], ["Create or Modify System Process", 0.01044052407504163], ["Access Token Manipulation", 0.009893545347822632]], "Almost every post-exploitation job was launched from an injected process.": [["Process Injection", 0.41243511127303706], ["Process Discovery", 0.08836314453142817], ["Native API", 0.046657242080528946], ["Scheduled Task/Job", 0.03339088492950154], ["Create or Modify System Process", 0.031285392020339024], ["Event Triggered Execution", 0.023609699132859895]], "a process where the threat actors injected:": [["Process Injection", 0.367033080527116], ["Process Discovery", 0.050859235299201506], ["Access Token Manipulation", 0.039544617374929446], ["Native API", 0.020556904302288653], ["Impair Defenses", 0.019765906601309197], ["Create or Modify System Process", 0.01958126681225575]], "where they were previously injected into": [["Ingress Tool Transfer", 0.05598601651531656], ["Process Injection", 0.05270284824082603], ["Hijack Execution Flow", 0.03145698383100768], ["Boot or Logon Autostart Execution", 0.02395145618843346], ["Office Application Startup", 0.022619474849495745], ["Command and Scripting Interpreter", 0.02224983244905974]], "Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account": [["Remote Services", 0.41808623710955095], ["Valid Accounts", 0.09582202345007428], ["Remote Service Session Hijacking", 0.08115282129233324], ["Remote Access Software", 0.059320627226566364], ["External Remote Services", 0.031343499645276655], ["Lateral Tool Transfer", 0.02273427405885151]], "previously injected into": [["Process Injection", 0.16043952730463568], ["Event Triggered Execution", 0.05477687961161331], ["Command and Scripting Interpreter", 0.037477911765499757], ["Exploit Public-Facing Application", 0.025205494301932294], ["Office Application Startup", 0.02476731389160643], ["Pre-OS Boot", 0.024703881249516942]], "Process injections in svchost process via CreateRemoteThread, Default named pipes, etc": [["Process Injection", 0.700402584895172], ["Native API", 0.08791747215780749], ["Process Discovery", 0.029303262650670393], ["Access Token Manipulation", 0.018832820298282812], ["Create or Modify System Process", 0.013457671834122773], ["Impair Defenses", 0.011046663962104452]], "processes which threat actors injected into:": [["Process Injection", 0.3244322947654312], ["Process Discovery", 0.1819712052216878], ["Impair Defenses", 0.04327443713620463], ["Access Token Manipulation", 0.020329412334857293], ["Native API", 0.02031895293805957], ["Windows Management Instrumentation", 0.015536019527430441]], "After injecting into various processes on the host,": [["Process Injection", 0.8006508821148587], ["Native API", 0.031007292263088418], ["Process Discovery", 0.017790305571676927], ["Create or Modify System Process", 0.006923087945487664], ["Event Triggered Execution", 0.006730876320107435], ["Access Token Manipulation", 0.00646010962115278]], "various injections across hosts": [["Exploit Public-Facing Application", 0.07901723882769153], ["Process Injection", 0.07739812114105625], ["Command and Scripting Interpreter", 0.05050443770179715], ["Inter-Process Communication", 0.045167547305145994], ["Native API", 0.04076829891896335], ["Server Software Component", 0.02689099805321526]], "injected into multiple processes on different hosts.": [["Process Injection", 0.5576337414643755], ["Native API", 0.06153216824216036], ["Process Discovery", 0.04312655706892034], ["Access Token Manipulation", 0.019104202497095105], ["System Services", 0.01832348357483336], ["Windows Management Instrumentation", 0.016256852140688994]], "the threat actors began discovery tasks using Windows utilities": [["Windows Management Instrumentation", 0.12756998824636193], ["Remote System Discovery", 0.06402935087499645], ["Impair Defenses", 0.041547614577464524], ["File and Directory Discovery", 0.03933369819486726], ["Automated Collection", 0.03453797613069136], ["Software Discovery", 0.03407408120349089]], "These batch scripts\u2019 purposes": [["Command and Scripting Interpreter", 0.651634519448378], ["Scheduled Task/Job", 0.0449896592903205], ["System Binary Proxy Execution", 0.024592296838516065], ["Windows Management Instrumentation", 0.017736938115404558], ["Indirect Command Execution", 0.011107733462822423], ["System Services", 0.011013292825053145]], "then two batch scripts were dropped and run.": [["Command and Scripting Interpreter", 0.37463331578036746], ["Scheduled Task/Job", 0.0767407719399897], ["Indicator Removal", 0.05759222856170176], ["System Binary Proxy Execution", 0.032488298539537344], ["System Services", 0.022115995247167498], ["Windows Management Instrumentation", 0.021249366136503866]], "using the following command line:\n\n\nC:\\Windows\\System32\\cmd.exe /c": [["Native API", 0.14830993352960167], ["File and Directory Discovery", 0.10932883439560119], ["Windows Management Instrumentation", 0.06427489187633993], ["Masquerading", 0.06352619254929238], ["System Information Discovery", 0.051020189647433406], ["Application Window Discovery", 0.04749773762009836]], "C:\\Windows\\system32\\cmd.exe /C powershell.exe -nop -w hidden -c": [["Hide Artifacts", 0.31040114666738666], ["Masquerading", 0.11438111252981371], ["Command and Scripting Interpreter", 0.07188559806041854], ["Native API", 0.027737220682349004], ["System Binary Proxy Execution", 0.02729006768463514], ["Indicator Removal", 0.022972518680219708]], "launching the getsystem command in the wrong console (shell console rather than the beacon console).": [["System Information Discovery", 0.4328242676794621], ["File and Directory Discovery", 0.08088988021467013], ["Virtualization/Sandbox Evasion", 0.07284486740887508], ["OS Credential Dumping", 0.02775668391053884], ["Native API", 0.02467845737255878], ["Hide Artifacts", 0.022800148971988187]], "C:\\Windows\\system32\\cmd.exe /C getsystem": [["System Information Discovery", 0.4916725470047078], ["File and Directory Discovery", 0.14677942545154266], ["Windows Management Instrumentation", 0.03299163295465252], ["Virtualization/Sandbox Evasion", 0.03259977977157596], ["Native API", 0.03076746048887092], ["OS Credential Dumping", 0.018263852219905802]], "cmd.exe /C": [["Command and Scripting Interpreter", 0.16781719469262], ["Native API", 0.1287862846004426], ["System Binary Proxy Execution", 0.0818180231744525], ["Masquerading", 0.070178780850974], ["Indirect Command Execution", 0.04676183718783553], ["Windows Management Instrumentation", 0.02878834138420436]], "C :\\Windows\\system32\\cmd.exe /C shell": [["Command and Scripting Interpreter", 0.145112020811966], ["Native API", 0.113907363589431], ["File and Directory Discovery", 0.06275867843938769], ["Windows Management Instrumentation", 0.04838027011508693], ["Masquerading", 0.0414842568403662], ["Boot or Logon Autostart Execution", 0.034268066382243965]], "Threat actors used two scripts named s.bat (for servers) and w.bat": [["Command and Scripting Interpreter", 0.47297795167372253], ["Scheduled Task/Job", 0.05879874428974411], ["System Binary Proxy Execution", 0.0382283534982619], ["System Services", 0.034613583531655896], ["Windows Management Instrumentation", 0.030514198791018673], ["Masquerading", 0.024130190818456198]], "bat script:": [["Command and Scripting Interpreter", 0.8132294384460479], ["Scheduled Task/Job", 0.018999426405510444], ["System Binary Proxy Execution", 0.01575954710048047], ["Native API", 0.011900445786431318], ["Windows Management Instrumentation", 0.007430487381129209], ["Indirect Command Execution", 0.007133111221152184]], "using Windows utilities like ping and tasklist.": [["System Network Connections Discovery", 0.22737352807968675], ["Remote System Discovery", 0.11281219507326286], ["System Network Configuration Discovery", 0.08305524246142865], ["System Information Discovery", 0.05417225112267195], ["Process Discovery", 0.05070773020000567], ["Network Service Discovery", 0.04566898423999799]], "tasklist was also used in order to enumerate processes on multiple hosts remotely": [["Process Discovery", 0.7968973556301449], ["Windows Management Instrumentation", 0.024234735229312142], ["System Service Discovery", 0.015563491582145799], ["System Network Connections Discovery", 0.015150972850951332], ["Network Service Discovery", 0.01135377797036489], ["Remote System Discovery", 0.009019258734889365]], "process list": [["Process Discovery", 0.8105984309967991], ["System Service Discovery", 0.01537156431967578], ["Process Injection", 0.015016257968204936], ["Native API", 0.0141787706677054], ["Impair Defenses", 0.01191674489847881], ["Windows Management Instrumentation", 0.01045672794153869]], "the threat actor started their first lateral movement using RDP": [["Remote Services", 0.6265704136665907], ["Remote Service Session Hijacking", 0.07707864291905779], ["Remote Access Software", 0.06084458329339847], ["Exploitation of Remote Services", 0.04080601485165182], ["Valid Accounts", 0.01231266293748172], ["External Remote Services", 0.011735954737300741]], "they accessed the server via RDP": [["Remote Services", 0.37750797437796535], ["Remote Access Software", 0.042836403745895646], ["Remote Service Session Hijacking", 0.040266106966614174], ["External Remote Services", 0.03622807241378969], ["System Owner/User Discovery", 0.03535944905646562], ["Valid Accounts", 0.03255427319247151]], "Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:": [["Remote Services", 0.4781666694374313], ["Remote Service Session Hijacking", 0.057180769144372645], ["External Remote Services", 0.051376089970323065], ["Proxy", 0.04121633713015364], ["Remote Access Software", 0.03011769143767149], ["Protocol Tunneling", 0.019871198536840634]], "the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.": [["Remote Services", 0.3358173752090948], ["Valid Accounts", 0.12138313372967398], ["Remote Service Session Hijacking", 0.09581085132136781], ["Remote Access Software", 0.057114858314057805], ["Lateral Tool Transfer", 0.02595988542335], ["External Remote Services", 0.020515784189869764]], "the first lateral movement from the beachhead to the server using RDP with an Administrator account:": [["Remote Services", 0.558602451425998], ["Remote Access Software", 0.05451189402951764], ["Remote Service Session Hijacking", 0.054217925633955194], ["Valid Accounts", 0.037823393675360015], ["Lateral Tool Transfer", 0.024965204647490937], ["External Remote Services", 0.019105325815869444]], "and again on a server with Administrator privileges.": [["Indicator Removal", 0.05883659673067309], ["Impair Defenses", 0.03984363127224596], ["File and Directory Permissions Modification", 0.037985665782768935], ["Server Software Component", 0.029925330641401057], ["Scheduled Task/Job", 0.02768260953275465], ["Account Access Removal", 0.02553763107898196]], "using the Administrator account each time": [["Create Account", 0.19793039979712596], ["Valid Accounts", 0.17961561995789238], ["Abuse Elevation Control Mechanism", 0.08807154722900454], ["Account Manipulation", 0.07665899351048866], ["Access Token Manipulation", 0.03747616100568529], ["Account Discovery", 0.027243890101854195]], "to execute Procdump, which was used to dump lsass.": [["OS Credential Dumping", 0.3599032523941639], ["File and Directory Discovery", 0.060703583238016647], ["Data from Local System", 0.0575456357825747], ["Automated Collection", 0.04959137021050874], ["Deobfuscate/Decode Files or Information", 0.04404581721735281], ["Native API", 0.028788348162155225]], "they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.": [["OS Credential Dumping", 0.10332847003875716], ["File and Directory Discovery", 0.09377881223428855], ["Native API", 0.09302396077649598], ["Virtualization/Sandbox Evasion", 0.07958633022753307], ["Deobfuscate/Decode Files or Information", 0.047892950363748334], ["Automated Collection", 0.025033085627927706]], "dumping their LSASS process": [["File and Directory Discovery", 0.1299003075508003], ["OS Credential Dumping", 0.12340286311513235], ["Data from Local System", 0.1174806950312082], ["Data Staged", 0.07203904393405941], ["Indicator Removal", 0.06240048197153629], ["Automated Collection", 0.058714095982409883]], "LSASS Dump": [["OS Credential Dumping", 0.23148760652992373], ["File and Directory Discovery", 0.10823931773842502], ["Automated Collection", 0.0712643784999647], ["Data from Local System", 0.070169748836763], ["Native API", 0.055425303336248795], ["Deobfuscate/Decode Files or Information", 0.03816287183572643]], "Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique": [["Process Discovery", 0.12774102078920063], ["OS Credential Dumping", 0.09521058217302292], ["Process Injection", 0.07739688807087729], ["Native API", 0.07053188666504748], ["Virtualization/Sandbox Evasion", 0.06225072530740025], ["Indicator Removal", 0.05216269195462894]], "C:\\programdata\\procdump64.exe -accepteula -ma lsass.exe C:\\ProgramData\\lsass.dmp": [["File and Directory Discovery", 0.1364151622920907], ["OS Credential Dumping", 0.10566229633723395], ["Data from Local System", 0.08673772157187282], ["Automated Collection", 0.06341186270116526], ["Data Staged", 0.04351271937510984], ["Archive Collected Data", 0.04285940141043323]], "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS,": [["Data from Local System", 0.09240657252368348], ["Indicator Removal", 0.08821994723817986], ["OS Credential Dumping", 0.08728573336650872], ["Automated Collection", 0.06612064020545667], ["Windows Management Instrumentation", 0.040171519567674036], ["Data Staged", 0.03747490242031717]], "Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.": [["Data from Local System", 0.11020696123588711], ["Lateral Tool Transfer", 0.10585988319106458], ["OS Credential Dumping", 0.0742708359515068], ["Data Staged", 0.04879598064124686], ["Data from Network Shared Drive", 0.044281594465212376], ["Remote Services", 0.03784266490351503]], "Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:": [["Ingress Tool Transfer", 0.19722199846004596], ["Data from Local System", 0.057727076003155096], ["Exfiltration Over C2 Channel", 0.042090423061848715], ["Data Staged", 0.03816087670748367], ["Lateral Tool Transfer", 0.02886470952760618], ["Command and Scripting Interpreter", 0.025955677135840096]], "The threat actors also transferred ProcDump from the beachhead to multiple workstations:": [["Lateral Tool Transfer", 0.08429753320704104], ["Data from Local System", 0.07485466500807925], ["Transfer Data to Cloud Account", 0.04550870665768507], ["Exfiltration Over C2 Channel", 0.04086558988221459], ["Data Staged", 0.0397861097160645], ["Exfiltration Over Alternative Protocol", 0.03707366617329783]], "This first lateral movement was performed in order to drop and install AnyDesk.": [["Indicator Removal", 0.08786742763737038], ["Masquerading", 0.047488160623738306], ["Inhibit System Recovery", 0.04015553890583282], ["Deobfuscate/Decode Files or Information", 0.020898294440192873], ["Modify System Image", 0.020626294610889], ["Compromise Client Software Binary", 0.019872261545664897]], "threat actors remotely dropped AnyDesk binary on a server from the beachhead:": [["Ingress Tool Transfer", 0.060237576453960696], ["Inter-Process Communication", 0.043925568792961216], ["Obfuscated Files or Information", 0.03285429455208786], ["Escape to Host", 0.031136119239928987], ["BITS Jobs", 0.027762002173237873], ["Deobfuscate/Decode Files or Information", 0.0272703795987245]], "used PowerShell to download and execute": [["Command and Scripting Interpreter", 0.4286109520315668], ["Ingress Tool Transfer", 0.37635929273397334], ["System Binary Proxy Execution", 0.023368341795452142], ["BITS Jobs", 0.018723908017403906], ["Scheduled Task/Job", 0.008788600419822563], ["Inter-Process Communication", 0.007061095882943926]], "which downloaded obfuscated PowerShell and executed it in memory:": [["Obfuscated Files or Information", 0.46856412039832496], ["Command and Scripting Interpreter", 0.11859921308024902], ["Deobfuscate/Decode Files or Information", 0.1005105562204706], ["System Binary Proxy Execution", 0.05110285733744559], ["Process Injection", 0.0218742789230413], ["Native API", 0.019937795814164265]], "just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon": [["Fallback Channels", 0.15280687673997315], ["Web Service", 0.06466510314189788], ["Exfiltration Over C2 Channel", 0.045723106119748315], ["Scheduled Transfer", 0.04441509999269623], ["Encrypted Channel", 0.038572459350189374], ["Dynamic Resolution", 0.03252341022675898]], "dropping and the execution of several payloads using multiple techniques": [["Command and Scripting Interpreter", 0.08777186614687424], ["System Binary Proxy Execution", 0.05938204453660391], ["Deobfuscate/Decode Files or Information", 0.04484025224172881], ["Indicator Removal", 0.04301882930236809], ["Obfuscated Files or Information", 0.04285013681197956], ["Execution Guardrails", 0.030854116751133087]], "threat actors used CS as the main Command and Control tool, dropped several payloads,": [["Obtain Capabilities", 0.06642678011977346], ["Ingress Tool Transfer", 0.05181289582725087], ["Develop Capabilities", 0.049529588662316576], ["Stage Capabilities", 0.049327515464736425], ["Command and Scripting Interpreter", 0.04291424751668304], ["Inter-Process Communication", 0.041515227062815664]], "the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.": [["System Services", 0.06856185366645395], ["Web Service", 0.03895045248488775], ["Remote Access Software", 0.027044852807552335], ["Steal or Forge Kerberos Tickets", 0.026322674278910472], ["Remote System Discovery", 0.024216735488640895], ["Access Token Manipulation", 0.024102727489791458]], "C:\\Windows\\System32\\cmd.exe /c start rundll32 namr.dll,IternalJob": [["System Binary Proxy Execution", 0.31799832248427123], ["Hijack Execution Flow", 0.15488542636425334], ["System Services", 0.06312393789660985], ["Native API", 0.05950492997661374], ["Boot or Logon Autostart Execution", 0.055996571100211806], ["Event Triggered Execution", 0.05128300431962862]], "Sysmon File Created event showing wab.exe created by rundll32.exe": [["Event Triggered Execution", 0.10650355274252224], ["Native API", 0.09035847913078357], ["Windows Management Instrumentation", 0.08795699178570292], ["Masquerading", 0.06634518651045844], ["Create or Modify System Process", 0.03857264794141715], ["System Binary Proxy Execution", 0.03638032414679896]], "cmd.exe /C rundll32.exe": [["System Binary Proxy Execution", 0.34743053333732776], ["Native API", 0.13378716186200035], ["System Services", 0.06420804376520896], ["Command and Scripting Interpreter", 0.05986317065467588], ["Hijack Execution Flow", 0.04131890197466207], ["Event Triggered Execution", 0.027322256050156864]], "C:\\Windows\\System32\\rundll32.exe": [["System Binary Proxy Execution", 0.25533171335958627], ["Native API", 0.1663107991508699], ["Hijack Execution Flow", 0.09069242443767357], ["Masquerading", 0.06978015638348672], ["Process Injection", 0.034057798128471255], ["Windows Management Instrumentation", 0.030042305804131236]], "Because rundll32.exe executed PowerShell, we can see that rundll32.exe created": [["Native API", 0.22266092081389458], ["System Binary Proxy Execution", 0.12094009684687142], ["Windows Management Instrumentation", 0.08174958397056441], ["Process Discovery", 0.05101666314645307], ["Virtualization/Sandbox Evasion", 0.03587114047885897], ["Process Injection", 0.03278567304426878]], "were initiated from the rundll32.exe process": [["Native API", 0.31745399300114013], ["Process Injection", 0.11508700512117548], ["System Binary Proxy Execution", 0.09753596707063501], ["Process Discovery", 0.09185042442575729], ["Windows Management Instrumentation", 0.03556594682281338], ["Access Token Manipulation", 0.029595539781527763]], "The random (PsExec) service runs a rundll32.exe process without any arguments.": [["System Binary Proxy Execution", 0.15809506255925634], ["Native API", 0.15213988022497615], ["System Services", 0.11951933347904625], ["Create or Modify System Process", 0.0812815109783426], ["Process Injection", 0.05865241676057796], ["Masquerading", 0.05016666750190158]], "The metadata included TA machine\u2019s hostname,": [["System Information Discovery", 0.3901999783439543], ["Remote System Discovery", 0.08638286896214599], ["System Network Configuration Discovery", 0.06433901081800718], ["System Owner/User Discovery", 0.03406859190065216], ["Windows Management Instrumentation", 0.02850672274118832], ["Automated Collection", 0.028024646797767852]], "wmic product get name,version": [["System Information Discovery", 0.3434002262468772], ["Windows Management Instrumentation", 0.18550295304697878], ["Software Discovery", 0.09213661767798902], ["Query Registry", 0.060890626067537944], ["Masquerading", 0.031814224744505126], ["File and Directory Discovery", 0.021522615158164754]], "\u201cDisplay information about current Windows version": [["System Information Discovery", 0.763217135190544], ["Software Discovery", 0.02929152553099816], ["Query Registry", 0.02118416397032666], ["File and Directory Discovery", 0.017460943811156555], ["Virtualization/Sandbox Evasion", 0.01713908103642518], ["Windows Management Instrumentation", 0.01666211393779253]], "MAC address": [["System Network Configuration Discovery", 0.30409495893765115], ["Adversary-in-the-Middle", 0.06325704694079802], ["Remote System Discovery", 0.045471086112625285], ["Data from Configuration Repository", 0.041896837720313704], ["Dynamic Resolution", 0.03147177923774264], ["System Information Discovery", 0.017052427089359813]], "showing wab.exe executed by WMI": [["Windows Management Instrumentation", 0.7278312601590486], ["Event Triggered Execution", 0.024537450211606873], ["System Information Discovery", 0.018226528938629284], ["Application Window Discovery", 0.014107647217956577], ["Native API", 0.013355644358321728], ["Virtualization/Sandbox Evasion", 0.013335270764901536]], "wmic /node": [["Windows Management Instrumentation", 0.6718183057743019], ["Command and Scripting Interpreter", 0.02392687074913851], ["Event Triggered Execution", 0.01640879707541914], ["OS Credential Dumping", 0.013154648349538053], ["Native API", 0.012950856875812267], ["Remote Services", 0.011499305934112492]], "obfuscated PowerShell": [["Obfuscated Files or Information", 0.7727749739935958], ["Deobfuscate/Decode Files or Information", 0.05657783406626626], ["Command and Scripting Interpreter", 0.01294683631615313], ["Execution Guardrails", 0.011560344270569527], ["Masquerading", 0.010282942042669238], ["Hide Artifacts", 0.008897635208453786]], "Once deobfuscated,": [["Deobfuscate/Decode Files or Information", 0.5009039814858406], ["Obfuscated Files or Information", 0.1331490011657365], ["Archive Collected Data", 0.0376120588827941], ["Indicator Removal", 0.023447414129319572], ["Hide Artifacts", 0.016501628448296876], ["Exfiltration Over Alternative Protocol", 0.013707444814200975]], "its installation as a service was used in order to persist and create a backdoor to the network.": [["Create or Modify System Process", 0.3592961413848773], ["System Services", 0.04289362765241915], ["Masquerading", 0.03194866960521647], ["Cloud Service Discovery", 0.028737585477916817], ["Boot or Logon Autostart Execution", 0.02856978207347685], ["System Service Discovery", 0.027100376444513043]], "the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.": [["System Services", 0.31504970827839723], ["Create or Modify System Process", 0.08594823290668839], ["Native API", 0.04891406399752781], ["System Service Discovery", 0.041992592581086084], ["Masquerading", 0.03964404741127406], ["Remote Services", 0.03142475064205954]], "a remote service was created with random alphanumeric characters, service name and service file name": [["Masquerading", 0.20437116440308137], ["System Service Discovery", 0.17049757037928073], ["System Services", 0.14482187624539797], ["Create or Modify System Process", 0.1272738495404824], ["Cloud Service Discovery", 0.026341668611542527], ["Native API", 0.022241399698572875]], "Below is an example of the service edc603a that was created": [["Create or Modify System Process", 0.21394950033903626], ["System Services", 0.1191834296278029], ["System Service Discovery", 0.07871657655165797], ["Cloud Service Discovery", 0.031117092679383566], ["Service Stop", 0.030275788597148672], ["Masquerading", 0.0297515690849558]], "A new service was created": [["Create or Modify System Process", 0.4102655797136038], ["System Services", 0.23197955953286706], ["System Service Discovery", 0.08749886859986739], ["Cloud Service Discovery", 0.02452801388020387], ["Service Stop", 0.02313829662933531], ["Masquerading", 0.021527836080512862]], "Threat actors obtained and abused credentials of privilege domain accounts": [["Valid Accounts", 0.41687072299892947], ["Modify Authentication Process", 0.060539881533698985], ["Account Manipulation", 0.05078827716534707], ["Brute Force", 0.03970858362819381], ["OS Credential Dumping", 0.02660447133905477], ["Create Account", 0.022773285563138266]], "A service account, with Domain Administration permissions, was used to create a remote service on a Domain Controller to move laterally.": [["Valid Accounts", 0.16233481631943267], ["Remote Services", 0.10755489157558475], ["System Services", 0.060093435510842445], ["Domain Policy Modification", 0.038224611303613425], ["Masquerading", 0.0368895631000241], ["Access Token Manipulation", 0.03668509247900066]], "the service account logged into one of the Domain Controllers from the beachhead.": [["Account Discovery", 0.28856088956315873], ["Valid Accounts", 0.08048429969489106], ["OS Credential Dumping", 0.05203190227614979], ["Create Account", 0.04619843556901297], ["System Owner/User Discovery", 0.04133873615478792], ["Account Manipulation", 0.0367649623439468]], "We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.": [["Indicator Removal", 0.5170201002312935], ["Impair Defenses", 0.03567334475680662], ["Data Destruction", 0.031104232001924078], ["Windows Management Instrumentation", 0.026556513934224604], ["System Shutdown/Reboot", 0.022166907646404017], ["Inhibit System Recovery", 0.018365633202976798]], "ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:": [["Indicator Removal", 0.35456703018785246], ["Inhibit System Recovery", 0.07713695270350493], ["Data from Local System", 0.03758501307141944], ["Data Destruction", 0.03553532418010573], ["Disk Wipe", 0.028936207328555244], ["Data Staged", 0.02867129545481986]], "Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:": [["Indicator Removal", 0.3994096002426445], ["Inhibit System Recovery", 0.04659813215033646], ["Masquerading", 0.03072088468824224], ["Hide Artifacts", 0.030288550513611994], ["Data from Local System", 0.029908477699548616], ["Windows Management Instrumentation", 0.027991798197910367]], "whoami": [["System Owner/User Discovery", 0.12524448758443332], ["Windows Management Instrumentation", 0.02758306197171263], ["Event Triggered Execution", 0.021521022130827506], ["Gather Victim Identity Information", 0.017078191023881764], ["Account Discovery", 0.016935553995028232], ["Web Service", 0.01523409285170391]], "C :\\Windows\\system32\\cmd.exe /C shell whoami /all": [["System Owner/User Discovery", 0.30273419453769246], ["Account Discovery", 0.08615598716520194], ["Windows Management Instrumentation", 0.04902858853959046], ["Query Registry", 0.045990553290763944], ["File and Directory Discovery", 0.0434321715378326], ["System Information Discovery", 0.04035061380570115]], "the win32 function CreateServiceA was used by the malware": [["Create or Modify System Process", 0.20553366105256185], ["System Services", 0.17566552866824556], ["Masquerading", 0.10876093061848896], ["Native API", 0.08795451578250835], ["System Binary Proxy Execution", 0.061239978796931126], ["Hijack Execution Flow", 0.04952845942918584]], "The account used to perform this lateral movement": [["Valid Accounts", 0.20897710750414622], ["Remote Services", 0.058366665695386934], ["Account Manipulation", 0.04386385300858292], ["Remote Service Session Hijacking", 0.033039725116114374], ["Account Discovery", 0.029382090358578125], ["Establish Accounts", 0.027951776309704236]], "Threat actors executed this tool on patient 0 with low-level privileges multiple times": [["Access Token Manipulation", 0.07347018113545559], ["Abuse Elevation Control Mechanism", 0.05486123879900509], ["Domain Policy Modification", 0.04831315739099941], ["Valid Accounts", 0.04753735575658985], ["Permission Groups Discovery", 0.03499463803075551], ["Command and Scripting Interpreter", 0.034827222722611476]], "The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.": [["Event Triggered Execution", 0.10123274597745838], ["Boot or Logon Autostart Execution", 0.04911828935784556], ["External Remote Services", 0.048673478344623836], ["Scheduled Task/Job", 0.044380462848293806], ["Pre-OS Boot", 0.04189471922364414], ["Boot or Logon Initialization Scripts", 0.03690771091410703]], "they accessed the server via Anydesk.": [["Exploit Public-Facing Application", 0.08636596370199603], ["Server Software Component", 0.08150621068517148], ["Compromise Infrastructure", 0.06924547973987832], ["External Remote Services", 0.03610751158548849], ["Fallback Channels", 0.02896946011478804], ["Acquire Infrastructure", 0.02538870955202172]], "AnyDesk and its installation as a service was used": [["Create or Modify System Process", 0.22864926711171235], ["System Services", 0.07327963835249103], ["Masquerading", 0.06566608152927111], ["System Service Discovery", 0.06496971908427168], ["Boot or Logon Autostart Execution", 0.031695670408457326], ["System Binary Proxy Execution", 0.028835169586610008]], "AnyDesk logs, %ProgramData%\\AnyDesk\\ad_svc.trace and %AppData%\\AnyDesk\\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion": [["Impair Defenses", 0.10769673432217428], ["Indicator Removal", 0.09991846040335846], ["Automated Collection", 0.09869698837416332], ["System Network Connections Discovery", 0.028766919824837794], ["Active Scanning", 0.027261116470675497], ["Process Discovery", 0.026492640566350364]], "The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.": [["Acquire Infrastructure", 0.050460279670926866], ["Stage Capabilities", 0.03633307138458548], ["Pre-OS Boot", 0.028958247474282186], ["Subvert Trust Controls", 0.024961846353391083], ["Account Manipulation", 0.024127840737180613], ["Phishing", 0.018242092480119595]], "Threat actors also created a remote thread in svchost.exe": [["Process Injection", 0.10475180259596498], ["Process Discovery", 0.08759723615636181], ["Remote Services", 0.06607420191970545], ["Access Token Manipulation", 0.06441763523244275], ["Windows Management Instrumentation", 0.039988896940564705], ["System Services", 0.03618830770767324]], "Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:": [["Process Injection", 0.3780116118911921], ["Native API", 0.16456804230746674], ["System Binary Proxy Execution", 0.0389009086499317], ["Event Triggered Execution", 0.03776958218041677], ["Process Discovery", 0.03740708026257393], ["Windows Management Instrumentation", 0.029825068311261405]], "the service account password was weak and cracked offline by threat actors.": [["Brute Force", 0.18137168560848016], ["OS Credential Dumping", 0.10147238964113374], ["Modify Authentication Process", 0.09218598104453497], ["Valid Accounts", 0.06232225665645776], ["Steal or Forge Kerberos Tickets", 0.06053372330131177], ["Password Policy Discovery", 0.0476804130118336]], "Named pipes were created in order to establish communication between CS processes": [["Process Injection", 0.1845353063135633], ["Native API", 0.18413773024460633], ["Non-Application Layer Protocol", 0.04673187602111845], ["Process Discovery", 0.03509625095855323], ["Impair Defenses", 0.02569726113611082], ["Access Token Manipulation", 0.02090953129203366]], "Named piped are commonly used by Cobalt Strike perform various techniques.": [["Command and Scripting Interpreter", 0.06973180500656855], ["Obfuscated Files or Information", 0.05746581625364429], ["Native API", 0.036995514243386984], ["Network Sniffing", 0.03215116799435967], ["Automated Collection", 0.02982980229561285], ["Process Injection", 0.026429749919282892]], "used CMD-based scripts": [["Command and Scripting Interpreter", 0.8669206633624739], ["Indirect Command Execution", 0.01712606067859708], ["System Binary Proxy Execution", 0.012044737566688899], ["Scheduled Task/Job", 0.010253905069023494], ["System Services", 0.006468801672173175], ["Event Triggered Execution", 0.006448289048451053]], "CMD-based scripts": [["Command and Scripting Interpreter", 0.8399026518874129], ["Indirect Command Execution", 0.025234486944451257], ["System Binary Proxy Execution", 0.014791664385524159], ["Scheduled Task/Job", 0.010990276536681661], ["Native API", 0.009180228149323545], ["System Services", 0.008580258231157883]], "gets executed via the \u201cSHELLEXECUTE\u201d.": [["Native API", 0.24714683352526076], ["System Binary Proxy Execution", 0.11199529415790403], ["System Services", 0.07665103611896908], ["Command and Scripting Interpreter", 0.058157942601584814], ["Hijack Execution Flow", 0.05042054457586412], ["Event Triggered Execution", 0.04755951352036176]], "The first .CMD file set seen to use AutoIt in its execution": [["Boot or Logon Autostart Execution", 0.22845586959355657], ["Create or Modify System Process", 0.07327244670009221], ["Command and Scripting Interpreter", 0.07100386272539527], ["Event Triggered Execution", 0.06406719252309721], ["Boot or Logon Initialization Scripts", 0.05568394644344111], ["System Binary Proxy Execution", 0.04758877569103526]], "Each email has an HTML attachment.": [["Email Collection", 0.2858476808088336], ["Phishing", 0.18631740869909952], ["User Execution", 0.049630194439626296], ["Application Layer Protocol", 0.027433506190481776], ["Phishing for Information", 0.019296626079838158], ["Office Application Startup", 0.01669637800149426]], "The email text employs scare tactics, such as evidence of a traffic violation, prompting the user to open the HTML attachment": [["User Execution", 0.41954405948638857], ["Phishing", 0.2840050251622316], ["Phishing for Information", 0.03211336270301991], ["Email Collection", 0.017442632330304915], ["Office Application Startup", 0.017218067287137605], ["Internal Spearphishing", 0.015195096393737987]], "prompting the user to open the HTML attachment": [["User Execution", 0.7356109335217847], ["Phishing", 0.05084145956597718], ["Command and Scripting Interpreter", 0.018239343563496966], ["Ingress Tool Transfer", 0.016562517119762976], ["Template Injection", 0.014482533201125428], ["Office Application Startup", 0.008501699033638298]], "contains some junk code and data in HEX format.": [["Obfuscated Files or Information", 0.22943933289783433], ["Deobfuscate/Decode Files or Information", 0.19300259482750357], ["Archive Collected Data", 0.11989188938665143], ["Data Encoding", 0.06595131411674274], ["Automated Collection", 0.024411439163246697], ["Data from Local System", 0.016042279305111793]], "The\u00a0data blob in HEX decodes": [["Deobfuscate/Decode Files or Information", 0.4230002556833707], ["Obfuscated Files or Information", 0.17484147483531792], ["Data Encoding", 0.11054329987601874], ["Archive Collected Data", 0.06686191418752477], ["Encrypted Channel", 0.020905339256619755], ["Data Obfuscation", 0.019077509558204416]], "slightly obfuscated URL address": [["Obfuscated Files or Information", 0.13434917712300148], ["Data Encoding", 0.1166852608705163], ["Dynamic Resolution", 0.09320590326251471], ["Data Obfuscation", 0.09291666358955612], ["Masquerading", 0.04714790310449038], ["Application Layer Protocol", 0.047020053257370055]], "two base64 encoded data blobs and code instructions for its execution.": [["Obfuscated Files or Information", 0.3876168563842796], ["Deobfuscate/Decode Files or Information", 0.204405817764642], ["Data Encoding", 0.15452042890136142], ["Archive Collected Data", 0.08255818785922042], ["Data Obfuscation", 0.020092727962267704], ["Encrypted Channel", 0.009353474069179251]], "base64 data block execution": [["Obfuscated Files or Information", 0.4274884620059353], ["Deobfuscate/Decode Files or Information", 0.16295003625267832], ["Data Encoding", 0.15466615276806792], ["Data Obfuscation", 0.029041102804285315], ["Archive Collected Data", 0.026575370326421804], ["Encrypted Channel", 0.026177715249510163]], "The first base64 data blob": [["Obfuscated Files or Information", 0.2370691096643823], ["Deobfuscate/Decode Files or Information", 0.212862628183634], ["Data Encoding", 0.12934666075619733], ["Archive Collected Data", 0.11338875584777044], ["Data Transfer Size Limits", 0.02783762795459736], ["Data Obfuscation", 0.022907319699081434]], "All data is then sent back to the attacker's C2": [["Exfiltration Over C2 Channel", 0.289975962678812], ["Data Encoding", 0.06071576449131256], ["Scheduled Transfer", 0.06061193504491247], ["Automated Exfiltration", 0.05807403488928932], ["Application Layer Protocol", 0.051652447711969626], ["Fallback Channels", 0.03238152305383458]], "the attacker's C2 via the HTTP POST method.": [["Application Layer Protocol", 0.45106799544288767], ["Exfiltration Over C2 Channel", 0.06324952443030983], ["Data Encoding", 0.03878960814940932], ["Fallback Channels", 0.03582922212373452], ["Data Obfuscation", 0.026909245596646113], ["Web Service", 0.026642707902616074]], "The C2 is constructed with the victim's enumerated data": [["Exfiltration Over C2 Channel", 0.20586529446965254], ["Automated Collection", 0.08935627718288802], ["Web Service", 0.041892637388023735], ["Data Encoding", 0.04011629246633239], ["Scheduled Transfer", 0.03840739985732254], ["Automated Exfiltration", 0.03199115382597095]], "extract sensitive information,": [["Automated Collection", 0.13397161916616143], ["Data from Local System", 0.11114807977310466], ["Archive Collected Data", 0.08563414216329117], ["Data from Information Repositories", 0.06282396758221241], ["Exfiltration Over C2 Channel", 0.052962848120217995], ["Data Staged", 0.050748284998213655]], "operating system version": [["System Information Discovery", 0.6419309529346017], ["Modify System Image", 0.04959978543522392], ["Software Discovery", 0.029740641603293407], ["Windows Management Instrumentation", 0.0181138136628744], ["Virtualization/Sandbox Evasion", 0.01344119562168547], ["Query Registry", 0.012117899615835415]], "OS architecture (x86 or x64)": [["System Information Discovery", 0.5857612596813189], ["Virtualization/Sandbox Evasion", 0.06857861510056958], ["Modify System Image", 0.035866257253235646], ["Software Discovery", 0.023349293709723135], ["Windows Management Instrumentation", 0.01357770035173345], ["Pre-OS Boot", 0.011035617242664832]], "keyboard layout": [["Input Capture", 0.14753178856121504], ["Encrypted Channel", 0.05018485672896729], ["Weaken Encryption", 0.03431411812271691], ["Deobfuscate/Decode Files or Information", 0.027872579131920604], ["System Information Discovery", 0.027533332132459554], ["Execution Guardrails", 0.019549361092079064]], "Opening the attached \u201cmulta_de_transito_502323.html\u201d file triggers the embedded JavaScript": [["User Execution", 0.1915278324535311], ["Command and Scripting Interpreter", 0.10074126319364844], ["Ingress Tool Transfer", 0.05664397987592252], ["Template Injection", 0.05440576556007748], ["System Binary Proxy Execution", 0.03154543307614675], ["Office Application Startup", 0.02673532604763669]], "download a \u201c.VBS\u201d file": [["Ingress Tool Transfer", 0.43290299213457917], ["Command and Scripting Interpreter", 0.113660845989824], ["BITS Jobs", 0.041347414549095546], ["System Binary Proxy Execution", 0.02849233747507614], ["Data from Local System", 0.020780047522281523], ["Masquerading", 0.01694944783738106]], "It proceeds by downloading the \u201csqlite3.dll\u201d file": [["Ingress Tool Transfer", 0.1906848152374992], ["BITS Jobs", 0.11623873527325343], ["Command and Scripting Interpreter", 0.05600933893753469], ["System Binary Proxy Execution", 0.05512570149671813], ["Deobfuscate/Decode Files or Information", 0.034304670763808075], ["Masquerading", 0.023958655201131718]], "to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys": [["Unsecured Credentials", 0.20917313165768303], ["OS Credential Dumping", 0.1566313222363473], ["Credentials from Password Stores", 0.10697776215028944], ["Email Collection", 0.07504874817948189], ["Account Discovery", 0.03648559474694941], ["Modify Registry", 0.025437802495127847]], "exploiting vulnerable web-facing devices": [["Exploit Public-Facing Application", 0.19028508350324658], ["Stage Capabilities", 0.12906925436535277], ["Drive-by Compromise", 0.0973933560035023], ["Exploitation for Client Execution", 0.06390427569228235], ["Server Software Component", 0.04260070873207512], ["Compromise Infrastructure", 0.03505117922422844]], "exfiltrate proprietary or confidential information,": [["Exfiltration Over Web Service", 0.1533775718464635], ["Exfiltration Over Alternative Protocol", 0.11333881275259784], ["Archive Collected Data", 0.11280858142948452], ["Exfiltration Over C2 Channel", 0.10516103369410693], ["Data from Local System", 0.046982253184667665], ["Data Staged", 0.034682528212004876]], "decrypting a shellcode": [["Deobfuscate/Decode Files or Information", 0.673558274684773], ["Obfuscated Files or Information", 0.14925250142932836], ["Data Encrypted for Impact", 0.02539007703221572], ["Encrypted Channel", 0.023798894830669173], ["Archive Collected Data", 0.01072431868434413], ["Execution Guardrails", 0.010522378425446077]], "starts by decrypting its initial configuration data": [["Deobfuscate/Decode Files or Information", 0.41779991862702015], ["Data Encrypted for Impact", 0.06501826852379496], ["Archive Collected Data", 0.05008517412442923], ["Obfuscated Files or Information", 0.04026164045263286], ["Weaken Encryption", 0.033140003172008034], ["Inhibit System Recovery", 0.028904279702155155]], "It starts its code by decrypting its initial configuration": [["Deobfuscate/Decode Files or Information", 0.5525848899055832], ["Obfuscated Files or Information", 0.0669872169481375], ["Data Encrypted for Impact", 0.040480180070804846], ["Weaken Encryption", 0.023296153095845477], ["Archive Collected Data", 0.020407532041535493], ["Execution Guardrails", 0.017614083579910247]], "the code of the decryption algorithm used by RedLine Stealer to decrypt its initial configuration data": [["Deobfuscate/Decode Files or Information", 0.6848508867506199], ["Obfuscated Files or Information", 0.06970143584311118], ["Data Encrypted for Impact", 0.03105361134779482], ["Archive Collected Data", 0.024811038302911568], ["Weaken Encryption", 0.024187333932124848], ["Encrypted Channel", 0.02347410815236551]], "Once the initial configuration data has been decrypted": [["Deobfuscate/Decode Files or Information", 0.28222132981220677], ["Modify Registry", 0.04986955856196697], ["Weaken Encryption", 0.045080896514823214], ["Inhibit System Recovery", 0.042388724923292855], ["Obfuscated Files or Information", 0.04225723398540757], ["Data Encrypted for Impact", 0.04192498545790666]], "to decrypt the password stored": [["Credentials from Password Stores", 0.11362825461427879], ["Deobfuscate/Decode Files or Information", 0.10632365520706621], ["Brute Force", 0.08874450634073938], ["OS Credential Dumping", 0.08841165374785932], ["Unsecured Credentials", 0.08190374708514075], ["Data Encrypted for Impact", 0.04176653830109652]], "Once the master key is decrypted,": [["Deobfuscate/Decode Files or Information", 0.27684084455550473], ["Data Encrypted for Impact", 0.15357225172813938], ["Weaken Encryption", 0.08436380999695232], ["Encrypted Channel", 0.03367305873866377], ["Execution Guardrails", 0.033195210429192254], ["Service Stop", 0.019167506291148256]], "to decrypt it using AES GCM algorithm": [["Deobfuscate/Decode Files or Information", 0.4872456797449381], ["Encrypted Channel", 0.09232036309172371], ["Data Encrypted for Impact", 0.07999399641770369], ["Obfuscated Files or Information", 0.07735341760653383], ["Archive Collected Data", 0.05354330617681208], ["Weaken Encryption", 0.03471164126871603]], "The decrypted password": [["Credentials from Password Stores", 0.11955826886822768], ["OS Credential Dumping", 0.11521547465490377], ["Unsecured Credentials", 0.11013160652115497], ["Brute Force", 0.10802795827997898], ["Deobfuscate/Decode Files or Information", 0.08086638000463418], ["Password Policy Discovery", 0.047073224284009285]], "Try to disable Windows Defender service \u201cWinDefend\u201d": [["Impair Defenses", 0.24492953629930006], ["Windows Management Instrumentation", 0.03731077225353686], ["Masquerading", 0.036938811831706074], ["Inhibit System Recovery", 0.03090093812541222], ["Indicator Removal", 0.02897675293169413], ["Service Stop", 0.025935635663192066]], "Try to disable Tamper Protection settings of Windows Defender": [["Impair Defenses", 0.12843239500971215], ["Subvert Trust Controls", 0.0651364050492586], ["Modify System Image", 0.04575808497404125], ["Masquerading", 0.03945886892887711], ["Hide Artifacts", 0.0309420236472066], ["File and Directory Permissions Modification", 0.029293720114636577]], "Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender.": [["Impair Defenses", 0.30235319482949224], ["Software Discovery", 0.07331397658155392], ["Masquerading", 0.03233158937778423], ["Windows Management Instrumentation", 0.027902888342949256], ["Event Triggered Execution", 0.022583430660196732], ["Virtualization/Sandbox Evasion", 0.01862516722069363]], "Disable Windows update services such as (\u201cwuauserv\u201d, \u201cWaaSMedicSvc\u201d, \u201cUsoSvc\u201d)": [["Impair Defenses", 0.22882665096064847], ["Service Stop", 0.12074020450702674], ["Masquerading", 0.09563868957566013], ["Create or Modify System Process", 0.03443382956562972], ["Indicator Removal", 0.023331737559555577], ["Rootkit", 0.02028069319436558]], "Disable Automatic Update and change Windows configurations related to Windows Update\u00a0": [["Impair Defenses", 0.10942443602643084], ["Masquerading", 0.07266377748153986], ["Modify System Image", 0.06958446662454576], ["Supply Chain Compromise", 0.03359786546169568], ["Modify Registry", 0.02566563653817062], ["Event Triggered Execution", 0.025477901972322168]], "which is often encoded or encrypted to prevent detection": [["Obfuscated Files or Information", 0.42052542887148775], ["Data Encoding", 0.17458341576589434], ["Deobfuscate/Decode Files or Information", 0.07631283663544086], ["Data Obfuscation", 0.044899169031530205], ["Encrypted Channel", 0.03365448227884941], ["Archive Collected Data", 0.02816302011718064]], "combination of Base64 and XOR functions.": [["Obfuscated Files or Information", 0.4319410478474234], ["Deobfuscate/Decode Files or Information", 0.2616297591001661], ["Data Encoding", 0.07790823925842573], ["Archive Collected Data", 0.03375050708542565], ["Data Obfuscation", 0.023786256777730566], ["Encrypted Channel", 0.020544784974934196]], "The master key is encoded with Base64 and encrypted": [["Deobfuscate/Decode Files or Information", 0.272479414021465], ["Obfuscated Files or Information", 0.09750128488220276], ["Encrypted Channel", 0.0833676579338772], ["Data Encrypted for Impact", 0.05595318995742121], ["Weaken Encryption", 0.05392674634367687], ["Data Encoding", 0.04992740366908822]], "to grab the encoded and encrypted master key": [["Deobfuscate/Decode Files or Information", 0.37342675112750484], ["Unsecured Credentials", 0.07719389954608606], ["Obfuscated Files or Information", 0.06684000057071063], ["Encrypted Channel", 0.04631525532425524], ["Data Encrypted for Impact", 0.04481200598929183], ["Weaken Encryption", 0.039176300713282326]], "it will parse the AES IV (Initialization vector) and the encrypted password": [["Unsecured Credentials", 0.14375546335623343], ["Deobfuscate/Decode Files or Information", 0.11208456266210899], ["OS Credential Dumping", 0.1038461301295707], ["Credentials from Password Stores", 0.09443192881159015], ["Network Sniffing", 0.0524200609220345], ["Password Policy Discovery", 0.048119946266114946]], "to steal information from the compromised or targeted host": [["Data from Local System", 0.21904263978699282], ["Exfiltration Over C2 Channel", 0.10408840645198617], ["Data Staged", 0.05100322932020933], ["Ingress Tool Transfer", 0.04005351882516616], ["Archive Collected Data", 0.03904662822834305], ["Automated Exfiltration", 0.03521619948686186]], "has the ability to collect or extract various types of system information from a targeted or compromised computer": [["System Information Discovery", 0.7488733385284086], ["Windows Management Instrumentation", 0.028044029265827664], ["Virtualization/Sandbox Evasion", 0.021800681662453605], ["Software Discovery", 0.014147780492305263], ["Peripheral Device Discovery", 0.012367642848728067], ["Data from Configuration Repository", 0.011322599710390999]], "func_GetHostSerialNumber()": [["System Information Discovery", 0.11509118154020714], ["System Network Configuration Discovery", 0.08594794688288006], ["Native API", 0.0767549143310376], ["Virtualization/Sandbox Evasion", 0.049313818280873736], ["Query Registry", 0.02703552528447429], ["Automated Collection", 0.026475886960047365]], "host serial number": [["System Information Discovery", 0.47743074772714167], ["Peripheral Device Discovery", 0.04100664935238145], ["Virtualization/Sandbox Evasion", 0.026793072786093827], ["System Network Configuration Discovery", 0.0260282968018739], ["Remote System Discovery", 0.02339222085717568], ["Windows Management Instrumentation", 0.02085563371125562]], "Retrieves\u00a0 system default language, timezone and OS version": [["System Information Discovery", 0.5646768743569578], ["System Time Discovery", 0.07784171373461492], ["Query Registry", 0.03853247669927077], ["System Network Configuration Discovery", 0.031713377757221814], ["System Location Discovery", 0.02625346760760661], ["Virtualization/Sandbox Evasion", 0.025642486289414457]], "Get processor information of the compromised host by executing \"SELECT * FROM Win32_Processor\"": [["System Information Discovery", 0.6864530286766065], ["Virtualization/Sandbox Evasion", 0.06645416654658627], ["Windows Management Instrumentation", 0.035668667930727385], ["Process Discovery", 0.027776363120195543], ["Software Discovery", 0.0244801145447549], ["Native API", 0.010955190011536489]], "func_GetProcessor()": [["Native API", 0.46248783349330613], ["Process Injection", 0.13050423972705288], ["Process Discovery", 0.07208327132866749], ["Virtualization/Sandbox Evasion", 0.04008310400595869], ["System Information Discovery", 0.02369044487133924], ["Windows Management Instrumentation", 0.016390628660972767]], "func_GetLanguageTimeZoneOsVersion()": [["System Information Discovery", 0.263327402768191], ["System Location Discovery", 0.09496558664196271], ["System Time Discovery", 0.05255252578351282], ["Virtualization/Sandbox Evasion", 0.03745927316066143], ["Native API", 0.036968499429794875], ["Query Registry", 0.0332422308990337]], "func_GetGraphicCards": [["Screen Capture", 0.07839013982743778], ["Obfuscated Files or Information", 0.058427446682081705], ["Masquerading", 0.043623491258989455], ["Native API", 0.03786393324997118], ["Build Image on Host", 0.036164456124502246], ["File and Directory Discovery", 0.02872049084362943]], "Get AdapterRAM and Graphic Card Name and type by executing\u00a0 \"root\\\\CIMV2\", \"SELECT * FROM Win32_VideoController\"": [["System Information Discovery", 0.46382995812532535], ["Virtualization/Sandbox Evasion", 0.08646317597480782], ["Peripheral Device Discovery", 0.04006274443754323], ["Windows Management Instrumentation", 0.038991364734878985], ["Software Discovery", 0.02571486974659835], ["System Network Configuration Discovery", 0.021301492748561825]], "func_GetTotalRAM()": [["System Information Discovery", 0.0959386321166495], ["Virtualization/Sandbox Evasion", 0.0779205251379031], ["Obfuscated Files or Information", 0.059088427511001254], ["Automated Collection", 0.04424504150668229], ["Native API", 0.03410708832701601], ["Command and Scripting Interpreter", 0.0287274602433856]], "Get the total RAM size of compromised host by executing \"SELECT * FROM Win32_OperatingSystem\" and look for \"TotalVisibleMemorySize\"": [["System Information Discovery", 0.4200812056737167], ["Virtualization/Sandbox Evasion", 0.07644970155449647], ["Software Discovery", 0.033101391498368236], ["Windows Management Instrumentation", 0.024979546961587544], ["File and Directory Discovery", 0.022606578782235605], ["Process Discovery", 0.017854832940614244]], "Retrieve the user domain name, username": [["System Owner/User Discovery", 0.54607512096792], ["Account Discovery", 0.15889099706681423], ["System Network Configuration Discovery", 0.06159684978001003], ["System Information Discovery", 0.0378643769330502], ["Permission Groups Discovery", 0.019390578907984804], ["Remote System Discovery", 0.012785725964509128]], "Get the user name of the compromised host": [["System Owner/User Discovery", 0.8607718106307352], ["Account Discovery", 0.04904659880967265], ["System Information Discovery", 0.0187333046123607], ["Permission Groups Discovery", 0.007586982607587043], ["System Network Configuration Discovery", 0.003931481636171847], ["Process Discovery", 0.0035990130848543318]], "func_GetUserName()": [["System Owner/User Discovery", 0.7881609980503592], ["Account Discovery", 0.04548064228880092], ["Native API", 0.022192184764897552], ["System Information Discovery", 0.008590619011637185], ["Access Token Manipulation", 0.006562906447686792], ["Permission Groups Discovery", 0.004364942082133373]], "Parse firewall and Anti Virus Product install in the compromised host by running\n\"SELECT * FROM ROOT\\\\SecurityCenter2\"\n\"SELECT * FROM ROOT\\\\SecurityCenter\"\n\"SELECT * FROM AntivirusProduct\"\n\"SELECT * FROM FirewallProduct\"\n\"SELECT * FROM AntiSpyWareProduct\"": [["Software Discovery", 0.795776030818829], ["Windows Management Instrumentation", 0.03764197127298503], ["Query Registry", 0.02049501866338323], ["System Information Discovery", 0.012201235305208027], ["Impair Defenses", 0.009386566650675578], ["Remote System Discovery", 0.007912959155419053]], "func_GetFirewalls()": [["Software Discovery", 0.2025208522474862], ["Impair Defenses", 0.1575698593211033], ["Network Service Discovery", 0.06549651489597719], ["System Network Connections Discovery", 0.056618904495368085], ["System Network Configuration Discovery", 0.04394175278069892], ["Query Registry", 0.017558988554133015]], "func_ListProcesses()": [["Process Discovery", 0.45846937429248075], ["Native API", 0.2462896907388771], ["Process Injection", 0.05020939785562436], ["System Service Discovery", 0.018531055457807942], ["Software Discovery", 0.016596032803783457], ["Windows Management Instrumentation", 0.014560098064613964]], "Retrieve process list and process information by running 'SELECT * FROM Win32_Process'": [["Process Discovery", 0.7835832016607336], ["Native API", 0.03421994446303455], ["Process Injection", 0.018951413173207202], ["Windows Management Instrumentation", 0.016472467229308865], ["System Information Discovery", 0.015187292058041056], ["Software Discovery", 0.013428921280208542]], "Screen Capture": [["Screen Capture", 0.7624946422003457], ["Video Capture", 0.06924886746774797], ["Input Capture", 0.015460898931132703], ["Application Window Discovery", 0.015323702723236339], ["Clipboard Data", 0.006064269278951724], ["Data from Local System", 0.005736170273273268]], "func_ScanScreen() is the one responsible for this screen capture capability": [["Screen Capture", 0.7581454421681365], ["Video Capture", 0.04982834087964226], ["Application Window Discovery", 0.029333896332511097], ["Input Capture", 0.014738284375773212], ["Clipboard Data", 0.009421173717478597], ["Virtualization/Sandbox Evasion", 0.007743251383533796]], "has a functionality to capture a screenshot of the targeted or compromised host as part of its data collection and exfiltration": [["Screen Capture", 0.7316433430240254], ["Video Capture", 0.033277269550896486], ["Data from Local System", 0.023921089100037637], ["Application Window Discovery", 0.009822932578125632], ["Automated Collection", 0.009185435203816246], ["Automated Exfiltration", 0.008897606896046623]], "uses .NET Graphics class CopyFromScreen Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration.": [["Screen Capture", 0.2894651370872616], ["Hide Artifacts", 0.05343382048395045], ["Data Manipulation", 0.03183187320161228], ["Data from Local System", 0.026030682195074997], ["OS Credential Dumping", 0.025144139717992498], ["Archive Collected Data", 0.022412804768320506]], "Parse all installed application in the compromised host by querying 'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall' registry": [["Query Registry", 0.3265515686098627], ["Software Discovery", 0.20793651605087657], ["Indicator Removal", 0.06902933964997568], ["Modify Registry", 0.048093839457488005], ["Windows Management Instrumentation", 0.04515788355712621], ["Masquerading", 0.023716520032217685]], "Parse browser application and browser version installed in the compromised host by querying \"SOFTWARE\\WOW6432Node\\Clients\\StartMenuInternet\" or \"SOFTWARE\\Clients\\StartMenuInternet\" registry": [["Query Registry", 0.376169977607649], ["Software Discovery", 0.2094444840085854], ["System Information Discovery", 0.03501790325535566], ["Credentials from Password Stores", 0.03449767766136773], ["Browser Bookmark Discovery", 0.03091155778969299], ["Windows Management Instrumentation", 0.015946193311110596]], "uses .NET Graphics class CopyFromScreen Function()": [["Screen Capture", 0.3987018066535415], ["Application Window Discovery", 0.08658092565870357], ["Clipboard Data", 0.057833479522027054], ["Hide Artifacts", 0.035743958848731265], ["Masquerading", 0.0212452660698686], ["Input Capture", 0.016288315941497693]], "using Windows CryptProtectData() API.": [["Deobfuscate/Decode Files or Information", 0.23120474297308388], ["Data Encrypted for Impact", 0.1834767269255619], ["Obfuscated Files or Information", 0.12927022262780014], ["Archive Collected Data", 0.0706188628323638], ["Weaken Encryption", 0.027426287756565786], ["Encrypted Channel", 0.025602608818708975]], "cracking browser sensitive information like passwords": [["Credentials from Password Stores", 0.5698743416350497], ["Browser Session Hijacking", 0.06717659615603715], ["Unsecured Credentials", 0.04722420083633893], ["Brute Force", 0.025327393062882845], ["Input Capture", 0.02273420776256179], ["Use Alternate Authentication Material", 0.018592011916706327]], "The decrypted password will be sent to its C2 Server as part of its data exfiltration.": [["Unsecured Credentials", 0.11220547996474918], ["Credentials from Password Stores", 0.11121265637971088], ["Deobfuscate/Decode Files or Information", 0.10391093370360556], ["OS Credential Dumping", 0.09999285427453987], ["Brute Force", 0.0487530497873815], ["Archive Collected Data", 0.0379201197300883]], "it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having \u201cwallet\u201d substring on its file name.": [["File and Directory Discovery", 0.44290682327366976], ["Automated Collection", 0.054569517766270004], ["Data from Local System", 0.04048874154556631], ["Unsecured Credentials", 0.033690075676852296], ["Data Encrypted for Impact", 0.020677201175434902], ["Data Staged", 0.019113336157739025]], "used a compiled remote desktop malware,": [["Remote Services", 0.5590217515272808], ["Remote Access Software", 0.16467909028858937], ["Remote Service Session Hijacking", 0.022552990801475076], ["Command and Scripting Interpreter", 0.01770220056561498], ["Exploitation of Remote Services", 0.016991370077403662], ["External Remote Services", 0.009959073599977226]], "then executed RDPEnable on the infected machine.": [["Command and Scripting Interpreter", 0.06458768123528687], ["Remote Services", 0.056466866982977364], ["Windows Management Instrumentation", 0.04813814134152026], ["Remote Access Software", 0.0370543330871987], ["System Shutdown/Reboot", 0.028930024726024312], ["Event Triggered Execution", 0.02417739815967763]], "There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system": [["Remote Services", 0.6282510552904041], ["Remote Access Software", 0.07566811808262751], ["Remote Service Session Hijacking", 0.03931826723998393], ["Exploitation of Remote Services", 0.02295188944398061], ["Windows Management Instrumentation", 0.017745043798926004], ["Event Triggered Execution", 0.016198484934533547]], "It enumerates files and directories": [["File and Directory Discovery", 0.8887962177493067], ["Data from Local System", 0.02098073161875574], ["Automated Collection", 0.010870405954339997], ["Data from Network Shared Drive", 0.00781523970600563], ["Data Staged", 0.006377730742024377], ["Native API", 0.004650631347967643]], "File enumeration": [["File and Directory Discovery", 0.8311285855353094], ["Data from Local System", 0.024538147299976585], ["Automated Collection", 0.017109919181044417], ["Data Staged", 0.011646341847280842], ["Data from Network Shared Drive", 0.009613976566020626], ["Native API", 0.008300208051019983]], "using FindFirstFileW, FindNextFileW, and FindClose APIs": [["File and Directory Discovery", 0.4491373545165166], ["Data Staged", 0.04961465546243349], ["Automated Collection", 0.049308449528264325], ["Native API", 0.03850689537642928], ["Data from Local System", 0.029767177262807216], ["Indicator Removal", 0.02312549104332087]], "For each directory it traverses": [["File and Directory Discovery", 0.6846876141027314], ["Automated Collection", 0.04114635241032175], ["Data from Local System", 0.03608726060146479], ["Data Staged", 0.03201484393453757], ["Data from Network Shared Drive", 0.01882569884268433], ["Native API", 0.013576586714083128]], "installing remote access software.": [["Remote Access Software", 0.25849672425309783], ["Remote Services", 0.1644582568715212], ["Software Deployment Tools", 0.06429745174008354], ["External Remote Services", 0.05247343477040886], ["Valid Accounts", 0.035926398188402285], ["Hardware Additions", 0.026242121929626768]], "actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.": [["Impair Defenses", 0.6045949538642374], ["Service Stop", 0.047373358531653614], ["Software Discovery", 0.021750726182453422], ["Rootkit", 0.01732930228622559], ["File and Directory Permissions Modification", 0.01575059495672579], ["Create or Modify System Process", 0.011293668501602383]], "by listing accessible local IPs": [["System Network Configuration Discovery", 0.485213614575082], ["Remote System Discovery", 0.11216980637901558], ["System Network Connections Discovery", 0.08826747585087187], ["Network Service Discovery", 0.05366091778117025], ["Gather Victim Network Information", 0.027001719506405345], ["Active Scanning", 0.022574983365117617]], "It checks for the number of processors in the infected system": [["System Information Discovery", 0.3754423970160149], ["Virtualization/Sandbox Evasion", 0.2325881768138422], ["Software Discovery", 0.06860141553186085], ["Process Discovery", 0.04376938387846852], ["Windows Management Instrumentation", 0.031605022570185416], ["Native API", 0.013096364312500991]], "Checking the number of processors": [["System Information Discovery", 0.31606392578939635], ["Virtualization/Sandbox Evasion", 0.18219169621498144], ["Process Discovery", 0.07586518161156892], ["Software Discovery", 0.053399783443248146], ["Windows Management Instrumentation", 0.039669694364783806], ["Native API", 0.0224375760070553]], "This is a multi-stage attack that involves sideloading DLLs,": [["Hijack Execution Flow", 0.2927813209105387], ["Shared Modules", 0.09987600844954908], ["Process Injection", 0.09302272718430406], ["System Binary Proxy Execution", 0.07071956286722639], ["Ingress Tool Transfer", 0.033453963011613866], ["Masquerading", 0.02119464561773958]], "involves sideloading DLLs along": [["Hijack Execution Flow", 0.36912230545563784], ["Shared Modules", 0.1494520454003365], ["System Binary Proxy Execution", 0.11636182659322418], ["Process Injection", 0.07856395393295915], ["Ingress Tool Transfer", 0.021953462446689314], ["Native API", 0.020588504943162906]], "icon files with encrypted data appended to the end of the files.": [["Obfuscated Files or Information", 0.32694941865993493], ["Masquerading", 0.0990227523068831], ["Archive Collected Data", 0.08027130441992225], ["Hide Artifacts", 0.049994569893539016], ["Data Encrypted for Impact", 0.0454824927829886], ["Deobfuscate/Decode Files or Information", 0.0267008360335571]], "These encrypted strings,": [["Obfuscated Files or Information", 0.40142278616670934], ["Deobfuscate/Decode Files or Information", 0.1749936495385915], ["Encrypted Channel", 0.08144467497832973], ["Data Encoding", 0.0716608636085497], ["Archive Collected Data", 0.043245700575043455], ["Data Encrypted for Impact", 0.03672625014819439]], "once decrypted, contained the C2 domains for additional malicious artifacts.": [["Deobfuscate/Decode Files or Information", 0.5459590824602945], ["Archive Collected Data", 0.04953713565399953], ["Obfuscated Files or Information", 0.04135564861713412], ["Data Encrypted for Impact", 0.03592406267496275], ["Encrypted Channel", 0.025592770006439104], ["Exfiltration Over Alternative Protocol", 0.024025344012405955]], "attempt to obtain system information": [["System Information Discovery", 0.8278039404850424], ["Windows Management Instrumentation", 0.026463129533453027], ["Virtualization/Sandbox Evasion", 0.021410659908398556], ["Software Discovery", 0.01744387242691805], ["System Network Configuration Discovery", 0.008574749088061271], ["Query Registry", 0.007834980215147214]], "the malware attempts to retrieve additional malicious artifacts": [["Indicator Removal", 0.10683169252893508], ["Deobfuscate/Decode Files or Information", 0.07810003282784768], ["Ingress Tool Transfer", 0.0682301138000624], ["Data from Local System", 0.05911946218193139], ["BITS Jobs", 0.031060954647283295], ["Masquerading", 0.03011109287429506]], "Inject and execute DLLs": [["Shared Modules", 0.25210590783361597], ["Process Injection", 0.19618904213332267], ["Hijack Execution Flow", 0.18585549787087208], ["System Binary Proxy Execution", 0.09945610350239538], ["Native API", 0.043994751891862985], ["Event Triggered Execution", 0.021231306397489144]], "Manipulate processes (list": [["Process Discovery", 0.4408042056924747], ["Process Injection", 0.13010242172398664], ["Native API", 0.04269514360183437], ["Impair Defenses", 0.04199723547008733], ["Access Token Manipulation", 0.03871219668884859], ["Service Stop", 0.02738626261940672]], "Manipulate files and directories (list": [["File and Directory Discovery", 0.21156020464890532], ["Indicator Removal", 0.17086700126326662], ["Data from Local System", 0.061406379037227996], ["Masquerading", 0.043704537833546706], ["File and Directory Permissions Modification", 0.03436781000646623], ["Data Manipulation", 0.03428516700877658]], "Manipulate files and directories (list, download, upload, view, delete": [["Indicator Removal", 0.22515892253688957], ["File and Directory Discovery", 0.12020560206054949], ["Data from Local System", 0.05866976161321767], ["Data Staged", 0.04276955509839724], ["File and Directory Permissions Modification", 0.038953265076618], ["Masquerading", 0.03629614214383101]], "download, upload": [["Ingress Tool Transfer", 0.5387071223702057], ["Exfiltration Over C2 Channel", 0.0288079437678335], ["Application Layer Protocol", 0.02553484677358551], ["Data from Local System", 0.0246635684074082], ["Exfiltration Over Alternative Protocol", 0.02406786124747891], ["Exfiltration Over Web Service", 0.022280333835576108]], "Take screenshots": [["Screen Capture", 0.8839768513061057], ["Video Capture", 0.0174241537565553], ["Application Window Discovery", 0.008593088694807275], ["Input Capture", 0.005917703090588895], ["Clipboard Data", 0.003680266050045255], ["Data from Local System", 0.003351005603877269]], "Execute commands via Command Prompt": [["Command and Scripting Interpreter", 0.7447104524000814], ["Indirect Command Execution", 0.06379552645147804], ["System Binary Proxy Execution", 0.017285153539717192], ["System Services", 0.01710840340424365], ["Native API", 0.016537855388086144], ["Windows Management Instrumentation", 0.009740195373813808]], "executed using ShellExecute with the following command line:": [["Command and Scripting Interpreter", 0.3957396906644503], ["Native API", 0.11875988960931372], ["System Binary Proxy Execution", 0.06886712483983036], ["System Services", 0.055292955885921945], ["Indirect Command Execution", 0.03483000511926204], ["Windows Management Instrumentation", 0.021452529564145804]], "This type of threats is usually delivered as email attachments.": [["Phishing", 0.34784807861403877], ["Phishing for Information", 0.08837408149166393], ["User Execution", 0.08350049486022242], ["Internal Spearphishing", 0.022678037810796834], ["Email Collection", 0.019397940568952925], ["Defacement", 0.018597272509390677]], "Encoded binary payload": [["Obfuscated Files or Information", 0.48054431685251703], ["Deobfuscate/Decode Files or Information", 0.2038698902829426], ["Data Encoding", 0.1792301663374158], ["Archive Collected Data", 0.015140586639779921], ["Data Obfuscation", 0.014118829888530979], ["Encrypted Channel", 0.010015705205838946]], "Encrypted and compressed payload": [["Obfuscated Files or Information", 0.43411080545084885], ["Archive Collected Data", 0.23857121479146406], ["Deobfuscate/Decode Files or Information", 0.11225813076214096], ["Data Encrypted for Impact", 0.025224337439279168], ["Data Encoding", 0.02352857997718469], ["Encrypted Channel", 0.021038983618217127]], "Start of encrypted and compressed loader configuration and payload": [["Obfuscated Files or Information", 0.3003124452012821], ["Deobfuscate/Decode Files or Information", 0.2560950900459751], ["Archive Collected Data", 0.07337342305357687], ["Execution Guardrails", 0.028259047302443573], ["Data Encrypted for Impact", 0.021813331260575736], ["Command and Scripting Interpreter", 0.014995588826410281]], "an encoded payload split across several nodes, further complicating its extraction.": [["Obfuscated Files or Information", 0.1615116007070223], ["Deobfuscate/Decode Files or Information", 0.1529603372672303], ["Data Encoding", 0.14662594682938634], ["Exfiltration Over Alternative Protocol", 0.06341359309301621], ["Archive Collected Data", 0.042739207458302016], ["Data Obfuscation", 0.04244394491692119]], "That node contains the encoded payload.": [["Data Encoding", 0.3661211635536714], ["Deobfuscate/Decode Files or Information", 0.2124172820345538], ["Obfuscated Files or Information", 0.11014064321974389], ["Data Obfuscation", 0.028815620939611528], ["Archive Collected Data", 0.015919419017600724], ["Encrypted Channel", 0.015729355526040534]], "the encoded payload": [["Data Encoding", 0.41729317179743014], ["Obfuscated Files or Information", 0.23870176729809386], ["Deobfuscate/Decode Files or Information", 0.17090358389221832], ["Data Obfuscation", 0.023188148946679695], ["Encrypted Channel", 0.015843146466172516], ["Archive Collected Data", 0.014520409691312998]], "To hide the strings it uses during its execution, it primarily uses a simple encoding by subtracting 35 from each character of the original string and encoding the result with Base64": [["Obfuscated Files or Information", 0.6510415235713634], ["Data Encoding", 0.10987890280544677], ["Deobfuscate/Decode Files or Information", 0.0599367144549732], ["Data Obfuscation", 0.02925888733403696], ["Masquerading", 0.018167016914060415], ["Encrypted Channel", 0.011954491379600933]], "Similar to decoding strings, the binary payload is extracted by decoding the data using Base64 and adding 35.": [["Deobfuscate/Decode Files or Information", 0.6036020046458447], ["Obfuscated Files or Information", 0.13561167801568647], ["Data Encoding", 0.09379960341519675], ["Archive Collected Data", 0.018215975401733916], ["Data Obfuscation", 0.014591374727545492], ["Encrypted Channel", 0.007858750993107861]], "the resulting bytes are further decoded with xor 82.": [["Deobfuscate/Decode Files or Information", 0.35164322585543084], ["Data Encoding", 0.3160092744569742], ["Obfuscated Files or Information", 0.09302490767293264], ["Encrypted Channel", 0.03446094888240003], ["Data Obfuscation", 0.025820175109414485], ["Archive Collected Data", 0.019822617385487247]], "The decoded payload": [["Deobfuscate/Decode Files or Information", 0.5919548790640341], ["Obfuscated Files or Information", 0.13276077735829295], ["Data Encoding", 0.12307524068790594], ["Data Obfuscation", 0.013533004404303462], ["Archive Collected Data", 0.013511150806867888], ["Encrypted Channel", 0.012892792068509563]], "Once the payload is decoded": [["Deobfuscate/Decode Files or Information", 0.5421597352018319], ["Data Encoding", 0.1448163373613694], ["Obfuscated Files or Information", 0.09839598117948281], ["Data Obfuscation", 0.024211011047073037], ["Encrypted Channel", 0.01857522864638889], ["Archive Collected Data", 0.011628358705608336]], "After decrypting and decompressing the payload": [["Deobfuscate/Decode Files or Information", 0.5999705729737408], ["Archive Collected Data", 0.10636929752419794], ["Obfuscated Files or Information", 0.09006023428034662], ["Data Encrypted for Impact", 0.03203008859863897], ["Encrypted Channel", 0.018046660418175712], ["Exfiltration Over Alternative Protocol", 0.015009644140236832]], "Decrypted and decompressed payload": [["Deobfuscate/Decode Files or Information", 0.6894860979136356], ["Obfuscated Files or Information", 0.10603041888308322], ["Archive Collected Data", 0.05033883851403458], ["Data Encrypted for Impact", 0.017248716674115067], ["Encrypted Channel", 0.01696706023925489], ["Data Encoding", 0.013850814010380425]], "Decodes sensitive memory regions in the current process with the same XOR key": [["Deobfuscate/Decode Files or Information", 0.2544553530351701], ["Process Injection", 0.21485485218753003], ["Obfuscated Files or Information", 0.05867585638617316], ["Native API", 0.05847586056860102], ["Virtualization/Sandbox Evasion", 0.03902249715901924], ["Hide Artifacts", 0.02878892300038819]], "it locates a packed and compressed payload": [["Obfuscated Files or Information", 0.32918618352824575], ["Deobfuscate/Decode Files or Information", 0.17899803523833419], ["Archive Collected Data", 0.11475660753970879], ["Automated Collection", 0.031149155415896124], ["File and Directory Discovery", 0.025137983809852167], ["Execution Guardrails", 0.018542609916161242]], "Injection type: Current process (1) or in the new process": [["Process Injection", 0.7593097095731269], ["Native API", 0.08553224010222284], ["Process Discovery", 0.01812179938627602], ["Hijack Execution Flow", 0.012890349834284616], ["Access Token Manipulation", 0.012404587648647405], ["Create or Modify System Process", 0.009204718381521535]], "Process to inject into": [["Process Injection", 0.7857989492775517], ["Native API", 0.07881237314142865], ["Hijack Execution Flow", 0.01019934831123027], ["System Binary Proxy Execution", 0.010011677219642636], ["System Services", 0.009960183339420883], ["Create or Modify System Process", 0.009551218266931664]], "\u00a0Process to inject into": [["Process Injection", 0.7857989492775517], ["Native API", 0.07881237314142865], ["Hijack Execution Flow", 0.01019934831123027], ["System Binary Proxy Execution", 0.010011677219642636], ["System Services", 0.009960183339420883], ["Create or Modify System Process", 0.009551218266931664]], "this loader prepends a stub containing 79 bytes of junk instructions before the actual payload shellcode.": [["Obfuscated Files or Information", 0.22435207617463315], ["Hijack Execution Flow", 0.10019516183653326], ["Shared Modules", 0.0764139059789768], ["System Binary Proxy Execution", 0.06584918686917392], ["Process Injection", 0.04825167311456635], ["Deobfuscate/Decode Files or Information", 0.046902026781706706]], "The bytes at 25 hardcoded offsets within this stub are replaced with random bytes to hinder shellcode detection.": [["Obfuscated Files or Information", 0.6638797685520805], ["Deobfuscate/Decode Files or Information", 0.03832186392849137], ["Execution Guardrails", 0.028244118712145216], ["Virtualization/Sandbox Evasion", 0.020637694758590126], ["Data Obfuscation", 0.01549952428318507], ["Data Encoding", 0.012622694265600082]], "To launch the shellcode, the loader calls ZwCreateThreadEx to create a new suspended injection thread hidden from debuggers using the THREAD_CREATE_FLAGS_CREATE_SUSPENDED (0x01) and THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER (0x4) thread creation flags.": [["Process Injection", 0.3977040806134443], ["Native API", 0.067458295938183], ["Event Triggered Execution", 0.041357904154096334], ["Hijack Execution Flow", 0.03964315999940854], ["Virtualization/Sandbox Evasion", 0.034637951926083176], ["System Binary Proxy Execution", 0.03046601046467498]], "by redirecting calls to the Windows Sleep API to its own function": [["Virtualization/Sandbox Evasion", 0.08785280678004748], ["Process Injection", 0.07159234807518941], ["Native API", 0.06766216822495019], ["Event Triggered Execution", 0.058718814993914854], ["Masquerading", 0.05767328307930423], ["Command and Scripting Interpreter", 0.02323894798351105]], "communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests": [["Application Layer Protocol", 0.6432445682795542], ["Exfiltration Over C2 Channel", 0.053270016764699335], ["Fallback Channels", 0.03502927077232287], ["Web Service", 0.034916041743071315], ["Data Obfuscation", 0.0177019879577137], ["Non-Application Layer Protocol", 0.015196384203437713]], "shared with the C2 server on the initial check-in request (Figure 11) for encrypting subsequent data communicated between the agent and C2 server with AES-256-CTR.": [["Encrypted Channel", 0.3893030410089074], ["Obfuscated Files or Information", 0.0755530287401249], ["Data Encoding", 0.07399151440261169], ["Deobfuscate/Decode Files or Information", 0.05724059759414582], ["Exfiltration Over Alternative Protocol", 0.048125999415799765], ["Archive Collected Data", 0.03471353151199208]], "the execution of the downloaded DLL via the tool rundll32.exe.": [["System Binary Proxy Execution", 0.23135909191062465], ["Hijack Execution Flow", 0.20731984891939853], ["Shared Modules", 0.10931711730257238], ["Native API", 0.04944985866902352], ["Process Injection", 0.0467960594707911], ["Deobfuscate/Decode Files or Information", 0.02594480004471609]], "performs the download of a file": [["Ingress Tool Transfer", 0.6509896416476079], ["Command and Scripting Interpreter", 0.04309281486926045], ["BITS Jobs", 0.022608565192754875], ["Application Layer Protocol", 0.016210008729037766], ["Data from Local System", 0.013690750543634592], ["Data Transfer Size Limits", 0.008277811714878592]], "PowerShell script that downloads and executes a dropper": [["Command and Scripting Interpreter", 0.3195053125232858], ["Ingress Tool Transfer", 0.14244690008341082], ["System Binary Proxy Execution", 0.07490417126988339], ["Native API", 0.02742411313473283], ["Masquerading", 0.02381023711524401], ["Scheduled Task/Job", 0.016796450549297307]], "downloads a payload": [["Ingress Tool Transfer", 0.6372562174907112], ["Command and Scripting Interpreter", 0.0710649239203687], ["BITS Jobs", 0.06579668164955706], ["Application Layer Protocol", 0.0156603001775022], ["Deobfuscate/Decode Files or Information", 0.015088502465467803], ["System Binary Proxy Execution", 0.010601167196161084]], "malware dynamically calls the API NtAllocateVirtualMemory": [["Native API", 0.1999535767741705], ["Process Injection", 0.09552921434170092], ["Virtualization/Sandbox Evasion", 0.07752077471421366], ["Hide Artifacts", 0.06854401977446595], ["System Binary Proxy Execution", 0.04220519466392137], ["Obfuscated Files or Information", 0.023621174000930886]], "AES Cryptographic Provider from WinCrypt APIs": [["Obfuscated Files or Information", 0.22720333164579157], ["Data Encrypted for Impact", 0.1610082467772802], ["Deobfuscate/Decode Files or Information", 0.11902027308044161], ["Encrypted Channel", 0.10307742342966172], ["Archive Collected Data", 0.04320208976114622], ["Weaken Encryption", 0.04090015447619101]], "the API Web RESTful that provides access to Microsoft Cloud service resources.": [["Cloud Service Dashboard", 0.16137621271986854], ["Web Service", 0.12369486524878578], ["Cloud Infrastructure Discovery", 0.055442701670180346], ["Data from Cloud Storage", 0.03059654254109024], ["Cloud Service Discovery", 0.027621213139089006], ["Steal Application Access Token", 0.022162216332691376]], "using the Microsoft Graph API": [["Cloud Service Dashboard", 0.06273105519710147], ["Data from Information Repositories", 0.055168988761011374], ["Gather Victim Identity Information", 0.035744680035126354], ["Web Service", 0.03515789790075992], ["Windows Management Instrumentation", 0.021674470996963173], ["Establish Accounts", 0.018989109066886705]], "uses the Microsoft Graph API": [["Data from Information Repositories", 0.06758747274705372], ["Cloud Service Dashboard", 0.06353282949345455], ["Gather Victim Identity Information", 0.03562322975082205], ["Web Service", 0.03332058284190075], ["Windows Management Instrumentation", 0.019223172423848613], ["Stage Capabilities", 0.01819019173069026]], "decrypted using the RSA": [["Deobfuscate/Decode Files or Information", 0.2913585669990201], ["Data Encrypted for Impact", 0.19349231968877534], ["Encrypted Channel", 0.12496590192209568], ["Weaken Encryption", 0.06535784322428831], ["Obfuscated Files or Information", 0.023917189835534373], ["Archive Collected Data", 0.022076108070659888]], "The malware proceeds to de-obfuscate strings using a XOR loop": [["Obfuscated Files or Information", 0.464405186994129], ["Deobfuscate/Decode Files or Information", 0.36797586430255025], ["Data Encoding", 0.020208650582866926], ["Encrypted Channel", 0.017154052468553685], ["Archive Collected Data", 0.01607536101523749], ["Data Obfuscation", 0.009108086136108555]], "de-obfuscated strings:": [["Obfuscated Files or Information", 0.5241534645070408], ["Deobfuscate/Decode Files or Information", 0.27557862897128754], ["Data Encoding", 0.04063219706867521], ["Archive Collected Data", 0.017517132472465703], ["Data Obfuscation", 0.013719366746773773], ["Encrypted Channel", 0.010546875618622508]], "decrypted through an AES-256-CBCdecryption algorithm": [["Deobfuscate/Decode Files or Information", 0.41187830371713835], ["Encrypted Channel", 0.13351562832735797], ["Obfuscated Files or Information", 0.06702101060772993], ["Weaken Encryption", 0.061852309195100555], ["Data Encrypted for Impact", 0.06031406684616465], ["Archive Collected Data", 0.04537181033844297]], "the decrypted content": [["Deobfuscate/Decode Files or Information", 0.5615180688275745], ["Archive Collected Data", 0.09917842119684461], ["Data Encrypted for Impact", 0.07969275020266252], ["Obfuscated Files or Information", 0.04336658677283179], ["Weaken Encryption", 0.020495312605157773], ["Encrypted Channel", 0.01894294358543786]], "The code in the injected PE": [["Process Injection", 0.07596665175283], ["Command and Scripting Interpreter", 0.02520764075397335], ["Subvert Trust Controls", 0.024367983387949856], ["Boot or Logon Autostart Execution", 0.02317127138743556], ["Obfuscated Files or Information", 0.022423558544123715], ["Native API", 0.02193850307382126]], "injects in itself a new PE (Portable Executable) file,": [["Process Injection", 0.3087127905465537], ["Hijack Execution Flow", 0.12204874738764518], ["Shared Modules", 0.07628213799569593], ["System Binary Proxy Execution", 0.061678461207065986], ["Boot or Logon Autostart Execution", 0.03194051912298651], ["Native API", 0.031882859712873066]], "passes the execution to the region of memory in which the copied PE is allocated": [["Process Injection", 0.3045747496957972], ["Native API", 0.07444156606137144], ["Virtualization/Sandbox Evasion", 0.04307575660345321], ["OS Credential Dumping", 0.030035837500565557], ["Access Token Manipulation", 0.02128939778978816], ["Process Discovery", 0.017268721249775885]], "the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.": [["Process Injection", 0.28996156888269214], ["Native API", 0.054777396573256434], ["OS Credential Dumping", 0.042084927954291626], ["Hide Artifacts", 0.020847978722124], ["Ingress Tool Transfer", 0.02070929407298138], ["Command and Scripting Interpreter", 0.016038609131238064]], "the full HTTP request to make the first connection to the C&C": [["Application Layer Protocol", 0.2832052130407049], ["Fallback Channels", 0.061386531593099807], ["Endpoint Denial of Service", 0.039850649813055736], ["Non-Standard Port", 0.035480311800145464], ["Data Obfuscation", 0.029798144940390084], ["Dynamic Resolution", 0.027294616524652166]], "enumerating the child files in the check OneDrive subdirectory.": [["File and Directory Discovery", 0.7259380021346025], ["Data from Local System", 0.036290115818122706], ["Data Staged", 0.02383362232682473], ["Data from Network Shared Drive", 0.02266449195570536], ["Automated Collection", 0.02201123455427676], ["Data from Removable Media", 0.009778940629649752]], "The execution triggers the setting of the following registry key": [["Modify Registry", 0.37269420013976867], ["Boot or Logon Autostart Execution", 0.22976366683070784], ["Query Registry", 0.15459319812118813], ["Event Triggered Execution", 0.026207057102030643], ["System Binary Proxy Execution", 0.024825597372555186], ["Office Application Startup", 0.020260422698657413]], "triggered when the user starts the presentation mode and moves the mouse": [["Event Triggered Execution", 0.1292159713334934], ["Remote Services", 0.11573041000102492], ["Input Capture", 0.07613433905510299], ["Virtualization/Sandbox Evasion", 0.02190929126604847], ["Application Window Discovery", 0.02188907578743779], ["Command and Scripting Interpreter", 0.021625251438427744]], "A new file, again with a JPEG extension": [["Masquerading", 0.06914036637745478], ["Screen Capture", 0.06340178486993876], ["Archive Collected Data", 0.06279770872301119], ["Obfuscated Files or Information", 0.05438223258749005], ["Build Image on Host", 0.031313004711642715], ["Data Obfuscation", 0.025857137108101124]], "Contents of the .img file, including the hidden files": [["Hide Artifacts", 0.12102538982005968], ["File and Directory Discovery", 0.11186034179028441], ["Data from Local System", 0.05845699539006055], ["Obfuscated Files or Information", 0.03934424671650198], ["Deobfuscate/Decode Files or Information", 0.03793191476741477], ["Build Image on Host", 0.037565428743192075]], "hiding the rest of its files from the user.": [["Hide Artifacts", 0.524318431482281], ["Indicator Removal", 0.06878465933883017], ["Rootkit", 0.045399135045032006], ["Masquerading", 0.03374496249037705], ["File and Directory Permissions Modification", 0.029110272941899745], ["Inhibit System Recovery", 0.023204849565215735]], "to run the subsequent BAT scripts": [["Command and Scripting Interpreter", 0.6668199898879476], ["Scheduled Task/Job", 0.04311764250116189], ["System Services", 0.02633111611039536], ["System Binary Proxy Execution", 0.025075557715617983], ["Native API", 0.023125403798782328], ["Indirect Command Execution", 0.012965597910949363]], "the attacker\u2019s BAT file to run": [["Command and Scripting Interpreter", 0.4483716119821029], ["System Binary Proxy Execution", 0.07575424470301143], ["Scheduled Task/Job", 0.05089996291965419], ["System Services", 0.03158600801493725], ["Native API", 0.02856623002320023], ["Indirect Command Execution", 0.02367886667053255]], "The BAT script": [["Command and Scripting Interpreter", 0.8261508802066536], ["System Binary Proxy Execution", 0.01631189617147777], ["Native API", 0.015630603450798024], ["Scheduled Task/Job", 0.015417847079956233], ["Indirect Command Execution", 0.007919211863141672], ["System Services", 0.007585918972466605]], "a BAT file (4.2) to be run on logon as another UI shell": [["Command and Scripting Interpreter", 0.17436219293569188], ["Boot or Logon Autostart Execution", 0.1678386267113268], ["Boot or Logon Initialization Scripts", 0.1352601162537865], ["Event Triggered Execution", 0.11360590422087763], ["Access Token Manipulation", 0.03528057526774878], ["Create or Modify System Process", 0.024702548177816773]], "executes another BAT script": [["Command and Scripting Interpreter", 0.6273018646128193], ["Native API", 0.044455575489702574], ["System Binary Proxy Execution", 0.03969308899979333], ["System Services", 0.03779791341863316], ["Scheduled Task/Job", 0.034111029748320025], ["Windows Management Instrumentation", 0.015371012002449069]], "Some variants used a known UAC bypass method abusing the legitimate fodhelper.exe": [["Abuse Elevation Control Mechanism", 0.7462808671773309], ["Access Token Manipulation", 0.029986755141319994], ["Exploitation for Privilege Escalation", 0.016381797625562473], ["System Binary Proxy Execution", 0.015701754847856356], ["Boot or Logon Autostart Execution", 0.011035357861972682], ["Event Triggered Execution", 0.010935638190528913]], "UAC bypass implementation": [["Abuse Elevation Control Mechanism", 0.6215447523658779], ["Access Token Manipulation", 0.037358453382657975], ["Exploitation for Privilege Escalation", 0.033585181342105745], ["Domain Policy Modification", 0.02808085296175675], ["System Binary Proxy Execution", 0.01221464096939568], ["File and Directory Permissions Modification", 0.011296635161607413]], "If it fails, it sets in the registry": [["Modify Registry", 0.27361039306454793], ["Boot or Logon Autostart Execution", 0.1255801508303896], ["Query Registry", 0.09592773391631626], ["Create or Modify System Process", 0.04299319576438032], ["Impair Defenses", 0.042460425704138466], ["Event Triggered Execution", 0.03769540564913334]], "Register a new service": [["Create or Modify System Process", 0.5293368527815976], ["System Services", 0.20649317706652343], ["System Service Discovery", 0.048199808107006414], ["Masquerading", 0.03064232790631253], ["Hijack Execution Flow", 0.01670090133497883], ["Cloud Service Discovery", 0.010210197918636392]], "a new service that will run its VBS script (4.1) using sc.exe.": [["System Services", 0.3891363257797687], ["Create or Modify System Process", 0.24160001501829495], ["Masquerading", 0.05210549869593271], ["System Binary Proxy Execution", 0.040294852605270104], ["System Service Discovery", 0.03328420103904255], ["Hijack Execution Flow", 0.031202439994355565]], "the malicious executable to unpack itself.": [["Deobfuscate/Decode Files or Information", 0.308012967792901], ["Obfuscated Files or Information", 0.16262230033864397], ["Masquerading", 0.046483715179046], ["System Binary Proxy Execution", 0.037418030085715474], ["Command and Scripting Interpreter", 0.036250282916702216], ["Hijack Execution Flow", 0.028452122375127852]], "which is unpacked only when run with a unique password, allow evading traditional signature-based detection.": [["Subvert Trust Controls", 0.12030663735488209], ["Obfuscated Files or Information", 0.0903523664659898], ["Unsecured Credentials", 0.059772309272231164], ["Execution Guardrails", 0.045486518703204214], ["Modify Authentication Process", 0.0431375147459686], ["Masquerading", 0.03319894805482407]], "decrypting and running the ransomware": [["Data Encrypted for Impact", 0.38713919910469896], ["Deobfuscate/Decode Files or Information", 0.3188198993956957], ["Archive Collected Data", 0.04269717108619473], ["Obfuscated Files or Information", 0.03460009050846059], ["Weaken Encryption", 0.015357498209357898], ["Execution Guardrails", 0.013193965344034286]], "The user is then prompted to open the single visible shortcut (2) file.": [["Boot or Logon Autostart Execution", 0.16339694205313787], ["Office Application Startup", 0.08607742154350577], ["User Execution", 0.0576861528290548], ["Masquerading", 0.05394753561661528], ["File and Directory Discovery", 0.041433293471258625], ["Hide Artifacts", 0.03928533658629609]], "contains obfuscated VBA scripts or a binary with a JPG extension": [["Obfuscated Files or Information", 0.6687264314349466], ["Deobfuscate/Decode Files or Information", 0.04054530334079068], ["Masquerading", 0.038729401041871746], ["Archive Collected Data", 0.028295387759427807], ["Data Obfuscation", 0.023900627612310984], ["Hide Artifacts", 0.009662040444033938]], "to trick users into opening the malicious attachments in": [["User Execution", 0.8099914496464483], ["Phishing", 0.0843654686732499], ["Template Injection", 0.009582119137636902], ["Masquerading", 0.009240036635426522], ["Office Application Startup", 0.005750193911691215], ["Command and Scripting Interpreter", 0.003872025185825365]], "If a target opens the malicious attachment,": [["User Execution", 0.47978083531377086], ["Phishing", 0.11858877194455145], ["Template Injection", 0.020598742649723754], ["Ingress Tool Transfer", 0.020327422643971176], ["Obfuscated Files or Information", 0.016511178383316904], ["Masquerading", 0.016254794566508243]], "using three possible types of messages to try to get a target to open the email and malicious attachment.": [["User Execution", 0.4384377410183792], ["Phishing", 0.3067495350506179], ["Office Application Startup", 0.0182538983532841], ["Email Collection", 0.017071732411706727], ["Phishing for Information", 0.016795981675103003], ["Internal Spearphishing", 0.010807864236818256]], "The attachment, if opened,": [["User Execution", 0.15084501297918607], ["File and Directory Discovery", 0.12309346767637862], ["Phishing", 0.04589552229398433], ["Ingress Tool Transfer", 0.04263983577827777], ["Virtualization/Sandbox Evasion", 0.029606338587072307], ["Masquerading", 0.024436785889204445]], "spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.": [["Phishing", 0.43756695587298655], ["User Execution", 0.22974307890738013], ["Phishing for Information", 0.05319830049760742], ["Internal Spearphishing", 0.03471651682185582], ["Compromise Accounts", 0.015986083492208394], ["Establish Accounts", 0.013235854487006392]], "a malicious attachment sent via phishing emails": [["Phishing", 0.51713047034207], ["User Execution", 0.2000293149870114], ["Phishing for Information", 0.03348838530657322], ["Internal Spearphishing", 0.024611747405802627], ["Email Collection", 0.011382566370048497], ["Template Injection", 0.011171401212819588]], "the malicious attachment,": [["User Execution", 0.2425867850229755], ["Phishing", 0.2383773170623529], ["Ingress Tool Transfer", 0.06940834971586848], ["Masquerading", 0.023572100645242], ["Obfuscated Files or Information", 0.020692009829580166], ["Template Injection", 0.018424559104989167]], "the email and malicious attachment.": [["Phishing", 0.24557499751019268], ["Email Collection", 0.16145311267728052], ["User Execution", 0.059840847493806255], ["Application Layer Protocol", 0.037014687973503636], ["Data Manipulation", 0.024038355855339397], ["Office Application Startup", 0.02114372381332673]], "sends emails pretending to be related to a shipment notice for the target which contain a malicious attachment.": [["Phishing", 0.4934108287487202], ["User Execution", 0.15888406111511266], ["Phishing for Information", 0.03220253323717813], ["Email Collection", 0.019943943270320983], ["Internal Spearphishing", 0.01286393175176495], ["Masquerading", 0.012192261327411275]], "Both send information to command and control (C2) servers": [["Application Layer Protocol", 0.19749021844282552], ["Exfiltration Over C2 Channel", 0.14512692932620444], ["Web Service", 0.13151399478900674], ["Fallback Channels", 0.07030814673296068], ["Data Encoding", 0.03431285980399305], ["Scheduled Transfer", 0.025768222111309948]], "keylogging every tap": [["Input Capture", 0.8180797897443947], ["Clipboard Data", 0.008111484547215199], ["Boot or Logon Autostart Execution", 0.006241751825084761], ["Event Triggered Execution", 0.005699312921054902], ["Remote Services", 0.004763267042917322], ["Screen Capture", 0.004600552636839157]], "obtain logs of the infected machine\u2019s keystrokes": [["Input Capture", 0.8129135912772093], ["Unsecured Credentials", 0.008915825274761834], ["Clipboard Data", 0.008311572176315733], ["Automated Collection", 0.00732236488145482], ["Screen Capture", 0.007086657580243399], ["Credentials from Password Stores", 0.006773965836161649]], "exfiltrate data from messaging applications such as WhatsApp and Viber": [["Exfiltration Over C2 Channel", 0.12178215961255198], ["Archive Collected Data", 0.07891908235799082], ["Exfiltration Over Web Service", 0.07616081845691336], ["Exfiltration Over Alternative Protocol", 0.07548119745500291], ["Automated Exfiltration", 0.04534723796930092], ["Data Staged", 0.04463351399807917]], "The malware can deliver payloads from the command and control (C2) server": [["Ingress Tool Transfer", 0.15699715721726412], ["Web Service", 0.10900410661354806], ["Application Layer Protocol", 0.09687189630879811], ["Command and Scripting Interpreter", 0.04999900513648376], ["Exfiltration Over C2 Channel", 0.03659315539862794], ["Inter-Process Communication", 0.03631822401039617]], "This vulnerability allows for a threat actor to obtain system privileges": [["Exploitation for Privilege Escalation", 0.4758414848645204], ["Abuse Elevation Control Mechanism", 0.07649204936584858], ["Exploitation of Remote Services", 0.046816282465127805], ["Exploitation for Client Execution", 0.02677467024702068], ["Access Token Manipulation", 0.02529664535232748], ["Domain Policy Modification", 0.025132253134233652]], "take screenshots": [["Screen Capture", 0.8839768513061057], ["Video Capture", 0.0174241537565553], ["Application Window Discovery", 0.008593088694807275], ["Input Capture", 0.005917703090588895], ["Clipboard Data", 0.003680266050045255], ["Data from Local System", 0.003351005603877269]], "This version of CEIDPageLock has VMProtect, which makes analysis and unpacking difficult": [["Virtualization/Sandbox Evasion", 0.09071659705625887], ["Deobfuscate/Decode Files or Information", 0.08153990314902237], ["Obfuscated Files or Information", 0.04612455501318009], ["Data Encrypted for Impact", 0.03683431070389794], ["OS Credential Dumping", 0.030542249293627383], ["Process Injection", 0.029648584280213296]], "then proceeded to dump credentials from LSASS.": [["OS Credential Dumping", 0.543022071681109], ["Unsecured Credentials", 0.1347123971918521], ["Credentials from Password Stores", 0.1066489228108083], ["Input Capture", 0.027708435928493726], ["Network Sniffing", 0.01751948787369997], ["Brute Force", 0.0124177585023183]], "the threat actors again used Get-System to elevate and then dumped LSASS.": [["OS Credential Dumping", 0.16683613702272385], ["System Information Discovery", 0.058985892829888836], ["File and Directory Discovery", 0.058130253672692596], ["Virtualization/Sandbox Evasion", 0.0521897861588821], ["Query Registry", 0.04145811020435361], ["Native API", 0.034167096730955505]], "Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.": [["OS Credential Dumping", 0.061623456857531594], ["Indicator Removal", 0.04336631949970847], ["Impair Defenses", 0.03692312077139045], ["Deobfuscate/Decode Files or Information", 0.036629231447574344], ["Automated Collection", 0.03371424429688348], ["System Information Discovery", 0.03296164712583129]], "threat actor injected into a dllhost.exe process": [["Process Injection", 0.5661456493902217], ["System Binary Proxy Execution", 0.08836422297165625], ["Hijack Execution Flow", 0.04651349473780389], ["Event Triggered Execution", 0.03726775511885618], ["Native API", 0.03588233177803643], ["Masquerading", 0.020613378086912944]], "which is then injected into svchost and dllhost.": [["Process Injection", 0.25938613428730467], ["Hijack Execution Flow", 0.09403615386420093], ["System Binary Proxy Execution", 0.06913301761448173], ["Obfuscated Files or Information", 0.0690569848417513], ["Shared Modules", 0.03290407118510578], ["Masquerading", 0.03089513542147071]], "Process injection was observed during the intrusion": [["Process Injection", 0.5162511634178563], ["Process Discovery", 0.09689310535997134], ["Native API", 0.041773789281759136], ["Access Token Manipulation", 0.029183039480948764], ["Impair Defenses", 0.02887517284741723], ["Event Triggered Execution", 0.01278184956626654]], "direct Cobalt Strike processes and the injected processes": [["Process Injection", 0.21648719741846356], ["Process Discovery", 0.10937329689619016], ["Impair Defenses", 0.03504843124097716], ["Resource Hijacking", 0.02956597083913473], ["Event Triggered Execution", 0.026712724555672685], ["Native API", 0.02462950291712857]], "injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.": [["Process Injection", 0.7217854943389433], ["Native API", 0.06346324756962138], ["Hijack Execution Flow", 0.03221376773520097], ["System Binary Proxy Execution", 0.028844067781272284], ["Event Triggered Execution", 0.01596808893627752], ["System Services", 0.01168243003536925]], "dumped from an injection into the SearchIndexer process": [["Native API", 0.11319463499533919], ["Process Injection", 0.09173066265377329], ["Automated Collection", 0.053072492555555933], ["Hijack Execution Flow", 0.040535242208069755], ["File and Directory Discovery", 0.03390275423091496], ["Deobfuscate/Decode Files or Information", 0.02490334906635508]], "This was achieved by transferring a Cobalt Strike DLL over SMB": [["Remote Services", 0.23011784484644945], ["Lateral Tool Transfer", 0.19530208594064133], ["Taint Shared Content", 0.07026404534550497], ["Exploitation of Remote Services", 0.05405014206830538], ["Ingress Tool Transfer", 0.037044579591837073], ["System Services", 0.027817663568055324]], "the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.": [["Lateral Tool Transfer", 0.2372623579345021], ["Remote Services", 0.1639850575392347], ["Taint Shared Content", 0.06974411198519692], ["Exploitation of Remote Services", 0.03865055561404062], ["Valid Accounts", 0.03466439149780775], ["Communication Through Removable Media", 0.02474552824169505]], "SMB to transfer DLL's into the ProgramData folder of hosts for purposes of lateral movement.": [["Lateral Tool Transfer", 0.13288584949735835], ["Taint Shared Content", 0.11443977379043639], ["Remote Services", 0.07328843292154041], ["Hijack Execution Flow", 0.058456063493026574], ["System Binary Proxy Execution", 0.04086673726320182], ["Masquerading", 0.040383981892663]], "and executing via a remote service on another workstation.": [["Remote Services", 0.15635490064367663], ["System Services", 0.1354174445277804], ["Scheduled Task/Job", 0.06620910866651376], ["Inter-Process Communication", 0.0394782699198185], ["Windows Management Instrumentation", 0.03877348456302923], ["Event Triggered Execution", 0.033397129807106]], "using a batch file named find.bat.": [["File and Directory Discovery", 0.30408282119275076], ["Automated Collection", 0.10672992172687513], ["Indicator Removal", 0.03744199828576725], ["Command and Scripting Interpreter", 0.034387199753883366], ["Masquerading", 0.030547298336657164], ["Data Staged", 0.028185504663998575]], "Windows discovery commands": [["File and Directory Discovery", 0.3578740309308427], ["Windows Management Instrumentation", 0.06814578039625319], ["Masquerading", 0.040043218819860324], ["Native API", 0.03591963857483413], ["Automated Collection", 0.03170323727308984], ["Remote System Discovery", 0.027533384415717503]], "using a batch script": [["Command and Scripting Interpreter", 0.7563470601712083], ["Scheduled Task/Job", 0.03038786706142708], ["System Binary Proxy Execution", 0.01324054942222482], ["Windows Management Instrumentation", 0.010500051563012772], ["System Services", 0.007631756505467242], ["Indicator Removal", 0.007190323172420473]], "batch script": [["Command and Scripting Interpreter", 0.7299422955318424], ["Scheduled Task/Job", 0.041585067438134705], ["System Binary Proxy Execution", 0.013375261016816797], ["Windows Management Instrumentation", 0.013084066788638615], ["Inter-Process Communication", 0.010018261069360207], ["System Services", 0.008346277652312035]], "basic discovery tasks on the host using built in Windows utilities.": [["Remote System Discovery", 0.17340952825222472], ["File and Directory Discovery", 0.09646698847771562], ["Network Share Discovery", 0.09401975011554015], ["Windows Management Instrumentation", 0.08811745050466194], ["Network Service Discovery", 0.05075712835765042], ["System Information Discovery", 0.04112209615475398]], "C:\\Windows\\system32\\cmd.exe /C": [["Native API", 0.1331577001742168], ["Masquerading", 0.10039591457046008], ["File and Directory Discovery", 0.0962226818413464], ["System Binary Proxy Execution", 0.05491019659964276], ["Command and Scripting Interpreter", 0.053323963481769515], ["Windows Management Instrumentation", 0.05034487194600984]], "via the find.bat batch script.": [["File and Directory Discovery", 0.17408371046663887], ["Command and Scripting Interpreter", 0.10829949424745887], ["Windows Management Instrumentation", 0.05599838321596053], ["Automated Collection", 0.04993611756109379], ["Indicator Removal", 0.04933381033249418], ["Masquerading", 0.04841257748489646]], "which was then fed to a batch script": [["Command and Scripting Interpreter", 0.7289901789457588], ["Scheduled Task/Job", 0.02872073718982853], ["System Binary Proxy Execution", 0.021854836004120054], ["Windows Management Instrumentation", 0.011871572723897402], ["Automated Collection", 0.009878995580261824], ["System Services", 0.009468527582000352]], "The batch file contained one line,": [["Command and Scripting Interpreter", 0.35594544518993015], ["Indicator Removal", 0.0923325899452767], ["System Binary Proxy Execution", 0.0431885667381434], ["Modify Registry", 0.030879213140915265], ["Scheduled Task/Job", 0.02940955651363382], ["Indirect Command Execution", 0.02183582967943192]], "began enumerating the network using native Windows binaries": [["Remote System Discovery", 0.353741066962374], ["System Network Connections Discovery", 0.12780128027333762], ["System Network Configuration Discovery", 0.10426844439268372], ["Network Share Discovery", 0.09182264247949609], ["Network Service Discovery", 0.06212994540050629], ["Data from Configuration Repository", 0.048611488660189016]], "via the interactive shell": [["Command and Scripting Interpreter", 0.5333994304599841], ["Native API", 0.046775521329551616], ["Indirect Command Execution", 0.02692655707561337], ["Event Triggered Execution", 0.02134259519353904], ["Windows Management Instrumentation", 0.01848342539541364], ["System Services", 0.017007240272337198]], "wrote a registry run key for persistence": [["Boot or Logon Autostart Execution", 0.5684127229910921], ["Modify Registry", 0.11923389268161533], ["Boot or Logon Initialization Scripts", 0.06793430402488673], ["Create or Modify System Process", 0.04099370268806538], ["Event Triggered Execution", 0.04089111664270327], ["Query Registry", 0.020337123604304886]], "used a registry run key to maintain persistence.": [["Boot or Logon Autostart Execution", 0.3899090813399862], ["Boot or Logon Initialization Scripts", 0.09701184659094045], ["Event Triggered Execution", 0.09040055804672965], ["Create or Modify System Process", 0.07716634610638651], ["Modify Registry", 0.0556368933704316], ["Scheduled Task/Job", 0.040911463277110885]], "C:\\Windows\\system32\\cmd.exe /C systeminfo": [["System Information Discovery", 0.626603293273359], ["Windows Management Instrumentation", 0.09012667728343311], ["Query Registry", 0.03746708605808297], ["File and Directory Discovery", 0.029518284715428496], ["Software Discovery", 0.02741566069944916], ["Process Discovery", 0.017638017773389088]], "sending new emails with attached xls and zip files.": [["Phishing", 0.37402745159766065], ["Email Collection", 0.08187168051768405], ["User Execution", 0.06625704356486452], ["Archive Collected Data", 0.03648477963957411], ["Office Application Startup", 0.03623453818487567], ["Application Layer Protocol", 0.021858665776246]], "The document came in via email in the form of a zip file which included an xls file.": [["Template Injection", 0.14614762662348466], ["Phishing", 0.12807690452281992], ["Archive Collected Data", 0.047684983709380874], ["Email Collection", 0.04627226304512897], ["Office Application Startup", 0.04235955305444065], ["User Execution", 0.039712845900124125]], "The emails were sent through various compromised email accounts, propagating additional malicious xls files": [["Email Collection", 0.3327467287716975], ["Phishing", 0.09829831152769003], ["Data Manipulation", 0.037236584904660815], ["Office Application Startup", 0.0314669280273949], ["Automated Collection", 0.024654828964568852], ["Automated Exfiltration", 0.02032091948221147]], "Using the remote admin tools": [["Remote Access Software", 0.16757419990006067], ["Remote Services", 0.1336091294801761], ["Valid Accounts", 0.10858015640962501], ["Command and Scripting Interpreter", 0.04080094292760373], ["Create Account", 0.03176283429410862], ["Lateral Tool Transfer", 0.030758026396136]], "the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment": [["Remote Access Software", 0.13586371794972912], ["External Remote Services", 0.08837432808201028], ["Remote Services", 0.08226471377916193], ["Remote Service Session Hijacking", 0.06287394324294542], ["Exploitation of Remote Services", 0.06034362648539983], ["Valid Accounts", 0.04134469473898156]], "Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.": [["Exploitation of Remote Services", 0.09997893358072939], ["Remote Access Software", 0.08004723460195583], ["Remote Services", 0.07654403439587595], ["External Remote Services", 0.05785923396746657], ["Exploit Public-Facing Application", 0.04801493829455189], ["Valid Accounts", 0.03869600158640043]], "after a user opened an Excel document and enabled macros.": [["Office Application Startup", 0.6008113595681017], ["Command and Scripting Interpreter", 0.045992407187713275], ["User Execution", 0.03929768221754178], ["Data Manipulation", 0.01789534290282335], ["Template Injection", 0.01492129426581605], ["Virtualization/Sandbox Evasion", 0.014153748853681326]], "To deobfuscate the document the tool xlmdeobfuscator was used with the following output.": [["Deobfuscate/Decode Files or Information", 0.4958314555190937], ["Obfuscated Files or Information", 0.16202208226666426], ["Archive Collected Data", 0.06659615991629265], ["Data Encrypted for Impact", 0.021282892240895652], ["Hide Artifacts", 0.013891204490263423], ["Data Encoding", 0.013471657231236094]], "After deobfuscation": [["Deobfuscate/Decode Files or Information", 0.5258660250056004], ["Obfuscated Files or Information", 0.15707409626035912], ["Archive Collected Data", 0.021141208299339822], ["Indicator Removal", 0.017821923595355327], ["Hide Artifacts", 0.012533602783767913], ["Data Encoding", 0.012312479514469721]], "used process hollowing to launch under the context of the Dllhost.exe process": [["Process Injection", 0.46876835686183543], ["Native API", 0.1514919939079076], ["System Binary Proxy Execution", 0.06746872272373283], ["Hijack Execution Flow", 0.056689577096669316], ["Access Token Manipulation", 0.035792648686208864], ["System Services", 0.022952962405469603]], "the following URLs are hard coded, and obfuscated": [["Obfuscated Files or Information", 0.2592744123472173], ["Data Encoding", 0.11719682449870795], ["Data Obfuscation", 0.07437353557562909], ["Masquerading", 0.04030867385319901], ["Web Service", 0.031897566319568194], ["Deobfuscate/Decode Files or Information", 0.03177861948976898]], "to download the second stage.": [["Ingress Tool Transfer", 0.4411216028878107], ["Multi-Stage Channels", 0.0633145053301785], ["BITS Jobs", 0.04481510578834021], ["Command and Scripting Interpreter", 0.02074227390806338], ["Fallback Channels", 0.01994306409034135], ["Stage Capabilities", 0.01691605344183094]], "malware pulled down and executed a Cobalt Strike payload on": [["Command and Scripting Interpreter", 0.08807923190007232], ["Ingress Tool Transfer", 0.0751763222310718], ["Deobfuscate/Decode Files or Information", 0.07159830606697726], ["Obfuscated Files or Information", 0.03400013895220744], ["Inter-Process Communication", 0.03258748148544796], ["Execution Guardrails", 0.03007461117201269]], "ran another round of discovery activity with native windows utilities": [["File and Directory Discovery", 0.11220916034013366], ["Automated Collection", 0.07256509734687015], ["Windows Management Instrumentation", 0.05976822855890422], ["Indicator Removal", 0.04861649392745636], ["Masquerading", 0.037291633277942764], ["Data from Network Shared Drive", 0.03405244175866785]], "\u201cC:\\Windows\\System32\\cmd.exe\u201d\u00a0CommandLine: \u201cC:\\Windows\\system32\\cmd.exe /c": [["Native API", 0.20147146353971918], ["Command and Scripting Interpreter", 0.1038335577332037], ["System Binary Proxy Execution", 0.08152837537139986], ["Masquerading", 0.07736720944288589], ["Hijack Execution Flow", 0.04473866506409675], ["File and Directory Discovery", 0.03956992188841523]], "C:\\Windows\\system32\\cmd.exe /C\u00a0gpupdate\u00a0": [["Abuse Elevation Control Mechanism", 0.10608879425586473], ["Domain Policy Modification", 0.10439445377315686], ["Access Token Manipulation", 0.09109888425120419], ["File and Directory Permissions Modification", 0.0298412436195665], ["Permission Groups Discovery", 0.028042668261623126], ["Event Triggered Execution", 0.02467882396850401]], "whoami.exe": [["System Owner/User Discovery", 0.2541255412696597], ["Event Triggered Execution", 0.052285361223474665], ["Native API", 0.05146745267109026], ["Windows Management Instrumentation", 0.046429504442688924], ["Masquerading", 0.04097285088760534], ["System Binary Proxy Execution", 0.03841937204131617]], "cmd.exe /C whoami": [["System Owner/User Discovery", 0.41656345577288767], ["Access Token Manipulation", 0.050676971708693466], ["Account Discovery", 0.04350987489339996], ["Command and Scripting Interpreter", 0.039352950494546644], ["Event Triggered Execution", 0.036150027150575435], ["Windows Management Instrumentation", 0.03227511609615664]], "The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon": [["Remote System Discovery", 0.08529169622040199], ["Lateral Tool Transfer", 0.0668243196888052], ["Fallback Channels", 0.043706087553939836], ["Software Deployment Tools", 0.0429659862175271], ["Remote Services", 0.04221411866715796], ["Exploitation of Remote Services", 0.03829925666653331]], "the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.": [["System Services", 0.17294927241139152], ["System Binary Proxy Execution", 0.062037429582618084], ["Hijack Execution Flow", 0.052608715711162914], ["Ingress Tool Transfer", 0.04488127065173885], ["BITS Jobs", 0.03835757714491469], ["Event Triggered Execution", 0.033383116618312426]], "They utilized RDP,": [["Remote Services", 0.39876573230913565], ["Remote Access Software", 0.13725615485326095], ["External Remote Services", 0.033316161049367715], ["Remote Service Session Hijacking", 0.029467298757260393], ["Exploitation of Remote Services", 0.02780864987216417], ["Valid Accounts", 0.015529136900050637]], "the threat actor was seen establishing RDP connections": [["Remote Services", 0.45037239475291907], ["Remote Service Session Hijacking", 0.0803753746005031], ["Remote Access Software", 0.05520965891641305], ["System Network Connections Discovery", 0.04633471213965095], ["External Remote Services", 0.032270938995358614], ["Exploitation of Remote Services", 0.026367585733687533]], "Cobalt Strike was used to enable RDP,": [["Remote Services", 0.5802907132996734], ["Remote Access Software", 0.134697104935604], ["Exploitation of Remote Services", 0.03540580183350392], ["Remote Service Session Hijacking", 0.023586139094409618], ["External Remote Services", 0.0097115458101865], ["Windows Management Instrumentation", 0.008898347112439017]], "remotedesktop mode = enable\u00a0cmd": [["Remote Services", 0.1721310595824561], ["Remote Access Software", 0.1376806732005601], ["Command and Scripting Interpreter", 0.10695181329648133], ["Windows Management Instrumentation", 0.06363341823962018], ["System Services", 0.04151741089520589], ["Event Triggered Execution", 0.04103661461065394]], "RDP connections were established from the beachhead host to systems throughout the environment": [["Remote Services", 0.2746682511005465], ["System Network Connections Discovery", 0.09564000382196988], ["Remote Access Software", 0.06370272132413328], ["External Remote Services", 0.05450836571906924], ["Remote Service Session Hijacking", 0.05310131808080909], ["Exploitation of Remote Services", 0.033611777669427766]], "details of the RDP session": [["Remote Services", 0.1677452030073872], ["System Network Connections Discovery", 0.14002431835228618], ["Remote Service Session Hijacking", 0.09593726240583153], ["System Owner/User Discovery", 0.07207481953882805], ["System Information Discovery", 0.03241476371001428], ["Input Capture", 0.026527461799415564]], "the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.": [["Phishing", 0.18854324634610026], ["User Execution", 0.16324231641520856], ["Obfuscated Files or Information", 0.06914912682731793], ["Template Injection", 0.0432565444999099], ["Stage Capabilities", 0.04095956776263904], ["Archive Collected Data", 0.032128285982752275]], "This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.": [["Remote Services", 0.2609849533310355], ["Proxy", 0.06421866761962454], ["Remote Service Session Hijacking", 0.05665243372430851], ["System Network Connections Discovery", 0.03892696420095747], ["Non-Application Layer Protocol", 0.035792027827936695], ["Protocol Tunneling", 0.029985914688562484]], "in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender": [["Impair Defenses", 0.416532493869579], ["Software Discovery", 0.08525690934145665], ["Windows Management Instrumentation", 0.03319981032365201], ["Masquerading", 0.027364845176710922], ["Subvert Trust Controls", 0.02314518201538115], ["Hide Artifacts", 0.018007768961910853]], "To evade detection, the threat actors disabled Windows Defender": [["Impair Defenses", 0.3381935716403798], ["Masquerading", 0.06858328110726629], ["Software Discovery", 0.054973852434905164], ["Hide Artifacts", 0.04793314368632541], ["Subvert Trust Controls", 0.03623626968700449], ["Domain Policy Modification", 0.018912063191947524]], "they disabled Windows Defender via a group policy modification.": [["Impair Defenses", 0.41334716581342523], ["Software Discovery", 0.06183100820689054], ["File and Directory Permissions Modification", 0.02831271282879623], ["Windows Management Instrumentation", 0.02492999342877677], ["Subvert Trust Controls", 0.02144052889938346], ["Domain Policy Modification", 0.01991358236496173]], "by adding the below to an already linked GPO.": [["Domain Policy Modification", 0.31791885306194173], ["Abuse Elevation Control Mechanism", 0.07205084707368284], ["Account Manipulation", 0.05894405237704484], ["File and Directory Permissions Modification", 0.05042735407394868], ["Access Token Manipulation", 0.039471654630679844], ["Create Account", 0.02800214512944798]], "They then force updated the GPO on all clients using Cobalt Strike.": [["Domain Policy Modification", 0.18498026461862638], ["File and Directory Permissions Modification", 0.03493935210119951], ["Account Manipulation", 0.032507138838812365], ["Abuse Elevation Control Mechanism", 0.031227569157414037], ["Supply Chain Compromise", 0.027441360373751496], ["Impair Defenses", 0.026460974588303238]], "Cobalt Strike Beacon was dropped and executed on the system": [["Indicator Removal", 0.06135114364422595], ["Fallback Channels", 0.05752151413290882], ["System Services", 0.04345972207455594], ["Impair Defenses", 0.039534612068880294], ["Deobfuscate/Decode Files or Information", 0.02840244316785432], ["Scheduled Transfer", 0.025189912634904388]], "was executed via rundll32.exe": [["Native API", 0.2624402612512002], ["System Binary Proxy Execution", 0.2299220372193297], ["Hijack Execution Flow", 0.04577716134201525], ["Windows Management Instrumentation", 0.03956176216145067], ["Process Injection", 0.03696394795011783], ["Masquerading", 0.030500755677717012]], "including the computer name and the OS version of the compromised system were sent": [["System Information Discovery", 0.7197623220529296], ["System Owner/User Discovery", 0.028835921406383035], ["System Network Configuration Discovery", 0.02543309144339166], ["Remote System Discovery", 0.02073772089876629], ["Automated Collection", 0.01939512282679616], ["Gather Victim Host Information", 0.014189161724125038]], "cmd.exe /C reg add": [["Boot or Logon Autostart Execution", 0.20027270878704967], ["Modify Registry", 0.1335396931431369], ["System Binary Proxy Execution", 0.10010394061095149], ["Event Triggered Execution", 0.05115044447005243], ["Indirect Command Execution", 0.041523480326801906], ["Masquerading", 0.040827298442003564]], "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware\u00a0\nDeleteValue\u00a0": [["Indicator Removal", 0.340861023902848], ["Inhibit System Recovery", 0.11619657681719132], ["Impair Defenses", 0.08007197085391925], ["Modify Registry", 0.07250097245802445], ["Data Destruction", 0.0412752948393119], ["System Shutdown/Reboot", 0.018775263702751604]], "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableRealtimeMonitoring\u00a0\nDeleteValue\u00a0": [["Indicator Removal", 0.5760954774396199], ["Impair Defenses", 0.13851077514029583], ["Inhibit System Recovery", 0.03258292141877986], ["Modify Registry", 0.0285454894430667], ["Data Destruction", 0.013952852912025951], ["Service Stop", 0.012410140398456856]], "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableBehaviorMonitoring\u00a0\nDeleteValue\u00a0": [["Indicator Removal", 0.3427045566534954], ["Impair Defenses", 0.1437393317064108], ["Modify Registry", 0.08457441563754714], ["Inhibit System Recovery", 0.07383644342290972], ["Data Destruction", 0.022554342107111613], ["File and Directory Permissions Modification", 0.019100263924177862]], "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Monitoring\\DisableIntrusionPreventionSystem\u00a0\nDeleteValue\u00a0": [["Indicator Removal", 0.25057021229418835], ["Impair Defenses", 0.18385840931668473], ["Inhibit System Recovery", 0.07872459402231212], ["Modify Registry", 0.07486819619300615], ["Data Destruction", 0.02399451884472732], ["File and Directory Permissions Modification", 0.02074854337563587]], "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\u00a0\nDeleteKey\u00a0": [["Indicator Removal", 0.17346207362917038], ["Modify Registry", 0.17093926524717448], ["Impair Defenses", 0.09748528875860557], ["Inhibit System Recovery", 0.059955457293740536], ["Query Registry", 0.03837809422103328], ["Boot or Logon Autostart Execution", 0.03183555014148763]], "The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed": [["Proxy", 0.3183848045752716], ["Protocol Tunneling", 0.10894486453172288], ["Remote Services", 0.06726855863899474], ["Non-Application Layer Protocol", 0.03531512912563596], ["Encrypted Channel", 0.02856698046747272], ["Non-Standard Port", 0.025007748345076228]], "This proxied traffic": [["Proxy", 0.5320117260682925], ["Data Obfuscation", 0.045571163791218595], ["Adversary-in-the-Middle", 0.03694340504374963], ["Protocol Tunneling", 0.03356065821345563], ["Application Layer Protocol", 0.027213686776919016], ["Non-Application Layer Protocol", 0.024809323733552074]], "LSASS was accessed by an unusual process \u201crunonce.exe\u201d on multiple hosts, including a domain controller.": [["OS Credential Dumping", 0.09196552956091132], ["Process Discovery", 0.08660472173008572], ["Indicator Removal", 0.061867147924794266], ["Native API", 0.06150622916096572], ["File and Directory Discovery", 0.05109125200530943], ["Windows Management Instrumentation", 0.049447176089562575]], "systems injected the Conti DLL into memory": [["Process Injection", 0.4239493860827634], ["Hijack Execution Flow", 0.16127255312974456], ["Shared Modules", 0.10817013173051], ["System Binary Proxy Execution", 0.04512395052061959], ["Event Triggered Execution", 0.02661774443504517], ["Native API", 0.01672131097674696]], "web application vulnerabilities": [["Exploit Public-Facing Application", 0.25855852436803295], ["Exploitation for Client Execution", 0.0955415789085872], ["Stage Capabilities", 0.0824406107760941], ["Server Software Component", 0.06911340950405395], ["Drive-by Compromise", 0.05024680017815977], ["Obtain Capabilities", 0.041264760848063735]], "exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891": [["Exploitation for Client Execution", 0.45941554179192606], ["Exploit Public-Facing Application", 0.16461428108011056], ["Exploitation of Remote Services", 0.05327896531411365], ["Exploitation for Privilege Escalation", 0.048084802628038305], ["Obtain Capabilities", 0.024325126913124898], ["Develop Capabilities", 0.012212949412745307]], "GrandstreamCVE-2020-25223WebAdmin of Sophos SG UTMCVE-2021-42013ApacheCVE-2022-31137Roxy-WICVE-2022-33891Apache SparkZSL-": [["Automated Collection", 0.14095615684887286], ["Automated Exfiltration", 0.04116067556400758], ["Data Transfer Size Limits", 0.039147179193214726], ["Data Staged", 0.038669042839068454], ["Archive Collected Data", 0.03601023526286452], ["Web Service", 0.03599750348121693]], "CVE-2018-12613, a phpMyAdmin vulnerability that could allow threat actors to view or execute files": [["Exploitation for Client Execution", 0.07291734868305241], ["Exploit Public-Facing Application", 0.06188200966574605], ["Server Software Component", 0.058872499554965], ["Ingress Tool Transfer", 0.04729443834400991], ["Phishing", 0.032326998402126855], ["User Execution", 0.03204082053194983]], "propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials": [["Brute Force", 0.38558230961393714], ["Multi-Factor Authentication Interception", 0.09011678599264977], ["Modify Authentication Process", 0.06855867793244505], ["Forced Authentication", 0.03606033743844026], ["Exploitation for Credential Access", 0.03506937940135041], ["Valid Accounts", 0.02945213715142845]], "default or weak credentials": [["Modify Authentication Process", 0.1447601929789139], ["Valid Accounts", 0.1169475623629878], ["Brute Force", 0.07174571935447711], ["Forced Authentication", 0.05819567092432123], ["Unsecured Credentials", 0.04383212027768197], ["Credentials from Password Stores", 0.04188192207760777]], "using a combination of eight common usernames and 130 passwords": [["Brute Force", 0.6062045409889985], ["Modify Authentication Process", 0.05158286133074895], ["Valid Accounts", 0.028916026925085117], ["Credentials from Password Stores", 0.020525741254710596], ["Use Alternate Authentication Material", 0.018645541612827454], ["Password Policy Discovery", 0.018638642131500037]], "malicious payload": [["Obfuscated Files or Information", 0.111848990331926], ["Ingress Tool Transfer", 0.049452486433490934], ["Command and Scripting Interpreter", 0.043222113478512174], ["Inter-Process Communication", 0.04280325707825934], ["System Binary Proxy Execution", 0.04101510814646575], ["User Execution", 0.03649196058277032]], "downloads": [["Ingress Tool Transfer", 0.31232291497176373], ["BITS Jobs", 0.08086341632418018], ["Application Layer Protocol", 0.036214573765268286], ["Command and Scripting Interpreter", 0.02155485554146748], ["Fallback Channels", 0.016467218276871143], ["Obtain Capabilities", 0.014316601488202274]], "downloads the Zerobot binary": [["Ingress Tool Transfer", 0.2844411828757239], ["Command and Scripting Interpreter", 0.14701482581090777], ["BITS Jobs", 0.12981022012895824], ["Deobfuscate/Decode Files or Information", 0.03631301919109551], ["System Binary Proxy Execution", 0.021742963511850094], ["Web Service", 0.017928733566487123]], "download and execute binaries of various architectures until it succeeds": [["Ingress Tool Transfer", 0.24737214733514748], ["BITS Jobs", 0.16732401904343555], ["Command and Scripting Interpreter", 0.15945880767938442], ["System Binary Proxy Execution", 0.04756916887763934], ["Native API", 0.027005444817474758], ["Virtualization/Sandbox Evasion", 0.0197871502360459]], "download this RAT,": [["Ingress Tool Transfer", 0.09640189551340185], ["Obtain Capabilities", 0.05275411055428254], ["BITS Jobs", 0.05082135423913844], ["Screen Capture", 0.04098254004281222], ["Command and Scripting Interpreter", 0.03414130084093243], ["Video Capture", 0.0291270643544019]], "identify the architecture": [["System Information Discovery", 0.20235047102588527], ["Virtualization/Sandbox Evasion", 0.06939997594293024], ["Software Discovery", 0.04521613122533557], ["Windows Management Instrumentation", 0.03450253210113041], ["Gather Victim Host Information", 0.02710150783232408], ["Peripheral Device Discovery", 0.025028862566792168]], "copies itself to the Startup folder": [["Boot or Logon Autostart Execution", 0.14511013744833576], ["Replication Through Removable Media", 0.1098255124021227], ["Masquerading", 0.04333779448192774], ["Boot or Logon Initialization Scripts", 0.04269841878584308], ["Create or Modify System Process", 0.04047394452665927], ["Data Staged", 0.034263731679589446]], "methodDescriptionUDP_LEGITSends UDP packets without data": [["Network Sniffing", 0.1937662921295632], ["Non-Application Layer Protocol", 0.12952047227899358], ["Adversary-in-the-Middle", 0.05346066534955994], ["Data Obfuscation", 0.05205125510281822], ["Non-Standard Port", 0.036539019531124546], ["Traffic Signaling", 0.03621011503488832]], "TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.": [["Non-Application Layer Protocol", 0.3727066167237939], ["Non-Standard Port", 0.08185617966634506], ["Traffic Signaling", 0.05662141146904179], ["Encrypted Channel", 0.0414714245590911], ["Application Layer Protocol", 0.03657255297008768], ["Network Sniffing", 0.0334962275817768]], "TLS_SOCKETContinuously sends random payloads on an open TLS socket.": [["Non-Application Layer Protocol", 0.22491038636414953], ["Non-Standard Port", 0.13395980274827085], ["Encrypted Channel", 0.12297123647883353], ["Data Obfuscation", 0.06143941806112438], ["Application Layer Protocol", 0.04881286632322024], ["Protocol Tunneling", 0.030928931892225137]], "methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).": [["Non-Application Layer Protocol", 0.13548828812285107], ["Network Sniffing", 0.06369330995810424], ["Application Layer Protocol", 0.0571972114721879], ["Data Obfuscation", 0.04950727691260108], ["Adversary-in-the-Middle", 0.04707045869056712], ["Non-Standard Port", 0.043903884079370153]], "HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (": [["Application Layer Protocol", 0.35619633562586805], ["Data Obfuscation", 0.07636982103065469], ["Data Encoding", 0.07538051910270048], ["Non-Standard Port", 0.03172845457304233], ["Network Sniffing", 0.02961411651886186], ["Non-Application Layer Protocol", 0.023330110899457773]], "Zerobot HTTP requests": [["Application Layer Protocol", 0.28766636066452284], ["Data Obfuscation", 0.06331779880727556], ["Data Encoding", 0.0377872659425728], ["Web Service", 0.03301079633369673], ["Endpoint Denial of Service", 0.03236110306586453], ["Non-Standard Port", 0.024790983483254894]], "open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.": [["Remote Access Software", 0.10182917984290163], ["Remote Services", 0.07447845579698188], ["Screen Capture", 0.06325463372151138], ["Command and Scripting Interpreter", 0.058713521682568666], ["Windows Management Instrumentation", 0.05830595429174651], ["Process Discovery", 0.042071799342296906]], "running commands": [["Command and Scripting Interpreter", 0.5457198182208765], ["Indirect Command Execution", 0.05422660020446665], ["System Services", 0.05036278731454509], ["Scheduled Task/Job", 0.028716482868372157], ["Native API", 0.021859267308732656], ["Ingress Tool Transfer", 0.020281007546655093]], "screenshotting,": [["Screen Capture", 0.8630269587057853], ["Video Capture", 0.01489501156596455], ["Application Window Discovery", 0.009215358690341121], ["Clipboard Data", 0.006018624652162449], ["Input Capture", 0.005217531716005782], ["Hide Artifacts", 0.0042767387504737565]], "This attachment (unless zipped) is the MyDoom executable.": [["User Execution", 0.1573311391975297], ["Ingress Tool Transfer", 0.12609349947245324], ["Masquerading", 0.09305336075062048], ["Command and Scripting Interpreter", 0.06882212176002707], ["Phishing", 0.06592628571377658], ["Obfuscated Files or Information", 0.03136567830961612]], "executables attached to its phishing e-mails have an extension hidden by default by most Windows deployments (.cmd, .scr, .com, etc.).": [["Masquerading", 0.23310711457880265], ["User Execution", 0.12811489868620085], ["Phishing", 0.10608484916412853], ["Obfuscated Files or Information", 0.05744937566997284], ["Hide Artifacts", 0.04392790218028373], ["Office Application Startup", 0.04358277726626312]], "the file is a 32-bit Windows executable packed using the UPX (Ultimate Packer for Executables) packer (https://en.wikipedia.org/wiki/UPX) to compress and make it more difficult to analyze.": [["Obfuscated Files or Information", 0.3097387924516753], ["Deobfuscate/Decode Files or Information", 0.1818124700598438], ["Archive Collected Data", 0.14125321599546267], ["Masquerading", 0.041665560212872155], ["Indicator Removal", 0.024919861647123207], ["File and Directory Discovery", 0.018811624898992716]], "The packer decompresses and executes": [["Obfuscated Files or Information", 0.2920377702641189], ["Deobfuscate/Decode Files or Information", 0.287696243555757], ["Archive Collected Data", 0.06813187118090243], ["Command and Scripting Interpreter", 0.017184681630945494], ["Masquerading", 0.017103054258498535], ["System Binary Proxy Execution", 0.015479102993179276]], "Upon execution, an attempt to alter the Windows firewall settings is made.": [["Impair Defenses", 0.6424529891044604], ["Software Discovery", 0.044688987226526714], ["Network Service Discovery", 0.01868314230736721], ["Windows Management Instrumentation", 0.012279730328901181], ["Network Boundary Bridging", 0.011442117849531636], ["Traffic Signaling", 0.010628358383644086]], "makes a copy of itself, places it in the \u201cTemp\u201d folder (C:\\Users\\<user>\\AppData\\Local\\Temp), and changes the name to a known Windows application/process.": [["Masquerading", 0.24178251204783865], ["Process Injection", 0.08579273417672678], ["Hide Artifacts", 0.07425160110217652], ["Native API", 0.029781059176150225], ["Compromise Client Software Binary", 0.02681559101427835], ["Data Staged", 0.02465615610081594]], "The activity thereafter included dumps of LSASS": [["Process Discovery", 0.17886644599455287], ["File and Directory Discovery", 0.07881849543958279], ["Indicator Removal", 0.06281736064059155], ["OS Credential Dumping", 0.059195131649504795], ["Data from Local System", 0.04891581061842372], ["Impair Defenses", 0.043054961613686236]], "process enumerations.": [["Process Discovery", 0.5533907366840275], ["Native API", 0.11599407748913086], ["Process Injection", 0.03280310985143094], ["Windows Management Instrumentation", 0.02357189312397646], ["System Service Discovery", 0.02058990867691483], ["Virtualization/Sandbox Evasion", 0.01900445986236488]], "then launched by cmd.exe": [["System Binary Proxy Execution", 0.17021451624602424], ["Command and Scripting Interpreter", 0.10205805041356755], ["Native API", 0.08630352724847414], ["System Services", 0.07942679744912746], ["Boot or Logon Autostart Execution", 0.06275285273806688], ["Event Triggered Execution", 0.05265042037278926]], "the executable \u20183ujwy2rz7v.exe\u2019 was downloaded": [["System Binary Proxy Execution", 0.2654006090439695], ["Masquerading", 0.13816073201391416], ["Ingress Tool Transfer", 0.07220191300818292], ["Native API", 0.06477834649497342], ["Hijack Execution Flow", 0.040629382028877024], ["BITS Jobs", 0.03633172315080621]], "that uses command and control servers to collect information on compromised systems": [["Automated Collection", 0.10076961790486044], ["Data from Configuration Repository", 0.06743561129252014], ["Gather Victim Host Information", 0.0574673734733055], ["Gather Victim Network Information", 0.04719393974372567], ["Data from Information Repositories", 0.04047666070612164], ["Active Scanning", 0.03878914561084914]], "A user had to click on this in order to execute the malware.": [["User Execution", 0.5467064572099076], ["Command and Scripting Interpreter", 0.03353284077336312], ["System Binary Proxy Execution", 0.029430195538382643], ["Ingress Tool Transfer", 0.017145730400421274], ["Office Application Startup", 0.016516276112918525], ["Masquerading", 0.016201677439754047]], "the malware immediately begins to look for EDR and antivirus software.": [["Software Discovery", 0.34662269583249333], ["Impair Defenses", 0.06479553343508206], ["Command and Scripting Interpreter", 0.04628537180592281], ["Windows Management Instrumentation", 0.022934932524279007], ["Masquerading", 0.020852222132802935], ["Event Triggered Execution", 0.01835785266999045]], "Phishing emails spoof legitimate senders to deliver RokRAT via LNK files": [["Phishing", 0.3802169799774303], ["User Execution", 0.10456302109264962], ["Phishing for Information", 0.05401875601955918], ["Internal Spearphishing", 0.03971761094521035], ["Acquire Infrastructure", 0.02725028452458608], ["Establish Accounts", 0.02393154157011518]], "Email attachments mimic legitimate documents": [["Phishing", 0.44762934045392655], ["User Execution", 0.21329408551981754], ["Template Injection", 0.045780052740726246], ["Email Collection", 0.02575307926621736], ["Masquerading", 0.01618790533916076], ["Office Application Startup", 0.014452115623411825]], "several Zip Archives files hosting multiple lure documents likely sent via phishing campaigns": [["Archive Collected Data", 0.1370257933954], ["Automated Collection", 0.08891649632537686], ["Data from Local System", 0.08870543427993886], ["Data Staged", 0.056770011275890236], ["Phishing", 0.05298206071050681], ["Automated Exfiltration", 0.030536833353748172]], "targets for phishing emails containing this type of decoy document.": [["Phishing", 0.14274009345617467], ["Phishing for Information", 0.09898090952036792], ["Internal Spearphishing", 0.054222425468745214], ["Masquerading", 0.05072594864648699], ["User Execution", 0.04334153819003265], ["Data Manipulation", 0.037179735100876674]], "campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document": [["Phishing", 0.4430489593385213], ["User Execution", 0.250202115270275], ["Phishing for Information", 0.033742159348899244], ["Template Injection", 0.023667639963951333], ["Office Application Startup", 0.016565214541266558], ["Internal Spearphishing", 0.01416153719338948]], "containing obfuscated PowerShell scripts": [["Obfuscated Files or Information", 0.74328529505094], ["Deobfuscate/Decode Files or Information", 0.07030135159252915], ["Command and Scripting Interpreter", 0.025082698371365387], ["System Binary Proxy Execution", 0.014835630085088779], ["Execution Guardrails", 0.01059629723500815], ["Masquerading", 0.01052051149157836]], "the obfuscation technique for the dropped files being hex-encoding vs. string concatenation": [["Obfuscated Files or Information", 0.7714653893435356], ["Deobfuscate/Decode Files or Information", 0.06758827549357282], ["Archive Collected Data", 0.03146904633052231], ["Data Encoding", 0.016555952909139377], ["Masquerading", 0.009264782282748654], ["Hide Artifacts", 0.008871897958786418]], "contain an encoded PowerShell,": [["Obfuscated Files or Information", 0.4819989219832665], ["Deobfuscate/Decode Files or Information", 0.10493040819665468], ["Data Encoding", 0.09683555299713265], ["Command and Scripting Interpreter", 0.05483275624858487], ["Data Obfuscation", 0.016089597379684878], ["Native API", 0.014182836204100688]], "PowerShell scripts in charge of downloading a second stage RokRAT shellcode": [["Command and Scripting Interpreter", 0.37181732859687827], ["Ingress Tool Transfer", 0.2645307500939813], ["Deobfuscate/Decode Files or Information", 0.041778215696784644], ["System Binary Proxy Execution", 0.0405141743966937], ["BITS Jobs", 0.024886598649575722], ["Obfuscated Files or Information", 0.02354269167061784]], "file download/upload": [["Ingress Tool Transfer", 0.5550429762896497], ["Data from Local System", 0.05147253720977358], ["Exfiltration Over Alternative Protocol", 0.02617830614450399], ["Application Layer Protocol", 0.025665417085185986], ["Exfiltration Over C2 Channel", 0.025340149060128082], ["Exfiltration Over Web Service", 0.023195537533309055]], "to start the download process": [["Ingress Tool Transfer", 0.5062702362018459], ["BITS Jobs", 0.07628104390220225], ["Command and Scripting Interpreter", 0.07589029045007964], ["System Binary Proxy Execution", 0.016391715966674044], ["Multi-Stage Channels", 0.013785081888928592], ["Application Layer Protocol", 0.012958068807179687]], "downloads the payload": [["Ingress Tool Transfer", 0.60150943343201], ["Command and Scripting Interpreter", 0.07886611057400988], ["BITS Jobs", 0.06200282519223131], ["Deobfuscate/Decode Files or Information", 0.027525231338767914], ["System Binary Proxy Execution", 0.013286364083736103], ["Application Layer Protocol", 0.01082851366565774]], "Optical Disc Image files (ISO) containing LNK files that had slightly modified PowerShell scripts, and Hangul Word Processor decoy documents": [["Data from Removable Media", 0.08461993677253166], ["Obfuscated Files or Information", 0.06844272467634016], ["Deobfuscate/Decode Files or Information", 0.0547766119127802], ["Hide Artifacts", 0.04781862973424676], ["Masquerading", 0.04598800833202628], ["Archive Collected Data", 0.044545726438962534]], "The ISO files that X-Force observed contained a LNK file": [["Hide Artifacts", 0.060687008775367424], ["Masquerading", 0.04355318090454024], ["Subvert Trust Controls", 0.035925963380068614], ["Obfuscated Files or Information", 0.03471236439449557], ["Inhibit System Recovery", 0.029936432558858854], ["Pre-OS Boot", 0.028839126037938843]], "a JPEG decoy file are dropped": [["Obfuscated Files or Information", 0.13263286399974955], ["Deobfuscate/Decode Files or Information", 0.12191211211710806], ["Archive Collected Data", 0.10750218919664209], ["Hide Artifacts", 0.0571359614775246], ["Indicator Removal", 0.044176394717889006], ["Masquerading", 0.0348835991290904]], "the JPEG decoy file": [["Archive Collected Data", 0.16930594841726349], ["Deobfuscate/Decode Files or Information", 0.14450610967634359], ["Obfuscated Files or Information", 0.1354219993922746], ["Hide Artifacts", 0.03111641255433534], ["Data Obfuscation", 0.03009399296630173], ["Screen Capture", 0.027253661051870492]], "drop batch files": [["Indicator Removal", 0.26688812490065583], ["Command and Scripting Interpreter", 0.1337197616787383], ["Masquerading", 0.049491968365879185], ["System Binary Proxy Execution", 0.02937852353027129], ["Scheduled Task/Job", 0.02540881700413893], ["Modify Registry", 0.020754376151782924]], "then the payload is executed using Windows API functions (VirtualProtect).": [["System Binary Proxy Execution", 0.21865696748823077], ["Process Injection", 0.11334775830176057], ["Native API", 0.08460337858616596], ["Obfuscated Files or Information", 0.07383539065491922], ["Hijack Execution Flow", 0.06369596788730805], ["Deobfuscate/Decode Files or Information", 0.03238252223542104]], "the payload that is decoded using the first byte as a key,": [["Deobfuscate/Decode Files or Information", 0.5799103358064631], ["Obfuscated Files or Information", 0.11102979255448317], ["Data Encoding", 0.10283413587869276], ["Encrypted Channel", 0.03509922215764422], ["Data Obfuscation", 0.011188232848159386], ["Weaken Encryption", 0.009649033101763427]], "packed into a Windows executable file": [["System Binary Proxy Execution", 0.20825237966768118], ["Masquerading", 0.13755288217240194], ["Obfuscated Files or Information", 0.08220498483895765], ["Command and Scripting Interpreter", 0.05736444546931899], ["Hijack Execution Flow", 0.05507497022451822], ["XSL Script Processing", 0.047566452873513416]], "stealing sensitive data from the victim\u2019s networks.": [["Exfiltration Over Alternative Protocol", 0.08042772762123386], ["Compromise Infrastructure", 0.06459467500355107], ["Exfiltration Over C2 Channel", 0.045587822782059126], ["Email Collection", 0.03214135617185322], ["Acquire Infrastructure", 0.025881270079882324], ["Automated Exfiltration", 0.02552438460036879]], "the adversary identifies data of interest from the network of the victim": [["Data from Configuration Repository", 0.0826016445991583], ["Gather Victim Network Information", 0.044774890806276835], ["Active Scanning", 0.04323437072937411], ["Data Staged", 0.03869855874768291], ["Data Manipulation", 0.03821588829277533], ["Gather Victim Identity Information", 0.03491780353172672]], "This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.": [["Data from Local System", 0.23527991852107238], ["File and Directory Discovery", 0.14861449033469828], ["Data Staged", 0.08060490209352261], ["Data from Network Shared Drive", 0.06846327588077844], ["Automated Collection", 0.061364235280624825], ["Data from Information Repositories", 0.051873578007688236]], "the adversary collected the data from various sources within the victim\u2019s network.": [["Data Staged", 0.09636890256638243], ["Automated Collection", 0.07103691330336045], ["Exfiltration Over C2 Channel", 0.06860120732601944], ["Data from Configuration Repository", 0.05504498988642324], ["Gather Victim Network Information", 0.04603049508670823], ["Archive Collected Data", 0.04096645767859492]], "Credential theft and password spraying": [["Brute Force", 0.19518116151077525], ["Modify Authentication Process", 0.14549477880106992], ["OS Credential Dumping", 0.12816889698142783], ["Credentials from Password Stores", 0.10989699865996312], ["Valid Accounts", 0.035280501093093115], ["Input Capture", 0.03513869983490259]], "password spraying attack against the victim\u2019s remote services,": [["Brute Force", 0.3784174471708081], ["Modify Authentication Process", 0.11151339446189477], ["Valid Accounts", 0.042300299745880066], ["Use Alternate Authentication Material", 0.03458147951641498], ["Password Policy Discovery", 0.03040871234270306], ["Steal or Forge Kerberos Tickets", 0.029613467614015027]], "With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised": [["Brute Force", 0.3652706430724095], ["Modify Authentication Process", 0.11526198108701412], ["Valid Accounts", 0.07863415815949386], ["Password Policy Discovery", 0.06416918669926311], ["OS Credential Dumping", 0.03359139737593487], ["Account Discovery", 0.03172062016588238]], "The adversary started a password spraying attack against those domain admin accounts,": [["Brute Force", 0.17427314644085806], ["Valid Accounts", 0.11697628963437941], ["Modify Authentication Process", 0.11580994440487472], ["OS Credential Dumping", 0.06180832852300849], ["Password Policy Discovery", 0.04848771749513004], ["Account Access Removal", 0.04458796767663021]], "The user account was possibly compromised on the Linux server by using credential stuffing or password spraying:": [["Modify Authentication Process", 0.14963144935586042], ["Valid Accounts", 0.11824412910091456], ["Brute Force", 0.08292822733002526], ["Account Discovery", 0.039742952423528315], ["System Owner/User Discovery", 0.03891617870030479], ["Account Access Removal", 0.035701116474703525]], "Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.": [["Brute Force", 0.11893371008990251], ["Input Capture", 0.0991634133990154], ["OS Credential Dumping", 0.09541027882220254], ["Modify Authentication Process", 0.06468608518981726], ["Network Sniffing", 0.05492268467294628], ["Unsecured Credentials", 0.04418080227173316]], "Password spraying": [["Brute Force", 0.30393588106001057], ["Modify Authentication Process", 0.1175062332098127], ["Password Policy Discovery", 0.05676492083324146], ["Use Alternate Authentication Material", 0.03867937318191527], ["OS Credential Dumping", 0.035486200956906626], ["Input Capture", 0.025022556600219032]], "or password spraying.": [["Brute Force", 0.19769162138844126], ["Modify Authentication Process", 0.10455028550996374], ["Input Capture", 0.055137175578317245], ["Use Alternate Authentication Material", 0.03653682916652096], ["Credentials from Password Stores", 0.03183913768070137], ["Forced Authentication", 0.030501907422233875]], "This adversary starts with obtaining usernames": [["System Owner/User Discovery", 0.5995916614770348], ["Account Discovery", 0.1328252005126103], ["Gather Victim Identity Information", 0.024169600938897168], ["Brute Force", 0.010153865670797057], ["Permission Groups Discovery", 0.008688826936918132], ["Adversary-in-the-Middle", 0.008075790496286832]], "The built-in Windows quser-command to show logged on users is also heavily used by them.": [["System Owner/User Discovery", 0.5835407504540168], ["Account Discovery", 0.13200274997266262], ["Permission Groups Discovery", 0.0268291711500343], ["System Network Connections Discovery", 0.015987686090614617], ["Access Token Manipulation", 0.013762917468108751], ["Windows Management Instrumentation", 0.012955744710946841]], "To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals": [["System Owner/User Discovery", 0.21192997781666223], ["Permission Groups Discovery", 0.20184684251553214], ["Account Discovery", 0.15365718690780703], ["Remote System Discovery", 0.05811112756306616], ["System Network Connections Discovery", 0.035665394222152036], ["Process Discovery", 0.01725282047172667]], "to identify if privileged users are active on the systems": [["Permission Groups Discovery", 0.3305468289602482], ["System Owner/User Discovery", 0.22524631795511327], ["Account Discovery", 0.11790087152156599], ["Access Token Manipulation", 0.018176386747689535], ["Abuse Elevation Control Mechanism", 0.016141986455516743], ["Remote System Discovery", 0.0144680628666865]], "These credentials are used in a credential stuffing": [["Unsecured Credentials", 0.08251319329682329], ["Modify Authentication Process", 0.07677001802969492], ["OS Credential Dumping", 0.07514844012445966], ["Forced Authentication", 0.06970782865799441], ["Credentials from Password Stores", 0.06425413938428749], ["Valid Accounts", 0.06144831737666781]], "The user account was possibly compromised on the Linux server by using credential stuffing": [["Valid Accounts", 0.14554770072217663], ["Modify Authentication Process", 0.09323167480222459], ["System Owner/User Discovery", 0.07040811886606134], ["Create Account", 0.05577283702735419], ["Account Discovery", 0.04725708025142953], ["Account Manipulation", 0.0444682632823456]], "credential stuffing": [["Modify Authentication Process", 0.11380742202278357], ["Forced Authentication", 0.08007697962147889], ["Valid Accounts", 0.06782250870495349], ["Brute Force", 0.0598197922174278], ["Forge Web Credentials", 0.053776004984758236], ["Input Capture", 0.04459612607013823]], "more specifically by credential stuffing": [["Valid Accounts", 0.06919310778054798], ["Forced Authentication", 0.052625137226445205], ["Brute Force", 0.04727005496965173], ["Modify Authentication Process", 0.04418134327738163], ["Phishing for Information", 0.042441417460393774], ["Exploitation for Credential Access", 0.03784327063982857]], "After obtaining a valid account, they use this account to access the victim\u2019s VPN, Citrix or another remote service that allows access to the network of the victim.": [["Valid Accounts", 0.2698404843061525], ["External Remote Services", 0.23722489355105555], ["Create Account", 0.06554971558323501], ["Compromise Accounts", 0.036636352734852586], ["Establish Accounts", 0.026677038942791158], ["Account Manipulation", 0.02654511758352256]], "With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.": [["Fallback Channels", 0.040397957109065394], ["Event Triggered Execution", 0.027593667022410073], ["Web Service", 0.027405879814427322], ["System Services", 0.02472405932908003], ["Scheduled Task/Job", 0.02304059750982671], ["Account Manipulation", 0.018162274811044186]], "the adversary used the valid account to directly login": [["Valid Accounts", 0.18826487139077686], ["Modify Authentication Process", 0.10337706504512856], ["Create Account", 0.07054819573562623], ["Brute Force", 0.06777061091347097], ["Account Access Removal", 0.04804818869818751], ["Use Alternate Authentication Material", 0.04644506990149806]], "The threat used valid accounts against remote services:": [["Valid Accounts", 0.28548833256040684], ["Create Account", 0.11760750732834581], ["Account Manipulation", 0.06820549537321056], ["Account Discovery", 0.04787116196991552], ["Compromise Accounts", 0.03437610640093501], ["Establish Accounts", 0.03355541811258359]], "the adversary accessed the company portal with the valid account.": [["Valid Accounts", 0.160162700897434], ["Compromise Accounts", 0.12615879073471267], ["Establish Accounts", 0.11300737846958443], ["Gather Victim Identity Information", 0.04415586988151809], ["Forge Web Credentials", 0.031070337721297137], ["Phishing for Information", 0.026842602559616614]], "cloud drive, or other cloud resources accessible by the compromised account.": [["Transfer Data to Cloud Account", 0.12780520097461395], ["Valid Accounts", 0.09124275478159041], ["Create Account", 0.05300012789324195], ["Account Manipulation", 0.051528981428423964], ["Data from Cloud Storage", 0.045106158358985626], ["Account Discovery", 0.042056886082902555]], "the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.": [["Valid Accounts", 0.08832380412040387], ["Phishing", 0.06260717111818188], ["Email Collection", 0.050303035777120114], ["Template Injection", 0.04722049198290377], ["Account Manipulation", 0.03383428417274554], ["Use Alternate Authentication Material", 0.030150598356718867]], "starts using the Cobalt Strike beacon for remote access and command and control.": [["Remote Access Software", 0.1796574233128975], ["Web Service", 0.05002819449859638], ["System Services", 0.03696183718069607], ["Remote System Discovery", 0.03198231647328498], ["Remote Services", 0.031424413133877706], ["Fallback Channels", 0.031066845758635966]], "If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller": [["Valid Accounts", 0.2864922153198866], ["Create Account", 0.08051325244568902], ["Account Discovery", 0.08034108478539446], ["Permission Groups Discovery", 0.04817147448433695], ["Account Manipulation", 0.048090865770016235], ["OS Credential Dumping", 0.027812647078405372]], "After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,": [["OS Credential Dumping", 0.31765520186284146], ["Valid Accounts", 0.13996547322665065], ["Credentials from Password Stores", 0.052677067319629414], ["Unsecured Credentials", 0.049452164208061415], ["Modify Authentication Process", 0.039318844156062294], ["Brute Force", 0.03880154147283596]], "and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.": [["Domain Trust Discovery", 0.27196216004046375], ["Remote System Discovery", 0.14255255809367368], ["System Network Configuration Discovery", 0.06080674518572542], ["Permission Groups Discovery", 0.03598551045369447], ["Network Service Discovery", 0.0172600052867509], ["Query Registry", 0.016581586579098345]], "successfully got a valid domain admin account this way.": [["Create Account", 0.32885947258411696], ["Valid Accounts", 0.22633209533638976], ["Account Discovery", 0.062028162116123636], ["Account Manipulation", 0.05890653889963897], ["Modify Authentication Process", 0.03225907463444893], ["OS Credential Dumping", 0.016503165969593322]], "In other cases, the adversary moved laterally to another system with a domain admin logged in.": [["Valid Accounts", 0.28328050835415575], ["Domain Policy Modification", 0.03316239859923849], ["Compromise Infrastructure", 0.03266468409047876], ["External Remote Services", 0.03155405310362395], ["Remote Services", 0.030535032991047203], ["Account Manipulation", 0.029494060425931435]], "This can be anything from file and directory-listings,": [["File and Directory Discovery", 0.8196931246617962], ["Data from Local System", 0.029224518106371594], ["Automated Collection", 0.020117850060024367], ["Data from Network Shared Drive", 0.013328489815007945], ["Data Staged", 0.01233845584134243], ["Network Share Discovery", 0.007459588516649619]], "the adversary copying results of the discovery phase, like file- and directory lists from local systems,": [["Data from Local System", 0.24015025438861376], ["File and Directory Discovery", 0.1318465314764257], ["Automated Collection", 0.12577717605683691], ["Data Staged", 0.10398411103328856], ["Data from Network Shared Drive", 0.05687477512815931], ["Automated Exfiltration", 0.02330940097568988]], "If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.": [["Exfiltration Over C2 Channel", 0.23829121283670793], ["Exfiltration Over Alternative Protocol", 0.06987013621392797], ["Archive Collected Data", 0.06589187808724754], ["Data Staged", 0.06539895165453193], ["Automated Exfiltration", 0.049246850687188204], ["Scheduled Transfer", 0.042637399273715036]], "The adversary uses the command and control channel to exfiltrate small amounts of data.": [["Exfiltration Over C2 Channel", 0.13239099510811173], ["Archive Collected Data", 0.10573021142687491], ["Exfiltration Over Alternative Protocol", 0.0991794482744008], ["Exfiltration Over Web Service", 0.08266927498247498], ["Exfiltration Over Other Network Medium", 0.033635553200453305], ["Scheduled Transfer", 0.033256442423045304]], "adversary executes Cobalt Strike\u2019s built-in Mimikatz to dump its password hashes.": [["OS Credential Dumping", 0.3265630678852247], ["Brute Force", 0.14623199035390202], ["Unsecured Credentials", 0.0695364753718021], ["Credentials from Password Stores", 0.055497053382569994], ["Use Alternate Authentication Material", 0.05188071040607816], ["Steal or Forge Kerberos Tickets", 0.05061136796324894]], "We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going": [["Account Discovery", 0.17760473860744153], ["OS Credential Dumping", 0.168238303254912], ["Use Alternate Authentication Material", 0.09944189471650357], ["Steal or Forge Kerberos Tickets", 0.05887681235145074], ["System Owner/User Discovery", 0.04325954265184052], ["Valid Accounts", 0.039050279542915484]], "the actor executes Cobalt Strike\u2019s built-in Mimikatz to dump its credentials or password hash": [["OS Credential Dumping", 0.3925771092613785], ["Unsecured Credentials", 0.13553054700223965], ["Credentials from Password Stores", 0.07707106196888161], ["Brute Force", 0.06625504127156953], ["Use Alternate Authentication Material", 0.036134640357984485], ["Steal or Forge Kerberos Tickets", 0.030008728177669773]], ", staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.": [["Exfiltration Over Web Service", 0.1322608310039031], ["Transfer Data to Cloud Account", 0.11210969558406286], ["Data from Local System", 0.051889937313418934], ["Data Staged", 0.03829075500983687], ["Exfiltration Over Alternative Protocol", 0.03380653190371169], ["Valid Accounts", 0.03372388555495989]], "Files and folders of interest are collected as well and staged for exfiltration.": [["Data from Local System", 0.1732212055995607], ["Data Staged", 0.13359037879785624], ["Indicator Removal", 0.06456726429014512], ["Automated Exfiltration", 0.055557802168611774], ["Exfiltration Over Web Service", 0.04588178106724518], ["Automated Collection", 0.04347829735714438]], "We\u2019ve seen the adversary staging data on a remote system or on the local system.": [["Data Staged", 0.23933497748249574], ["Exfiltration Over C2 Channel", 0.042692911742793986], ["Modify Cloud Compute Infrastructure", 0.032931499373080285], ["Data from Local System", 0.031156784756044803], ["Automated Exfiltration", 0.025383121198367886], ["Stage Capabilities", 0.02304489603622643]], "This activity group always uses a renamed version of rar.exe.": [["Masquerading", 0.26842437439708683], ["Access Token Manipulation", 0.03989720717211924], ["Impair Defenses", 0.03619255308928204], ["Create or Modify System Process", 0.03343242357658124], ["Indicator Removal", 0.02379479893102175], ["Event Triggered Execution", 0.020327153870618564]], "The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.": [["Lateral Tool Transfer", 0.36514950607338403], ["Ingress Tool Transfer", 0.08721587844609954], ["Remote Services", 0.06380892884428059], ["Taint Shared Content", 0.0251324811647428], ["Communication Through Removable Media", 0.01689862759431806], ["Data from Network Shared Drive", 0.01337154914574709]], "The DLL\u2019s used were side-loaded in memory on compromised systems.": [["Hijack Execution Flow", 0.26926474760360425], ["Shared Modules", 0.15922107035325872], ["Process Injection", 0.08378026743241722], ["System Binary Proxy Execution", 0.061752555874335986], ["Native API", 0.03114876070041924], ["Deobfuscate/Decode Files or Information", 0.026473505114618996]], "File deletion": [["Indicator Removal", 0.7040509655727814], ["Data Destruction", 0.12786874957105107], ["Disk Wipe", 0.014242152957315957], ["Inhibit System Recovery", 0.01397473110042243], ["System Shutdown/Reboot", 0.007880277166492861], ["File and Directory Discovery", 0.00600315900349439]], "Use scheduled tasks": [["Scheduled Task/Job", 0.8129007784540453], ["Inter-Process Communication", 0.03659697909828923], ["Command and Scripting Interpreter", 0.020044412019838437], ["Masquerading", 0.01059690835522302], ["System Services", 0.007600770669220302], ["Create or Modify System Process", 0.005574197310451657]], "The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.": [["Scheduled Task/Job", 0.6551117165397631], ["Command and Scripting Interpreter", 0.09977117170906126], ["Inter-Process Communication", 0.04617189273384048], ["Masquerading", 0.012666860013317818], ["System Services", 0.011192449533419089], ["System Binary Proxy Execution", 0.009050725448376443]], "An example of the creation of such a scheduled task by the adversary:\nschtasks /create /ru \"SYSTEM\" /tn \"update\" /tr \"cmd /c c:\\windows\\temp\\update.bat\" /sc once /f /st 06:59:00": [["Scheduled Task/Job", 0.7990352048480324], ["Masquerading", 0.031124965451945943], ["Inter-Process Communication", 0.02888395279742144], ["Create or Modify System Process", 0.008017863211563843], ["Command and Scripting Interpreter", 0.00791760520540996], ["Domain Policy Modification", 0.005118885277982105]], "batch files for automation.": [["Command and Scripting Interpreter", 0.5734683576572276], ["Scheduled Task/Job", 0.07377819637412732], ["Masquerading", 0.012957107133893623], ["System Services", 0.012397353951906833], ["Automated Collection", 0.012349686521912616], ["System Binary Proxy Execution", 0.012261711480396207]], "The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.": [["Command and Scripting Interpreter", 0.1158460814163993], ["Indicator Removal", 0.10052972507304005], ["Data Staged", 0.05727183507073651], ["Scheduled Task/Job", 0.048705965724191815], ["Automated Collection", 0.04440615263499678], ["Masquerading", 0.034799779647285096]], "executing a batch-file (.bat) to perform their tasks.": [["Command and Scripting Interpreter", 0.5575621701327553], ["Scheduled Task/Job", 0.08559952378035703], ["System Services", 0.029809486789282285], ["System Binary Proxy Execution", 0.026576275026765225], ["Masquerading", 0.015590190122672598], ["Native API", 0.013791591846927964]], "They switched to C2 encapsulated in HTTPS in Q3 2019.": [["Application Layer Protocol", 0.43555333418340286], ["Encrypted Channel", 0.10136086073793571], ["Data Obfuscation", 0.06163286736134686], ["Non-Standard Port", 0.028196751674836627], ["Protocol Tunneling", 0.02530781933422247], ["Data Encoding", 0.02524715361194184]], "the adversary achieving credentials access by brute force": [["Brute Force", 0.5407977832832541], ["Valid Accounts", 0.047747074867555146], ["Modify Authentication Process", 0.047198153716389205], ["Use Alternate Authentication Material", 0.03675679115815254], ["Forced Authentication", 0.02774576694615502], ["Multi-Factor Authentication Interception", 0.024732911251049546]], "The adversary installs a hackers best friend during the intrusion: Cobalt Strike.": [["Exploit Public-Facing Application", 0.05792789474770879], ["Endpoint Denial of Service", 0.05728325058463941], ["Exploitation of Remote Services", 0.05165597252791564], ["Compromise Infrastructure", 0.03902588266752364], ["Obtain Capabilities", 0.03565461595853253], ["Impair Defenses", 0.03238058276384148]], "the adversary also searches for VPN and firewall configs,": [["System Network Configuration Discovery", 0.10298601306303137], ["Software Discovery", 0.09297655645924288], ["Active Scanning", 0.07922927273465781], ["Network Service Discovery", 0.06357087743609403], ["Impair Defenses", 0.0634503810785631], ["System Network Connections Discovery", 0.06019707758468336]], "This lures users to double-click the graphic to view the content,": [["User Execution", 0.5281355540433263], ["Phishing", 0.028018940781191725], ["Masquerading", 0.025337114468545297], ["Browser Session Hijacking", 0.020972420094458138], ["Stage Capabilities", 0.01923060688010214], ["Screen Capture", 0.016254961400020144]], "Malicious documents that implement this technique require users to double-click a document element.": [["User Execution", 0.43183235370279827], ["Template Injection", 0.08118967343301828], ["Phishing", 0.0296348838110081], ["Office Application Startup", 0.024793549877259485], ["Inter-Process Communication", 0.02162600437966772], ["Command and Scripting Interpreter", 0.02065749216626112]], "and enumerating files and drives": [["File and Directory Discovery", 0.6926271802972808], ["Data from Local System", 0.049319401517020786], ["System Information Discovery", 0.024092899337510944], ["Data from Removable Media", 0.024039272575885385], ["Data from Network Shared Drive", 0.022643445393249632], ["Automated Collection", 0.016747025398786062]], "establish persistence by creating a registry key under \\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run only if the victim\u2019s machine name differs.": [["Boot or Logon Autostart Execution", 0.2840215632351858], ["Event Triggered Execution", 0.11241118714921909], ["Boot or Logon Initialization Scripts", 0.07488832237893306], ["Modify Registry", 0.07058400694719955], ["Masquerading", 0.03762794861215678], ["Create or Modify System Process", 0.033641826643052125]], "include exfiltrating system information": [["Inhibit System Recovery", 0.14639666938192467], ["Data from Local System", 0.08984204277980362], ["Disk Wipe", 0.07001565866509298], ["Exfiltration Over C2 Channel", 0.048724997816997705], ["Indicator Removal", 0.04532557298877816], ["System Information Discovery", 0.03712191100596208]], "implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.": [["Obfuscated Files or Information", 0.8039355595845308], ["Deobfuscate/Decode Files or Information", 0.03752830661162219], ["Masquerading", 0.014983725772672046], ["Data Obfuscation", 0.01286097667250091], ["Execution Guardrails", 0.009404849642853815], ["Hide Artifacts", 0.008950100583752108]], "the obfuscation techniques used": [["Obfuscated Files or Information", 0.7370053811432805], ["Deobfuscate/Decode Files or Information", 0.07468008865845263], ["Data Encoding", 0.020467213533239707], ["Data Obfuscation", 0.01607237725861745], ["Archive Collected Data", 0.014440561466917292], ["Execution Guardrails", 0.012158449192855893]], "obfuscated using Crypto Obfuscator,": [["Obfuscated Files or Information", 0.569865820159404], ["Deobfuscate/Decode Files or Information", 0.14437022120579765], ["Archive Collected Data", 0.05585756171019167], ["Data Encrypted for Impact", 0.02946347656370235], ["Encrypted Channel", 0.02380285191754482], ["Weaken Encryption", 0.013944535952722511]], "malicious dynamic link library (DLL) file that\u2019s eventually side-loaded to the application.": [["Hijack Execution Flow", 0.5862809066280011], ["Shared Modules", 0.06446472362310245], ["System Binary Proxy Execution", 0.055142099477795505], ["Process Injection", 0.044331231809789186], ["Masquerading", 0.03318237180210592], ["Event Triggered Execution", 0.020513297843601022]], "to a side-loading vulnerability that": [["Exploit Public-Facing Application", 0.13107411622971424], ["Exploitation for Client Execution", 0.10697087951930308], ["Hijack Execution Flow", 0.07004438945302863], ["Drive-by Compromise", 0.030094649877196986], ["Stage Capabilities", 0.026687309390904707], ["Process Injection", 0.026584421908386266]], "We\u2019ve seen the payload delivered in diverse ways including DLL side-loading,": [["Obfuscated Files or Information", 0.12607692009692487], ["Hijack Execution Flow", 0.12531144709756614], ["Ingress Tool Transfer", 0.07947012477764501], ["Process Injection", 0.07772480959250334], ["System Binary Proxy Execution", 0.06251392560578366], ["Shared Modules", 0.0516222514502292]], "abuse legitimate applications vulnerable to DLL side-loading attack.": [["Hijack Execution Flow", 0.5204952524816832], ["Shared Modules", 0.11609893507866258], ["System Binary Proxy Execution", 0.07228261749771112], ["Process Injection", 0.0604506474054666], ["Event Triggered Execution", 0.018433630080805084], ["Masquerading", 0.01280011385122119]], "DLL Side-Loading": [["Hijack Execution Flow", 0.46150763282981094], ["Shared Modules", 0.1576745231549214], ["System Binary Proxy Execution", 0.07514434763826179], ["Process Injection", 0.044570073057430215], ["Event Triggered Execution", 0.021010181506860556], ["Boot or Logon Autostart Execution", 0.014663813009899457]], "A benign, legitimate executable abused to side-load the malicious DLL": [["Hijack Execution Flow", 0.49481386719032594], ["Shared Modules", 0.13267175697276415], ["System Binary Proxy Execution", 0.08439314139241998], ["Process Injection", 0.05920214787214708], ["Event Triggered Execution", 0.015047743322794536], ["Masquerading", 0.0133170518622559]], "The malicious side loaded DLL": [["Hijack Execution Flow", 0.31552346495398764], ["Shared Modules", 0.16494586656451105], ["System Binary Proxy Execution", 0.12081163221859728], ["Process Injection", 0.08677034413643699], ["Native API", 0.024966072669749935], ["Masquerading", 0.020756070338288152]], "WDSyncService.exe executable abused to side-load a malicious DLL\u00a0": [["Hijack Execution Flow", 0.27315077590705455], ["System Binary Proxy Execution", 0.1406800566653696], ["Process Injection", 0.07442770461912424], ["Masquerading", 0.06971395844716484], ["Native API", 0.0501764967443404], ["Shared Modules", 0.04070600759536121]], "Side loaded malicious DLL\u00a0": [["Hijack Execution Flow", 0.38026488564191613], ["Shared Modules", 0.13695095713142347], ["System Binary Proxy Execution", 0.12996395311990458], ["Process Injection", 0.07268988180450234], ["Native API", 0.019244003411046276], ["Masquerading", 0.018876427572103387]], "abused to side-load the malicious DLL.": [["Hijack Execution Flow", 0.4646627866395033], ["Shared Modules", 0.1505444639758512], ["System Binary Proxy Execution", 0.09146646153898806], ["Process Injection", 0.06967699814725312], ["Native API", 0.013966941349344215], ["Event Triggered Execution", 0.013618971296220073]], "executable abused to side-load malicious DLL\u00a0": [["Hijack Execution Flow", 0.46073270435996555], ["Shared Modules", 0.15042553297204095], ["System Binary Proxy Execution", 0.12118270784169557], ["Process Injection", 0.061328714429256845], ["Event Triggered Execution", 0.015381816458966502], ["Native API", 0.015377359255833906]], "that is abused to side-load a malicious DLL": [["Hijack Execution Flow", 0.46555244891524966], ["Shared Modules", 0.1498239699217581], ["System Binary Proxy Execution", 0.0840204699653095], ["Process Injection", 0.06203129265048782], ["Event Triggered Execution", 0.014724615729863532], ["Native API", 0.01371534555390947]], "executable that dropped a legitimate WD Discovery app to side-load the malicious WDLocal.dll": [["Hijack Execution Flow", 0.32738839437406847], ["System Binary Proxy Execution", 0.1340539388314874], ["Process Injection", 0.08171268743307072], ["Masquerading", 0.07191825636863727], ["Native API", 0.04931878011409917], ["Event Triggered Execution", 0.03827326271902932]], "side-loads malicious WDLocal.dll\u00a0The side-loaded DLL": [["Hijack Execution Flow", 0.410337507981367], ["Shared Modules", 0.12742563569483328], ["System Binary Proxy Execution", 0.11351757665734236], ["Process Injection", 0.096336688635738], ["Native API", 0.029987643624068038], ["Event Triggered Execution", 0.022318886034969815]], "DLL side-loading is a highly effective technique for tricking Windows systems into loading malicious code.": [["Hijack Execution Flow", 0.40847759322594357], ["System Binary Proxy Execution", 0.1442105931191579], ["Process Injection", 0.08907363106506173], ["Shared Modules", 0.06239546794713015], ["Masquerading", 0.038456024166964795], ["Obfuscated Files or Information", 0.018576565061809082]], "Adversaries use side-loading attacks for execution": [["Hijack Execution Flow", 0.10973926132025323], ["Exploitation for Client Execution", 0.06968353193391064], ["Exploit Public-Facing Application", 0.04390097672542567], ["System Script Proxy Execution", 0.03195067637484794], ["Process Injection", 0.029648592867716952], ["Shared Modules", 0.028945762131826484]], "Once the executable starts running, it side-loads the malicious DLL": [["Hijack Execution Flow", 0.49862943922281244], ["Shared Modules", 0.09277244654873519], ["System Binary Proxy Execution", 0.09138293204008503], ["Process Injection", 0.0871452435398046], ["Event Triggered Execution", 0.02993588427598494], ["Native API", 0.0231114905263389]], "to lure victims into downloading a malicious file": [["User Execution", 0.6114285154878009], ["Phishing", 0.08380508164319436], ["Drive-by Compromise", 0.05021004292870953], ["Ingress Tool Transfer", 0.035353737313463376], ["Stage Capabilities", 0.023776622011803198], ["Masquerading", 0.013753308035935689]], "designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information.": [["Credentials from Password Stores", 0.10370853970658951], ["Browser Session Hijacking", 0.0707158369841858], ["Data from Local System", 0.06424626625046125], ["Email Collection", 0.04954813653575162], ["Phishing for Information", 0.04119342210746764], ["Exfiltration Over C2 Channel", 0.03517212319439335]], "The scripts are encoded using different techniques,": [["Obfuscated Files or Information", 0.41651058053861334], ["Deobfuscate/Decode Files or Information", 0.161681469121823], ["Data Encoding", 0.07729679845348052], ["Command and Scripting Interpreter", 0.05480791883171828], ["Archive Collected Data", 0.017411168064185894], ["Masquerading", 0.01582639749682129]], "(base64 encoded with string replacements)": [["Obfuscated Files or Information", 0.37390035377180497], ["Data Encoding", 0.30438437193526935], ["Deobfuscate/Decode Files or Information", 0.14183911184178458], ["Data Obfuscation", 0.02728861312886311], ["Archive Collected Data", 0.023885510199677596], ["Encrypted Channel", 0.013555898853682911]], "uses are compressed and encrypted": [["Archive Collected Data", 0.46369091135197066], ["Obfuscated Files or Information", 0.2596421437030139], ["Deobfuscate/Decode Files or Information", 0.04700845772340651], ["Data Encrypted for Impact", 0.03511743264672614], ["Exfiltration Over Alternative Protocol", 0.02073188331725091], ["Encrypted Channel", 0.012142079715325528]], "Base64 encoded string with several string replacements.": [["Obfuscated Files or Information", 0.3665124334164143], ["Data Encoding", 0.33368500666430745], ["Deobfuscate/Decode Files or Information", 0.10734451489496676], ["Data Obfuscation", 0.02932111371125451], ["Archive Collected Data", 0.015880261772384056], ["Encrypted Channel", 0.012708322366147863]], "self-written extensions that obfuscate the PHP scripts.": [["Obfuscated Files or Information", 0.5545426089819854], ["Data Obfuscation", 0.05103993677505859], ["Data Encoding", 0.035737716409134056], ["Deobfuscate/Decode Files or Information", 0.02475564202210279], ["Template Injection", 0.02048321521040911], ["Masquerading", 0.01713166823985305]], "And malicious payloads are also sometimes encrypted/packed or obfuscated": [["Obfuscated Files or Information", 0.6886930769133451], ["Deobfuscate/Decode Files or Information", 0.07620257670158877], ["Archive Collected Data", 0.02482427744230818], ["Execution Guardrails", 0.02197025193920323], ["Data Encoding", 0.021475852782430523], ["Encrypted Channel", 0.01666836472137783]], "obfuscated with SmartAssembly": [["Obfuscated Files or Information", 0.7785464139133357], ["Deobfuscate/Decode Files or Information", 0.052427897391786785], ["Execution Guardrails", 0.012366895155828882], ["Hide Artifacts", 0.011221645451374893], ["Process Injection", 0.010863939018095067], ["Archive Collected Data", 0.009582459610427129]], "base64 encoded with some string modifications": [["Obfuscated Files or Information", 0.37064474409531656], ["Data Encoding", 0.31526977972767734], ["Deobfuscate/Decode Files or Information", 0.1416284641213655], ["Archive Collected Data", 0.025538918067235718], ["Data Obfuscation", 0.023319740210486523], ["Encrypted Channel", 0.015661921360356566]], "it downloads the file from its command and control (C2) server,": [["Ingress Tool Transfer", 0.6758035655704592], ["Data from Local System", 0.02202022595181541], ["Command and Scripting Interpreter", 0.021552518639091866], ["Application Layer Protocol", 0.01906440872428631], ["Exfiltration Over C2 Channel", 0.018484388508458103], ["Web Service", 0.013120683840393986]], "they\u2019re downloaded from the C2": [["Ingress Tool Transfer", 0.15924522438027489], ["Web Service", 0.0399959539438308], ["Exfiltration Over C2 Channel", 0.039793206584312686], ["Data from Local System", 0.03400440000545193], ["Automated Collection", 0.032835385625732544], ["Application Layer Protocol", 0.023039402129184094]], "executes, it drops a PHP application with additional files": [["System Binary Proxy Execution", 0.07290222004228422], ["Native API", 0.0678691799440922], ["Hijack Execution Flow", 0.05212953897444275], ["Indicator Removal", 0.04688988085834287], ["Process Injection", 0.041006401846460705], ["Command and Scripting Interpreter", 0.0403340185386593]], "Download and run": [["Ingress Tool Transfer", 0.5730667856207217], ["Command and Scripting Interpreter", 0.06846896120257198], ["BITS Jobs", 0.06135976567154091], ["System Binary Proxy Execution", 0.014586879713578301], ["Application Layer Protocol", 0.012359267494970719], ["Web Service", 0.011302503730382935]], "Downloads a file from the given URL and executes it with the given arguments.": [["Ingress Tool Transfer", 0.5466618992141952], ["Command and Scripting Interpreter", 0.12337141414111913], ["Application Layer Protocol", 0.02294695332320361], ["BITS Jobs", 0.014468592312286735], ["Native API", 0.012372071967470604], ["System Binary Proxy Execution", 0.011118869949407646]], "the given task the downloaded file": [["Ingress Tool Transfer", 0.5472718298032895], ["Command and Scripting Interpreter", 0.04934591130666735], ["BITS Jobs", 0.024874992344424196], ["Data from Local System", 0.020104060842484624], ["Masquerading", 0.016397399096864], ["Automated Collection", 0.015629062685041478]], "the new stealer is downloaded and executed": [["Ingress Tool Transfer", 0.29004606158615187], ["BITS Jobs", 0.0448344089108294], ["Native API", 0.02897017994517064], ["Scheduled Task/Job", 0.026194970560522196], ["System Binary Proxy Execution", 0.023049996297932963], ["Process Injection", 0.022741423288760235]], "\u00a0\u00a0Upload file function\u00a0": [["Ingress Tool Transfer", 0.278095738096654], ["Data from Local System", 0.07308805295852372], ["Exfiltration Over C2 Channel", 0.030795253225250487], ["Data Staged", 0.02890124178533389], ["Automated Exfiltration", 0.02717626085666167], ["Exfiltration Over Web Service", 0.024421294095889116]], "then decodes and executes it.": [["Deobfuscate/Decode Files or Information", 0.6076494739885506], ["Obfuscated Files or Information", 0.17857625338562666], ["Data Encoding", 0.029095211975281095], ["Archive Collected Data", 0.01672106125179578], ["Encrypted Channel", 0.01021883635433844], ["Command and Scripting Interpreter", 0.009912655803691202]], "In the main thread the SFX/ZIP file is executed/decompressed,": [["Archive Collected Data", 0.29053301285555927], ["Deobfuscate/Decode Files or Information", 0.16507480762464416], ["Obfuscated Files or Information", 0.10455436309408006], ["Process Injection", 0.02048956473465358], ["Native API", 0.020241263459132044], ["Data Staged", 0.016443708914792302]], "DLL that decodes and drops three files": [["Deobfuscate/Decode Files or Information", 0.46702370672564797], ["Obfuscated Files or Information", 0.14442961077580424], ["System Binary Proxy Execution", 0.04103520972768351], ["Archive Collected Data", 0.03540074051339148], ["Masquerading", 0.02351488068308331], ["Command and Scripting Interpreter", 0.017857757739447404]], "It starts with de-obfuscating the next stage (string replacements + base64 decoding)": [["Deobfuscate/Decode Files or Information", 0.39425671885968994], ["Obfuscated Files or Information", 0.34136049362859666], ["Data Encoding", 0.06181465628564708], ["Archive Collected Data", 0.03901816825814451], ["Data Obfuscation", 0.018028209522021294], ["Encrypted Channel", 0.016490420994683]], "Once decoded, this executable, written in Rust and compiled with Cargo, gets the current date and time, and decrypts Chromium-based browsers\u2019 encryption key\u00a0": [["Deobfuscate/Decode Files or Information", 0.38328286270589146], ["Obfuscated Files or Information", 0.06479303008067544], ["Encrypted Channel", 0.05244147199650838], ["System Time Discovery", 0.02950847457701199], ["Archive Collected Data", 0.026436769628321678], ["Data Encrypted for Impact", 0.023261802337331123]], "It does this by decoding the rss.txt into an executable": [["Deobfuscate/Decode Files or Information", 0.07803314579655], ["Web Service", 0.06140930618713277], ["Archive Collected Data", 0.03647416250062833], ["Command and Scripting Interpreter", 0.03513989107917024], ["Automated Exfiltration", 0.032089388038329524], ["Automated Collection", 0.02850089550633003]], "the executable decodes and drops the next stage": [["Deobfuscate/Decode Files or Information", 0.6655083934599617], ["Obfuscated Files or Information", 0.13883417460060168], ["Process Injection", 0.01898535096940127], ["Native API", 0.011620305451374975], ["Encrypted Channel", 0.0085322018349919], ["Data Encoding", 0.00825367833805134]], "it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.": [["Scheduled Task/Job", 0.3361689349232067], ["System Binary Proxy Execution", 0.06486309118724164], ["System Services", 0.05248136092652323], ["Command and Scripting Interpreter", 0.03593190862285703], ["Event Triggered Execution", 0.0358846491034779], ["Create or Modify System Process", 0.03349964725073893]], "registers a new scheduled task to trigger every day and repeat every hour with option \u201cd\u201d as an argument.": [["Scheduled Task/Job", 0.7954847253236176], ["Inter-Process Communication", 0.03573382298486448], ["Masquerading", 0.011527630503610421], ["System Time Discovery", 0.0093384702437363], ["Command and Scripting Interpreter", 0.009321879854357836], ["Create or Modify System Process", 0.005670882803473783]], "Creates a scheduled task to be executed with d as an argument\u00a0": [["Scheduled Task/Job", 0.657170241622595], ["Inter-Process Communication", 0.1002265948652934], ["Command and Scripting Interpreter", 0.026704872874361556], ["Masquerading", 0.02585281280975165], ["System Services", 0.010254251271914202], ["Create or Modify System Process", 0.007184116107023113]], "Responsible for installing persistence via scheduled tasks": [["Scheduled Task/Job", 0.40029001619247145], ["Create or Modify System Process", 0.1291766723619746], ["Boot or Logon Autostart Execution", 0.06771458398168928], ["Event Triggered Execution", 0.05409232119660609], ["Boot or Logon Initialization Scripts", 0.045043497776876315], ["Command and Scripting Interpreter", 0.027554964521651324]], "The attacker must know the time to set it in the scheduled task.": [["Scheduled Task/Job", 0.7704371653379726], ["Inter-Process Communication", 0.028162614492414768], ["System Time Discovery", 0.022486811934449638], ["Indicator Removal", 0.00843525199197359], ["Virtualization/Sandbox Evasion", 0.007432425440772028], ["Masquerading", 0.007209854228216011]], "createTS\u2014creates scheduled task. createLG\u2014creates scheduled task at logon\u00a0": [["Scheduled Task/Job", 0.6814858382432736], ["Create or Modify System Process", 0.04863149690406282], ["Boot or Logon Autostart Execution", 0.022408113383003896], ["Boot or Logon Initialization Scripts", 0.021217984311812366], ["Inter-Process Communication", 0.018065652847165298], ["Masquerading", 0.01582735925970788]], "it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes.": [["Scheduled Task/Job", 0.6672751854788662], ["Create or Modify System Process", 0.038261153984454045], ["Event Triggered Execution", 0.03437799257805753], ["Boot or Logon Autostart Execution", 0.017007212555159714], ["Masquerading", 0.01549844510390042], ["Boot or Logon Initialization Scripts", 0.015271950033337365]], "registers two scheduled tasks:": [["Scheduled Task/Job", 0.6364638829430258], ["Inter-Process Communication", 0.05051703520169772], ["Masquerading", 0.033106352127486575], ["Create or Modify System Process", 0.018378360413696938], ["Command and Scripting Interpreter", 0.01718166686106529], ["System Services", 0.014732191976309258]], "embeds legitimate DLLs using the SmartAssembly feature\u00a0": [["Hijack Execution Flow", 0.2584238066827297], ["Shared Modules", 0.13911740873029038], ["System Binary Proxy Execution", 0.11472831043339327], ["Process Injection", 0.10810336115194004], ["Masquerading", 0.023943405612077716], ["Event Triggered Execution", 0.020452020506442216]], "Once the execution completes, the file is deleted to leave no evidence on the machine.": [["Indicator Removal", 0.7218556827797714], ["Data Destruction", 0.0565448848008458], ["Hide Artifacts", 0.013581895121867285], ["Inhibit System Recovery", 0.010778352816558463], ["Masquerading", 0.010373831174982156], ["Data Staged", 0.01027361928620711]], "the file is deleted to remove evidence from the machine.": [["Indicator Removal", 0.6366602547788368], ["Data Destruction", 0.1069122411228336], ["Inhibit System Recovery", 0.04059773538520259], ["Disk Wipe", 0.01969781688076415], ["Data Staged", 0.010783529079211766], ["Hide Artifacts", 0.010153748889746139]], "passes this command line as an argument": [["Command and Scripting Interpreter", 0.37700604609924326], ["Indirect Command Execution", 0.11309784478926259], ["Native API", 0.09354780296067754], ["System Services", 0.03059466866434881], ["System Binary Proxy Execution", 0.02639367590932792], ["Virtualization/Sandbox Evasion", 0.012246610287958442]], "Gets a command to run, executes it": [["Command and Scripting Interpreter", 0.518412375773263], ["Indirect Command Execution", 0.0765249181648767], ["System Services", 0.0690724957669154], ["Native API", 0.03309025234905629], ["Scheduled Task/Job", 0.028492952587854392], ["System Binary Proxy Execution", 0.018885100265301557]], "\u00a0Gets command from C2 and executes it\u00a0": [["Command and Scripting Interpreter", 0.31816814687666806], ["Web Service", 0.1157784479295294], ["Ingress Tool Transfer", 0.10554832903692835], ["Application Layer Protocol", 0.030077503549132863], ["Multi-Stage Channels", 0.02469242419761576], ["System Services", 0.02446130761999783]], "Executable that accepts an executable as an argument and executes it with hidden console": [["Hide Artifacts", 0.2065383335076696], ["System Binary Proxy Execution", 0.09002028736558024], ["Masquerading", 0.0651407555992527], ["Native API", 0.06443273302649861], ["Command and Scripting Interpreter", 0.05342918812837292], ["Process Injection", 0.05185555485396804]], "\u201cwmic os get LocalDateTime /value\u201d.": [["System Time Discovery", 0.7257723344586486], ["Indicator Removal", 0.04956644865066525], ["Virtualization/Sandbox Evasion", 0.02858342512137792], ["System Information Discovery", 0.02261350339901747], ["Windows Management Instrumentation", 0.01132752856376631], ["System Location Discovery", 0.008677438220362245]], "to steal the victim\u2019s Facebook information and send it back to the C2.": [["Phishing for Information", 0.0811682804196963], ["Establish Accounts", 0.062233269495798195], ["Email Collection", 0.047458495072465114], ["Exfiltration Over C2 Channel", 0.04320720276881168], ["Compromise Accounts", 0.043132827391037964], ["Web Service", 0.03775910627503222]], "Extract victim\u2019s sensitive Facebook data using the graph API and send the results to a C2 server\u00a0": [["Exfiltration Over C2 Channel", 0.06761686356791811], ["Data from Local System", 0.06544885523620285], ["Email Collection", 0.05595656730336893], ["Automated Collection", 0.0345945271711317], ["Web Service", 0.032226707210832276], ["Automated Exfiltration", 0.03190032879074274]], "The malware can extract this information and send it to its command and control (C2) server": [["Automated Collection", 0.14698350435195254], ["Exfiltration Over C2 Channel", 0.11793293765508539], ["System Information Discovery", 0.07029869033243315], ["System Network Configuration Discovery", 0.04254886202263809], ["System Owner/User Discovery", 0.03851446434681439], ["Data from Local System", 0.02512372654201261]], "API functions.": [["Native API", 0.2737395892609414], ["Cloud Service Dashboard", 0.06313073216317], ["Web Service", 0.04893964569917606], ["Command and Scripting Interpreter", 0.0182843927280474], ["Application Layer Protocol", 0.016186083680560688], ["Deobfuscate/Decode Files or Information", 0.01296816091955968]], "API calls": [["Native API", 0.14765428141600181], ["Cloud Service Dashboard", 0.10136800175762174], ["Web Service", 0.07434575389694804], ["Application Layer Protocol", 0.05686953114679572], ["Command and Scripting Interpreter", 0.015060063390897693], ["Ingress Tool Transfer", 0.013472118364756822]], "the API calls": [["Cloud Service Dashboard", 0.1585591819601444], ["Native API", 0.14240180522964976], ["Web Service", 0.04731930445808596], ["Application Layer Protocol", 0.030778903108884627], ["Command and Scripting Interpreter", 0.016838902022701], ["Ingress Tool Transfer", 0.01634856972786035]], "calls point to a suspicious API": [["Native API", 0.14979502297753505], ["Cloud Service Dashboard", 0.03284790207501792], ["Web Service", 0.03242266435242896], ["Application Layer Protocol", 0.0315921094321532], ["Hijack Execution Flow", 0.02798704252899813], ["Exploit Public-Facing Application", 0.02380665841641905]], "creation functions like NtCreateUserProcess, NtCreateProcessEx, CreateProcessInternalW, CreateProcessA or CreateProcessW.": [["Native API", 0.271538439993843], ["Process Injection", 0.153481856311294], ["Access Token Manipulation", 0.11852701601720818], ["Create or Modify System Process", 0.06670970668412646], ["Event Triggered Execution", 0.04043743917539141], ["System Binary Proxy Execution", 0.030670494240371916]], "an exported function from one of the Windows libraries": [["Native API", 0.2571583595141408], ["System Binary Proxy Execution", 0.07599145918807358], ["Masquerading", 0.05635155543661452], ["Command and Scripting Interpreter", 0.046454844482411585], ["Hijack Execution Flow", 0.04505090863703585], ["Process Injection", 0.041439780797120934]], "suspicious APIs often used in code injection techniques like CreateRemoteThread or NtSetContextThread.": [["Process Injection", 0.5220391113094281], ["Native API", 0.20245061918745624], ["Event Triggered Execution", 0.02180592287169622], ["Hijack Execution Flow", 0.016530776594903575], ["System Binary Proxy Execution", 0.014233756076237265], ["Virtualization/Sandbox Evasion", 0.011102236744520804]], "frequently called API function": [["Native API", 0.34157976916450183], ["Hijack Execution Flow", 0.031231078232380322], ["Web Service", 0.02767468219432523], ["Masquerading", 0.02660238618826764], ["Shared Modules", 0.023466092235002872], ["Cloud Service Dashboard", 0.020148586955455895]], "critical APIs": [["Native API", 0.07514829561632116], ["Obtain Capabilities", 0.06930076640452563], ["Web Service", 0.06866387886769969], ["Cloud Service Dashboard", 0.05781683131731986], ["Develop Capabilities", 0.04529629811326788], ["Exploitation for Client Execution", 0.04048022534063572]], "Microsoft Outlook Messaging API (MAPI) module": [["Email Collection", 0.1816980110434061], ["Web Service", 0.06644609832884289], ["Application Layer Protocol", 0.0535424531351245], ["Office Application Startup", 0.037471502585391475], ["Phishing", 0.03286365143508149], ["Establish Accounts", 0.02567060325929943]], "process creation library functions": [["Process Injection", 0.3949527089289075], ["Native API", 0.16773302075757054], ["Process Discovery", 0.06808429736180897], ["Create or Modify System Process", 0.04065164362172084], ["Access Token Manipulation", 0.03125964895251581], ["Hijack Execution Flow", 0.02151127851354978]], "calls the NtProtectVirtualMemory function where the NewAccessProtection argument is PAGE_EXECUTE_READWRITE and the BaseAddress argument is an address to a library function": [["Process Injection", 0.2044704630419283], ["Native API", 0.08433256739190495], ["System Binary Proxy Execution", 0.03930954326916693], ["Hide Artifacts", 0.03336695780509635], ["Masquerading", 0.029804895279495393], ["Rootkit", 0.023097580359166755]], "uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.": [["Indicator Removal", 0.11593419877514832], ["System Shutdown/Reboot", 0.05627848364056666], ["Data Destruction", 0.047788382052773526], ["Disk Wipe", 0.037536608989808214], ["Process Injection", 0.03462410532620596], ["Impair Defenses", 0.03409522220882011]], "dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread": [["Process Injection", 0.452320994544122], ["Native API", 0.059214167973753506], ["Access Token Manipulation", 0.0487960143244127], ["Process Discovery", 0.039036782165937506], ["Create or Modify System Process", 0.02187888334625341], ["Abuse Elevation Control Mechanism", 0.01582007882097018]], "the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.": [["Process Injection", 0.6813296215523579], ["Native API", 0.060105287953388285], ["Access Token Manipulation", 0.020059450521021007], ["Create or Modify System Process", 0.017062338429266712], ["Process Discovery", 0.015040634156863759], ["Event Triggered Execution", 0.013398638397304008]], "it queues an APC into the patched GlobalGetAtomA to get the payload running.": [["Process Injection", 0.09574253721848709], ["Create or Modify System Process", 0.04123911791496827], ["Hijack Execution Flow", 0.030705783835999024], ["Event Triggered Execution", 0.02885195630892796], ["System Services", 0.028252366787575683], ["Deobfuscate/Decode Files or Information", 0.027076950848445688]], "APC routine argument in the case of NtQueueApcThread,": [["Process Injection", 0.19497540555987647], ["Native API", 0.08227849154805371], ["Event Triggered Execution", 0.05076729481142569], ["Create or Modify System Process", 0.04267872747370297], ["Access Token Manipulation", 0.03567646054839839], ["Masquerading", 0.028552980542813692]], "AtomBombing is the write-primitive, which allows writing to the remote process using atom tables and APC.": [["Process Injection", 0.4229011160388597], ["Native API", 0.07561796502589967], ["Process Discovery", 0.03203431120030602], ["Access Token Manipulation", 0.023440254907256722], ["Hide Artifacts", 0.015714406394603444], ["Data Manipulation", 0.013879124937048837]], "AtomBombing Injection Technique": [["Process Injection", 0.18844749451114973], ["Obfuscated Files or Information", 0.11723229408775297], ["Native API", 0.03019523779428034], ["Event Triggered Execution", 0.026125783097960778], ["Exploit Public-Facing Application", 0.02313726826388671], ["Hijack Execution Flow", 0.020386333668464318]], "AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs": [["Process Injection", 0.17902149816718332], ["Obfuscated Files or Information", 0.1364298955616788], ["Hijack Execution Flow", 0.08256098827870804], ["Native API", 0.056144079223220386], ["Exploitation for Client Execution", 0.041695331800544445], ["Shared Modules", 0.027263537757737842]], "Malware using the AtomBombing technique first writes the payload into the global atom table, which can be accessed by all processes.": [["Process Injection", 0.205863736373399], ["Obfuscated Files or Information", 0.1907978053114777], ["Native API", 0.06251952798046857], ["Hijack Execution Flow", 0.05405023748483031], ["Deobfuscate/Decode Files or Information", 0.05156085808127729], ["System Binary Proxy Execution", 0.02691195885817586]], "uses a slightly modified AtomBombing technique that injects one of its stages into a Windows process": [["Process Injection", 0.7328563006212162], ["Native API", 0.10091370060419194], ["System Binary Proxy Execution", 0.011123233436367284], ["Process Discovery", 0.010173941840259325], ["Event Triggered Execution", 0.010067861701081154], ["Hijack Execution Flow", 0.00926472082399102]], "the malware can read HTTP-POST headers": [["Application Layer Protocol", 0.2724006440354201], ["Data Encoding", 0.0871156124053538], ["Data Obfuscation", 0.06498772475307565], ["Exfiltration Over C2 Channel", 0.04073032113681508], ["System Network Configuration Discovery", 0.02899091006514479], ["Network Sniffing", 0.025791146487166003]], "injects the main bot into svchost.exe.": [["Process Injection", 0.26773711519596227], ["System Binary Proxy Execution", 0.10107667070414333], ["Command and Scripting Interpreter", 0.05660212802449175], ["System Services", 0.05415293440942188], ["Hijack Execution Flow", 0.04646846760368175], ["Create or Modify System Process", 0.046310374896861344]], "Injected Processes": [["Process Injection", 0.6557409407896609], ["Native API", 0.06360742980265023], ["Process Discovery", 0.05805400161439143], ["Create or Modify System Process", 0.017339906902613774], ["Access Token Manipulation", 0.014006025435003469], ["Event Triggered Execution", 0.013295958828583448]], "Process Injection via Hooking": [["Process Injection", 0.6629343430262906], ["Native API", 0.14142310794852225], ["Hijack Execution Flow", 0.018514433134753604], ["Process Discovery", 0.014406458000533664], ["Access Token Manipulation", 0.01405493054935034], ["Create or Modify System Process", 0.012876342387542148]], "use this technique to inject themselves into other processes": [["Process Injection", 0.8592165805525729], ["Native API", 0.04424637487394856], ["Hijack Execution Flow", 0.00982070174471734], ["System Services", 0.005590003353938894], ["Create or Modify System Process", 0.0054887740536570615], ["Access Token Manipulation", 0.0053927143395955356]], "they inject their main bot into a Windows process, and then inject their other modules into different processes according to the module\u2019s purpose": [["Process Injection", 0.6852180262752706], ["Native API", 0.05380278406387208], ["Create or Modify System Process", 0.021981529514602142], ["Hijack Execution Flow", 0.020618679539428125], ["System Binary Proxy Execution", 0.016987721228624807], ["Event Triggered Execution", 0.01381316080715753]], "an injection into a web browser process.": [["Process Injection", 0.23480799506333483], ["Browser Session Hijacking", 0.07438598762107015], ["Exploit Public-Facing Application", 0.04973869702428086], ["Server Software Component", 0.03659190620518593], ["Native API", 0.0343254635359111], ["Credentials from Password Stores", 0.02913591939114545]], "injected thread": [["Process Injection", 0.4527937507854289], ["Native API", 0.045280221761102024], ["Event Triggered Execution", 0.030333101398435144], ["Process Discovery", 0.020207260175154004], ["Create or Modify System Process", 0.0176405624489971], ["Access Token Manipulation", 0.014544233765731145]], "they suspend the remote process threads": [["Impair Defenses", 0.11714164171579432], ["Service Stop", 0.09859552789248918], ["Process Injection", 0.08166535220213983], ["Process Discovery", 0.0610593960671662], ["Virtualization/Sandbox Evasion", 0.04592674450426307], ["Access Token Manipulation", 0.037187962681519825]], "The injected process": [["Process Injection", 0.7307129537038535], ["Native API", 0.06930487018610706], ["Process Discovery", 0.036253282775749546], ["Create or Modify System Process", 0.013173809501569695], ["Access Token Manipulation", 0.01238156164716473], ["Hijack Execution Flow", 0.011101372422480712]], "goes through processes one by one": [["Process Discovery", 0.42621085771778894], ["Native API", 0.1698141372826048], ["Process Injection", 0.10976409962711693], ["Access Token Manipulation", 0.021812662950738047], ["Windows Management Instrumentation", 0.014544689160869683], ["System Services", 0.014458058096867298]], "used to steal victims\u2019 sensitive data.": [["Archive Collected Data", 0.07682538496723919], ["Data from Local System", 0.05366846331386035], ["Exfiltration Over Alternative Protocol", 0.051615963050734175], ["Exfiltration Over C2 Channel", 0.04307658806405591], ["Obtain Capabilities", 0.04090229011530587], ["Exfiltration Over Web Service", 0.03030051904719048]], "injects its main bot into a hollowed instance of svchost.exe": [["Process Injection", 0.7263683282788335], ["Native API", 0.042575263525767106], ["System Binary Proxy Execution", 0.034253333847522195], ["Hijack Execution Flow", 0.025406274104163882], ["Command and Scripting Interpreter", 0.014640813482254898], ["Event Triggered Execution", 0.011937895516132545]], "implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory.": [["Process Injection", 0.7555485768750689], ["Native API", 0.050152834956247526], ["Process Discovery", 0.016344916562175637], ["Impair Defenses", 0.011571415360400635], ["Access Token Manipulation", 0.011049235378983724], ["Hijack Execution Flow", 0.010727241505136468]], "Process hollowing is a process injection technique that creates a new legitimate process in a suspended mode, unmaps its main image and replaces it with malicious code.": [["Process Injection", 0.730310384620787], ["Process Discovery", 0.023664797664631632], ["Native API", 0.021257389047908276], ["Access Token Manipulation", 0.015421142540476813], ["Create or Modify System Process", 0.013468412170329866], ["Service Stop", 0.008934413818621005]], "The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread.": [["Process Injection", 0.5141120434989377], ["Access Token Manipulation", 0.05755384746313438], ["Native API", 0.0522690365226453], ["Process Discovery", 0.04842162602820372], ["Impair Defenses", 0.024499735135877564], ["Create or Modify System Process", 0.0209145424793137]], "for process hollowing from a WoW64 process into a 64-bit svchost.exe": [["Process Injection", 0.5978050456100485], ["Native API", 0.056528972690449805], ["Process Discovery", 0.03605022340447369], ["System Binary Proxy Execution", 0.02107138857348907], ["Access Token Manipulation", 0.018291015580280668], ["Hijack Execution Flow", 0.016545822174904058]], "Evasive Process Hollowing By Entrypoint Patching": [["Process Injection", 0.6966769196759177], ["Native API", 0.023282146530877526], ["Virtualization/Sandbox Evasion", 0.017795212390704897], ["Obfuscated Files or Information", 0.01700961553372302], ["Hide Artifacts", 0.012399528914272788], ["Modify System Image", 0.011060813162863331]], "Evasive Process": [["Process Injection", 0.1879312696119566], ["Native API", 0.0795090299338793], ["Impair Defenses", 0.05214669757994379], ["Virtualization/Sandbox Evasion", 0.049066404313799813], ["Masquerading", 0.042582923209520944], ["Access Token Manipulation", 0.035280450397295354]], "Evasive Process Hollowing by Entrypoint Patching": [["Process Injection", 0.6966769196759177], ["Native API", 0.023282146530877526], ["Virtualization/Sandbox Evasion", 0.017795212390704897], ["Obfuscated Files or Information", 0.01700961553372302], ["Hide Artifacts", 0.012399528914272788], ["Modify System Image", 0.011060813162863331]], "Decompresses a local buffer": [["Deobfuscate/Decode Files or Information", 0.29189928147447836], ["Archive Collected Data", 0.1354073911452388], ["Obfuscated Files or Information", 0.08748824304441488], ["Hide Artifacts", 0.0387124327278538], ["Process Injection", 0.030907174656942475], ["Indicator Removal", 0.018945559651423565]], "Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory": [["Process Injection", 0.6841348250992934], ["Native API", 0.046488027180680784], ["Event Triggered Execution", 0.013320325022081764], ["Hijack Execution Flow", 0.01172849069874783], ["Access Token Manipulation", 0.011182235867314516], ["System Binary Proxy Execution", 0.008891894402177608]], "obscure the call by wiping artifacts from the buffer, such as wiping the PE header.": [["Impair Defenses", 0.11762286651330946], ["Rootkit", 0.0820976214809629], ["Process Injection", 0.08083689223502318], ["Obfuscated Files or Information", 0.0405766199357372], ["Hide Artifacts", 0.04040883151504199], ["Data Obfuscation", 0.0352815253099191]], "malware disguised as Hancom Office document files.": [["Template Injection", 0.11948139247102052], ["Masquerading", 0.10017659417629658], ["User Execution", 0.08343833218615564], ["Phishing", 0.07443035434641265], ["Data from Local System", 0.06589553737781632], ["File and Directory Discovery", 0.03670531536645184]], "\u201cWho and What Threatens the World (Column).exe\u201d and is designed to deceive users by using an icon that is similar to that of Hancom Office.": [["Masquerading", 0.35828786329072654], ["Obfuscated Files or Information", 0.030495268476119497], ["Defacement", 0.020383343279781904], ["Hide Artifacts", 0.018312842943132096], ["Data Manipulation", 0.0174769901060951], ["Office Application Startup", 0.016320046967534366]], "creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.": [["Masquerading", 0.23479691392789798], ["Hide Artifacts", 0.10471938304281538], ["Data Staged", 0.045602203506641674], ["Replication Through Removable Media", 0.03967676476440399], ["Taint Shared Content", 0.027257888506394077], ["Compromise Client Software Binary", 0.02497837065633567]], "malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.": [["Masquerading", 0.2917900152820963], ["Office Application Startup", 0.06496212845430994], ["Data Staged", 0.046476929783847085], ["File and Directory Discovery", 0.042665913287688526], ["Hide Artifacts", 0.03953473825705937], ["System Binary Proxy Execution", 0.03819739662771168]], "connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.": [["Scheduled Task/Job", 0.3012835393008937], ["Command and Scripting Interpreter", 0.04266229789646053], ["Inter-Process Communication", 0.03256142504864066], ["Fallback Channels", 0.023463809979202548], ["Event Triggered Execution", 0.022274895228745772], ["System Time Discovery", 0.020703204266519844]], "URL registered in the task scheduler appears to be a normal homepage": [["Scheduled Task/Job", 0.2026923280890764], ["Masquerading", 0.11675388742772369], ["Inter-Process Communication", 0.07590479188323185], ["Office Application Startup", 0.03176330159594209], ["Dynamic Resolution", 0.026220485451511004], ["Indicator Removal", 0.020916889770255336]], "Decompressing the compressed file": [["Archive Collected Data", 0.4855765105735317], ["Deobfuscate/Decode Files or Information", 0.23612402274623612], ["Obfuscated Files or Information", 0.07345210333167664], ["Data Encrypted for Impact", 0.01794319290709862], ["Exfiltration Over Alternative Protocol", 0.012716424248156128], ["Exfiltration Over C2 Channel", 0.00827428118741092]], "Decompressing": [["Archive Collected Data", 0.44828177672347], ["Deobfuscate/Decode Files or Information", 0.2144824064585293], ["Obfuscated Files or Information", 0.07072153657619204], ["Exfiltration Over Alternative Protocol", 0.02033425023161859], ["Data Encrypted for Impact", 0.018484618391398523], ["Exfiltration Over C2 Channel", 0.012424152509187502]], "injected and executed within the normal Windows process called mstsc.exe.": [["Process Injection", 0.3005896416953244], ["System Binary Proxy Execution", 0.21204951071597058], ["Native API", 0.12611004625574765], ["Hijack Execution Flow", 0.0350727341633114], ["Masquerading", 0.034991697742151266], ["Event Triggered Execution", 0.03481548467604509]], "of mstsc.exe being executed after being injected with malware": [["System Binary Proxy Execution", 0.2640665269489051], ["Process Injection", 0.195285944853102], ["Native API", 0.07993060887580246], ["Event Triggered Execution", 0.056779444874457866], ["Hijack Execution Flow", 0.038705571492909395], ["Masquerading", 0.02636365513654283]], "deleted using the cmd command.": [["Indicator Removal", 0.7500135818605911], ["Data Destruction", 0.07236651030507235], ["Inhibit System Recovery", 0.028282458218815417], ["Disk Wipe", 0.018045444927144758], ["System Shutdown/Reboot", 0.01289473557766062], ["Modify Registry", 0.006986526518041858]], "registers its file with the name onedrivenew under the Run key": [["Boot or Logon Autostart Execution", 0.25518263068380337], ["Masquerading", 0.10724097884149333], ["Replication Through Removable Media", 0.053180140909802755], ["Create or Modify System Process", 0.036283362268988255], ["Modify Registry", 0.03215074246413035], ["Hide Artifacts", 0.030115764483452954]], "registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.": [["Boot or Logon Autostart Execution", 0.38414256451637563], ["Boot or Logon Initialization Scripts", 0.07225842615789764], ["Create or Modify System Process", 0.06984657025187782], ["Replication Through Removable Media", 0.04420077822247832], ["Scheduled Task/Job", 0.03873803732676262], ["Event Triggered Execution", 0.032898448233396264]], "schtasks.exe command to register the file to the task scheduler with": [["Scheduled Task/Job", 0.638411477189518], ["Masquerading", 0.0723002463831979], ["Inter-Process Communication", 0.02707790031001805], ["Create or Modify System Process", 0.019004633648984647], ["System Binary Proxy Execution", 0.016528505770714016], ["Boot or Logon Autostart Execution", 0.010822916546906782]], "URL registered in the task scheduler": [["Scheduled Task/Job", 0.4301517345457118], ["Inter-Process Communication", 0.07780607757081756], ["Masquerading", 0.07335682540719779], ["Process Discovery", 0.022811776628155964], ["Dynamic Resolution", 0.016610932652666582], ["Indicator Removal", 0.015265661617068568]], "using an obfuscated Meterpreter stager": [["Obfuscated Files or Information", 0.6352113039888316], ["Data Obfuscation", 0.03711903264663568], ["Deobfuscate/Decode Files or Information", 0.03274652977979774], ["Encrypted Channel", 0.022291915183489334], ["Execution Guardrails", 0.02091283387389694], ["Archive Collected Data", 0.015679219033169923]], "One of the techniques to conceal the traffic from DNS-based filtering is Domain Fronting.": [["Proxy", 0.16937342074083897], ["Dynamic Resolution", 0.07697351833738139], ["Data Obfuscation", 0.06598333714008543], ["Compromise Infrastructure", 0.04916881474421357], ["Network Denial of Service", 0.049090438062742776], ["Acquire Infrastructure", 0.04723451233415576]], "Domain fronting uses legitimate or high-reputation domains to remain undetected by defenders.": [["Acquire Infrastructure", 0.4433177994199599], ["Compromise Infrastructure", 0.16911543559850511], ["Stage Capabilities", 0.030919654341323495], ["Dynamic Resolution", 0.030047805290656877], ["Establish Accounts", 0.018353926991927613], ["Masquerading", 0.01768823561582471]], "domains for domain fronting may indicate an interest in the geopolitics of this area of the world.": [["Acquire Infrastructure", 0.24514591193781668], ["Gather Victim Network Information", 0.0731333941458193], ["Compromise Infrastructure", 0.060702807307127286], ["Search Open Websites/Domains", 0.060445535218330994], ["Search Open Technical Databases", 0.0550287927694882], ["Dynamic Resolution", 0.04333551700917298]], "the domain fronting functionality before launching the attack.": [["Compromise Infrastructure", 0.32845963509377085], ["Acquire Infrastructure", 0.12755940409726282], ["Endpoint Denial of Service", 0.06029151088440629], ["Network Denial of Service", 0.04700727624387405], ["Stage Capabilities", 0.035133426107217154], ["Dynamic Resolution", 0.0248915004465622]], "The actor in this campaign has used domain fronting, which is a technique which can use high reputation domains to conceal the Cobalt Strike command and control traffic.": [["Proxy", 0.12341530908914777], ["Compromise Infrastructure", 0.11584320456432519], ["Dynamic Resolution", 0.10858980333384298], ["Acquire Infrastructure", 0.06673802214019778], ["Network Denial of Service", 0.06597697362210948], ["Data Obfuscation", 0.05296093210257583]], "Domain fronting can be achieved with a redirect between the malicious server and the target.": [["Compromise Infrastructure", 0.331245225037383], ["Acquire Infrastructure", 0.2336929191044076], ["Dynamic Resolution", 0.045401387082506836], ["Stage Capabilities", 0.025728823103355333], ["Endpoint Denial of Service", 0.01847036483706389], ["Drive-by Compromise", 0.01769833563945917]], "actors may misuse various content delivery networks (CDNs) to set up redirects of serving content to the content served by attacker-controlled C2 hosts.": [["Compromise Infrastructure", 0.10846006644558251], ["Dynamic Resolution", 0.08056322489493452], ["Web Service", 0.07713654285694803], ["Proxy", 0.07645773311215408], ["Acquire Infrastructure", 0.06691787683831468], ["Fallback Channels", 0.057548207470042835]], "The beacons are of particular interest due to the domain fronting technique using a government host as the initial DNS lure.": [["Dynamic Resolution", 0.0874313211446513], ["Acquire Infrastructure", 0.06756439277448224], ["Web Service", 0.05566947459979585], ["Gather Victim Network Information", 0.05079577087200983], ["Search Open Technical Databases", 0.04256975296699737], ["Active Scanning", 0.038329134762615964]], "The DNS request for the initial host resolves to a Cloudflare-owned IP address that allows the attacker to employ domain fronting and send the traffic to the actual C2 host": [["Application Layer Protocol", 0.1828108257072377], ["Dynamic Resolution", 0.1717791874402137], ["Proxy", 0.06480364478668911], ["Fallback Channels", 0.05836259701190501], ["Compromise Infrastructure", 0.04713363827954168], ["Network Denial of Service", 0.032073652443110175]], "Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering.": [["Compromise Infrastructure", 0.25776208163674846], ["Acquire Infrastructure", 0.15395955770569733], ["Dynamic Resolution", 0.04903498370195296], ["Endpoint Denial of Service", 0.04734432617463947], ["Network Denial of Service", 0.03276074871058485], ["Stage Capabilities", 0.02589574140109876]], "modify the subsequent HTTPs requests header to instruct the CDN to direct the traffic to an attacker-controlled host.": [["Application Layer Protocol", 0.17811492271033336], ["Proxy", 0.08176718398312069], ["Compromise Infrastructure", 0.0770600399223925], ["Stage Capabilities", 0.060495357535274685], ["Data Obfuscation", 0.04474944269959346], ["Browser Session Hijacking", 0.03876025299031767]], "The threat actor in this case uses domain fronting with the Cloudflare Content Delivery Network": [["Compromise Infrastructure", 0.37303100057957117], ["Acquire Infrastructure", 0.24872824067440172], ["Stage Capabilities", 0.05728044879882495], ["Dynamic Resolution", 0.03318321164578803], ["Drive-by Compromise", 0.018764325135457054], ["Web Service", 0.016196041970945083]], ".]net via HTTP Get and POST metadata specified in the beacon's configuration.": [["Application Layer Protocol", 0.16859491237410643], ["Exfiltration Over C2 Channel", 0.13579147205774966], ["Web Service", 0.0576684823504188], ["Data Encoding", 0.044111111957514264], ["System Network Configuration Discovery", 0.03953595807035673], ["Dynamic Resolution", 0.031276378816542744]], "relies on other parts of the HTTP request, including the Host header and the actual C2": [["Application Layer Protocol", 0.47699528445734485], ["Data Obfuscation", 0.054645766383282925], ["Data Encoding", 0.03837700367334605], ["Fallback Channels", 0.03332827923923533], ["Exfiltration Over C2 Channel", 0.028876417948934772], ["Dynamic Resolution", 0.024130629856711248]], "suspicious section .kxrt with the packed and encoded malicious code.": [["Obfuscated Files or Information", 0.43184116077008605], ["Deobfuscate/Decode Files or Information", 0.13299335536339124], ["Data Obfuscation", 0.044880361323949555], ["Data Encoding", 0.044420773267375924], ["Encrypted Channel", 0.029521861818710287], ["Masquerading", 0.020960901278344567]], "decryption routine is executed that decrypts the remaining malicious code in the .kxrt section and writes it to the virtual memory.": [["Deobfuscate/Decode Files or Information", 0.5968021443781111], ["Obfuscated Files or Information", 0.1215111617917329], ["Archive Collected Data", 0.022968188558149704], ["Data Encrypted for Impact", 0.01750436709945422], ["Encrypted Channel", 0.01438237086769426], ["Hide Artifacts", 0.013094778079578547]], "Decoder routine to decrypt the beacon DLL.": [["Deobfuscate/Decode Files or Information", 0.6654508988343995], ["Obfuscated Files or Information", 0.12004490625926706], ["Encrypted Channel", 0.0195253538707345], ["Data Encoding", 0.01663433432969776], ["Archive Collected Data", 0.008785084952133503], ["Masquerading", 0.008483069084259581]], "The decrypted malicious code": [["Deobfuscate/Decode Files or Information", 0.6247223053983927], ["Obfuscated Files or Information", 0.17530577638747857], ["Data Encrypted for Impact", 0.03469601181994903], ["Archive Collected Data", 0.019943610321904462], ["Encrypted Channel", 0.019553348562630267], ["Execution Guardrails", 0.012418114961172386]], "Once decoded, the loader's execution jumps to the beginning of the DLL": [["Hijack Execution Flow", 0.23207243837493408], ["Deobfuscate/Decode Files or Information", 0.23142865422655592], ["Process Injection", 0.1020275582718579], ["Shared Modules", 0.08801416177207794], ["System Binary Proxy Execution", 0.055830265951599845], ["Obfuscated Files or Information", 0.05121893984309836]], "now responsible for decoding the configuration.": [["Deobfuscate/Decode Files or Information", 0.33957277229023847], ["Obfuscated Files or Information", 0.19612790730539129], ["Data Encoding", 0.06747285371819621], ["Modify Registry", 0.0325601700835501], ["Data Obfuscation", 0.027381884503078754], ["Encrypted Channel", 0.018095604649352882]], "by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver": [["Application Layer Protocol", 0.20168793718664196], ["Proxy", 0.10753788921546864], ["Data Obfuscation", 0.0599274792575711], ["Non-Standard Port", 0.04049463875968186], ["Non-Application Layer Protocol", 0.04015346251092053], ["Protocol Tunneling", 0.029097845724808155]], "calls the VirtualProtect function": [["Process Injection", 0.11626455437122994], ["Virtualization/Sandbox Evasion", 0.061148025096879055], ["Hide Artifacts", 0.04222029801330278], ["System Binary Proxy Execution", 0.035435492412960894], ["Native API", 0.03277874740334506], ["Hijack Execution Flow", 0.03260393305548734]], "modifies the victim's system power and lid open/close policies in the registry.": [["Event Triggered Execution", 0.060218526051801204], ["Traffic Signaling", 0.03336389226238833], ["Modify Registry", 0.03125708025637384], ["Abuse Elevation Control Mechanism", 0.030781069939914106], ["Boot or Logon Autostart Execution", 0.030327810672184482], ["Account Access Removal", 0.02655747810474518]], "can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy.": [["Event Triggered Execution", 0.04660242344856864], ["Modify Registry", 0.04443843409777236], ["Impair Defenses", 0.030994237962249194], ["Scheduled Task/Job", 0.03006697312600336], ["Virtualization/Sandbox Evasion", 0.028594164417107246], ["Create or Modify System Process", 0.025815410188493523]], "routed through European TOR VPN exit nodes.": [["Proxy", 0.3614149300693465], ["External Remote Services", 0.11788592310742171], ["Protocol Tunneling", 0.06542823865651001], ["Encrypted Channel", 0.031634877274885016], ["Network Boundary Bridging", 0.023395806045671774], ["Adversary-in-the-Middle", 0.013488511897672075]], "VPN access using Single Factor authentication.": [["External Remote Services", 0.3340987662192202], ["Valid Accounts", 0.07401003634644074], ["Multi-Factor Authentication Interception", 0.039904022393798616], ["Use Alternate Authentication Material", 0.03970947333256942], ["Modify Authentication Process", 0.039386021915008354], ["Steal or Forge Kerberos Tickets", 0.024900522259678086]], "Minidump of LSASS process memory": [["Process Injection", 0.12301522566900336], ["Process Discovery", 0.07873577968225524], ["Virtualization/Sandbox Evasion", 0.076803558068609], ["OS Credential Dumping", 0.0537283127247782], ["Native API", 0.04670972730082318], ["Indicator Removal", 0.04300514174764982]], "The minidump function of comsvcs.dll can be used to dump lsass.exe.": [["Native API", 0.14457734446440743], ["OS Credential Dumping", 0.10718022983098484], ["System Binary Proxy Execution", 0.07281935043763149], ["Process Injection", 0.05093731827541666], ["Deobfuscate/Decode Files or Information", 0.04556927141828329], ["File and Directory Discovery", 0.04406308570220992]], "leveraging comsvcs.dll with proxy execution by rundll32.exe.": [["System Binary Proxy Execution", 0.44208052643378504], ["Process Injection", 0.12717526123104478], ["Native API", 0.10752250823670485], ["Hijack Execution Flow", 0.08374641853388039], ["System Services", 0.03006647097796695], ["Event Triggered Execution", 0.020827505195820894]], "do rundll32.exe C:\\windows\\System32\\comsvcs.dll,": [["System Binary Proxy Execution", 0.2670267291395268], ["Hijack Execution Flow", 0.23951781451173046], ["Native API", 0.10327400160459108], ["Shared Modules", 0.061860835316169184], ["Process Injection", 0.037454742664732296], ["Masquerading", 0.020302019374916165]], "Conducting discovery indirectly via schedule tasks named \u201cWindows Update\u201d": [["Windows Management Instrumentation", 0.10497142446206877], ["Scheduled Task/Job", 0.0872963530268731], ["Masquerading", 0.08539236336820066], ["Process Discovery", 0.04868130714501308], ["System Service Discovery", 0.026644525317628107], ["System Information Discovery", 0.022573848221068588]], "performing remote directory listings.": [["File and Directory Discovery", 0.5395549531261403], ["Remote System Discovery", 0.04526392451114869], ["Network Share Discovery", 0.03894677997824928], ["Data from Local System", 0.03366414174848532], ["Data from Network Shared Drive", 0.03306134850972341], ["Automated Collection", 0.031509156379358944]], "to discover interesting to them directories": [["File and Directory Discovery", 0.4055481973562637], ["Data from Information Repositories", 0.04920399600909461], ["Automated Collection", 0.043798835086913755], ["Data from Local System", 0.04246256151473018], ["Data Staged", 0.040144656426231946], ["Data from Network Shared Drive", 0.028934251461164594]], "Leveraging a dual-use tool, PCHunter64, to acquire detailed process and system information.": [["System Information Discovery", 0.6609085310983356], ["Windows Management Instrumentation", 0.056450328321470934], ["Virtualization/Sandbox Evasion", 0.046071126133083354], ["Software Discovery", 0.04144297717004902], ["Process Discovery", 0.03283239528913349], ["Query Registry", 0.012344422043509934]], "Threat actors can use windows binaries and commands": [["Command and Scripting Interpreter", 0.16196303994204803], ["System Binary Proxy Execution", 0.15739772299674473], ["Windows Management Instrumentation", 0.05490088102775642], ["Event Triggered Execution", 0.05395717982946299], ["Masquerading", 0.04315798009689839], ["System Script Proxy Execution", 0.039662359534366365]], "RDP connection established": [["Remote Services", 0.6633185254624167], ["Remote Access Software", 0.04224359471739291], ["Remote Service Session Hijacking", 0.03592647355842493], ["System Network Connections Discovery", 0.026690616157738406], ["External Remote Services", 0.013315654781747031], ["Exploitation of Remote Services", 0.009688289105617429]], "Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network": [["Remote Services", 0.6238974045327857], ["Remote Access Software", 0.07704550114405491], ["Remote Service Session Hijacking", 0.05632612910985662], ["Exploitation of Remote Services", 0.044048065909502686], ["External Remote Services", 0.017282218535549992], ["Valid Accounts", 0.014373214649394256]], "the threat actor was able to RDP unencumbered across the organization\u2019s infrastructure.": [["Remote Services", 0.40878954270891693], ["Remote Access Software", 0.09957388591996279], ["Exploitation of Remote Services", 0.056035825559374884], ["External Remote Services", 0.055648919817973], ["Remote Service Session Hijacking", 0.0362768178497501], ["Valid Accounts", 0.02536899780854396]], "The threat actor executed two actions to bypass Windows Defender": [["Impair Defenses", 0.28153980129667966], ["Software Discovery", 0.048188104514747074], ["Windows Management Instrumentation", 0.04479633818228241], ["System Script Proxy Execution", 0.04327756408277329], ["Domain Policy Modification", 0.04237710282910358], ["Masquerading", 0.04110420473804519]], "the threat actor leveraged one of the most popular dual-use agents, AnyDesk, to provide persistent remote access into the affected organization on multiple systems.": [["Remote Access Software", 0.20560619868599322], ["External Remote Services", 0.15330980773172978], ["Software Deployment Tools", 0.07639011069112135], ["Valid Accounts", 0.06449776498596936], ["Remote Services", 0.059129506809553596], ["Exploitation of Remote Services", 0.026439275760746526]], "several files were staged for possible, but unconfirmed exfiltration": [["Indicator Removal", 0.19522697776439807], ["Data Staged", 0.11219284701114433], ["Data from Local System", 0.08787027389269601], ["Automated Exfiltration", 0.05071783958578089], ["Archive Collected Data", 0.034158041816033], ["Data Destruction", 0.031356816707210695]], "spear phishing emails that contain a .csv or .xlt file attachment": [["Phishing", 0.4842837084856923], ["User Execution", 0.1449275328483808], ["Phishing for Information", 0.05479642921259843], ["Email Collection", 0.020433788444004286], ["Template Injection", 0.019242288773666204], ["Internal Spearphishing", 0.016595140272526256]], "The email is directed to \u201cNon-Resident Alien\u201d tax payers to have them fill out a PDF file (that is attached to the email)": [["Phishing", 0.15687778614475348], ["Gather Victim Identity Information", 0.06862803857312848], ["User Execution", 0.05658217320547328], ["Phishing for Information", 0.05530891431704045], ["Email Collection", 0.0478215284956653], ["Office Application Startup", 0.04191620977893876]], "a cyber-attack in the form of credential stuffing,": [["Phishing for Information", 0.07756771886285654], ["Brute Force", 0.06897062183285842], ["Internal Spearphishing", 0.06689502015549101], ["Gather Victim Identity Information", 0.053998390491998144], ["Forge Web Credentials", 0.034137975846059404], ["Compromise Accounts", 0.03373759123728762]], "Enduring Credential Stuffing": [["Modify Authentication Process", 0.15123496725207425], ["Forced Authentication", 0.07333413338915704], ["Valid Accounts", 0.06820801528869938], ["Brute Force", 0.05992807131470274], ["Forge Web Credentials", 0.04627132857274817], ["Use Alternate Authentication Material", 0.03940153431729543]], "using login credentials from what the company suspects are past data breaches from other companies": [["Brute Force", 0.10304685237979447], ["Gather Victim Identity Information", 0.09647219217381232], ["Valid Accounts", 0.06099825913056696], ["Exploitation for Credential Access", 0.05592193083127036], ["Unsecured Credentials", 0.03939114145961173], ["Credentials from Password Stores", 0.038897679422678924]], "replace the \u201cServiceManager.exe\u201d file from the driver folder with a malicious file to trick the driver into running the tainted file": [["Create or Modify System Process", 0.23835464824492153], ["Masquerading", 0.15768403172792794], ["Hijack Execution Flow", 0.05900831479558401], ["System Services", 0.05587675883610266], ["Boot or Logon Autostart Execution", 0.05354904273991903], ["Pre-OS Boot", 0.02972941742125004]], "log keystrokes": [["Input Capture", 0.8843981789991568], ["Clipboard Data", 0.005845142134033741], ["Unsecured Credentials", 0.0043657164189263966], ["Credentials from Password Stores", 0.004235473322690989], ["Screen Capture", 0.003472447562378733], ["Network Sniffing", 0.0034255328367494313]], "a vulnerability in unencrypted Wi-Fi routers that makes them susceptible to a TCP exploit.": [["Adversary-in-the-Middle", 0.1269106537700476], ["Encrypted Channel", 0.07694479828636616], ["Application Layer Protocol", 0.0579954658134315], ["Network Boundary Bridging", 0.055745741573365114], ["Protocol Tunneling", 0.051660671348005255], ["Weaken Encryption", 0.050557219364449686]], "A threat actor could take advantage of this vulnerability by creating a specific file that contains data that is stored in the JET database format, and having the targeted user open it, which would then allow for remote code execution at the level of the current process": [["Exploitation for Client Execution", 0.2043490891786204], ["Exploitation of Remote Services", 0.0752149191234333], ["Exploit Public-Facing Application", 0.05158719492428349], ["Process Injection", 0.04566237504103935], ["Event Triggered Execution", 0.03386959297639591], ["Exploitation for Privilege Escalation", 0.030271550938469036]], "This vulnerability, registered as \u201cCVE-2018-14327,\u201d allows a low-privileged user account to escalate privileges on any Windows machine that had connected to the EE Mini modem via USB.": [["Exploitation for Privilege Escalation", 0.14470965995630253], ["Abuse Elevation Control Mechanism", 0.05035026207404884], ["Replication Through Removable Media", 0.029108501844735107], ["Network Boundary Bridging", 0.028807530799627168], ["Traffic Signaling", 0.027111087853437535], ["Weaken Encryption", 0.025981731679416652]], "decrypts that specific payload code": [["Deobfuscate/Decode Files or Information", 0.7368533322570517], ["Obfuscated Files or Information", 0.08173782164627356], ["Encrypted Channel", 0.027102776065051102], ["Data Encrypted for Impact", 0.024987895882535027], ["Archive Collected Data", 0.018514293292540406], ["Weaken Encryption", 0.014515758915736589]], "A threat actor could establish an administrator session": [["Remote Service Session Hijacking", 0.2042909283115928], ["Access Token Manipulation", 0.060320102504982286], ["Abuse Elevation Control Mechanism", 0.05720426938095423], ["Valid Accounts", 0.04957934164297611], ["Remote Services", 0.04351316385611831], ["Event Triggered Execution", 0.04173331675012228]], "a payload download code that grabs malware to download and install the backdoor.": [["Ingress Tool Transfer", 0.23063894794300877], ["Command and Scripting Interpreter", 0.08383901680541234], ["BITS Jobs", 0.06660652059874612], ["Multi-Stage Channels", 0.05022049257680643], ["Obtain Capabilities", 0.04228590781012671], ["Supply Chain Compromise", 0.03145043559022151]], "then sign on as a legitimate user": [["Create Account", 0.15804919280402618], ["Account Access Removal", 0.09083428491296267], ["Valid Accounts", 0.07128200436082542], ["Modify Authentication Process", 0.041335691943359947], ["Access Token Manipulation", 0.03920860167071467], ["Abuse Elevation Control Mechanism", 0.036911577416077035]], "decrypting database passwords from Windows registry values": [["OS Credential Dumping", 0.2771132660117989], ["Unsecured Credentials", 0.1745197124796022], ["Credentials from Password Stores", 0.13409672408526266], ["Modify Registry", 0.046595050402953114], ["Brute Force", 0.0430720122096638], ["Deobfuscate/Decode Files or Information", 0.03388271850727853]], "decrypting them from Windows registry values": [["Deobfuscate/Decode Files or Information", 0.4781685068860448], ["Modify Registry", 0.07725271123315375], ["Obfuscated Files or Information", 0.05268980612946261], ["Data Encrypted for Impact", 0.04337556685670024], ["Query Registry", 0.03304329301618861], ["Archive Collected Data", 0.027109628201360935]], "decrypt the more sensitive data in the user\u2019s database.": [["Deobfuscate/Decode Files or Information", 0.18773617112409205], ["Data Encrypted for Impact", 0.15087635909664995], ["Archive Collected Data", 0.13292511536487273], ["Weaken Encryption", 0.06780362401961806], ["Service Stop", 0.06516106932471119], ["Obfuscated Files or Information", 0.045999505355634504]], "decrypt these database passwords,": [["Brute Force", 0.12790805336057492], ["OS Credential Dumping", 0.10473259671624431], ["Deobfuscate/Decode Files or Information", 0.09988824342519673], ["Credentials from Password Stores", 0.09836832432280068], ["Unsecured Credentials", 0.09788239860966375], ["Data Encrypted for Impact", 0.0302542683300901]], "decrypts the password": [["Deobfuscate/Decode Files or Information", 0.123815947801894], ["Brute Force", 0.11796021529916503], ["Credentials from Password Stores", 0.08438475775059952], ["OS Credential Dumping", 0.08109199594794503], ["Unsecured Credentials", 0.06878023392466864], ["Modify Authentication Process", 0.03681966537517288]], "decrypted dba user password.": [["OS Credential Dumping", 0.16799024799023354], ["Brute Force", 0.11896401206220227], ["Credentials from Password Stores", 0.09804352404908177], ["Unsecured Credentials", 0.08286804718725625], ["Deobfuscate/Decode Files or Information", 0.05221401880100362], ["Modify Authentication Process", 0.04021595485292066]], "decrypts this payload": [["Deobfuscate/Decode Files or Information", 0.762792632011616], ["Obfuscated Files or Information", 0.08305665048206629], ["Encrypted Channel", 0.024985933937858914], ["Data Encoding", 0.021102272496972482], ["Data Encrypted for Impact", 0.014397117764990499], ["Archive Collected Data", 0.014039706917390659]], "decrypting the appropriate loader": [["Deobfuscate/Decode Files or Information", 0.6092079230817817], ["Data Encrypted for Impact", 0.07626269855084776], ["Obfuscated Files or Information", 0.0691776465356378], ["Archive Collected Data", 0.03522230741836093], ["Weaken Encryption", 0.022540574093133807], ["Execution Guardrails", 0.014736937783466632]], "decrypts the payload": [["Deobfuscate/Decode Files or Information", 0.7428460677214608], ["Obfuscated Files or Information", 0.08653118736604097], ["Encrypted Channel", 0.024362497830965675], ["Data Encoding", 0.019631943760844005], ["Archive Collected Data", 0.017489296547148862], ["Data Encrypted for Impact", 0.017415580604830984]], "decrypting them": [["Deobfuscate/Decode Files or Information", 0.5835603466597534], ["Data Encrypted for Impact", 0.10185790367907142], ["Archive Collected Data", 0.08277595272615162], ["Obfuscated Files or Information", 0.03709116211683956], ["Weaken Encryption", 0.018189537127109155], ["Encrypted Channel", 0.01482744458460398]], "gather database passwords": [["Credentials from Password Stores", 0.19807473010674592], ["OS Credential Dumping", 0.16670539013047428], ["Brute Force", 0.16123172285958878], ["Unsecured Credentials", 0.14329600690662042], ["Password Policy Discovery", 0.06571143333034014], ["Modify Authentication Process", 0.02677294855716677]], "steal database passwords and configuration information": [["OS Credential Dumping", 0.31039273291423314], ["Credentials from Password Stores", 0.21579733256030617], ["Unsecured Credentials", 0.1660084960943939], ["Brute Force", 0.047721828349270475], ["Password Policy Discovery", 0.020942292453586964], ["Input Capture", 0.011332414205252545]], "steal credentials by decrypting them from registry values.": [["Credentials from Password Stores", 0.2264726265883642], ["Unsecured Credentials", 0.22326611732886337], ["OS Credential Dumping", 0.21765459376484755], ["Modify Authentication Process", 0.02918435510997446], ["Input Capture", 0.026131831433211933], ["Modify Registry", 0.022664573740065867]], "Exfiltrated credentials": [["OS Credential Dumping", 0.1503846757069168], ["Credentials from Password Stores", 0.11128745130335596], ["Unsecured Credentials", 0.10175764277999153], ["Valid Accounts", 0.05940410027163746], ["Exfiltration Over Alternative Protocol", 0.031507441691356414], ["Brute Force", 0.02309516515200195]], "decrypt these database passwords": [["Brute Force", 0.1373465106994087], ["OS Credential Dumping", 0.10031092482518937], ["Credentials from Password Stores", 0.09371054865021898], ["Deobfuscate/Decode Files or Information", 0.09141183586446078], ["Unsecured Credentials", 0.09115127840238603], ["Data Encrypted for Impact", 0.03192411327338592]], "decrypts the password for the dba username": [["OS Credential Dumping", 0.20644116664881498], ["Brute Force", 0.15730153070905564], ["Unsecured Credentials", 0.06552077897955257], ["Credentials from Password Stores", 0.06527551112849189], ["Modify Authentication Process", 0.04607543161129774], ["Steal or Forge Kerberos Tickets", 0.046007080363591434]], "successfully obtain the database passwords": [["OS Credential Dumping", 0.2149268396401606], ["Credentials from Password Stores", 0.20177618714552598], ["Unsecured Credentials", 0.14158625699417748], ["Brute Force", 0.12756975861446884], ["Password Policy Discovery", 0.05771302822767019], ["Modify Authentication Process", 0.026415139095662288]], "steal credentials by decrypting them from registry values": [["Unsecured Credentials", 0.2941014693629321], ["OS Credential Dumping", 0.21739128774807537], ["Credentials from Password Stores", 0.1408712237741488], ["Modify Registry", 0.049710732518734035], ["Modify Authentication Process", 0.019176740281011614], ["Forced Authentication", 0.016892571909753247]], "the encryption key for sensitive data": [["Data Encrypted for Impact", 0.23749353542513818], ["Weaken Encryption", 0.11452458040488958], ["Encrypted Channel", 0.10287531868789464], ["Archive Collected Data", 0.09569256369048404], ["Obfuscated Files or Information", 0.07375427043537364], ["Deobfuscate/Decode Files or Information", 0.06191288017929081]], "encrypted": [["Obfuscated Files or Information", 0.17399481485999263], ["Data Encrypted for Impact", 0.16792941066943023], ["Deobfuscate/Decode Files or Information", 0.14713368103767657], ["Archive Collected Data", 0.10904138547021597], ["Encrypted Channel", 0.08342663225345932], ["Weaken Encryption", 0.03417540478782314]], "XORed with the value": [["Deobfuscate/Decode Files or Information", 0.08425611054208525], ["Obfuscated Files or Information", 0.07239905638337357], ["Encrypted Channel", 0.04910764406075244], ["Data Manipulation", 0.03854498189722321], ["Virtualization/Sandbox Evasion", 0.03234067263977696], ["XSL Script Processing", 0.02647224774454708]], "encrypted using its own XOR key": [["Deobfuscate/Decode Files or Information", 0.23710451540409697], ["Encrypted Channel", 0.18137326266665], ["Obfuscated Files or Information", 0.13452890943133886], ["Data Encrypted for Impact", 0.12802151929120584], ["Weaken Encryption", 0.05165738811950781], ["Archive Collected Data", 0.03822355408700876]], "encrypted payload": [["Obfuscated Files or Information", 0.37123349955754925], ["Deobfuscate/Decode Files or Information", 0.1576183090559039], ["Encrypted Channel", 0.11101234331963926], ["Data Encrypted for Impact", 0.05500086396375509], ["Archive Collected Data", 0.050621938086897925], ["Data Encoding", 0.03314630985824883]], "write module to the encrypted storage": [["Obfuscated Files or Information", 0.17699709837332372], ["Archive Collected Data", 0.14187570072712224], ["Data Encrypted for Impact", 0.10895450878005931], ["Deobfuscate/Decode Files or Information", 0.10687261800056845], ["Hide Artifacts", 0.04000412567685404], ["Weaken Encryption", 0.02601037799815394]], "unpacks and loads the next stage of the malware, namely the main module": [["Deobfuscate/Decode Files or Information", 0.13672978838301963], ["Hijack Execution Flow", 0.11169056867873742], ["Shared Modules", 0.07216330256280717], ["Command and Scripting Interpreter", 0.0637855991254305], ["Ingress Tool Transfer", 0.06042895892342821], ["System Binary Proxy Execution", 0.058080559901408035]], "unpacking the main module and": [["Deobfuscate/Decode Files or Information", 0.16895306912763505], ["Obfuscated Files or Information", 0.06528793077875324], ["Hijack Execution Flow", 0.058703718903975896], ["Ingress Tool Transfer", 0.05277864202102919], ["Command and Scripting Interpreter", 0.04827665648769418], ["Shared Modules", 0.041770267252278406]], "handles communication between the modules and attacker\u2019s C&C server.": [["Multi-Stage Channels", 0.057424847052420354], ["Non-Application Layer Protocol", 0.04608978574610509], ["Application Layer Protocol", 0.0379762164430669], ["Ingress Tool Transfer", 0.036676598816733554], ["Web Service", 0.03594447944795315], ["Fallback Channels", 0.03260158602009197]], "0x10000013data for C&C server (execution logs, stolen data, \u2026)": [["Data Staged", 0.1990394102312894], ["Data from Local System", 0.12974738622964638], ["Automated Collection", 0.07098695148148403], ["Indicator Removal", 0.06895369158881756], ["Exfiltration Over C2 Channel", 0.05207199586241629], ["Automated Exfiltration", 0.02894495691922545]], "upload data to C&C": [["Ingress Tool Transfer", 0.20060326219071345], ["Data from Local System", 0.13614876278860033], ["Data Staged", 0.09116025399802008], ["Exfiltration Over C2 Channel", 0.048130939023520024], ["Automated Exfiltration", 0.03837943288997364], ["Exfiltration Over Web Service", 0.030854905366712874]], "exfiltrates data over its C&C channel.": [["Exfiltration Over C2 Channel", 0.12665094700328763], ["Exfiltration Over Web Service", 0.09826600934264795], ["Exfiltration Over Alternative Protocol", 0.09535117477452704], ["Exfiltration Over Other Network Medium", 0.06949401393643045], ["Archive Collected Data", 0.06369859573374081], ["Exfiltration Over Physical Medium", 0.049994104723806755]], "acquire a list of the running processes and their loaded modules": [["Process Discovery", 0.776340810174972], ["Native API", 0.027387841656245013], ["Process Injection", 0.02427421952157671], ["System Service Discovery", 0.021140120534244227], ["Software Discovery", 0.02104223498690576], ["Windows Management Instrumentation", 0.016247629932026948]], "collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line": [["Process Discovery", 0.8083835438585605], ["Native API", 0.024933360094031354], ["Access Token Manipulation", 0.01772673029637917], ["System Service Discovery", 0.014211903764630118], ["System Information Discovery", 0.011837273360156981], ["Windows Management Instrumentation", 0.010307236090874158]], "collect information about loaded modules for each of the running processes": [["Process Discovery", 0.3375511041523548], ["Software Discovery", 0.08659913180836376], ["Windows Management Instrumentation", 0.057965090616006694], ["Process Injection", 0.05176809590158149], ["Virtualization/Sandbox Evasion", 0.050861133567557455], ["Native API", 0.05070850742927042]], "0x10000025get handle of the process with specified PID": [["Process Discovery", 0.5725769436647139], ["Native API", 0.10354917000577682], ["Process Injection", 0.0788043667693711], ["Access Token Manipulation", 0.04545310809077288], ["System Service Discovery", 0.011834188626174013], ["Impair Defenses", 0.01067430164745485]], "enumerates running processes": [["Process Discovery", 0.8637064448332531], ["Native API", 0.016380465112561207], ["System Service Discovery", 0.013094728927498727], ["Process Injection", 0.011767374229845595], ["Windows Management Instrumentation", 0.00770631407250088], ["Software Discovery", 0.007692823869676791]], "get information about processes running on a system": [["Process Discovery", 0.8680545845455088], ["System Service Discovery", 0.013786881745464516], ["Software Discovery", 0.013577794649700697], ["Windows Management Instrumentation", 0.01063901117171407], ["System Information Discovery", 0.008965417366299425], ["Native API", 0.007671198331042275]], "stored in DataS5 (for dba) and DataS6 (for micros) registry values within one of the following registry keys": [["Modify Registry", 0.468053139876596], ["Query Registry", 0.30915462481957473], ["Boot or Logon Autostart Execution", 0.04352526549110735], ["Unsecured Credentials", 0.010158684599191432], ["Indicator Removal", 0.008849475612484474], ["Office Application Startup", 0.008433390405538243]], "Windows registry Run key": [["Boot or Logon Autostart Execution", 0.5965778374850373], ["Modify Registry", 0.14160329707599517], ["Query Registry", 0.06571070927484042], ["Event Triggered Execution", 0.01622487111018579], ["System Binary Proxy Execution", 0.014442469154088165], ["Boot or Logon Initialization Scripts", 0.014314867526732684]], "GetComputerName API": [["System Information Discovery", 0.33037402247188596], ["System Network Configuration Discovery", 0.06196359688160774], ["Remote System Discovery", 0.04928037668796635], ["Native API", 0.03839078907167814], ["System Owner/User Discovery", 0.031545313744135474], ["Masquerading", 0.02878641857006528]], "GetTickCount Windows API": [["Native API", 0.13867648458807452], ["Application Window Discovery", 0.07530532146197297], ["Virtualization/Sandbox Evasion", 0.0635646140936123], ["System Information Discovery", 0.058603324382310217], ["File and Directory Discovery", 0.044284297669650335], ["Windows Management Instrumentation", 0.04202573166063938]], "PeekNamedPipe Windows API function": [["Native API", 0.24594737254101462], ["Application Window Discovery", 0.15169939678427793], ["Hide Artifacts", 0.07936623097819957], ["Masquerading", 0.05439655584909686], ["Input Capture", 0.03920526479233254], ["Clipboard Data", 0.02719438252232934]], "information about specific registry keys": [["Query Registry", 0.720347228140899], ["Modify Registry", 0.11620800055497103], ["Software Discovery", 0.02111969642942564], ["Boot or Logon Autostart Execution", 0.01575384675640088], ["Unsecured Credentials", 0.010014532447689212], ["Windows Management Instrumentation", 0.009882175906982935]], "queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data": [["OS Credential Dumping", 0.19497256490995302], ["Query Registry", 0.18925240653368527], ["Unsecured Credentials", 0.1259402327627385], ["Windows Management Instrumentation", 0.04203764500945583], ["Password Policy Discovery", 0.03366624336053674], ["Credentials from Password Stores", 0.030847491015498392]], "is injected into one of the processes specified by the C&C": [["Process Injection", 0.7772820867186844], ["Native API", 0.0658731565467233], ["Process Discovery", 0.02234330017408707], ["Create or Modify System Process", 0.009250361968008302], ["Access Token Manipulation", 0.00906031064180984], ["Hijack Execution Flow", 0.008927723320082768]], "module is injected into one of the processes specified by the C&C": [["Process Injection", 0.6267362176353606], ["Native API", 0.05691684788412368], ["Shared Modules", 0.04586242183951839], ["Hijack Execution Flow", 0.03005876885413141], ["Create or Modify System Process", 0.022482235194096326], ["System Binary Proxy Execution", 0.02114519039028887]], "is injected only into processes running under WOW64.": [["Process Injection", 0.5990484123444982], ["Native API", 0.04748717362079496], ["Hijack Execution Flow", 0.0447579086724507], ["System Binary Proxy Execution", 0.03062256437882525], ["Event Triggered Execution", 0.018654484126752902], ["Shared Modules", 0.017905086100792954]], "its injection into one of the following processes": [["Process Injection", 0.5961085841614789], ["Native API", 0.07100823508045792], ["Hijack Execution Flow", 0.027447875611181234], ["System Binary Proxy Execution", 0.02487826329062207], ["Create or Modify System Process", 0.017818001813767317], ["Event Triggered Execution", 0.01669163720873472]], "0x10000012inject and execute received module in specified process": [["Process Injection", 0.4313082950898738], ["Native API", 0.20093151733711134], ["System Binary Proxy Execution", 0.0630002469087132], ["System Services", 0.04764828939193766], ["Shared Modules", 0.018404478366531484], ["Hijack Execution Flow", 0.016925471701690863]], "injected first,": [["Process Injection", 0.1732664022098017], ["Exploit Public-Facing Application", 0.03484523890922049], ["Event Triggered Execution", 0.028412132651237352], ["Command and Scripting Interpreter", 0.02631883907532297], ["Hijack Execution Flow", 0.023518996583059143], ["Boot or Logon Autostart Execution", 0.02305851666535429]], "inject a networking module": [["Network Boundary Bridging", 0.07109094220068601], ["Adversary-in-the-Middle", 0.06818218770836125], ["Proxy", 0.05519067828767638], ["System Network Configuration Discovery", 0.0468915573793983], ["Traffic Signaling", 0.03818301574183055], ["Exploit Public-Facing Application", 0.024011233168066737]], "inject processes that are expected to communicate over the network": [["Process Injection", 0.3931775373814707], ["Native API", 0.056063782696548756], ["System Services", 0.03617583487165284], ["Process Discovery", 0.026667505855472694], ["Access Token Manipulation", 0.0225813433091486], ["Inter-Process Communication", 0.02084469150748765]], "0x0AInject and execute received module in specified process": [["Process Injection", 0.46278200088058524], ["Native API", 0.200016043251861], ["System Binary Proxy Execution", 0.053097809260791336], ["System Services", 0.04449793093931435], ["Shared Modules", 0.018356634796102906], ["Command and Scripting Interpreter", 0.016858824161015425]], "0x0BInject and execute received module in specified process": [["Process Injection", 0.378025240337774], ["Native API", 0.2062586239695768], ["System Services", 0.06493939814612744], ["System Binary Proxy Execution", 0.06295350584526528], ["Command and Scripting Interpreter", 0.020698464522190995], ["Hijack Execution Flow", 0.019907019554387045]], "inject and execute received module in specified process": [["Process Injection", 0.5982838732277688], ["Native API", 0.09954366381851747], ["Shared Modules", 0.04661652138224737], ["System Services", 0.036212564318711594], ["System Binary Proxy Execution", 0.031823073440427466], ["Hijack Execution Flow", 0.019108453499618247]], "scanning selected IP addresses": [["Active Scanning", 0.19424572841726637], ["Network Service Discovery", 0.12154149178503039], ["Remote System Discovery", 0.12046436510761119], ["System Network Configuration Discovery", 0.11741441552780246], ["Gather Victim Network Information", 0.03998023847092139], ["Dynamic Resolution", 0.035520996212447586]], "scan specific IP addresses": [["Active Scanning", 0.16426898658242317], ["Network Service Discovery", 0.14916687652182925], ["System Network Configuration Discovery", 0.1418273949119722], ["Remote System Discovery", 0.11416038965768852], ["Gather Victim Network Information", 0.03751775461488976], ["Dynamic Resolution", 0.035931218184387374]], "IP addresses intended for scanning and the special \u201cping\u201d IP address": [["Dynamic Resolution", 0.1270936883877958], ["Active Scanning", 0.10598943775947917], ["System Network Configuration Discovery", 0.10585013891700873], ["Network Service Discovery", 0.062422870504444124], ["Remote System Discovery", 0.05164965816861176], ["Adversary-in-the-Middle", 0.04058517645301804]], "scanning IPs specified in the command data to collect additional information about the environment": [["System Network Configuration Discovery", 0.5074463315213528], ["Remote System Discovery", 0.09823744632036002], ["System Network Connections Discovery", 0.05904499145584903], ["Gather Victim Network Information", 0.03437376286299948], ["Active Scanning", 0.029575050872535105], ["Network Service Discovery", 0.02551706574882641]], "scan of the selected IP addresses": [["System Network Configuration Discovery", 0.1968110104483953], ["Remote System Discovery", 0.1497975209290827], ["Active Scanning", 0.13769233741548703], ["Network Service Discovery", 0.10995740720073655], ["Gather Victim Network Information", 0.04380692104294668], ["System Network Connections Discovery", 0.039205026396949734]], "downloaded from the C&C along with the ModScan module": [["Automated Collection", 0.13708012025916824], ["File and Directory Discovery", 0.09543117666935903], ["Data from Local System", 0.08514692540251886], ["Ingress Tool Transfer", 0.05432324273628094], ["System Information Discovery", 0.02901662706951548], ["Data from Removable Media", 0.023228027720214553]], "parsing payload received in the C&C responses": [["Deobfuscate/Decode Files or Information", 0.24001722524316282], ["Data Encoding", 0.13112048424809766], ["Obfuscated Files or Information", 0.06275064977427129], ["Data Obfuscation", 0.046301454399932655], ["Application Layer Protocol", 0.042733090346398966], ["Network Sniffing", 0.025290508784942295]], "download additional payloads and C&C commands": [["Ingress Tool Transfer", 0.7017561873911724], ["Command and Scripting Interpreter", 0.09123276690892995], ["BITS Jobs", 0.036496394283919584], ["Application Layer Protocol", 0.011140951086687391], ["Multi-Stage Channels", 0.01107856473844172], ["Web Service", 0.010571726141815835]], "TCP ports 50123": [["Non-Standard Port", 0.4493150533311356], ["Network Service Discovery", 0.11503755148088454], ["Traffic Signaling", 0.06848597679549538], ["Non-Application Layer Protocol", 0.04694893159241152], ["Dynamic Resolution", 0.03064224537345537], ["System Network Connections Discovery", 0.027787103568702586]], "and 2638": [["Obfuscated Files or Information", 0.05063331798057918], ["Encrypted Channel", 0.03706050102036715], ["Dynamic Resolution", 0.03677064271079291], ["Fallback Channels", 0.028892350411903918], ["Acquire Infrastructure", 0.027218768648963495], ["Web Service", 0.02396001232914568]], "by sending a specially crafted TCP packet": [["Non-Application Layer Protocol", 0.36303084244735795], ["Application Layer Protocol", 0.13197109189089168], ["Non-Standard Port", 0.09276241391043084], ["Proxy", 0.03874836266355802], ["Protocol Tunneling", 0.03817099552578593], ["Data Obfuscation", 0.033842821793661826]], "sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638": [["Non-Standard Port", 0.13112904622212945], ["Traffic Signaling", 0.10708370645168129], ["Non-Application Layer Protocol", 0.0800315858353076], ["Network Sniffing", 0.07995163848847368], ["Adversary-in-the-Middle", 0.06085417664991436], ["Dynamic Resolution", 0.05172905883974274]], "transmitted using the lightweight networking module,": [["Non-Application Layer Protocol", 0.16128611168811932], ["Application Layer Protocol", 0.11058852694297262], ["Adversary-in-the-Middle", 0.07547918856461626], ["Encrypted Channel", 0.0506747726735339], ["Proxy", 0.04332912619610987], ["Protocol Tunneling", 0.03548497868577346]], "Version of the Oracle": [["Data from Information Repositories", 0.041901009530568155], ["Obtain Capabilities", 0.03994435200240015], ["Command and Scripting Interpreter", 0.028251629610423584], ["Software Discovery", 0.025615014517530007], ["Develop Capabilities", 0.020841637364050418], ["Exploit Public-Facing Application", 0.020719039288694917]], "information about the database server and the TDS versions used": [["System Information Discovery", 0.10704963460784578], ["Gather Victim Host Information", 0.04844121411102086], ["Query Registry", 0.041749165251550494], ["System Network Connections Discovery", 0.037595748249995196], ["Software Discovery", 0.03599582457520604], ["File and Directory Discovery", 0.029083745089044002]], "sending an HTTP Post message": [["Application Layer Protocol", 0.47746310922699897], ["Exfiltration Over C2 Channel", 0.044333474824189326], ["Data Encoding", 0.03642155146118401], ["Web Service", 0.03478318364247111], ["Exfiltration Over Alternative Protocol", 0.032120256537627595], ["Data Obfuscation", 0.026292624083738003]], "module uses HTTP and port 80.": [["Application Layer Protocol", 0.31417916442156957], ["Non-Standard Port", 0.14149180876582398], ["Non-Application Layer Protocol", 0.04201232895318225], ["Dynamic Resolution", 0.027545668990498692], ["Data Obfuscation", 0.027159265714424532], ["Proxy", 0.025696993935946787]], "avoid system processes that might attract attention if caught communicating over the network": [["Impair Defenses", 0.15362327790247038], ["Process Injection", 0.06723377000585072], ["Process Discovery", 0.042798169135365126], ["Proxy", 0.03482434423358549], ["Non-Application Layer Protocol", 0.033692184678330475], ["Exploitation of Remote Services", 0.031615510847069594]], "HTTP POST or GET methods": [["Application Layer Protocol", 0.4502872069562952], ["Exfiltration Over C2 Channel", 0.04742866305284348], ["Data Encoding", 0.026354956917276295], ["Exfiltration Over Alternative Protocol", 0.023378872196052492], ["Web Service", 0.023057848346904587], ["Use Alternate Authentication Material", 0.0223067461453454]], "uses HTTP for command and control": [["Application Layer Protocol", 0.742612813520345], ["Non-Standard Port", 0.0228612116658522], ["Data Obfuscation", 0.015582390463626911], ["Fallback Channels", 0.01260516173385186], ["Web Service", 0.012378913500172915], ["Proxy", 0.011423030343112234]], "stored between data xml tags (<data>%version%</data>) of the response from the service": [["System Information Discovery", 0.046870302116538816], ["System Service Discovery", 0.03776177255980535], ["Automated Collection", 0.03696638882950274], ["Create or Modify System Process", 0.03458174228047054], ["Deobfuscate/Decode Files or Information", 0.034469388099794704], ["Masquerading", 0.032823176534539124]], "encrypted payload, containing the main functionality of the dropper, is stored in the dropper\u2019s resources as bitmaps named from A to L.": [["Obfuscated Files or Information", 0.26729875708164974], ["Deobfuscate/Decode Files or Information", 0.20312849124595297], ["Archive Collected Data", 0.05896159066098936], ["Hide Artifacts", 0.035291938706297064], ["Execution Guardrails", 0.01851368810038466], ["Exfiltration Over Alternative Protocol", 0.016649689270764448]], "being the payloads stored in the resources": [["Cloud Infrastructure Discovery", 0.06609302149633028], ["Deobfuscate/Decode Files or Information", 0.04347398070277724], ["Obfuscated Files or Information", 0.03640169035353614], ["Ingress Tool Transfer", 0.032628262554893955], ["Execution Guardrails", 0.025340671745628263], ["Template Injection", 0.02115467142681388]], "encrypted within the main module\u2019s code.": [["Obfuscated Files or Information", 0.34138015176384123], ["Deobfuscate/Decode Files or Information", 0.11430859637036797], ["Data Encrypted for Impact", 0.1076691941203737], ["Encrypted Channel", 0.09861106203524159], ["Archive Collected Data", 0.05321988341833041], ["Weaken Encryption", 0.0426410474430608]], "with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.": [["Brute Force", 0.1872767763768414], ["Modify Authentication Process", 0.11638465959572898], ["Valid Accounts", 0.08245378088817806], ["OS Credential Dumping", 0.07221611220248071], ["Credentials from Password Stores", 0.047891403630591904], ["Use Alternate Authentication Material", 0.0318515813121488]], "hash of the dropped loader to change with each execution,": [["Obfuscated Files or Information", 0.09167338948160364], ["Hijack Execution Flow", 0.05314384863064665], ["System Binary Proxy Execution", 0.052891550113264844], ["Deobfuscate/Decode Files or Information", 0.03574118591733183], ["Rootkit", 0.03013730759425911], ["Boot or Logon Autostart Execution", 0.02984896514706903]], "creating a Windows service": [["Create or Modify System Process", 0.3679759343137403], ["System Services", 0.34177337626576565], ["System Service Discovery", 0.047238465746609476], ["Masquerading", 0.042727948733418106], ["Scheduled Task/Job", 0.019029677467532494], ["Hijack Execution Flow", 0.016953302987366043]], "create a new service for persistence.": [["Create or Modify System Process", 0.5650111727638143], ["Boot or Logon Autostart Execution", 0.05390358069798709], ["Scheduled Task/Job", 0.046882192730036854], ["Event Triggered Execution", 0.044954249277951455], ["Boot or Logon Initialization Scripts", 0.03721036841400972], ["System Services", 0.02515188405802665]], "Decompiled code responsible for loading the payload from the binary\u2019s resources,": [["Deobfuscate/Decode Files or Information", 0.49439315324594907], ["Obfuscated Files or Information", 0.16327978279746735], ["Hijack Execution Flow", 0.04770143921197263], ["Process Injection", 0.02505468568783013], ["Shared Modules", 0.021736792519589286], ["System Binary Proxy Execution", 0.016867426239235567]], "Communication with the C&C is encrypted using AES in CBC mode": [["Encrypted Channel", 0.46319332411246], ["Deobfuscate/Decode Files or Information", 0.06043607661293937], ["Non-Application Layer Protocol", 0.05580760155004124], ["Obfuscated Files or Information", 0.051674826436172966], ["Data Encoding", 0.044646920535034704], ["Weaken Encryption", 0.04164670164051964]], "XORed with the first 4 bytes of the AES key used to encrypt the message.": [["Deobfuscate/Decode Files or Information", 0.24233329778839344], ["Encrypted Channel", 0.2112992874165009], ["Obfuscated Files or Information", 0.1961168476117242], ["Archive Collected Data", 0.04506108676005494], ["Data Encrypted for Impact", 0.03473133202437855], ["Weaken Encryption", 0.0315382813107375]], "encrypts communication with C&C using AES in CBC mode": [["Encrypted Channel", 0.5263511876531062], ["Obfuscated Files or Information", 0.07533891032882167], ["Deobfuscate/Decode Files or Information", 0.05294304318893334], ["Weaken Encryption", 0.034769902485091306], ["Non-Application Layer Protocol", 0.02827624618631186], ["Data Encoding", 0.027814715087596434]], "using Windows Command Shell to execute the initial dropper.": [["Indicator Removal", 0.11021764311463839], ["System Binary Proxy Execution", 0.06599243532934956], ["Command and Scripting Interpreter", 0.05848942149745399], ["Native API", 0.04850989164981452], ["Masquerading", 0.045789093923074176], ["Deobfuscate/Decode Files or Information", 0.032931503224654934]], "use Registry Run key for persistence": [["Boot or Logon Autostart Execution", 0.6076638752226905], ["Modify Registry", 0.08197127321046895], ["Boot or Logon Initialization Scripts", 0.07033362641674527], ["Event Triggered Execution", 0.045423495248681604], ["Create or Modify System Process", 0.037055098334633045], ["Office Application Startup", 0.021728435140934723]], "inject it\u2019s modules into various processes.": [["Process Injection", 0.6722340916423403], ["Hijack Execution Flow", 0.04709080582162977], ["Native API", 0.035217970583715674], ["Create or Modify System Process", 0.031653343690964335], ["Shared Modules", 0.024653742273138105], ["System Services", 0.018337739462402913]], "gathers username and computer name from victim machines and reports them to the C&C in initial message.": [["System Owner/User Discovery", 0.48623494040405674], ["System Information Discovery", 0.10704297382509662], ["Account Discovery", 0.05402551152050213], ["Automated Collection", 0.038998437979081965], ["Remote System Discovery", 0.032320641018515166], ["System Network Configuration Discovery", 0.013933545363787003]], "The attack revolves around a DLL sideloading": [["Hijack Execution Flow", 0.23948657976791105], ["Process Injection", 0.06642993953391374], ["Shared Modules", 0.04916070628625285], ["System Binary Proxy Execution", 0.02730387108522874], ["Obfuscated Files or Information", 0.025371176655432905], ["Exploitation for Client Execution", 0.023732920851111047]], "DLL sideloading scenario, the malicious loader (ffmpeg.dll) would replace the clean dependency;": [["Hijack Execution Flow", 0.3840356622877508], ["Shared Modules", 0.061249538318485], ["Process Injection", 0.049298437785956564], ["System Binary Proxy Execution", 0.040647445212569404], ["Masquerading", 0.02983283519230761], ["Compromise Client Software Binary", 0.024762182372750064]], "DLL sideloading": [["Hijack Execution Flow", 0.41633154586306365], ["Shared Modules", 0.14683024984180154], ["System Binary Proxy Execution", 0.07832623116415681], ["Process Injection", 0.049612788019348625], ["Event Triggered Execution", 0.018290570527394075], ["Ingress Tool Transfer", 0.017399734109929923]], "encoded malware": [["Obfuscated Files or Information", 0.4336252912925443], ["Data Encoding", 0.2403280777653014], ["Deobfuscate/Decode Files or Information", 0.12186491625488975], ["Data Obfuscation", 0.029525184246341752], ["Encrypted Channel", 0.016715637047490087], ["Masquerading", 0.01167952109036079]], "malicious encoded .ico payload": [["Obfuscated Files or Information", 0.28287864368291094], ["Data Encoding", 0.21119711787831486], ["Deobfuscate/Decode Files or Information", 0.0804460025231757], ["Data Obfuscation", 0.06855121401681516], ["Encrypted Channel", 0.027320057914264017], ["Masquerading", 0.022228625437052618]], "generate the HTTP request": [["Application Layer Protocol", 0.43149324568607456], ["Data Obfuscation", 0.03404106437315632], ["Data Encoding", 0.034025665712153146], ["Non-Standard Port", 0.028789509413070444], ["Endpoint Denial of Service", 0.020002752662660564], ["Exfiltration Over C2 Channel", 0.01897320001304498]], "these appear to be maliciously patched versions of the legitimate ffmpeg.dll": [["Masquerading", 0.09587988956329235], ["Obfuscated Files or Information", 0.09319223240288377], ["Video Capture", 0.0463103748120022], ["Deobfuscate/Decode Files or Information", 0.04337549743265302], ["System Binary Proxy Execution", 0.04300129228324366], ["Hijack Execution Flow", 0.029106026108902866]], "GetSystemTimeAsFileTime Api call": [["System Time Discovery", 0.7354351197995351], ["Indicator Removal", 0.053175936801755475], ["Virtualization/Sandbox Evasion", 0.0357755783052933], ["System Information Discovery", 0.013533047421739785], ["File and Directory Discovery", 0.00719225733677734], ["OS Credential Dumping", 0.006474756420802466]], "which initiates the payload download": [["Ingress Tool Transfer", 0.58146964947213], ["BITS Jobs", 0.07170686033173017], ["Command and Scripting Interpreter", 0.04988811430433933], ["Application Layer Protocol", 0.02457864837043566], ["Deobfuscate/Decode Files or Information", 0.011639355032990684], ["Inter-Process Communication", 0.010953562540929489]], "malware tries to login and get access to the victim server via brute force.": [["Brute Force", 0.4848290419736057], ["Use Alternate Authentication Material", 0.03685614576949222], ["Steal or Forge Kerberos Tickets", 0.03542320316015746], ["Modify Authentication Process", 0.03219760475359712], ["Endpoint Denial of Service", 0.016253242275743242], ["Valid Accounts", 0.015733902109203626]], "tries to get access to the server via brute force": [["Brute Force", 0.51696425855222], ["Use Alternate Authentication Material", 0.04530098203449318], ["Steal or Forge Kerberos Tickets", 0.03306792184118501], ["Modify Authentication Process", 0.023724815830094385], ["Endpoint Denial of Service", 0.018395095166749795], ["Valid Accounts", 0.015019340801756941]], "malware samples are packed with UPX Packer.": [["Obfuscated Files or Information", 0.43177037061004875], ["System Binary Proxy Execution", 0.032286658210524115], ["Masquerading", 0.02870758224605314], ["Ingress Tool Transfer", 0.026852621484122607], ["Subvert Trust Controls", 0.024477541427303802], ["Hijack Execution Flow", 0.024425491612776105]], "Upon unpacking a sample": [["Deobfuscate/Decode Files or Information", 0.27598363435151235], ["Obfuscated Files or Information", 0.20825174155769544], ["Archive Collected Data", 0.058621384755699356], ["Masquerading", 0.022850019622985735], ["Command and Scripting Interpreter", 0.019550258173572633], ["Ingress Tool Transfer", 0.01457974701148086]], "the malware uses a set of credentials that is hard coded into the malware binary,": [["Credentials from Password Stores", 0.1439754480519786], ["Unsecured Credentials", 0.13706569421578307], ["Modify Authentication Process", 0.07656093189013875], ["OS Credential Dumping", 0.06945657475093138], ["Valid Accounts", 0.04729622860735058], ["Forced Authentication", 0.03981496713889556]], "Hard-coded credentials for brute forcing.": [["Brute Force", 0.4377293586159727], ["Modify Authentication Process", 0.0688961484509417], ["Credentials from Password Stores", 0.052384878919708625], ["Multi-Factor Authentication Interception", 0.051204307578670276], ["OS Credential Dumping", 0.03954830656172899], ["Unsecured Credentials", 0.03567074311853468]], "from the decrypted configuration": [["Deobfuscate/Decode Files or Information", 0.524535113711266], ["Data Encrypted for Impact", 0.09823370995241346], ["Archive Collected Data", 0.05074276918245654], ["Obfuscated Files or Information", 0.038916044910875795], ["Weaken Encryption", 0.03722047872634085], ["Encrypted Channel", 0.019650173123288532]], "The malware then de-XORs other strings, with the hard-coded key": [["Deobfuscate/Decode Files or Information", 0.30262498002077604], ["Obfuscated Files or Information", 0.11383970369805843], ["Modify Registry", 0.05246951682479769], ["Indicator Removal", 0.03721974224105929], ["Masquerading", 0.03006640788997849], ["Encrypted Channel", 0.023627377761636457]], "Most of the strings are de-XOR\u2019d in a function": [["Obfuscated Files or Information", 0.28536422557507585], ["Deobfuscate/Decode Files or Information", 0.1792476443401363], ["Native API", 0.0346599990003499], ["Indicator Removal", 0.02042438201509205], ["Masquerading", 0.020035512053563572], ["Data Manipulation", 0.019719036671725983]], "simply de-XOR the entire binary": [["Deobfuscate/Decode Files or Information", 0.24848628203115292], ["Indicator Removal", 0.054679277233370585], ["Obfuscated Files or Information", 0.04844076577481441], ["Rootkit", 0.036280256300297124], ["Hide Artifacts", 0.03194750019839274], ["Process Injection", 0.026856910999136355]], "Also the de-XOR\u2019d strings,": [["Deobfuscate/Decode Files or Information", 0.28122630804349696], ["Obfuscated Files or Information", 0.18118911161498555], ["Indicator Removal", 0.042795811107568325], ["Native API", 0.03072116330123588], ["Masquerading", 0.021390956879055678], ["Modify Registry", 0.01988903154145709]], "Once the malware has de-XOR\u2019d all its strings, it invokes a method named go.": [["Deobfuscate/Decode Files or Information", 0.14397856540523504], ["Native API", 0.11504461691894682], ["Obfuscated Files or Information", 0.0951888906444373], ["Command and Scripting Interpreter", 0.06528977006675189], ["Indicator Removal", 0.031340777660481066], ["Masquerading", 0.030517160394069175]], "we find an XOR loop that decrypts this configuration.": [["Deobfuscate/Decode Files or Information", 0.7231526043165344], ["Obfuscated Files or Information", 0.06498635948230283], ["Encrypted Channel", 0.022850777918206694], ["Data Encrypted for Impact", 0.022186995308703522], ["Weaken Encryption", 0.02007452545616226], ["Archive Collected Data", 0.013351909912433436]], "as a hard-coded XOR key": [["Deobfuscate/Decode Files or Information", 0.11635693482219649], ["Encrypted Channel", 0.10498742810614348], ["Boot or Logon Autostart Execution", 0.08566643689126119], ["Event Triggered Execution", 0.034534170274886554], ["Input Capture", 0.03299580926880404], ["Abuse Elevation Control Mechanism", 0.023626656435638247]], "we find an XOR loop": [["Command and Scripting Interpreter", 0.080083912286919], ["Deobfuscate/Decode Files or Information", 0.07709186403797805], ["Virtualization/Sandbox Evasion", 0.06426885746476699], ["Encrypted Channel", 0.04616031966707914], ["Native API", 0.022950703906038525], ["Traffic Signaling", 0.021626957583875055]], "This produces strings including a commandline usage:": [["Native API", 0.09944241172249763], ["System Information Discovery", 0.07769971396968303], ["Obfuscated Files or Information", 0.077233220412319], ["Command and Scripting Interpreter", 0.07228027097396476], ["File and Directory Discovery", 0.057569566608298366], ["Query Registry", 0.04296344596436339]], "can be set via the command-line as well.": [["Modify Registry", 0.19604763432091163], ["Boot or Logon Autostart Execution", 0.04874711412932785], ["Office Application Startup", 0.04509097867842381], ["Impair Defenses", 0.04163614213963411], ["Create or Modify System Process", 0.034298080312688904], ["Query Registry", 0.027032943684006563]], "This parses command-line options": [["Command and Scripting Interpreter", 0.22156702078604767], ["Query Registry", 0.13761001691775257], ["Native API", 0.05694173567120549], ["Indirect Command Execution", 0.03171708873108361], ["Obfuscated Files or Information", 0.026692878571240107], ["Deobfuscate/Decode Files or Information", 0.02288424208536572]], "the data will be published on our TOR darknet sites.": [["Search Open Technical Databases", 0.0883536839289735], ["Gather Victim Network Information", 0.059456476999020236], ["Data from Information Repositories", 0.05606338245100322], ["Search Closed Sources", 0.046979840198402574], ["Exfiltration Over C2 Channel", 0.04578180688961673], ["Automated Collection", 0.04029978836476759]], "--remove       self remove this file after work": [["Indicator Removal", 0.7929614689758062], ["Data Destruction", 0.03261971643312048], ["Inhibit System Recovery", 0.015004756969603236], ["Masquerading", 0.009339729161459358], ["Hide Artifacts", 0.007975042100969755], ["Modify Registry", 0.007913893608786419]], "this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached,": [["Virtualization/Sandbox Evasion", 0.23453136353923226], ["Impair Defenses", 0.19431960459108233], ["Native API", 0.07043573863838902], ["Process Discovery", 0.06895732694400034], ["Process Injection", 0.04916201025483694], ["Rootkit", 0.02271120369759106]], "the embedded .NET injector and PE payload(s).": [["Process Injection", 0.3051971543617199], ["Obfuscated Files or Information", 0.07368980133603058], ["Native API", 0.041243092502311125], ["Shared Modules", 0.03537837570389697], ["Hijack Execution Flow", 0.030993283728568372], ["System Binary Proxy Execution", 0.028246703277359154]], "embedded payloads of one of the IronPython scripts.": [["Command and Scripting Interpreter", 0.26672291902808265], ["Obfuscated Files or Information", 0.056298947627389906], ["Ingress Tool Transfer", 0.025733710174479965], ["Inter-Process Communication", 0.024902754677178417], ["Deobfuscate/Decode Files or Information", 0.020893219863481388], ["System Binary Proxy Execution", 0.0203016291273062]], "the main task of loading malware is done by an embedded process injector.": [["Process Injection", 0.5338363862131431], ["Hijack Execution Flow", 0.0727276411881808], ["System Binary Proxy Execution", 0.06407603625093827], ["Native API", 0.04512685829756115], ["Shared Modules", 0.031338496818522715], ["Command and Scripting Interpreter", 0.01887695753146306]], "IronNetInjector is made of an IronPython script that contains a .NET injector and one or more payloads.": [["Process Injection", 0.19660627261537458], ["Command and Scripting Interpreter", 0.07159099836911008], ["Inter-Process Communication", 0.04867653748023846], ["Native API", 0.0317109223253148], ["Ingress Tool Transfer", 0.026663861686866467], ["Event Triggered Execution", 0.022351985299712638]], "Contain an encrypted .NET injector and one or more encrypted PE payloads.": [["Obfuscated Files or Information", 0.45730316853651487], ["Encrypted Channel", 0.07646574288923086], ["Deobfuscate/Decode Files or Information", 0.06547296934246369], ["Execution Guardrails", 0.03912706782251912], ["Data Encrypted for Impact", 0.03651729983650594], ["Process Injection", 0.03106914358697159]], "Embedded .NET injector and payload(s) are encoded with Base64 and encrypted with Rijndael.": [["Obfuscated Files or Information", 0.5185632276758915], ["Deobfuscate/Decode Files or Information", 0.22972185807673848], ["Data Encoding", 0.09241368318784544], ["Encrypted Channel", 0.018848325596708754], ["Archive Collected Data", 0.012466077081828723], ["Data Obfuscation", 0.010597557728678523]], "script with embedded .NET injector and ComRAT payload": [["Process Injection", 0.27605693314922164], ["System Binary Proxy Execution", 0.11499682796941696], ["Command and Scripting Interpreter", 0.08920080270846671], ["Native API", 0.0635010977004325], ["Shared Modules", 0.05371454938179903], ["Obfuscated Files or Information", 0.04265950241099814]], "the embedded payloads in the IronPython scripts,": [["Command and Scripting Interpreter", 0.2052074159271952], ["Obfuscated Files or Information", 0.054287041672649125], ["Ingress Tool Transfer", 0.04134991485483051], ["Native API", 0.036608434518552016], ["Deobfuscate/Decode Files or Information", 0.03195695441478236], ["System Binary Proxy Execution", 0.02753272859159882]], "embedded malware:": [["Obfuscated Files or Information", 0.08222701803032724], ["User Execution", 0.049704271629779535], ["Process Injection", 0.049400935136718414], ["Exploitation for Client Execution", 0.043312898975501], ["System Binary Proxy Execution", 0.04294376261105652], ["Develop Capabilities", 0.04252774098752188]], "the embedded files in the scripts": [["Command and Scripting Interpreter", 0.13137024893738966], ["Ingress Tool Transfer", 0.0927777177926156], ["System Binary Proxy Execution", 0.08610513044921972], ["XSL Script Processing", 0.06513242107644598], ["Native API", 0.03541936594006988], ["Obfuscated Files or Information", 0.03225607832267918]], "These scripts contain an embedded PE loader to execute an embedded malware payload.": [["Command and Scripting Interpreter", 0.3566233672380299], ["System Binary Proxy Execution", 0.22177029621796793], ["Event Triggered Execution", 0.02883166249449548], ["Boot or Logon Autostart Execution", 0.023201103073816315], ["Native API", 0.02201291553803168], ["Inter-Process Communication", 0.018920075750030567]], "the embedded .NET injector": [["Process Injection", 0.49063068774198326], ["Native API", 0.05412667978787673], ["Shared Modules", 0.051790662047672686], ["Hijack Execution Flow", 0.042098771583414046], ["System Binary Proxy Execution", 0.03776086285011734], ["Event Triggered Execution", 0.025328043829471403]], "which in turn injects the payload(s) into its own or a remote process.": [["Process Injection", 0.8055857675223055], ["Native API", 0.0268754139170229], ["Hijack Execution Flow", 0.022656087781276216], ["System Binary Proxy Execution", 0.010227061577278108], ["System Services", 0.008819199171659074], ["Event Triggered Execution", 0.007471749449862507]], "contains the ability to inject .NET assemblies into unmanaged processes.": [["Process Injection", 0.6647950528776468], ["System Binary Proxy Execution", 0.05423119594040197], ["Hijack Execution Flow", 0.04534131269081312], ["Native API", 0.0448346263505488], ["Event Triggered Execution", 0.024081342407007954], ["Shared Modules", 0.01564816592360047]], "the payload is either loaded into its own process or a remote one.": [["Process Injection", 0.2541932417437524], ["Hijack Execution Flow", 0.11138351792497848], ["Native API", 0.06859701584148982], ["Deobfuscate/Decode Files or Information", 0.04861807623615426], ["System Binary Proxy Execution", 0.0444331736403866], ["Ingress Tool Transfer", 0.03539200568252846]], "remote process the payload gets injected to.": [["Process Injection", 0.6281510332357986], ["Native API", 0.04451655933444203], ["Hijack Execution Flow", 0.023165861795786283], ["System Binary Proxy Execution", 0.017808167855083764], ["System Services", 0.016055069131987745], ["Inter-Process Communication", 0.013672873044742302]], "the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process.": [["Process Injection", 0.39810425643157565], ["Native API", 0.16052821702254982], ["Hijack Execution Flow", 0.07468824159591456], ["System Binary Proxy Execution", 0.05377171966978324], ["Event Triggered Execution", 0.03770841013384033], ["Masquerading", 0.031623528495723294]], "the injector is its ability to load an assembly into an unmanaged process.": [["Process Injection", 0.8161097009661911], ["Native API", 0.020878678533092228], ["Hijack Execution Flow", 0.02078408706983823], ["Shared Modules", 0.014526455425660617], ["System Binary Proxy Execution", 0.013144092494824287], ["Event Triggered Execution", 0.009440362851680038]], "to load an assembly into an unmanaged process.": [["Process Injection", 0.45559829331149265], ["System Binary Proxy Execution", 0.11227851420019566], ["Native API", 0.06178226177760718], ["Hijack Execution Flow", 0.053777091335849396], ["Event Triggered Execution", 0.03771886634234647], ["System Services", 0.02311938030107554]], "The method InjectAssembly is used to inject a .NET assembly into a native process": [["Process Injection", 0.6704686190815528], ["System Binary Proxy Execution", 0.05039311531094561], ["Native API", 0.04548131887066534], ["Hijack Execution Flow", 0.029916814381438422], ["Event Triggered Execution", 0.02603447298428675], ["Shared Modules", 0.019871716166384702]], "Function and variable names are obfuscated": [["Obfuscated Files or Information", 0.752682842639649], ["Deobfuscate/Decode Files or Information", 0.07346702319298612], ["Masquerading", 0.01604688707570085], ["Data Encoding", 0.009311322390090257], ["Data Obfuscation", 0.008379286262633684], ["Encrypted Channel", 0.007819230262076425]], "Strings are encrypted": [["Obfuscated Files or Information", 0.36140279384982815], ["Deobfuscate/Decode Files or Information", 0.18676420206415342], ["Encrypted Channel", 0.09740133593691128], ["Data Encoding", 0.08876261383040594], ["Archive Collected Data", 0.03763599030646257], ["Data Encrypted for Impact", 0.028635096314697146]], "scripts are obfuscated to prevent easy detection.": [["Obfuscated Files or Information", 0.6675374409850144], ["Deobfuscate/Decode Files or Information", 0.07044643554000635], ["Masquerading", 0.021509800292018457], ["Command and Scripting Interpreter", 0.01582947887291793], ["System Binary Proxy Execution", 0.014675956167195858], ["Execution Guardrails", 0.014545230474719971]], "Decoded IronPython script": [["Deobfuscate/Decode Files or Information", 0.5382473115415382], ["Obfuscated Files or Information", 0.16408302809137487], ["Command and Scripting Interpreter", 0.04385647730641615], ["Data Encoding", 0.01446800682642029], ["Archive Collected Data", 0.014181442053387663], ["Native API", 0.010504396671349538]], "the Rijndael decryption key is passed.": [["Deobfuscate/Decode Files or Information", 0.6553284646597934], ["Encrypted Channel", 0.0500657247569105], ["Data Encrypted for Impact", 0.045342844752910866], ["Obfuscated Files or Information", 0.04085461036407023], ["Weaken Encryption", 0.029523421887537142], ["Archive Collected Data", 0.02229629252674]], "get decoded and decrypted": [["Deobfuscate/Decode Files or Information", 0.7661037015673314], ["Obfuscated Files or Information", 0.06511308061705956], ["Archive Collected Data", 0.03198456125512323], ["Data Encoding", 0.02394377734870727], ["Encrypted Channel", 0.017822449623452773], ["Data Encrypted for Impact", 0.014602498687753254]], "The decryption key is passed as an argument": [["Deobfuscate/Decode Files or Information", 0.6177146131158681], ["Data Encrypted for Impact", 0.05710663900223591], ["Encrypted Channel", 0.05118677716215598], ["Weaken Encryption", 0.0383783485360042], ["Obfuscated Files or Information", 0.035059111709623274], ["Archive Collected Data", 0.025109884492908838]], "full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.": [["Process Injection", 0.5941366029560813], ["Hijack Execution Flow", 0.05181382477496184], ["System Binary Proxy Execution", 0.04089417507885231], ["Native API", 0.03543256570196874], ["Shared Modules", 0.026151054310566118], ["Event Triggered Execution", 0.01762292430244513]], "PowerShell Empire\u2019s ReflectivePEInjection script": [["Command and Scripting Interpreter", 0.1883227224433551], ["Process Injection", 0.16663032897794436], ["Native API", 0.03309578414788299], ["Shared Modules", 0.021880348408311726], ["Modify Registry", 0.021380258466895594], ["System Binary Proxy Execution", 0.01992509268326783]], "The method Invoke is used to inject a native PE into a remote process and InvokeVoid to call any exported function of the injected payload.": [["Process Injection", 0.43870932928040235], ["Native API", 0.17137385151140844], ["System Services", 0.040095469375965476], ["System Binary Proxy Execution", 0.029854850526109703], ["Shared Modules", 0.028726389019839548], ["Event Triggered Execution", 0.024958814118614465]], "As a command line argument": [["Command and Scripting Interpreter", 0.33294209271441344], ["Indirect Command Execution", 0.1273382506270393], ["Native API", 0.07757671657665689], ["System Binary Proxy Execution", 0.036687208250037066], ["System Services", 0.02818474632043378], ["Masquerading", 0.018478842930810015]], "Windows task XML file": [["Scheduled Task/Job", 0.30273650741949953], ["Masquerading", 0.09800529483275915], ["Inter-Process Communication", 0.04065071323149385], ["Process Discovery", 0.03967551529672338], ["System Service Discovery", 0.03300968786877592], ["Indicator Removal", 0.030914524626742736]], "The task is used to start an IronPython script": [["Scheduled Task/Job", 0.3694978302143734], ["Command and Scripting Interpreter", 0.14454517959901084], ["System Services", 0.043193464372229796], ["Inter-Process Communication", 0.041139180529846935], ["Create or Modify System Process", 0.025103877399793608], ["Native API", 0.018811904988668318]], "The task\u2019s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created:": [["Scheduled Task/Job", 0.2439873746929224], ["Create or Modify System Process", 0.11181033167547685], ["Event Triggered Execution", 0.07908535181932677], ["Boot or Logon Autostart Execution", 0.07517367810244674], ["Boot or Logon Initialization Scripts", 0.03989715174274141], ["Masquerading", 0.03980951495613617]], "the Windows task XML": [["Scheduled Task/Job", 0.1679241294345139], ["Process Discovery", 0.11546078573664673], ["Masquerading", 0.07541432582326164], ["System Service Discovery", 0.06665325975110209], ["Windows Management Instrumentation", 0.04659638933497867], ["Inter-Process Communication", 0.027712251960231696]], "The task file is then used to create a task which in turn starts a script when triggered.": [["Scheduled Task/Job", 0.5149416493790149], ["Command and Scripting Interpreter", 0.05329817537816238], ["Inter-Process Communication", 0.048092678995939005], ["Masquerading", 0.031930176891195414], ["System Services", 0.025965919572037758], ["Create or Modify System Process", 0.02450550502658004]], "a Windows task XML to start": [["Scheduled Task/Job", 0.35547210311665467], ["Masquerading", 0.07785393604549742], ["Inter-Process Communication", 0.04688147713439941], ["Command and Scripting Interpreter", 0.03535638809721131], ["Create or Modify System Process", 0.034864709109388055], ["System Service Discovery", 0.03303639768128848]], "the submitter collected the files from different places": [["Data from Local System", 0.236465377147264], ["Automated Collection", 0.12428104827667849], ["Data Staged", 0.12255254067285413], ["Ingress Tool Transfer", 0.0784949528688502], ["File and Directory Discovery", 0.06746785503036458], ["Automated Exfiltration", 0.046154471374499115]], "This is accomplished with a native bootstrapper DLL, which gets injected into the remote process and prepares it so a .NET assembly can be injected afterwards.": [["Process Injection", 0.32586689161413457], ["System Binary Proxy Execution", 0.09047928024423167], ["Hijack Execution Flow", 0.07399395017971137], ["Event Triggered Execution", 0.06017233487717471], ["Shared Modules", 0.05889328439760124], ["Native API", 0.04406372581565212]], "DLL gets injected": [["Process Injection", 0.2742859129319487], ["Hijack Execution Flow", 0.2006374395604008], ["Shared Modules", 0.17076196035498345], ["System Binary Proxy Execution", 0.063851729035224], ["Event Triggered Execution", 0.027777811629524193], ["Native API", 0.027309588224178644]], "The output is then parsed to the targeted process ID with the help of tasklist filters.": [["Process Discovery", 0.8389169572689525], ["System Service Discovery", 0.011494147678217149], ["Process Injection", 0.010707309681221557], ["Native API", 0.010555891829406878], ["Impair Defenses", 0.009522412567222669], ["System Information Discovery", 0.008397166356038273]], "Contains the imported unmanaged function declarations and win32 structures/constants.": [["Native API", 0.1579526564167104], ["Hijack Execution Flow", 0.06384786023496429], ["Obfuscated Files or Information", 0.04560730518484562], ["Shared Modules", 0.045380992793632786], ["Query Registry", 0.043825107933340414], ["Software Discovery", 0.04156201560375465]], "being able to use the .NET framework APIs directly from Python.": [["Native API", 0.21769292178149408], ["Command and Scripting Interpreter", 0.06000312113018596], ["Inter-Process Communication", 0.033890568763462796], ["Web Service", 0.025453339181215392], ["Application Layer Protocol", 0.02411465038637714], ["Develop Capabilities", 0.02273441817377712]], "can use .NET framework APIs": [["Native API", 0.27733744155931295], ["System Binary Proxy Execution", 0.04267967715409328], ["Inter-Process Communication", 0.04020292687555574], ["Command and Scripting Interpreter", 0.04004669892954052], ["Deobfuscate/Decode Files or Information", 0.03073878087942505], ["Windows Management Instrumentation", 0.01942028692521533]], "use of the .NET framework APIs": [["Native API", 0.3243239935924776], ["System Binary Proxy Execution", 0.03929752551239761], ["Deobfuscate/Decode Files or Information", 0.035424190505669625], ["Inter-Process Communication", 0.02919947846086793], ["Command and Scripting Interpreter", 0.02766397076258456], ["Hijack Execution Flow", 0.020345518002270684]], "when .NET framework APIs are used in the code": [["Native API", 0.23752781608176887], ["Hijack Execution Flow", 0.04006325416990872], ["Obfuscated Files or Information", 0.030176489212291147], ["Event Triggered Execution", 0.025569770310662248], ["Exploitation for Client Execution", 0.02515405966829751], ["Deobfuscate/Decode Files or Information", 0.022942933815552905]], "use of WMI to both store and persist the backdoor": [["Boot or Logon Autostart Execution", 0.1837956929295219], ["Event Triggered Execution", 0.17223134342733593], ["Windows Management Instrumentation", 0.14756974392902086], ["Pre-OS Boot", 0.041731011108573704], ["Modify Registry", 0.037407023781662684], ["Boot or Logon Initialization Scripts", 0.025916387279254327]], "Windows Management Instrumentation (WMI).": [["Windows Management Instrumentation", 0.6956436386494141], ["System Information Discovery", 0.032872933082975384], ["Event Triggered Execution", 0.03181707026152544], ["Application Window Discovery", 0.028140548008555224], ["Query Registry", 0.021822674677117494], ["Virtualization/Sandbox Evasion", 0.013496671448733908]], "to use WMI for storage and\npersistence.": [["Windows Management Instrumentation", 0.13026478155753918], ["Event Triggered Execution", 0.10866984919397783], ["Boot or Logon Autostart Execution", 0.10208030797479915], ["Pre-OS Boot", 0.0538433199604167], ["Create or Modify System Process", 0.0466086191824828], ["Modify Registry", 0.03236869452242642]], "WMI provides many administrative capabilities\non local and remote systems, including querying system information,\nstarting and stopping processes, and setting conditional triggers.": [["Windows Management Instrumentation", 0.7971983522887984], ["Event Triggered Execution", 0.031346022242975904], ["Application Window Discovery", 0.00662655485540463], ["Access Token Manipulation", 0.006527607243098275], ["OS Credential Dumping", 0.00614642845786521], ["Command and Scripting Interpreter", 0.005837598505465875]], "WMI\ncan be accessed using a variety of tools, including the Windows WMI\nCommand-line (wmic.exe), or through APIs accessible to programming and\nscripting languages such as PowerShell.": [["Windows Management Instrumentation", 0.8375709227526378], ["Event Triggered Execution", 0.02043102493469885], ["OS Credential Dumping", 0.018263868937520352], ["Query Registry", 0.0063701907491002276], ["System Information Discovery", 0.004813548578374304], ["Native API", 0.0034517688714698637]], "WMI permanent event subscriptions can be used to trigger actions\nwhen specified conditions are met.": [["Event Triggered Execution", 0.4631666733352886], ["Windows Management Instrumentation", 0.14964448819139614], ["Scheduled Task/Job", 0.022081490591578178], ["Boot or Logon Autostart Execution", 0.02032093145460666], ["Virtualization/Sandbox Evasion", 0.014609937460340035], ["Traffic Signaling", 0.011404746188450644]], "Subscriptions consist of three core WMI classes: a Filter, a\nConsumer, and a FilterToConsumerBinding.": [["Windows Management Instrumentation", 0.19687672970195652], ["Event Triggered Execution", 0.17613053726035816], ["Impair Defenses", 0.03039599348307555], ["Create or Modify System Process", 0.020624797397315382], ["Modify Registry", 0.015829879633180225], ["Query Registry", 0.01444297381626634]], "WMI Consumers specify an\naction to be performed, including executing a command, running a\nscript, adding an entry to a log, or sending an email": [["Windows Management Instrumentation", 0.5661703315649508], ["Event Triggered Execution", 0.1497185099403701], ["Access Token Manipulation", 0.021342059584676772], ["Boot or Logon Autostart Execution", 0.010209494145308503], ["Abuse Elevation Control Mechanism", 0.009923103777249165], ["Create or Modify System Process", 0.00877146495352851]], "Creating a WMI permanent event subscription": [["Event Triggered Execution", 0.5150678683622569], ["Windows Management Instrumentation", 0.17205961957370422], ["Scheduled Task/Job", 0.027293174146876438], ["Boot or Logon Autostart Execution", 0.021109003252839074], ["Create or Modify System Process", 0.012929047969091613], ["System Services", 0.011580568791096188]], "WMI Filters\ndefine conditions that will trigger a Consumer, including system\nstartup, the execution of a program,": [["Windows Management Instrumentation", 0.2988975015353497], ["Event Triggered Execution", 0.2680921620061898], ["Boot or Logon Autostart Execution", 0.027621213124014336], ["Impair Defenses", 0.020036950070303386], ["Query Registry", 0.017738900107902654], ["Create or Modify System Process", 0.01635859154037677]], "then created a WMI event subscription in order to execute the\nbackdoor": [["Event Triggered Execution", 0.2593719073521423], ["Windows Management Instrumentation", 0.1794249933138674], ["Boot or Logon Autostart Execution", 0.07096262699591853], ["Pre-OS Boot", 0.02793373132457019], ["Create or Modify System Process", 0.020445286632160244], ["Scheduled Task/Job", 0.01617418708324309]], "use WMI to persist a backdoor and also store\nthe PowerShell backdoor code.": [["Boot or Logon Autostart Execution", 0.30810738252338055], ["Event Triggered Execution", 0.10485213990518333], ["Boot or Logon Initialization Scripts", 0.035287768053260955], ["Pre-OS Boot", 0.03481159008157009], ["Create or Modify System Process", 0.03454740889171534], ["Modify Registry", 0.03427760201442922]], "created a new\nWMI class and added a text property to it in order to store a string\nvalue.": [["Windows Management Instrumentation", 0.25931522430598564], ["Event Triggered Execution", 0.13350627227044537], ["System Information Discovery", 0.038246235453805656], ["Masquerading", 0.03577965558411187], ["Boot or Logon Autostart Execution", 0.029540784470982608], ["Modify Registry", 0.027663937554221724]], "The WMI component of the POSHSPY backdoor leverages a Filter to\nexecute the PowerShell component of the backdoor on a regular basis.": [["Windows Management Instrumentation", 0.4263087247212954], ["Event Triggered Execution", 0.13492784837627134], ["Command and Scripting Interpreter", 0.07751439346906247], ["Boot or Logon Autostart Execution", 0.02804942817585605], ["Scheduled Task/Job", 0.021532042839742527], ["Boot or Logon Initialization Scripts", 0.013995730064797854]], "WMI Component": [["Windows Management Instrumentation", 0.7266171337622912], ["Event Triggered Execution", 0.04937043632539524], ["Pre-OS Boot", 0.010454545645865987], ["Remote Services", 0.007027515016970915], ["Multi-Factor Authentication Interception", 0.006496313180958356], ["Peripheral Device Discovery", 0.006487420563918466]], "\u201cBfeOnServiceStartTypeChange\u201d WMI\nQuery Language (WQL) filter condition\nThe BfeOnServiceStartTypeChange Filter was\nbound to the CommandLineEventConsumer WindowsParentalControlsMigration.": [["Windows Management Instrumentation", 0.16544845762578284], ["Event Triggered Execution", 0.09791273311661633], ["Query Registry", 0.03775832023775496], ["Modify Registry", 0.022535568445517743], ["Masquerading", 0.020970853914784524], ["Lateral Tool Transfer", 0.019923793455571454]], "legitimate WMI persistence": [["Event Triggered Execution", 0.2850138182987907], ["Windows Management Instrumentation", 0.2017172557513987], ["Boot or Logon Autostart Execution", 0.08109415185621162], ["Pre-OS Boot", 0.06525798958844956], ["Boot or Logon Initialization Scripts", 0.03603418624949508], ["Modify Registry", 0.01610225853681303]], "attacker use of WMI": [["Windows Management Instrumentation", 0.6962165981553446], ["Event Triggered Execution", 0.06097414061881529], ["Pre-OS Boot", 0.01113677219825094], ["Access Token Manipulation", 0.007837041441555595], ["Multi-Factor Authentication Interception", 0.007702373380921707], ["OS Credential Dumping", 0.006557898116472303]], "WMI persistence.": [["Event Triggered Execution", 0.24533843497795657], ["Windows Management Instrumentation", 0.1589563017612866], ["Boot or Logon Autostart Execution", 0.10633198557067527], ["Pre-OS Boot", 0.06355039640893208], ["Boot or Logon Initialization Scripts", 0.060140482805830904], ["Modify Registry", 0.023003661342416288]], "decrypted, and executed the backdoor code": [["Deobfuscate/Decode Files or Information", 0.633776489333561], ["Obfuscated Files or Information", 0.07937560464853546], ["Data Encrypted for Impact", 0.05543649170987563], ["Weaken Encryption", 0.020441654290283568], ["Archive Collected Data", 0.019577589701142078], ["Encrypted Channel", 0.01714250484380984]], "Decoded CommandLineTemplate PowerShell code": [["Deobfuscate/Decode Files or Information", 0.2491458459318282], ["Obfuscated Files or Information", 0.18408477218216704], ["Command and Scripting Interpreter", 0.13801117918004874], ["Native API", 0.03621248558895662], ["System Binary Proxy Execution", 0.03263325574281157], ["XSL Script Processing", 0.02946381124411125]], "wrote the encrypted and base64-encoded PowerShell\nbackdoor code": [["Obfuscated Files or Information", 0.5837306181759724], ["Deobfuscate/Decode Files or Information", 0.19551353861455076], ["Data Encoding", 0.035275184132359215], ["Encrypted Channel", 0.024320370458087548], ["Archive Collected Data", 0.016133249048919676], ["Command and Scripting Interpreter", 0.013547981341078296]], "base64-encoded PowerShell command.": [["Obfuscated Files or Information", 0.43657190650298316], ["Deobfuscate/Decode Files or Information", 0.17499810814039016], ["Data Encoding", 0.12417444614957461], ["Command and Scripting Interpreter", 0.04412885788464306], ["Archive Collected Data", 0.01859806580563164], ["Data Obfuscation", 0.014759847290231927]], "executing PowerShell code as an EncodedCommand": [["Command and Scripting Interpreter", 0.34334415610180663], ["Obfuscated Files or Information", 0.22519893579793798], ["Deobfuscate/Decode Files or Information", 0.09326103384842616], ["Native API", 0.03480801448646832], ["System Binary Proxy Execution", 0.024515732651600765], ["Indirect Command Execution", 0.016816248066197564]], "to download and execute additional\nPowerShell code and Windows binaries": [["Command and Scripting Interpreter", 0.39088925061528984], ["Ingress Tool Transfer", 0.2538484259252339], ["System Binary Proxy Execution", 0.10568462003925834], ["BITS Jobs", 0.046656969780999744], ["Native API", 0.019271346101695414], ["Inter-Process Communication", 0.009307473294768408]], "Downloading and executing PowerShell code": [["Command and Scripting Interpreter", 0.42083858350102793], ["Ingress Tool Transfer", 0.38271336320094007], ["System Binary Proxy Execution", 0.032281306869283106], ["BITS Jobs", 0.021239799504853312], ["Inter-Process Communication", 0.009786986867289812], ["Scheduled Task/Job", 0.008511801828580134]], "Encrypting communications using AES and RSA public key cryptography": [["Encrypted Channel", 0.5634016824880629], ["Data Encrypted for Impact", 0.0613389595503817], ["Weaken Encryption", 0.056145449600909204], ["Exfiltration Over Alternative Protocol", 0.03635243195486431], ["Deobfuscate/Decode Files or Information", 0.027961740231544286], ["Obfuscated Files or Information", 0.027538357420004538]], "Writing executables to a randomly-selected directory under Program Files, and naming the EXE to match the\nchosen directory name": [["Masquerading", 0.37409169339630133], ["Hijack Execution Flow", 0.13822157283966943], ["Native API", 0.06201603713447734], ["System Binary Proxy Execution", 0.04272107080781462], ["Process Injection", 0.03730477030515588], ["Hide Artifacts", 0.02618474197429207]], "Appending a file signature header to all encrypted data,": [["Data Encrypted for Impact", 0.2401928043086524], ["Obfuscated Files or Information", 0.23732186393874494], ["Subvert Trust Controls", 0.05655987118019337], ["Archive Collected Data", 0.05341082144760528], ["Deobfuscate/Decode Files or Information", 0.05093960066960286], ["Masquerading", 0.029461092714807117]], "appended file\nheaders used to bypass content inspection made this backdoor difficult\nto identify": [["Obfuscated Files or Information", 0.22440982057648698], ["Masquerading", 0.06991554980175904], ["Data Obfuscation", 0.04959716857865735], ["File and Directory Discovery", 0.04102719876233989], ["Template Injection", 0.03946698608540688], ["Hide Artifacts", 0.03712193611411226]], "Word document lure requesting the user to run the VBA macro.": [["Office Application Startup", 0.3599371398101426], ["Command and Scripting Interpreter", 0.26429423525447204], ["User Execution", 0.06722836809722209], ["Inter-Process Communication", 0.032573892996310305], ["Template Injection", 0.02393540672926812], ["System Binary Proxy Execution", 0.009355601177751282]], "When opened, the user sees a social engineering image telling them that they must click the \u201cEnable editing\u201d button to see the document\u2019s contents.": [["User Execution", 0.15382008846412312], ["Template Injection", 0.06437224108792126], ["Hide Artifacts", 0.06196833475351847], ["Data Manipulation", 0.057582855255596845], ["Office Application Startup", 0.04413033823625332], ["File and Directory Discovery", 0.040971560149679016]], "Packed DLL analysis": [["Hijack Execution Flow", 0.19932101170869998], ["Shared Modules", 0.10168933448168584], ["Obfuscated Files or Information", 0.09403081534885949], ["System Binary Proxy Execution", 0.047537699628197476], ["Software Discovery", 0.04326769288066938], ["Process Injection", 0.033063727443727695]], "packing being used to obfuscate the malware.": [["Obfuscated Files or Information", 0.8431413954881989], ["Deobfuscate/Decode Files or Information", 0.023261002742778536], ["Archive Collected Data", 0.010181538734391257], ["Execution Guardrails", 0.00984893979965675], ["Masquerading", 0.007863286619523279], ["Hide Artifacts", 0.006732747094326003]], "there is indeed some sort of unpacking happening.": [["Deobfuscate/Decode Files or Information", 0.2547744680513168], ["Obfuscated Files or Information", 0.18763194790378324], ["Indicator Removal", 0.03495369809565063], ["Masquerading", 0.03209569100659169], ["Archive Collected Data", 0.02794759508352417], ["Hide Artifacts", 0.02395863450002404]], "Although the unpacking procedure happens in multiple steps": [["Deobfuscate/Decode Files or Information", 0.29782476486287784], ["Obfuscated Files or Information", 0.19277533666622143], ["Archive Collected Data", 0.04062974371091164], ["Masquerading", 0.032374945249150966], ["Command and Scripting Interpreter", 0.02912060866980001], ["System Binary Proxy Execution", 0.0181236565156375]], "As soon as the unpacked executable is running": [["Hijack Execution Flow", 0.13062912297123125], ["Deobfuscate/Decode Files or Information", 0.08547440698320945], ["System Binary Proxy Execution", 0.06402079158798638], ["Native API", 0.052982297796811094], ["Process Injection", 0.050152753193317245], ["Obfuscated Files or Information", 0.04317923650374551]], "An Examination of its Unpacking Routine": [["Obfuscated Files or Information", 0.41774307329844856], ["Deobfuscate/Decode Files or Information", 0.1762708171182537], ["Archive Collected Data", 0.03522836796413458], ["Masquerading", 0.02239518144449462], ["Command and Scripting Interpreter", 0.01694982591537455], ["Execution Guardrails", 0.011784691472888973]], "its unpacking routine": [["Deobfuscate/Decode Files or Information", 0.3069340377295465], ["Obfuscated Files or Information", 0.18257453993296016], ["Archive Collected Data", 0.05796264519909551], ["Masquerading", 0.040243185086333726], ["Command and Scripting Interpreter", 0.02679201883464034], ["Automated Collection", 0.017177168700986557]], "Once the \u201c.tmp\u201d file is found, it is moved and renamed to the Office templates folder": [["Office Application Startup", 0.2727936365170094], ["Indicator Removal", 0.12207846125229599], ["Masquerading", 0.08177595214387332], ["Data Staged", 0.07666504787122949], ["Hide Artifacts", 0.03616834480623195], ["Data Manipulation", 0.026990001490028826]], "loaded using rundll32.exe.": [["System Binary Proxy Execution", 0.43565069456590283], ["Native API", 0.13935884581850286], ["Hijack Execution Flow", 0.09038016247561619], ["Process Injection", 0.03226680859700589], ["Masquerading", 0.03166566833082788], ["Event Triggered Execution", 0.029176804104013798]], "As a second argument, the macro passes the entry function \u201cDllUnregisterServer\u201d to rundll32.exe so that the execution starts correctly.": [["System Binary Proxy Execution", 0.4535085755464935], ["Boot or Logon Autostart Execution", 0.06558915237345074], ["Command and Scripting Interpreter", 0.0555157427490869], ["Event Triggered Execution", 0.05510712801655339], ["System Services", 0.038728447207658556], ["Office Application Startup", 0.03446762439563832]], "runs rundll32.exe to load the malware.": [["System Binary Proxy Execution", 0.5182288690350633], ["Hijack Execution Flow", 0.10277821027111847], ["Native API", 0.05879218436531615], ["Process Injection", 0.030087732678103093], ["Boot or Logon Autostart Execution", 0.022105373838423554], ["Shared Modules", 0.018681837802715786]], "executes it using rundll32.exe": [["System Binary Proxy Execution", 0.5533155713413681], ["Native API", 0.1305485723450844], ["System Services", 0.05049175615333318], ["Command and Scripting Interpreter", 0.03127799194606616], ["Hijack Execution Flow", 0.023774789747674267], ["Event Triggered Execution", 0.016555274013502517]], "Looking at the decrypted data": [["Deobfuscate/Decode Files or Information", 0.46381219130201323], ["Archive Collected Data", 0.11061856471180342], ["Data Encrypted for Impact", 0.0646256427434099], ["Obfuscated Files or Information", 0.039436934839396164], ["File and Directory Discovery", 0.03680734138839309], ["Weaken Encryption", 0.014760819088475475]], "the decryption process starts": [["Deobfuscate/Decode Files or Information", 0.6917181932702252], ["Data Encrypted for Impact", 0.054611700850709766], ["Archive Collected Data", 0.03273472810986682], ["Encrypted Channel", 0.024951032761855917], ["Obfuscated Files or Information", 0.019563997945696365], ["Weaken Encryption", 0.018290857607114908]], "data that will be decrypted": [["Deobfuscate/Decode Files or Information", 0.24940835100574943], ["Archive Collected Data", 0.227190770999639], ["Data Encrypted for Impact", 0.12822795316411387], ["Obfuscated Files or Information", 0.04225643293814732], ["Exfiltration Over Alternative Protocol", 0.033541426367238475], ["Weaken Encryption", 0.033217365310720365]], "The algorithm to decrypt the data is simple.": [["Deobfuscate/Decode Files or Information", 0.39244560595569017], ["Data Encrypted for Impact", 0.13551460499219936], ["Archive Collected Data", 0.12121088692438342], ["Obfuscated Files or Information", 0.051864683567142175], ["Encrypted Channel", 0.04568598407219112], ["Weaken Encryption", 0.04252100437947508]], "the second decryption stage occurs": [["Deobfuscate/Decode Files or Information", 0.6569400568100943], ["Data Encrypted for Impact", 0.05626909166752338], ["Archive Collected Data", 0.03801068476168592], ["Obfuscated Files or Information", 0.0341755177584202], ["Encrypted Channel", 0.03174080110316115], ["Weaken Encryption", 0.022131003509344178]], "the decrypted memory structure": [["Deobfuscate/Decode Files or Information", 0.4471694876724922], ["Obfuscated Files or Information", 0.057540827369897476], ["Archive Collected Data", 0.05659942508589657], ["Data Encrypted for Impact", 0.041482797749340966], ["File and Directory Discovery", 0.02409540451693602], ["Weaken Encryption", 0.0237808292447641]], "Before the decryption starts": [["Deobfuscate/Decode Files or Information", 0.5366268849950995], ["Data Encrypted for Impact", 0.08778336581324264], ["Archive Collected Data", 0.05809900452062986], ["Obfuscated Files or Information", 0.041152529869874985], ["Encrypted Channel", 0.030844764362174704], ["Weaken Encryption", 0.027877413335774506]], "contains the decryption algorithm for the second stage": [["Deobfuscate/Decode Files or Information", 0.6054926244671927], ["Obfuscated Files or Information", 0.06043210463385352], ["Data Encrypted for Impact", 0.055861501151647786], ["Encrypted Channel", 0.0409200632225985], ["Archive Collected Data", 0.03721400462402207], ["Weaken Encryption", 0.02682288835036035]], "The output of this decryption": [["Deobfuscate/Decode Files or Information", 0.7504492173451397], ["Obfuscated Files or Information", 0.04201555688170286], ["Archive Collected Data", 0.03371324108384128], ["Data Encrypted for Impact", 0.028461500878108805], ["Encrypted Channel", 0.026712138444666245], ["Data Encoding", 0.010537686310592086]], "The decryption algorithm": [["Deobfuscate/Decode Files or Information", 0.5254657769621026], ["Data Encrypted for Impact", 0.09384095840763958], ["Obfuscated Files or Information", 0.06476342963634903], ["Encrypted Channel", 0.05922979120539399], ["Archive Collected Data", 0.04920852242649914], ["Weaken Encryption", 0.03894338730395639]], "the executable code used to decrypt the encrypted data": [["Deobfuscate/Decode Files or Information", 0.5135477629830294], ["Obfuscated Files or Information", 0.0984604025486011], ["Data Encrypted for Impact", 0.09508665321409333], ["Archive Collected Data", 0.063380350398171], ["Weaken Encryption", 0.025846638502392476], ["Encrypted Channel", 0.02251911513018201]], "After successfully decrypting the C2 URLs": [["Deobfuscate/Decode Files or Information", 0.3051486725504496], ["Data Encoding", 0.1492765254276189], ["Encrypted Channel", 0.10139381469422241], ["Web Service", 0.03301998457553258], ["Exfiltration Over Alternative Protocol", 0.031646036850209495], ["Exfiltration Over C2 Channel", 0.03121444896155112]], "all the decrypted C2 URLs": [["Deobfuscate/Decode Files or Information", 0.2083930589312244], ["Data Encoding", 0.1134320853624722], ["Web Service", 0.07131737868765872], ["Encrypted Channel", 0.061673621542720124], ["Application Layer Protocol", 0.0368921984497046], ["Exfiltration Over C2 Channel", 0.0360509238268525]], "the malware calls a decryption function": [["Deobfuscate/Decode Files or Information", 0.7172788938145926], ["Obfuscated Files or Information", 0.0704519417257652], ["Data Encrypted for Impact", 0.047490309059520674], ["Archive Collected Data", 0.030791889372934388], ["Encrypted Channel", 0.021471920204195367], ["Weaken Encryption", 0.015568032027824365]], "Although the decoding algorithm of the C2 response looks quite complex, it is actually Base64 decoding, followed by an XOR operation using the key 0x7A.": [["Data Encoding", 0.4148004930475353], ["Deobfuscate/Decode Files or Information", 0.3074439982042467], ["Encrypted Channel", 0.062294411254334915], ["Obfuscated Files or Information", 0.038406024553485414], ["Data Obfuscation", 0.030471053969411133], ["Application Layer Protocol", 0.012603841202559954]], "decryption function.": [["Deobfuscate/Decode Files or Information", 0.5784179596024616], ["Data Encrypted for Impact", 0.102890257815339], ["Obfuscated Files or Information", 0.05120960337236302], ["Archive Collected Data", 0.047610134752776576], ["Encrypted Channel", 0.03429782537407828], ["Weaken Encryption", 0.03289717485294546]], "can be decrypted to an active malware download server": [["Deobfuscate/Decode Files or Information", 0.3501432936305569], ["Obfuscated Files or Information", 0.07555227492341991], ["Archive Collected Data", 0.067947022556882], ["Data Encrypted for Impact", 0.05402192289300653], ["Exfiltration Over Alternative Protocol", 0.03860188142887232], ["Ingress Tool Transfer", 0.024904629045839236]], "The API function located at the beginning of the memory section are resolved using GetProcAddress": [["Native API", 0.15054397006304443], ["System Information Discovery", 0.1242349323477661], ["Virtualization/Sandbox Evasion", 0.06440142892499601], ["Process Injection", 0.05450046246732611], ["Process Discovery", 0.03092291993255118], ["File and Directory Discovery", 0.028528534857082784]], "Windows API functions": [["Native API", 0.7210924884871728], ["System Binary Proxy Execution", 0.031785620551424774], ["Masquerading", 0.02690656408191377], ["Windows Management Instrumentation", 0.021461580658326183], ["Command and Scripting Interpreter", 0.015009760781782112], ["Process Injection", 0.011391830509501271]], "After resolving the functions": [["Native API", 0.07413774553689079], ["Masquerading", 0.04959449635396141], ["Hijack Execution Flow", 0.046712320202506055], ["System Services", 0.02775490525197214], ["Rootkit", 0.02718208311608109], ["Virtualization/Sandbox Evasion", 0.02431840884772391]], "The names of Windows API functions are stored in the first 150 bytes": [["Native API", 0.4857708693532915], ["Obfuscated Files or Information", 0.10431961186570654], ["Masquerading", 0.042522962131594975], ["System Information Discovery", 0.02420756603107887], ["Deobfuscate/Decode Files or Information", 0.02417656158092829], ["Virtualization/Sandbox Evasion", 0.023109229379892078]], "several Windows API functions are resolved using GetProcAddress": [["Native API", 0.5166398635519677], ["File and Directory Discovery", 0.06625392070846099], ["Masquerading", 0.06014328927179006], ["System Information Discovery", 0.03029321095516868], ["Query Registry", 0.028015008069918877], ["System Binary Proxy Execution", 0.023150821501877642]], "memory structure contains executable code.": [["Process Injection", 0.1051924533126525], ["Obfuscated Files or Information", 0.06485050446899243], ["Virtualization/Sandbox Evasion", 0.05516840500104154], ["Hijack Execution Flow", 0.04903373848288733], ["Native API", 0.047845160829344584], ["Deobfuscate/Decode Files or Information", 0.045017505402723944]], "Data view of the section containing the encrypted malware.": [["Deobfuscate/Decode Files or Information", 0.22485503032553963], ["Obfuscated Files or Information", 0.20431868433123626], ["File and Directory Discovery", 0.06443034962813143], ["Data Encrypted for Impact", 0.06064987590095356], ["Archive Collected Data", 0.06020191876786608], ["Unsecured Credentials", 0.031731607210040945]], "The area after this contains encrypted data.": [["Obfuscated Files or Information", 0.12118471960318156], ["Archive Collected Data", 0.09754735935306152], ["Data Encrypted for Impact", 0.09634461780688296], ["Hide Artifacts", 0.093557643266843], ["Deobfuscate/Decode Files or Information", 0.06832383388797299], ["Encrypted Channel", 0.033314586941290907]], "Structure of the encrypted section.": [["Obfuscated Files or Information", 0.2827972871366115], ["Deobfuscate/Decode Files or Information", 0.1480107504922316], ["Data Encrypted for Impact", 0.10868552159387763], ["Archive Collected Data", 0.076250028957821], ["Encrypted Channel", 0.048687835672182676], ["Weaken Encryption", 0.0318102773937567]], "encrypted URLs contained in the malware itself.": [["Obfuscated Files or Information", 0.14181637489234547], ["Encrypted Channel", 0.10039048085772938], ["Data Encoding", 0.06141980248363676], ["Application Layer Protocol", 0.04263512672550473], ["Data Obfuscation", 0.04194233527732678], ["Stage Capabilities", 0.04064956738578453]], "This technique is called self-injection or PE overwrite": [["Process Injection", 0.2092511615964126], ["Modify System Image", 0.07062385214754911], ["Pre-OS Boot", 0.030885412692605398], ["Event Triggered Execution", 0.027715031490064594], ["Modify Registry", 0.02600481071808751], ["Hijack Execution Flow", 0.022896944922735855]], "This function obtains the username,": [["System Owner/User Discovery", 0.8525569162719004], ["Account Discovery", 0.043282127318217116], ["System Information Discovery", 0.011227832882267221], ["Native API", 0.00796390615724633], ["Permission Groups Discovery", 0.003785027138966449], ["System Network Configuration Discovery", 0.003743195485477886]], "the computer name and the domain of infected system.": [["System Information Discovery", 0.3092572057420698], ["System Network Configuration Discovery", 0.16380561249740866], ["Remote System Discovery", 0.1155129101037549], ["System Owner/User Discovery", 0.05428034011761242], ["Gather Victim Host Information", 0.025746284359070157], ["System Network Connections Discovery", 0.020338630689508082]], "the computer architecture": [["System Information Discovery", 0.18840536351827183], ["Virtualization/Sandbox Evasion", 0.05571405572318363], ["Modify System Image", 0.036392879318962464], ["Software Discovery", 0.022117979977723537], ["Gather Victim Host Information", 0.02150022905309313], ["Develop Capabilities", 0.01754982153081946]], "generated based on the computer architecture.": [["System Information Discovery", 0.32462853828340155], ["Obfuscated Files or Information", 0.06486320360431357], ["Virtualization/Sandbox Evasion", 0.06307672885888435], ["Modify System Image", 0.05113963740502618], ["Execution Guardrails", 0.02514295945058074], ["Gather Victim Host Information", 0.018305134100368926]], "The subsequent functions collect additional information such as the machine\u2019s public IP address": [["System Network Configuration Discovery", 0.7671237651878533], ["System Network Connections Discovery", 0.02716095090033879], ["System Information Discovery", 0.023678677947018185], ["Remote System Discovery", 0.020325998568172576], ["System Location Discovery", 0.016744931411843786], ["Gather Victim Network Information", 0.012574748653374688]], "To determine the command and control (C2) servers waiting for the data to be sent to, the malware calls a decryption function that uses the RC4 algorithm": [["Deobfuscate/Decode Files or Information", 0.17723718946131872], ["Encrypted Channel", 0.10124892526582208], ["Data Encoding", 0.07737799254413978], ["Exfiltration Over C2 Channel", 0.042116010545833325], ["Web Service", 0.03546958657033685], ["Fallback Channels", 0.0326835034732314]], "After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data": [["Data Encoding", 0.278010267845309], ["Exfiltration Over C2 Channel", 0.0990987583106177], ["Deobfuscate/Decode Files or Information", 0.08266250333884427], ["Application Layer Protocol", 0.07845743777229564], ["Encrypted Channel", 0.07630770430361819], ["Web Service", 0.03611295132153983]], "making a HTTP GET request": [["Application Layer Protocol", 0.2852416286324413], ["System Network Configuration Discovery", 0.031061791876383835], ["Cloud Service Dashboard", 0.030257258126507498], ["Exfiltration Over C2 Channel", 0.028835011126860068], ["Web Service", 0.023751106448825162], ["Ingress Tool Transfer", 0.02369668151899412]], "the malware initiates a download, which delivers an executable": [["Ingress Tool Transfer", 0.5347345463173491], ["Command and Scripting Interpreter", 0.09818335159940249], ["System Binary Proxy Execution", 0.057324343233144955], ["BITS Jobs", 0.054360547580193354], ["User Execution", 0.028968583326312695], ["Inter-Process Communication", 0.014383039546917251]], "Its main purpose is to download and execute a second stage malware payload": [["Ingress Tool Transfer", 0.5944781436202254], ["Command and Scripting Interpreter", 0.08252455749571493], ["BITS Jobs", 0.06432303015614024], ["System Binary Proxy Execution", 0.03151991293819664], ["Inter-Process Communication", 0.011220833263594266], ["Deobfuscate/Decode Files or Information", 0.010416789060880388]], "Thread Execution Hijacking": [["Process Injection", 0.2703970558520202], ["Process Discovery", 0.06927767005196918], ["Native API", 0.06617899689868618], ["Access Token Manipulation", 0.040020100038036854], ["Event Triggered Execution", 0.029103312194364437], ["Virtualization/Sandbox Evasion", 0.02762107887510941]], "The final execution method Hancitor supports is Thread Execution Hijacking.": [["Process Injection", 0.32923003214459223], ["Native API", 0.07101745389227943], ["System Binary Proxy Execution", 0.03936754135729998], ["Event Triggered Execution", 0.027169751365573452], ["Process Discovery", 0.026958508234127626], ["Hijack Execution Flow", 0.024588593671240222]], "The only difference is that the malware replaces the thread context with the downloaded executable and resumes it afterwards.": [["Process Injection", 0.22838861044948158], ["Native API", 0.08101405568951771], ["BITS Jobs", 0.07411890134603363], ["Ingress Tool Transfer", 0.05694711725032278], ["System Binary Proxy Execution", 0.04746653915248027], ["Command and Scripting Interpreter", 0.029206595740842715]], "Process Hollowing": [["Process Injection", 0.1716895409999135], ["Native API", 0.04831596899555233], ["Obfuscated Files or Information", 0.036403801374847854], ["Virtualization/Sandbox Evasion", 0.024539182334028672], ["Command and Scripting Interpreter", 0.02227456058528693], ["Hide Artifacts", 0.018181748118673412]], "If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.": [["Process Injection", 0.3042218142133532], ["Service Stop", 0.07064503284406083], ["Impair Defenses", 0.04956697479234628], ["Process Discovery", 0.04889505297116512], ["Native API", 0.03882123838608111], ["Virtualization/Sandbox Evasion", 0.037583548051980456]], "The malware then allocates new memory in the newly-created process, writes the executable to it and executes it in a new thread.": [["Process Injection", 0.6405448084827099], ["Process Discovery", 0.0640513402877132], ["Native API", 0.05330789070381811], ["Access Token Manipulation", 0.01834565200851471], ["Create or Modify System Process", 0.0134008778810731], ["BITS Jobs", 0.008252749916009322]], "Process Injection method": [["Process Injection", 0.6772477899516323], ["Native API", 0.15182740056246172], ["Hijack Execution Flow", 0.016928566330108967], ["Process Discovery", 0.012804222114943522], ["System Binary Proxy Execution", 0.011564209226092866], ["Access Token Manipulation", 0.01098369705369907]], "the malware was distributed as email Word document attachments": [["Phishing", 0.4740756427562246], ["User Execution", 0.15262370085889537], ["Email Collection", 0.026664786225518027], ["Template Injection", 0.02345000914957782], ["Office Application Startup", 0.013791171969124985], ["Ingress Tool Transfer", 0.010467778079467128]], "then recursively searches through all local temp folders.": [["File and Directory Discovery", 0.5235491371645111], ["Data from Local System", 0.088794978075613], ["Data Staged", 0.05067252427173385], ["Automated Collection", 0.039056828925595935], ["Indicator Removal", 0.033826642564142445], ["Data from Network Shared Drive", 0.030583171201727755]], "Query string containing system information before being sent to the C2.": [["System Information Discovery", 0.6547563406555873], ["System Network Configuration Discovery", 0.029541344672545402], ["Automated Collection", 0.020822614302461538], ["Query Registry", 0.015373138818192193], ["Virtualization/Sandbox Evasion", 0.013256908728336328], ["System Time Discovery", 0.012573351100844548]], "The backdoor\nuses domain fronting to obfuscate its true C2 server": [["Data Obfuscation", 0.20442747975798203], ["Obfuscated Files or Information", 0.12642815835907792], ["Data Encoding", 0.08254735992543892], ["Encrypted Channel", 0.06926847412754965], ["Proxy", 0.050231649388987], ["Dynamic Resolution", 0.0339924618700608]], "The fronted\ndomain is configured by an earlier stage of execution and the actual\ndomain is hard-coded in the backdoor.": [["Domain Trust Discovery", 0.15986537503379641], ["System Network Configuration Discovery", 0.07703725804127363], ["Dynamic Resolution", 0.07366009076512572], ["Acquire Infrastructure", 0.0735307317216575], ["Domain Policy Modification", 0.03786096912016959], ["Compromise Infrastructure", 0.032946662480412836]], "PowerShell initiated the\nfirst connection to the fronted domain": [["System Network Connections Discovery", 0.14152663328596934], ["Command and Scripting Interpreter", 0.12537435708765496], ["Remote Services", 0.047602501699280125], ["Remote Service Session Hijacking", 0.03029988120687564], ["Dynamic Resolution", 0.02539427225066123], ["System Network Configuration Discovery", 0.023964806186098964]], "communicates with its C2 server using HTTPS": [["Application Layer Protocol", 0.6189842815866322], ["Encrypted Channel", 0.04920639799509244], ["Data Obfuscation", 0.037813690556472726], ["Non-Standard Port", 0.0322625769717626], ["Proxy", 0.026873900725552898], ["Non-Application Layer Protocol", 0.023611244522027484]], "its C2 server consists of\nJSON data exchanged via HTTP POST requests.": [["Application Layer Protocol", 0.35847583813789974], ["Exfiltration Over C2 Channel", 0.12430580042387558], ["Web Service", 0.10266543339756104], ["Fallback Channels", 0.04559615927709158], ["Data Encoding", 0.04354503070373501], ["Exfiltration Over Alternative Protocol", 0.03445782295500133]], "HTTP POST request that contains\nthe command output.": [["Application Layer Protocol", 0.271704067701272], ["Exfiltration Over C2 Channel", 0.08032327937176802], ["Data Encoding", 0.08026816853867019], ["Web Service", 0.0549009800244853], ["Exfiltration Over Alternative Protocol", 0.03297472912813571], ["Data Obfuscation", 0.023903252508339207]], "C2\nserver via a subsequent HTTP POST request": [["Application Layer Protocol", 0.509908690856653], ["Exfiltration Over C2 Channel", 0.11193479427131993], ["Fallback Channels", 0.04733040810003841], ["Web Service", 0.04097955219560236], ["Data Encoding", 0.028628929216713714], ["Data Obfuscation", 0.018820072086992056]], "its C2 server via a\nsubsequent HTTP POST request.": [["Application Layer Protocol", 0.34247775172294925], ["Web Service", 0.11705970913563715], ["Exfiltration Over C2 Channel", 0.09241996760305472], ["Fallback Channels", 0.07535817297185239], ["Data Encoding", 0.01784716653596253], ["Dynamic Resolution", 0.015782971332633202]], "its C2 server every five\nseconds via HTTP POST requests.": [["Web Service", 0.14985856838150907], ["Fallback Channels", 0.14804885498528986], ["Application Layer Protocol", 0.0686912055368821], ["Exfiltration Over C2 Channel", 0.06110268340769393], ["Scheduled Transfer", 0.039771481649051546], ["Dynamic Resolution", 0.029058769109774497]], "backdoor that supports commands, including screen capture": [["Screen Capture", 0.7183137304587115], ["Video Capture", 0.04863401594109374], ["Application Window Discovery", 0.028037693648291485], ["Input Capture", 0.022538629239421307], ["Clipboard Data", 0.010202457925021603], ["Hide Artifacts", 0.008929337719640537]], "Upload a screen capture": [["Screen Capture", 0.7685058681620242], ["Video Capture", 0.06996917754600775], ["Application Window Discovery", 0.007714580137809549], ["Input Capture", 0.007479899319161837], ["Data from Local System", 0.007176148579031228], ["Archive Collected Data", 0.00617382723125934]], "keystroke capture": [["Input Capture", 0.7991252986242334], ["Screen Capture", 0.021305583729360086], ["Clipboard Data", 0.01655221798258139], ["Video Capture", 0.010479203694506256], ["Credentials from Password Stores", 0.0063412370311587574], ["Network Sniffing", 0.005828465170501334]], "The backdoor writes captured\nkeystrokes to memory": [["Input Capture", 0.6824508164130122], ["Clipboard Data", 0.02038802294910134], ["Screen Capture", 0.014184169063656955], ["Credentials from Password Stores", 0.013364811753228808], ["Deobfuscate/Decode Files or Information", 0.01172051247358254], ["OS Credential Dumping", 0.011420218540146129]], "continuously captures keystrokes": [["Input Capture", 0.8595090705072661], ["Clipboard Data", 0.013966493740788339], ["Screen Capture", 0.011393898124058274], ["Video Capture", 0.005511437041423048], ["Credentials from Password Stores", 0.004198828684309309], ["Virtualization/Sandbox Evasion", 0.003496707488763465]], "the keylogging utility": [["Input Capture", 0.863146449768752], ["Clipboard Data", 0.008351863659847691], ["Boot or Logon Autostart Execution", 0.005891633163833373], ["Credentials from Password Stores", 0.005534025414315011], ["Screen Capture", 0.005113165862690193], ["Unsecured Credentials", 0.004282504736030662]], "This attacker utilized an additional keylogging utility": [["Input Capture", 0.7725149110747478], ["Clipboard Data", 0.009759597612377062], ["Encrypted Channel", 0.008379631268304244], ["Deobfuscate/Decode Files or Information", 0.007652268522278643], ["Unsecured Credentials", 0.006717706906818423], ["Remote Services", 0.005650981720889516]], "The keylogging utility was configured\nto capture and record keystrokes to C:\\ProgramData\\psh\\System32Log.txt.": [["Input Capture", 0.8268654159865344], ["Screen Capture", 0.011935964794465263], ["Video Capture", 0.008262137109636166], ["Network Sniffing", 0.006719326595886401], ["Audio Capture", 0.006292999832153564], ["Unsecured Credentials", 0.00604631148644386]], "Keylogger Deployment": [["Input Capture", 0.8054721840341251], ["Boot or Logon Autostart Execution", 0.01254385431785374], ["Event Triggered Execution", 0.010200775147360269], ["Unsecured Credentials", 0.005379852505332475], ["Credentials from Password Stores", 0.004873850504467423], ["OS Credential Dumping", 0.004775765050073506]], "keylogger": [["Input Capture", 0.8783769434694156], ["Credentials from Password Stores", 0.006552869969044913], ["Clipboard Data", 0.005192450075354934], ["Unsecured Credentials", 0.00471984684764479], ["Screen Capture", 0.004104673287877508], ["OS Credential Dumping", 0.0033681682043961445]], "The backdoor may also download and execute\nadditional PowerShell commands from its command and control (C2) server.": [["Command and Scripting Interpreter", 0.36723763104831164], ["Ingress Tool Transfer", 0.10538994412581852], ["Multi-Stage Channels", 0.06463304453770047], ["Compromise Client Software Binary", 0.024495628687591264], ["BITS Jobs", 0.020716854980994633], ["System Binary Proxy Execution", 0.016444331026614516]], "Downloaded VBScript and PowerShell": [["Command and Scripting Interpreter", 0.5782694723502577], ["Ingress Tool Transfer", 0.19625113839747502], ["System Binary Proxy Execution", 0.0710824904780479], ["BITS Jobs", 0.01768659571997291], ["Scheduled Task/Job", 0.013113038331274772], ["Native API", 0.007872311788888031]], "a PowerShell script block was executed\nto download": [["Ingress Tool Transfer", 0.30097273056829], ["Command and Scripting Interpreter", 0.21372135350926494], ["BITS Jobs", 0.05132656044449828], ["System Binary Proxy Execution", 0.030279688255581395], ["Inter-Process Communication", 0.016129702241050765], ["Application Layer Protocol", 0.01532891211348351]], "PowerShell to connect to third-party file sharing\nsites to download the UltraVNC application": [["Remote Services", 0.16846159084541965], ["Ingress Tool Transfer", 0.12316636481439279], ["Command and Scripting Interpreter", 0.1053534450014248], ["Lateral Tool Transfer", 0.050863652788275523], ["Remote Access Software", 0.0390466343848406], ["Web Service", 0.019638438158475446]], "PowerShell to connect to third-party file sharing\nsites to download an NGROK utility": [["Ingress Tool Transfer", 0.20631136728772767], ["Web Service", 0.09280209416611852], ["Command and Scripting Interpreter", 0.08713588839218626], ["Lateral Tool Transfer", 0.06135956571184496], ["Remote Services", 0.028591765613391662], ["Application Layer Protocol", 0.024307067343758027]], "use UltraVNC to download two LNK\nfiles": [["Ingress Tool Transfer", 0.2486349970953942], ["Remote Services", 0.06837099823804756], ["Command and Scripting Interpreter", 0.05918356128390369], ["Data from Local System", 0.04323464818042192], ["Lateral Tool Transfer", 0.041619167435585074], ["Data Staged", 0.023739871674103692]], "used UltraVNC to download an in-memory dropper": [["Ingress Tool Transfer", 0.12373494757890836], ["Command and Scripting Interpreter", 0.08211904823182346], ["System Binary Proxy Execution", 0.04426618562081053], ["Remote Services", 0.0386748487120959], ["Hide Artifacts", 0.037100048079712365], ["Deobfuscate/Decode Files or Information", 0.03666819958733566]], "using UltraVNC to download and store\na file": [["Ingress Tool Transfer", 0.3531954659228216], ["Command and Scripting Interpreter", 0.04488612599248549], ["Remote Services", 0.042402367060263235], ["Data Staged", 0.04098631967010634], ["Data from Local System", 0.0317121119005109], ["Lateral Tool Transfer", 0.031028547475551997]], "deployed additional tools": [["Ingress Tool Transfer", 0.13887305697152], ["Command and Scripting Interpreter", 0.05850761015505011], ["Stage Capabilities", 0.04341686686403411], ["Server Software Component", 0.0322823400417043], ["Lateral Tool Transfer", 0.026842032712079546], ["BITS Jobs", 0.025126496856104887]], "The Data field may contain RC4-encrypted, Base64-encoded command": [["Data Encoding", 0.2734620627065664], ["Obfuscated Files or Information", 0.22541709420970504], ["Deobfuscate/Decode Files or Information", 0.14531278323288577], ["Archive Collected Data", 0.07816138020144829], ["Encrypted Channel", 0.035330747928307996], ["Exfiltration Over Alternative Protocol", 0.02163189247931396]], "The backdoor uses an RC4 key\nconfigured by an earlier stage of execution to encrypt and decrypt the\nData field": [["Deobfuscate/Decode Files or Information", 0.20897166822877625], ["Obfuscated Files or Information", 0.11460858611090453], ["Data Encrypted for Impact", 0.09760685703062663], ["Encrypted Channel", 0.08457243676511615], ["Weaken Encryption", 0.07985560060432388], ["Execution Guardrails", 0.055469135881118785]], "observed the RC4 key\nUwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and\ndecryption.": [["Deobfuscate/Decode Files or Information", 0.46241884051933607], ["Encrypted Channel", 0.14297611476134006], ["Obfuscated Files or Information", 0.06538811013739476], ["Data Encrypted for Impact", 0.049712951939805856], ["Weaken Encryption", 0.03289781791321915], ["Execution Guardrails", 0.028707292200560917]], "RC4-decrypts command data returned in\nthe Data field.": [["Deobfuscate/Decode Files or Information", 0.5723016453342478], ["Obfuscated Files or Information", 0.11313057825302082], ["Data Encoding", 0.0444055660119617], ["Encrypted Channel", 0.03839594945620794], ["Archive Collected Data", 0.03319168939873779], ["Data Encrypted for Impact", 0.017674265253486938]], "The dropper configures\nthe backdoor with a C2 server address, RC4 encryption key,": [["Deobfuscate/Decode Files or Information", 0.08996388876226273], ["Obfuscated Files or Information", 0.07800035718589125], ["Execution Guardrails", 0.06250552255889064], ["Modify Registry", 0.05425372758727659], ["Rootkit", 0.030714773450619175], ["Indicator Removal", 0.028925794307896484]], "Base64-decodes": [["Deobfuscate/Decode Files or Information", 0.4514590235552733], ["Data Encoding", 0.20629892701235383], ["Obfuscated Files or Information", 0.18920749795872152], ["Archive Collected Data", 0.02823734175664799], ["Data Obfuscation", 0.018050342944749605], ["Encrypted Channel", 0.01447083099908237]], "decryption.": [["Deobfuscate/Decode Files or Information", 0.6168060478894181], ["Data Encrypted for Impact", 0.07556868110522211], ["Archive Collected Data", 0.06667485102889681], ["Obfuscated Files or Information", 0.0437040840792342], ["Weaken Encryption", 0.025498189657324137], ["Encrypted Channel", 0.02375442808269491]], "decrypt the\nData field.": [["Deobfuscate/Decode Files or Information", 0.30086580993437395], ["Archive Collected Data", 0.11028943071019863], ["Data Encrypted for Impact", 0.10857330589261675], ["Obfuscated Files or Information", 0.06508601545833448], ["Weaken Encryption", 0.06275044328039558], ["Encrypted Channel", 0.04059575158813472]], "decrypts and executes in memory": [["Deobfuscate/Decode Files or Information", 0.6941648159074079], ["Obfuscated Files or Information", 0.0632438612097238], ["Data Encrypted for Impact", 0.03741414419390705], ["Archive Collected Data", 0.02716769405354572], ["Encrypted Channel", 0.02412395936336015], ["Weaken Encryption", 0.014231499974954685]], "embedded key to decrypt the source code": [["Deobfuscate/Decode Files or Information", 0.4984826366613329], ["Obfuscated Files or Information", 0.13666116754394544], ["Data Encrypted for Impact", 0.0747888181970493], ["Weaken Encryption", 0.03676816750450147], ["Execution Guardrails", 0.03574083858547093], ["Encrypted Channel", 0.02749613210153675]], "the deobfuscated SMOKEDHAM dropper.": [["Obfuscated Files or Information", 0.30342980281737664], ["Deobfuscate/Decode Files or Information", 0.2559300985998469], ["Masquerading", 0.04640413674082198], ["Hide Artifacts", 0.036813824259889105], ["Archive Collected Data", 0.02880604793231976], ["Indicator Removal", 0.0241430762633244]], "Upload a screen capture to its C2\nserver": [["Screen Capture", 0.6605681016072175], ["Video Capture", 0.0804225898464892], ["Exfiltration Over C2 Channel", 0.014164695728446258], ["Archive Collected Data", 0.012254005791091756], ["Automated Exfiltration", 0.010147233204041834], ["Input Capture", 0.009854043608772482]], "The backdoor writes captured\nkeystrokes to memory and uploads them to its C2 server": [["Input Capture", 0.5398051918327345], ["Screen Capture", 0.04644412066386241], ["Credentials from Password Stores", 0.01832468436662131], ["Deobfuscate/Decode Files or Information", 0.01738015908194144], ["Automated Exfiltration", 0.016891730503620306], ["Automated Collection", 0.016519798250554333]], "reg.exe add\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run": [["Boot or Logon Autostart Execution", 0.3182430938720543], ["System Binary Proxy Execution", 0.06446532032872841], ["Query Registry", 0.06296657425987152], ["Create or Modify System Process", 0.056849058544873904], ["Masquerading", 0.0556404690858952], ["Event Triggered Execution", 0.04645987788843462]], "created a persistence mechanism for NGROK by adding\nVirtualHost.vbs to the WindNT value under the current users Run\nregistry key.": [["Boot or Logon Autostart Execution", 0.08212420562018616], ["Create or Modify System Process", 0.07487553055862066], ["Scheduled Task/Job", 0.0581775786932898], ["Event Triggered Execution", 0.05176124679781058], ["Boot or Logon Initialization Scripts", 0.04908417508597088], ["Office Application Startup", 0.03887432099620018]], "created a persistence mechanism for UltraVNC by adding the\napplication to the ConhostNT value under the current users Run\nregistry key.": [["Boot or Logon Autostart Execution", 0.18582536908893252], ["Event Triggered Execution", 0.1229611504978226], ["Create or Modify System Process", 0.06443578836881104], ["Scheduled Task/Job", 0.05799467276375984], ["Boot or Logon Initialization Scripts", 0.04131929531661586], ["External Remote Services", 0.03481004836819922]], "store\na file named update.lnk in the %APPDATA%\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\ directory": [["Boot or Logon Autostart Execution", 0.38066551808758925], ["Masquerading", 0.06795531224435646], ["Boot or Logon Initialization Scripts", 0.052310582029412266], ["Modify Registry", 0.051371218711326994], ["Create or Modify System Process", 0.04682189751769141], ["Event Triggered Execution", 0.04293427070542935]], "the command line argument\nprovided": [["Command and Scripting Interpreter", 0.16201383177589684], ["System Information Discovery", 0.08006697502508128], ["Native API", 0.07416856313722309], ["File and Directory Discovery", 0.05806699885907756], ["Virtualization/Sandbox Evasion", 0.05673500561852673], ["Query Registry", 0.047271079797485294]], "passed as an argument on the\ncommand line.": [["Command and Scripting Interpreter", 0.2091340814205237], ["Native API", 0.11697965491613385], ["Indirect Command Execution", 0.07064683231118246], ["System Binary Proxy Execution", 0.03332799055726241], ["System Services", 0.02271726432475246], ["Obfuscated Files or Information", 0.021547901677564676]], "executed using the Command-Line Compiler.": [["Obfuscated Files or Information", 0.1002906169769248], ["Trusted Developer Utilities Proxy Execution", 0.05518514722491157], ["Deobfuscate/Decode Files or Information", 0.05155534304047467], ["Command and Scripting Interpreter", 0.047623735568065956], ["XSL Script Processing", 0.047032975466376914], ["Native API", 0.03879188192495554]], "launched with a command\nline": [["Command and Scripting Interpreter", 0.4526292333193813], ["System Binary Proxy Execution", 0.08529581288119847], ["System Services", 0.07034183567759007], ["Native API", 0.05142106436537469], ["Indirect Command Execution", 0.03613731684374811], ["Boot or Logon Autostart Execution", 0.032010049793386085]], "using Command Prompt.": [["Command and Scripting Interpreter", 0.3578791956343833], ["Indicator Removal", 0.03158973851041409], ["Windows Management Instrumentation", 0.02505981229051394], ["Indirect Command Execution", 0.021246133090649977], ["OS Credential Dumping", 0.02006815651696303], ["Masquerading", 0.019696797074351683]], "backdoor source code is embedded as an encrypted\nstring.": [["Obfuscated Files or Information", 0.6400793337045309], ["Deobfuscate/Decode Files or Information", 0.10853319156602242], ["Encrypted Channel", 0.01681868803143446], ["Execution Guardrails", 0.014793433178715884], ["Data Encrypted for Impact", 0.013584143264034367], ["Archive Collected Data", 0.012387702362747437]], "systeminfo.exe": [["System Information Discovery", 0.4103232969308985], ["Windows Management Instrumentation", 0.09452074610346879], ["Software Discovery", 0.05342920825297862], ["Process Discovery", 0.04984986600217075], ["File and Directory Discovery", 0.039213008077914696], ["Native API", 0.03878197098081474]], "reg.exe ADD\n'HKLM\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList": [["Account Discovery", 0.1812474125104571], ["System Owner/User Discovery", 0.07436636057367428], ["Query Registry", 0.071175828968275], ["Boot or Logon Autostart Execution", 0.05348110795257879], ["Modify Registry", 0.048680068694538295], ["Permission Groups Discovery", 0.037337612467178816]], "modifying\nTerminal Server registry key values": [["Modify Registry", 0.5162937027824045], ["Boot or Logon Autostart Execution", 0.12837321409822583], ["Query Registry", 0.11677997955043655], ["Boot or Logon Initialization Scripts", 0.021925026284942757], ["Event Triggered Execution", 0.017820594316352214], ["Create or Modify System Process", 0.011803949393748563]], "modifying the Local Security Authority (LSA)\nregistry key value": [["Modify Registry", 0.22959209749096965], ["Domain Policy Modification", 0.16420562531412233], ["Boot or Logon Autostart Execution", 0.0631841509678114], ["Abuse Elevation Control Mechanism", 0.0596251253019591], ["Query Registry", 0.05951696790652528], ["Impair Defenses", 0.05445286989221285]], "reg.exe ADD\n'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server' /v\nfDenyTSConnections /t REG_DWORD /d 0 /f": [["Event Triggered Execution", 0.0769316601540603], ["Traffic Signaling", 0.07223752826564425], ["System Network Connections Discovery", 0.07104394319885783], ["Remote Services", 0.04910159456073296], ["Command and Scripting Interpreter", 0.03975404791262599], ["Impair Defenses", 0.03926460066402152]], "reg.exe ADD\n'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server' /v\nfSingleSessionPerUser /t REG_DWORD /d 0 /f": [["Boot or Logon Autostart Execution", 0.11043352591325624], ["Event Triggered Execution", 0.10577219617137372], ["Modify Registry", 0.09423793835345078], ["Abuse Elevation Control Mechanism", 0.08625990647797291], ["Access Token Manipulation", 0.06133001382307443], ["Query Registry", 0.05150514574228235]], "reg.exe ADD\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v\nLimitBlankPasswordUse /t REG_DWORD /d 1 /f": [["Modify Authentication Process", 0.1261108374571901], ["Modify Registry", 0.06972512760732065], ["Brute Force", 0.06455556934118307], ["Password Policy Discovery", 0.05573303116303226], ["Abuse Elevation Control Mechanism", 0.03944203609541078], ["Use Alternate Authentication Material", 0.035904068935963165]], "modified the WDigest registry key value\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential\nto enable credential caching.": [["OS Credential Dumping", 0.1253589595223001], ["Modify Authentication Process", 0.065289379067718], ["Modify Registry", 0.06464502007486726], ["Boot or Logon Autostart Execution", 0.05026406969130913], ["Boot or Logon Initialization Scripts", 0.04949232604686247], ["Account Access Removal", 0.04582121152170559]], "to enable multiple Remote Desktop\nconnection sessions": [["Remote Services", 0.35372723611705775], ["Remote Service Session Hijacking", 0.22853673382056586], ["Remote Access Software", 0.09631590193458875], ["External Remote Services", 0.017573029210909388], ["Event Triggered Execution", 0.01717300729957726], ["System Network Connections Discovery", 0.012015713027603955]], "the attacker was observed moving laterally to\ndifferent systems in the environment using Remote Desktop Protocol\n(RDP) connections.": [["Remote Services", 0.3382186870052344], ["Remote Service Session Hijacking", 0.16026933225077825], ["Exploitation of Remote Services", 0.13611721114469646], ["Remote Access Software", 0.03286557836454917], ["Valid Accounts", 0.02385042872400625], ["External Remote Services", 0.021945159968786362]], "attacker dump the LSASS process using Task\nManager to a file named lsass.DMP, and later, zip the dump into two\nfiles named lsass.zip and lsass2.zip located in the\nC:\\ProgramData\\psh\\ directory.": [["OS Credential Dumping", 0.22443771816148256], ["Process Discovery", 0.14150464298664242], ["Indicator Removal", 0.050049572547490644], ["File and Directory Discovery", 0.033089028166527985], ["Process Injection", 0.029809689935570684], ["System Information Discovery", 0.029629349063668153]], "LSASS Dumping": [["OS Credential Dumping", 0.21517434358328982], ["Data from Local System", 0.1078210160939455], ["Automated Collection", 0.09517123792379713], ["File and Directory Discovery", 0.08598237454316568], ["Native API", 0.043947481851819944], ["Data Staged", 0.03700443502855374]], "conducted credential harvesting\nvia dumping LSASS memory.": [["OS Credential Dumping", 0.763393253908257], ["Credentials from Password Stores", 0.0424551961241683], ["Unsecured Credentials", 0.021027880507977856], ["Brute Force", 0.010247072401820873], ["Input Capture", 0.008687702613209353], ["Network Sniffing", 0.007271400346036903]], "activity from Tor": [["Proxy", 0.08195621524425596], ["Impair Defenses", 0.05465030157801326], ["System Network Connections Discovery", 0.04899579767203161], ["System Network Configuration Discovery", 0.04457345716769853], ["Application Layer Protocol", 0.03814911221098091], ["Network Sniffing", 0.03527329374154752]], "hop points to enable their cyber operations while remaining anonymous.": [["Acquire Infrastructure", 0.12549103212269053], ["Compromise Infrastructure", 0.1099735185102059], ["Proxy", 0.08440399584585355], ["Establish Accounts", 0.03039447691413471], ["Gather Victim Identity Information", 0.025989257466460424], ["Masquerading", 0.022487404887075704]], "\u201cThe Onion Router\u201d (Tor) is often used by cyber threat actors for anonymity and C2.": [["Proxy", 0.4608667017854105], ["Protocol Tunneling", 0.06008592235412476], ["Encrypted Channel", 0.038902583949410784], ["Application Layer Protocol", 0.03800416338945743], ["Data Obfuscation", 0.035634370948507854], ["Dynamic Resolution", 0.023021073250431744]], "resulted in confirmed compromises of internet-facing Federal Government agency systems.": [["Compromise Infrastructure", 0.17316203603013827], ["Acquire Infrastructure", 0.044921570854345456], ["Search Open Technical Databases", 0.04187788479300533], ["Gather Victim Network Information", 0.041269395088791176], ["Obtain Capabilities", 0.03468877692356644], ["Exploit Public-Facing Application", 0.034166174929053696]], "the actors leveraging CVE-2019-19781 to compromise Citrix Application Delivery Controllers.": [["Exploitation for Client Execution", 0.2421071694581244], ["Exploit Public-Facing Application", 0.15187840660320276], ["Exploitation of Remote Services", 0.11390086321023468], ["Obtain Capabilities", 0.03847335962024095], ["Develop Capabilities", 0.038303591915368654], ["Exploitation for Privilege Escalation", 0.03677297714443731]], "attack of a Remote Desktop Protocol on a public-facing server.": [["Remote Services", 0.1838337362631339], ["Remote Access Software", 0.06814280284317548], ["Exploitation of Remote Services", 0.06384315926703536], ["Remote Service Session Hijacking", 0.03689721767235615], ["External Remote Services", 0.03680711670700106], ["Proxy", 0.02419654759894014]], "cyber threat actors using external proxy tools": [["Proxy", 0.5454159882352724], ["Compromise Infrastructure", 0.07962780432361953], ["Application Layer Protocol", 0.035107387391137626], ["Fallback Channels", 0.016350104620528272], ["Protocol Tunneling", 0.015975818406500624], ["Network Denial of Service", 0.015226800985459312]], "These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.": [["Proxy", 0.5408054861304548], ["Compromise Infrastructure", 0.026409797789252114], ["Data Obfuscation", 0.02354931310679595], ["Protocol Tunneling", 0.023163267484019787], ["Acquire Infrastructure", 0.017920000645608215], ["Application Layer Protocol", 0.016847806091518182]], "proxy tools depending on their intended use.": [["Proxy", 0.6193336725752242], ["Application Layer Protocol", 0.0352650529496741], ["Protocol Tunneling", 0.0282344078025522], ["Fallback Channels", 0.019927090533828094], ["Compromise Infrastructure", 0.019524402999232682], ["Data Obfuscation", 0.017785127098491577]], "activity from a network proxy tool": [["Proxy", 0.3150116175383], ["Network Sniffing", 0.0548587669825732], ["Adversary-in-the-Middle", 0.04429306713651455], ["System Network Configuration Discovery", 0.04217932647788441], ["Impair Defenses", 0.03571466146918615], ["Application Layer Protocol", 0.03140843885470271]], "Cyber threat actors also continue to identify large repositories of credentials that are available on the internet to enable brute-force attacks.": [["Brute Force", 0.3267165648200806], ["Gather Victim Identity Information", 0.11308088533807792], ["Phishing for Information", 0.03813557383456565], ["Multi-Factor Authentication Interception", 0.030418375292047297], ["Credentials from Password Stores", 0.030233536410880817], ["Unsecured Credentials", 0.025915813994541195]], "brute-force passwords.": [["Brute Force", 0.5333178966617164], ["Modify Authentication Process", 0.04655690756026466], ["Credentials from Password Stores", 0.04106867187205546], ["Password Policy Discovery", 0.035681267089667505], ["Input Capture", 0.02903635281064589], ["Multi-Factor Authentication Interception", 0.024931849142024336]], "threat actors using Mimikatz in conjunction with coin miner protocols and software.": [["Resource Hijacking", 0.21664111992864987], ["Automated Collection", 0.03015467677965658], ["Steal or Forge Kerberos Tickets", 0.0279950771213248], ["Exfiltration Over Alternative Protocol", 0.0209419601350676], ["Impair Defenses", 0.016972848082815004], ["Automated Exfiltration", 0.01640644303075314]], "The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool.": [["OS Credential Dumping", 0.48743878321870965], ["Unsecured Credentials", 0.17775012636169543], ["Credentials from Password Stores", 0.17019940428381122], ["Input Capture", 0.01877059968801651], ["Brute Force", 0.0167516952920726], ["Network Sniffing", 0.011024444752361499]], "the actors using Mimikatz during their operations.": [["Video Capture", 0.04113165558936552], ["Masquerading", 0.03154979602606537], ["Remote Services", 0.030830476400686813], ["Remote Access Software", 0.026083731845058224], ["Input Capture", 0.02107651676325459], ["Valid Accounts", 0.0204186393007331]], "a brute-force attack of a Remote Desktop Protocol on a public-facing server.": [["Brute Force", 0.37204120323914225], ["Remote Services", 0.07481722081286382], ["Steal or Forge Kerberos Tickets", 0.0349741945764393], ["Remote Access Software", 0.020927828263428917], ["Endpoint Denial of Service", 0.019244356036744546], ["Valid Accounts", 0.017224702690883265]], "such as a keystroke logger": [["Input Capture", 0.8654282381933627], ["Credentials from Password Stores", 0.007924648300125249], ["Screen Capture", 0.005451785275331161], ["Clipboard Data", 0.004871813400306987], ["Unsecured Credentials", 0.0045070845082540055], ["Video Capture", 0.004084675348129783]], "file injection capability": [["Process Injection", 0.17783892341206198], ["Native API", 0.07538837620811717], ["Ingress Tool Transfer", 0.061394105643197805], ["System Binary Proxy Execution", 0.04596736127997242], ["Hijack Execution Flow", 0.04460395571701058], ["Obfuscated Files or Information", 0.04092054245928071]], "actors to execute directory traversal attacks": [["File and Directory Discovery", 0.13950345695699712], ["Hijack Execution Flow", 0.05336621097902787], ["Ingress Tool Transfer", 0.04423735432337776], ["Native API", 0.03435294410535825], ["Masquerading", 0.028036104653152046], ["System Binary Proxy Execution", 0.022376839668914895]], "or delete files": [["Indicator Removal", 0.6473875379502342], ["Data Destruction", 0.10554540842614692], ["System Shutdown/Reboot", 0.023023878314305433], ["Inhibit System Recovery", 0.02247596353126979], ["Disk Wipe", 0.021639161048403126], ["Service Stop", 0.012833317236990417]], "allows cyber threat actors to execute arbitrary system commands,": [["Command and Scripting Interpreter", 0.0936883840758728], ["Event Triggered Execution", 0.043540477751354466], ["Indirect Command Execution", 0.0413709533503957], ["Develop Capabilities", 0.038343467015731485], ["Domain Policy Modification", 0.03716114969253578], ["Abuse Elevation Control Mechanism", 0.0342253599083364]], "concealed programs and documents at innocuous-seeming locations on victim networks and in victim networks\u2019 \u201crecycle bins.\u201d": [["Hide Artifacts", 0.19193364346751537], ["Masquerading", 0.0646650117099724], ["Data Staged", 0.060579019257718164], ["Indicator Removal", 0.055250392148537955], ["Archive Collected Data", 0.03486220110896395], ["Inhibit System Recovery", 0.02933582265603935]], "The lures are designed to socially engineer the recipient to download and open an attached RAR file that contains either a Microsoft Compiled HTML Help (CHM) or Excel payload.": [["User Execution", 0.4566250977804028], ["Phishing", 0.11645751346764203], ["Template Injection", 0.03628159326529904], ["Phishing for Information", 0.03299072488817457], ["Web Service", 0.02173165322732744], ["Masquerading", 0.02138951210429267]], "phishing emails that were used as lures to deliver the files": [["Phishing", 0.5120972183080369], ["User Execution", 0.1563045863096251], ["Phishing for Information", 0.058199745033090125], ["Gather Victim Identity Information", 0.017396891919607686], ["Acquire Infrastructure", 0.01712133908399657], ["Internal Spearphishing", 0.014979597159511322]], "download further malware payloads": [["Ingress Tool Transfer", 0.6442137059283196], ["BITS Jobs", 0.05199339449791967], ["Command and Scripting Interpreter", 0.050535332760618466], ["Application Layer Protocol", 0.01557789448193121], ["Obtain Capabilities", 0.013699585037060587], ["Web Service", 0.009600271306316454]], "to download a next stage EXE payload using cURL": [["Ingress Tool Transfer", 0.38509455793493363], ["Command and Scripting Interpreter", 0.12732443141098634], ["Application Layer Protocol", 0.03973034087192726], ["BITS Jobs", 0.03599036284273296], ["Deobfuscate/Decode Files or Information", 0.027763426818012932], ["Native API", 0.024083191764083176]], "downloading of the next stage.": [["Ingress Tool Transfer", 0.40857805510041567], ["BITS Jobs", 0.043331871074382355], ["Multi-Stage Channels", 0.03787123321154106], ["Data Staged", 0.032338085831459105], ["Fallback Channels", 0.02590075930785778], ["Command and Scripting Interpreter", 0.02194982462438251]], "One scheduled task (shown below) runs every 15 minutes": [["Scheduled Task/Job", 0.7553479483287845], ["Inter-Process Communication", 0.023564264660356875], ["Masquerading", 0.021857571226347332], ["Command and Scripting Interpreter", 0.014283488193557875], ["Indicator Removal", 0.007912719831044588], ["Virtualization/Sandbox Evasion", 0.007324850683424895]], "\"C:\\Windows\\System32\\schtasks.exe\" /create /sc MINUTE /mo 15 /TN": [["System Time Discovery", 0.2091829658891271], ["Scheduled Task/Job", 0.16485636485142743], ["Indicator Removal", 0.10879709959534437], ["Virtualization/Sandbox Evasion", 0.05225463408417912], ["Masquerading", 0.051807416009894525], ["OS Credential Dumping", 0.01721781029531262]], "creates two different scheduled tasks.": [["Scheduled Task/Job", 0.7277392913564523], ["Inter-Process Communication", 0.04109912078600503], ["Masquerading", 0.024701732654444145], ["Command and Scripting Interpreter", 0.014215122081402876], ["Create or Modify System Process", 0.00984103948105985], ["System Services", 0.00892903158759596]], "Scheduled task": [["Scheduled Task/Job", 0.7881314924750389], ["Inter-Process Communication", 0.03795978105664849], ["Command and Scripting Interpreter", 0.01821277754007875], ["Masquerading", 0.015191027692752608], ["System Services", 0.008580851523579052], ["Create or Modify System Process", 0.006158965095817448]], "The second scheduled task created attempts to execute the payload downloaded by the other task:\u00a0\n\"C:\\Windows\\System32\\schtasks.exe\" /create /sc MINUTE /mo 20 /TN": [["Scheduled Task/Job", 0.6887197833356545], ["Inter-Process Communication", 0.04570687591183909], ["Masquerading", 0.03173676718366804], ["Command and Scripting Interpreter", 0.01091966324975117], ["System Binary Proxy Execution", 0.009502928168153159], ["Process Discovery", 0.008996004228639828]], "create a scheduled task": [["Scheduled Task/Job", 0.8149333571760659], ["Inter-Process Communication", 0.041241307805217974], ["Masquerading", 0.015140281114220406], ["Command and Scripting Interpreter", 0.01372611539144565], ["System Services", 0.0066172253112183445], ["Create or Modify System Process", 0.005921964100935918]], "\"C:\\Windows\\System32\\schtasks.exe\" /create /sc minute /mo 15 /tn": [["System Time Discovery", 0.2091829658891271], ["Scheduled Task/Job", 0.16485636485142743], ["Indicator Removal", 0.10879709959534437], ["Virtualization/Sandbox Evasion", 0.05225463408417912], ["Masquerading", 0.051807416009894525], ["OS Credential Dumping", 0.01721781029531262]], "used to create scheduled tasks for persistence": [["Scheduled Task/Job", 0.8370017017749478], ["Inter-Process Communication", 0.026946114521010672], ["Create or Modify System Process", 0.018929351143388957], ["Command and Scripting Interpreter", 0.010239210688071185], ["Event Triggered Execution", 0.008212509459998678], ["Boot or Logon Autostart Execution", 0.006595245723682479]], "schtasks /create /tn WinSecurity /sc minute /mo 15": [["System Time Discovery", 0.2670298558956123], ["Scheduled Task/Job", 0.201121267048523], ["Virtualization/Sandbox Evasion", 0.06331236540551409], ["Indicator Removal", 0.050114665270404396], ["OS Credential Dumping", 0.020989888965192115], ["Process Discovery", 0.017248897704454542]], "These payloads are compressed inside RAR files, this helps avoid static analysis techniques": [["Obfuscated Files or Information", 0.6710133960581762], ["Deobfuscate/Decode Files or Information", 0.09755289691413811], ["Archive Collected Data", 0.024979763672135055], ["Data Encoding", 0.012118879048649467], ["Execution Guardrails", 0.011606479615465097], ["Hijack Execution Flow", 0.011206598130884085]], "The more common payloads contained within the RAR files are Microsoft Compiled HTML Help (CHM) files": [["Obfuscated Files or Information", 0.13248282971325984], ["Template Injection", 0.09046847500262649], ["Deobfuscate/Decode Files or Information", 0.08970820532091577], ["Masquerading", 0.05312560115537559], ["Web Service", 0.0312985897524178], ["Office Application Startup", 0.030646789005014816]], "The computer name": [["System Information Discovery", 0.49716628088321574], ["Remote System Discovery", 0.08189263211233275], ["System Owner/User Discovery", 0.03760726776293351], ["System Network Configuration Discovery", 0.035317303639609735], ["Windows Management Instrumentation", 0.01921912048394545], ["Network Share Discovery", 0.015838121658419985]], "the computer name is sent to the C2": [["System Information Discovery", 0.31060980517381304], ["System Owner/User Discovery", 0.0870497838021118], ["System Network Configuration Discovery", 0.05371691962470348], ["Remote System Discovery", 0.049987112166553854], ["Automated Collection", 0.038982962055789876], ["Dynamic Resolution", 0.03435095250111201]], "the username is also sent to the C2.": [["System Owner/User Discovery", 0.7222378509749673], ["Account Discovery", 0.04604644174608072], ["Exfiltration Over C2 Channel", 0.017323714708589635], ["System Information Discovery", 0.009730255196647645], ["Web Service", 0.007843702634220842], ["Data Encoding", 0.006997040890090618]], "The computer name and the username is also sent to the C2.": [["System Owner/User Discovery", 0.39374557436188584], ["System Information Discovery", 0.09560177245576577], ["Exfiltration Over C2 Channel", 0.07090367247190286], ["Automated Collection", 0.03907934120568322], ["Web Service", 0.025628955278208212], ["System Network Configuration Discovery", 0.021038816471405968]], "plugins such as a keylogger,": [["Input Capture", 0.8873943536298172], ["Credentials from Password Stores", 0.006238320419794832], ["Clipboard Data", 0.004926802937481113], ["Boot or Logon Autostart Execution", 0.004307752812231752], ["Screen Capture", 0.0039819241323735925], ["Unsecured Credentials", 0.0037940336929812957]], "remote access tool": [["Remote Access Software", 0.21479627800449894], ["Remote Services", 0.18401156106270974], ["External Remote Services", 0.058492897746278305], ["Valid Accounts", 0.05555365381060107], ["Software Deployment Tools", 0.0431969130224017], ["Exploitation of Remote Services", 0.03099779500337192]], "file stealer": [["Data from Local System", 0.16693358021848473], ["File and Directory Discovery", 0.07323825373750403], ["Data Staged", 0.0620705368480799], ["Data from Network Shared Drive", 0.057247514913794116], ["Ingress Tool Transfer", 0.046405538230592486], ["Hide Artifacts", 0.03992236271788597]], "an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.": [["Obfuscated Files or Information", 0.6932312833591032], ["Data Encoding", 0.0436534864117147], ["Masquerading", 0.04065219002043607], ["Data Obfuscation", 0.033125253424551415], ["Deobfuscate/Decode Files or Information", 0.025577268179329364], ["Encrypted Channel", 0.013397543037700244]], "Encoded PowerShell command": [["Obfuscated Files or Information", 0.31817051815742886], ["Command and Scripting Interpreter", 0.1766179492568588], ["Deobfuscate/Decode Files or Information", 0.09849977447418352], ["Data Encoding", 0.0634469100222055], ["Native API", 0.018554724829272104], ["Encrypted Channel", 0.01722822237653422]], "The decoded command": [["Deobfuscate/Decode Files or Information", 0.6521638824941686], ["Obfuscated Files or Information", 0.13341336517161875], ["Data Encoding", 0.05144147710861169], ["Archive Collected Data", 0.015683234238909997], ["Encrypted Channel", 0.01467973176382255], ["Data Obfuscation", 0.008530343931641718]], "threat actors obtain initial access to networks is through the use of compromised valid credential pairs": [["Valid Accounts", 0.2848774045365485], ["External Remote Services", 0.061677801416756134], ["Brute Force", 0.0529638636219786], ["Exploitation for Credential Access", 0.036823311023664936], ["Modify Authentication Process", 0.03100532616565796], ["Account Manipulation", 0.03016857137775095]], "often will search for directories on the network": [["File and Directory Discovery", 0.4647736294121922], ["Remote System Discovery", 0.08649586024500323], ["Network Share Discovery", 0.07778724354152024], ["Data from Network Shared Drive", 0.04499536619120229], ["Automated Collection", 0.037388963666800154], ["Data from Local System", 0.026603649478014847]], "remote desktop protocol (RDP) and secure shell (SSH) accesses": [["Remote Services", 0.6265318966760142], ["Remote Service Session Hijacking", 0.046688260818835106], ["External Remote Services", 0.037882100311757885], ["Remote Access Software", 0.037275524336071286], ["Exploitation of Remote Services", 0.021885264061979385], ["Valid Accounts", 0.020983191275746816]], "Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers": [["Exploitation of Remote Services", 0.10385027483677149], ["Remote Services", 0.10134940642301071], ["External Remote Services", 0.04241924886071603], ["Remote Access Software", 0.04221985210301483], ["Remote System Discovery", 0.03837878621549422], ["Develop Capabilities", 0.03801251314230711]], "Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.": [["External Remote Services", 0.16857053852676668], ["Remote Services", 0.10356612588681857], ["Exploitation of Remote Services", 0.061267238151568475], ["Remote Access Software", 0.05603650078031492], ["Valid Accounts", 0.05567635216284057], ["Software Deployment Tools", 0.03524122026155671]], "use brute force password attacks": [["Brute Force", 0.6777829451450985], ["Modify Authentication Process", 0.030899679444501216], ["Credentials from Password Stores", 0.02338150830012113], ["Password Policy Discovery", 0.02112466041659616], ["Use Alternate Authentication Material", 0.01942143099574229], ["OS Credential Dumping", 0.0180011738500341]], "The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER": [["Application Layer Protocol", 0.44126111076671254], ["Non-Standard Port", 0.05444959038491427], ["Non-Application Layer Protocol", 0.030621062766867296], ["Data Obfuscation", 0.02499663496865538], ["Data Encoding", 0.02392062790614105], ["Network Sniffing", 0.02277926950365972]], "The threat actor also engaged in brute-forcing against the victim's internal web services": [["Brute Force", 0.13431971386789815], ["Endpoint Denial of Service", 0.06364105258266355], ["Exploit Public-Facing Application", 0.05970396621191127], ["Compromise Infrastructure", 0.056137332293161105], ["Gather Victim Identity Information", 0.044220963394051016], ["Network Denial of Service", 0.03305771294542416]], "brute forcing tool called FSCAN.": [["Brute Force", 0.46856491372788317], ["OS Credential Dumping", 0.034834511952063704], ["Multi-Factor Authentication Interception", 0.03129486304282591], ["Steal or Forge Kerberos Tickets", 0.024151799035154877], ["Data Encrypted for Impact", 0.01734838004057313], ["Use Alternate Authentication Material", 0.01705331985397385]], "brute-force attacks on systems": [["Brute Force", 0.6177248319584995], ["Multi-Factor Authentication Interception", 0.028131931983684126], ["Steal or Forge Kerberos Tickets", 0.020156656296762786], ["Endpoint Denial of Service", 0.014789477237672774], ["Use Alternate Authentication Material", 0.014195801796881237], ["Modify Authentication Process", 0.012885357350492229]], "brute forcing attempts on some of the internal FTP servers inside victim network": [["Brute Force", 0.26491195469858336], ["Steal or Forge Kerberos Tickets", 0.03097979966730999], ["Exfiltration Over Alternative Protocol", 0.030777809041369487], ["Network Denial of Service", 0.027515098269098148], ["Endpoint Denial of Service", 0.024760201821445286], ["Fallback Channels", 0.0204439080568575]], "The database used a weak password and was susceptible to brute-force attacks.": [["Brute Force", 0.29182231807528053], ["Steal or Forge Kerberos Tickets", 0.04245145804177501], ["OS Credential Dumping", 0.02690584878212551], ["Use Alternate Authentication Material", 0.024884147128804036], ["Password Policy Discovery", 0.019144067014393775], ["Gather Victim Identity Information", 0.018646668040931846]], "threat actor used the Windows command-line arguments": [["Command and Scripting Interpreter", 0.31289715590039285], ["Windows Management Instrumentation", 0.07287281941725525], ["System Binary Proxy Execution", 0.05389483647639223], ["Masquerading", 0.048695492091463226], ["Native API", 0.03851007475579065], ["Indirect Command Execution", 0.03298154109240117]], "received a command-line argument from attacker": [["Command and Scripting Interpreter", 0.12590908058934627], ["Native API", 0.08427379052180489], ["Indirect Command Execution", 0.03675497780140365], ["Execution Guardrails", 0.031407498179093586], ["Obfuscated Files or Information", 0.026668977022465734], ["Virtualization/Sandbox Evasion", 0.021623529598878952]], "Used to search for the string \"DBPath\" in all files within the current directory and its subdirectories": [["File and Directory Discovery", 0.7681403518308096], ["Data Staged", 0.024204684226421875], ["Automated Collection", 0.016473837038885282], ["Data from Local System", 0.014828031433045218], ["Data from Network Shared Drive", 0.009115984095026583], ["Native API", 0.007748737160914467]], "List of recently opened files and folders on the computer.": [["File and Directory Discovery", 0.6561104677698427], ["Data from Local System", 0.04338891699479462], ["Indicator Removal", 0.027156178921906807], ["Data Staged", 0.02320140491085471], ["Automated Collection", 0.019419688763145166], ["Hide Artifacts", 0.018793810215108887]], "The threat actor uses stolen passwords from valid accounts": [["Brute Force", 0.31417630339305463], ["Modify Authentication Process", 0.1056161475519177], ["Credentials from Password Stores", 0.06734950566533324], ["Valid Accounts", 0.062039132250552236], ["OS Credential Dumping", 0.0569545620070378], ["Password Policy Discovery", 0.04436341111053765]], "to escalate privileges using valid accounts": [["Abuse Elevation Control Mechanism", 0.1918979702740553], ["Exploitation for Privilege Escalation", 0.0957362859224361], ["Valid Accounts", 0.08347335534860656], ["Create Account", 0.0820148465827272], ["Access Token Manipulation", 0.07379181056578409], ["Account Manipulation", 0.07012255622438983]], "the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.": [["System Network Configuration Discovery", 0.1903297381112801], ["Proxy", 0.08599112909595083], ["System Network Connections Discovery", 0.08497597286648784], ["Adversary-in-the-Middle", 0.058672123665656675], ["Network Sniffing", 0.05248415405478323], ["Non-Application Layer Protocol", 0.04554110256293733]], "After establishing the reverse SOCKS proxy connection,": [["Proxy", 0.47826892843977437], ["Protocol Tunneling", 0.07828719058393503], ["Application Layer Protocol", 0.05489558833004671], ["Non-Application Layer Protocol", 0.047106397727373746], ["Non-Standard Port", 0.029311112312943574], ["Data Obfuscation", 0.02328651517198403]], "The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.": [["Proxy", 0.37818380825230963], ["Network Boundary Bridging", 0.13006446239948843], ["Protocol Tunneling", 0.03763232562478617], ["Exploit Public-Facing Application", 0.02972273455157457], ["Dynamic Resolution", 0.023893601773217858], ["Adversary-in-the-Middle", 0.02291439723795636]], "Execution of FRP reverse SOCKS proxy on infected host.": [["Proxy", 0.5843214307512027], ["Protocol Tunneling", 0.06204022222307566], ["Application Layer Protocol", 0.0337356727415886], ["Non-Application Layer Protocol", 0.030399675756824143], ["Adversary-in-the-Middle", 0.02160733006397455], ["Non-Standard Port", 0.019068431793303572]], "Installation of malicious Windows service.": [["Create or Modify System Process", 0.2642804475446191], ["Masquerading", 0.1353490390462689], ["System Services", 0.10539522159187646], ["System Binary Proxy Execution", 0.066894482630168], ["System Service Discovery", 0.04452365758380765], ["Hijack Execution Flow", 0.04035002511681287]], "it will install a fake Windows service called \u201cwindowsupdate\u201d": [["Create or Modify System Process", 0.22002410090707075], ["Masquerading", 0.18455797843552715], ["Event Triggered Execution", 0.0418774682736755], ["Scheduled Task/Job", 0.03556612504417682], ["Boot or Logon Autostart Execution", 0.028506635022844486], ["System Service Discovery", 0.025208005741341903]], "Malicious service installation is accomplished via the below command line argument:\nsc create WindowsUpdate binPath= C:\\Windows\\Temp\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate": [["Create or Modify System Process", 0.6414448663488684], ["System Services", 0.10812644636073258], ["Masquerading", 0.052843679700276355], ["System Service Discovery", 0.024046302587992882], ["Hijack Execution Flow", 0.01761415869658722], ["Boot or Logon Autostart Execution", 0.011666395220905523]], "Maintain Presence via Windows Service Installation": [["Create or Modify System Process", 0.49198486877896347], ["System Services", 0.10692780048250747], ["Masquerading", 0.042107292699341374], ["Scheduled Task/Job", 0.03387389784641912], ["Event Triggered Execution", 0.03212694148229168], ["Boot or Logon Autostart Execution", 0.027528854772453964]], "To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload": [["Remote Services", 0.12929303499771475], ["Remote Access Software", 0.0989075543213545], ["Scheduled Task/Job", 0.04407573291654921], ["Event Triggered Execution", 0.04317177262957014], ["Exploitation of Remote Services", 0.04266634782441988], ["System Services", 0.03378849029506298]], "installed a second stage persistence backdoor on infected device by abusing Windows Services.": [["Pre-OS Boot", 0.18512277213557293], ["Boot or Logon Autostart Execution", 0.1734242675417348], ["Create or Modify System Process", 0.12105745041038875], ["Event Triggered Execution", 0.07095489133900898], ["Modify Registry", 0.03893331389819995], ["Boot or Logon Initialization Scripts", 0.035112684237272075]], "This service executes a malicious binary (Cobalt Strike Cat payload) under \u201cC:\\Windows\\Temp\\svchost.exe\u201d every time the victim device is started.": [["Create or Modify System Process", 0.36917508294291523], ["System Services", 0.1908130692609361], ["Masquerading", 0.06745844335467505], ["System Service Discovery", 0.04016862812099753], ["Scheduled Task/Job", 0.023768062390097298], ["Event Triggered Execution", 0.022798305139305777]], "Windows services ran with the highest privilege, NT AUTHORITY\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.": [["Create or Modify System Process", 0.1619152191559008], ["System Services", 0.08411164249509806], ["Pre-OS Boot", 0.06496834331054534], ["Event Triggered Execution", 0.06333686706123727], ["Boot or Logon Autostart Execution", 0.056817174114541596], ["Scheduled Task/Job", 0.04220990514765317]], "the threat actor used private proxy addresses from a Chinese underground proxy IP solution called 'Tigercloud Club' to conceal their real IP address.": [["Proxy", 0.2617367883195614], ["Dynamic Resolution", 0.0779234527738053], ["System Network Configuration Discovery", 0.04842173411848605], ["Network Denial of Service", 0.04782295747278403], ["Compromise Infrastructure", 0.03487170767184264], ["Adversary-in-the-Middle", 0.03291588601599478]], "Reverse proxy tool": [["Proxy", 0.6078059348087493], ["Application Layer Protocol", 0.030916419716593], ["Protocol Tunneling", 0.026820195160052858], ["Compromise Infrastructure", 0.021723074902209313], ["Fallback Channels", 0.021612259186816293], ["Data Obfuscation", 0.020722479961116307]], "Threat actor uploaded the fast reverse proxy (FRP) binary": [["Proxy", 0.30466816747582304], ["Application Layer Protocol", 0.04587377926199042], ["Fallback Channels", 0.04420939616962426], ["Data Obfuscation", 0.03374177899360031], ["Adversary-in-the-Middle", 0.026946773950376045], ["System Network Configuration Discovery", 0.026028451167816703]], "One of the main initial access vector is exploitation of publicly exposed web services.": [["Exploit Public-Facing Application", 0.1487961432244209], ["Server Software Component", 0.11668734294289686], ["Compromise Infrastructure", 0.11263134313280643], ["Drive-by Compromise", 0.07868035788520947], ["Acquire Infrastructure", 0.05802664232572369], ["Stage Capabilities", 0.056481736685381465]], "Initial Compromise Through Exploiting Publicly Facing Applications": [["Drive-by Compromise", 0.23409982446158487], ["Exploit Public-Facing Application", 0.09078902266909801], ["Compromise Infrastructure", 0.05520839997044872], ["Phishing", 0.04796531489209833], ["Obtain Capabilities", 0.046649623733275455], ["Develop Capabilities", 0.0420174602933903]], "the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:\u2022 \u00a0 \u00a0CVE-2023-21839 \u00a0 \u00a0 \u00a0Oracle WebLogic Server RCE [13]\u2022 \u00a0 \u00a0CVE-2021-3129 \u00a0 \u00a0 \u00a0Laravel debug mode RCE [14]\u2022 \u00a0 \u00a0CVE-2020-2551 \u00a0 \u00a0 \u00a0Oracle WebLogic RCE [15]\u2022 \u00a0 \u00a0CVE-2021-44228 \u00a0 \u00a0 Apache Log4j [16]": [["Exploitation for Client Execution", 0.4797405796641088], ["Exploitation of Remote Services", 0.1449711177913503], ["Exploit Public-Facing Application", 0.1240676105278297], ["Exploitation for Privilege Escalation", 0.030481344515827704], ["Obtain Capabilities", 0.029313409360613385], ["Develop Capabilities", 0.01807827187171393]], "the victim IP address was publicly serving a web service that contained a phpMyAdmin database.": [["Compromise Infrastructure", 0.11867985221868861], ["Endpoint Denial of Service", 0.06669868187637515], ["Acquire Infrastructure", 0.06445142010285719], ["Server Software Component", 0.06316312881791997], ["Exploit Public-Facing Application", 0.056083545132784886], ["Web Service", 0.042221873163529045]], "The threat actor primarily focused on exploiting four different remote code execution (RCE) vulnerabilities to target web services": [["Exploit Public-Facing Application", 0.4186547373943404], ["Exploitation for Client Execution", 0.1479409143977788], ["Obtain Capabilities", 0.03552359858681552], ["Drive-by Compromise", 0.03536990716622083], ["Endpoint Denial of Service", 0.02706933897506315], ["Compromise Infrastructure", 0.024686804305927082]], "Decrypting and exporting browser data": [["Deobfuscate/Decode Files or Information", 0.30425947979488616], ["Archive Collected Data", 0.1458378432898807], ["Credentials from Password Stores", 0.07618270840811267], ["Obfuscated Files or Information", 0.05315186582209432], ["Exfiltration Over Alternative Protocol", 0.024467103754920123], ["Data Encoding", 0.024207752237708074]], "the decryption key for the ZIP folder and access the tool": [["Deobfuscate/Decode Files or Information", 0.4355440234038736], ["Archive Collected Data", 0.19906152402496186], ["Obfuscated Files or Information", 0.07811338738489661], ["Data Encrypted for Impact", 0.049518087665735754], ["File and Directory Discovery", 0.015285404897804482], ["Execution Guardrails", 0.01340967371066043]], "distributed inside an encrypted ZIP folder.": [["Archive Collected Data", 0.3144322493929209], ["Obfuscated Files or Information", 0.17125370609374344], ["Exfiltration Over Alternative Protocol", 0.056975264699688936], ["Data Encrypted for Impact", 0.038558727069448184], ["Data Staged", 0.03067083999913702], ["Deobfuscate/Decode Files or Information", 0.02231795336681193]], "executed the \"tasklist /SVC\" command to list all running processes on the victim device.": [["Process Discovery", 0.6931181921774077], ["System Service Discovery", 0.024713533206897165], ["Windows Management Instrumentation", 0.023214289693553915], ["Software Discovery", 0.019530684852664473], ["System Information Discovery", 0.017059413543489874], ["Virtualization/Sandbox Evasion", 0.012429114980567315]], "deleted the LaZagne binary after execution to avoid detection from the user's side.": [["Indicator Removal", 0.21608419550186472], ["Obfuscated Files or Information", 0.05450854408882979], ["Deobfuscate/Decode Files or Information", 0.04960728344908386], ["Hijack Execution Flow", 0.037873107213646735], ["Masquerading", 0.036669949101584644], ["Impair Defenses", 0.03187369525172013]], "The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actor\u00b4s system to the victim.": [["Ingress Tool Transfer", 0.1226294785841991], ["BITS Jobs", 0.04581289330700253], ["Obtain Capabilities", 0.03592479820676475], ["Hijack Execution Flow", 0.030529963766721624], ["Compromise Client Software Binary", 0.028578214013747612], ["Command and Scripting Interpreter", 0.02839128266591255]], "Recording keystrokes in real time with offline logging available": [["Input Capture", 0.7900086481547545], ["Video Capture", 0.022736159069834515], ["Screen Capture", 0.017506989424457577], ["Audio Capture", 0.011719231212385153], ["Clipboard Data", 0.006722461035346179], ["Network Sniffing", 0.006136423708933009]], "Downloading files remotely": [["Ingress Tool Transfer", 0.6449599543188459], ["Application Layer Protocol", 0.03380267648676152], ["Command and Scripting Interpreter", 0.026521866127055867], ["Lateral Tool Transfer", 0.02484351721309994], ["Web Service", 0.018245239042910272], ["BITS Jobs", 0.013520863195773038]], "the dropper then downloads a custom XMRig miner": [["Ingress Tool Transfer", 0.06513748514618962], ["Deobfuscate/Decode Files or Information", 0.06382375654412771], ["Command and Scripting Interpreter", 0.05759460831671524], ["Resource Hijacking", 0.047810460171826004], ["BITS Jobs", 0.04187626546381168], ["Automated Collection", 0.0381093684772387]], "a script to download, configure and execute": [["Ingress Tool Transfer", 0.363544425938922], ["Command and Scripting Interpreter", 0.34303092192348117], ["BITS Jobs", 0.026777881195306042], ["System Binary Proxy Execution", 0.02527470408822532], ["Web Service", 0.01896944720468491], ["Scheduled Task/Job", 0.009443153047474052]], "to download the XMRig payload.": [["Ingress Tool Transfer", 0.21636378544086363], ["BITS Jobs", 0.08235586383994455], ["Deobfuscate/Decode Files or Information", 0.0781660269418982], ["Command and Scripting Interpreter", 0.06483849668157758], ["System Binary Proxy Execution", 0.040995432201635026], ["Archive Collected Data", 0.015678852837322427]], "pulls the XMRig payload": [["Deobfuscate/Decode Files or Information", 0.12167307135521306], ["Command and Scripting Interpreter", 0.06300671005905213], ["Native API", 0.052944643311567764], ["System Binary Proxy Execution", 0.05283392167068883], ["XSL Script Processing", 0.040104118941079694], ["Virtualization/Sandbox Evasion", 0.040026377611356675]], "generating a script to decode the legitimate Mach-O file.": [["Deobfuscate/Decode Files or Information", 0.6300153358470062], ["Obfuscated Files or Information", 0.16796687951477837], ["Archive Collected Data", 0.04280716073408422], ["Data Encoding", 0.016320608419607918], ["Masquerading", 0.006646167277552699], ["Data Encrypted for Impact", 0.006527304163645093]], "is decoded and unarchived": [["Deobfuscate/Decode Files or Information", 0.8146794853953289], ["Obfuscated Files or Information", 0.04778074148494227], ["Archive Collected Data", 0.02234370435755011], ["Data Encoding", 0.012364912639825695], ["Encrypted Channel", 0.005420720030943403], ["Data Encrypted for Impact", 0.0045398826475808625]], "This value is decoded": [["Deobfuscate/Decode Files or Information", 0.4931497098684075], ["Data Encoding", 0.15865080144906843], ["Obfuscated Files or Information", 0.1382743258652224], ["Encrypted Channel", 0.026788235283872155], ["Data Obfuscation", 0.01764837962822768], ["Archive Collected Data", 0.012946172806875617]], "The Logic Pro X dropper binary is deleted with the /tmp/ bundle": [["Indicator Removal", 0.43466247733420055], ["Masquerading", 0.0350157674223465], ["Deobfuscate/Decode Files or Information", 0.030638300487614144], ["Rootkit", 0.02949956791749821], ["Inhibit System Recovery", 0.022726873279046884], ["Hide Artifacts", 0.021933609949319383]], "In order to unpack the legitimate binary,": [["Deobfuscate/Decode Files or Information", 0.502478253607264], ["Obfuscated Files or Information", 0.1588907804886306], ["Hijack Execution Flow", 0.037048792848621614], ["Masquerading", 0.025465388611365374], ["System Binary Proxy Execution", 0.016816740754189326], ["Archive Collected Data", 0.015009629187390227]], "binary unpacks a customized Mach-O": [["Obfuscated Files or Information", 0.4314220196724474], ["Deobfuscate/Decode Files or Information", 0.1753793352619238], ["Hijack Execution Flow", 0.03482173251797478], ["Masquerading", 0.021172048527135286], ["System Binary Proxy Execution", 0.019923764928117094], ["Command and Scripting Interpreter", 0.015820923481382223]], "previously written Base64 file": [["Deobfuscate/Decode Files or Information", 0.2715400675490751], ["Obfuscated Files or Information", 0.26144813603661504], ["Archive Collected Data", 0.10447379875908061], ["Data Encoding", 0.06019116984174302], ["Data Encrypted for Impact", 0.017244745336179156], ["Data Obfuscation", 0.014612078515824776]], "Files are dropped/downloaded as Base64-encoded archives.": [["Archive Collected Data", 0.19376188806395875], ["Deobfuscate/Decode Files or Information", 0.12193267926847592], ["Ingress Tool Transfer", 0.06435907945725838], ["Exfiltration Over Alternative Protocol", 0.06078057758009964], ["Obfuscated Files or Information", 0.05785521517093611], ["Data from Local System", 0.04057405482727534]], "The script first deletes itself from the disk.": [["Indicator Removal", 0.5769849079246483], ["Data Destruction", 0.08417686598467082], ["Command and Scripting Interpreter", 0.03993556931905217], ["Disk Wipe", 0.02694538971251443], ["System Shutdown/Reboot", 0.020876360922664428], ["Inhibit System Recovery", 0.02045975571024809]], "removes any files": [["Indicator Removal", 0.729288215012586], ["Data Destruction", 0.06521668366285328], ["Inhibit System Recovery", 0.022518392544364954], ["Disk Wipe", 0.021761373669559145], ["System Shutdown/Reboot", 0.013863668144332457], ["Command and Scripting Interpreter", 0.006810034131215046]], "deleted every time": [["Indicator Removal", 0.6109066654610887], ["Data Destruction", 0.09885063843954078], ["Inhibit System Recovery", 0.02940596637675583], ["Modify Registry", 0.010821833965666085], ["System Shutdown/Reboot", 0.01029710355490297], ["Data Staged", 0.00860461828367246]], "The script then removes any files": [["Indicator Removal", 0.7291760614534721], ["Data Destruction", 0.04110793802643126], ["Command and Scripting Interpreter", 0.03049449892563916], ["Inhibit System Recovery", 0.00850492371699683], ["File and Directory Discovery", 0.008245136485254243], ["Masquerading", 0.0075093326619722275]], "script removes the i2pd Mach-O file from the disk.": [["Indicator Removal", 0.35104089421640283], ["Data Destruction", 0.0893568704634425], ["Disk Wipe", 0.05671419202023344], ["Inhibit System Recovery", 0.048450568376401215], ["Service Stop", 0.018110549121171944], ["System Shutdown/Reboot", 0.017901538563372732]], "Even though the scripts produce many on-disk artifacts, the dropper and scripts are quick to remove them": [["Indicator Removal", 0.5579446940010623], ["Inhibit System Recovery", 0.05082318167027424], ["Data Destruction", 0.03419539927511809], ["Hide Artifacts", 0.02773739506599478], ["Disk Wipe", 0.01931372998048054], ["Modify Registry", 0.016062211193727093]], "Files are deleted after use.": [["Indicator Removal", 0.6208409629298817], ["Data Destruction", 0.10706939172813176], ["Inhibit System Recovery", 0.02983209029328111], ["Data Staged", 0.015974111548436146], ["File and Directory Discovery", 0.012372021089657221], ["Disk Wipe", 0.010750297007064065]], "to proxy the miner\u2019s network communications.": [["Proxy", 0.25325577112438913], ["Protocol Tunneling", 0.04433903496127643], ["Adversary-in-the-Middle", 0.044224863904543874], ["Data Obfuscation", 0.03510954098379611], ["Non-Application Layer Protocol", 0.03469116585408656], ["Fallback Channels", 0.02580565295671255]], "mining proxy.": [["Proxy", 0.21516273285621149], ["Fallback Channels", 0.032439289503221024], ["Application Layer Protocol", 0.030549538142149946], ["Compromise Infrastructure", 0.03046872632923989], ["Protocol Tunneling", 0.02661774099131035], ["Acquire Infrastructure", 0.025677738352812122]], "The usage of a proxy allows authors to control all of their mining implants and their target pools via a centralized console": [["Proxy", 0.28650744029530545], ["Fallback Channels", 0.05357791005266921], ["Compromise Infrastructure", 0.03738298145339327], ["Acquire Infrastructure", 0.028541355890364873], ["Dynamic Resolution", 0.02819128540049983], ["Resource Hijacking", 0.02437232952648663]], "the mining proxy": [["Proxy", 0.12582514678921575], ["Resource Hijacking", 0.09707164515194769], ["Acquire Infrastructure", 0.03196824980635758], ["Fallback Channels", 0.027422438881766518], ["Compromise Infrastructure", 0.026175285548685413], ["Data Obfuscation", 0.023305282850439993]], "command line arguments": [["Command and Scripting Interpreter", 0.46245930862393725], ["Native API", 0.07079030991239575], ["Indirect Command Execution", 0.07038199401893827], ["System Binary Proxy Execution", 0.02323536948276538], ["System Services", 0.015383502283436294], ["Obfuscated Files or Information", 0.01414244664607083]], "is executed as a command line argument": [["Command and Scripting Interpreter", 0.25579303489963845], ["Indirect Command Execution", 0.1344732875725065], ["Native API", 0.131947661488838], ["System Binary Proxy Execution", 0.06492172090049847], ["System Services", 0.052066855207582294], ["Event Triggered Execution", 0.024669813677584876]], "The padded i2pd Mach-O file": [["Obfuscated Files or Information", 0.16410708253646847], ["Deobfuscate/Decode Files or Information", 0.08252943679686191], ["Archive Collected Data", 0.07889666241095107], ["Automated Collection", 0.05673161401892694], ["File and Directory Discovery", 0.04042919715315521], ["Data from Local System", 0.040016873621118484]], "pads the resulting Mach-O with a random number of \\x00 bytes": [["Obfuscated Files or Information", 0.2737361660201209], ["Data Transfer Size Limits", 0.041320983279560665], ["Data Obfuscation", 0.03146889378824674], ["Virtualization/Sandbox Evasion", 0.029013235154220777], ["Deobfuscate/Decode Files or Information", 0.026868575223018106], ["Disk Wipe", 0.02132820644130069]], "binaries are padded with a random number of zero bytes to change its hash and expand its size.": [["Obfuscated Files or Information", 0.5889773182532108], ["Deobfuscate/Decode Files or Information", 0.02580436961103642], ["Data Encoding", 0.01995203446599258], ["Data Obfuscation", 0.01616542189841656], ["Data Transfer Size Limits", 0.012983222090685016], ["Adversary-in-the-Middle", 0.011963478117480594]], "is padded with a random number of \\x00 bytes.": [["Obfuscated Files or Information", 0.44555077709491697], ["Data Transfer Size Limits", 0.0596595934024077], ["Data Encoding", 0.0503424314699957], ["Data Obfuscation", 0.025404849523162555], ["Archive Collected Data", 0.01751103816956411], ["Encrypted Channel", 0.01595358828766924]], "the user will continue to execute the dropper": [["Indicator Removal", 0.055855708400805885], ["Event Triggered Execution", 0.04897189854751925], ["System Binary Proxy Execution", 0.04430354430517876], ["Command and Scripting Interpreter", 0.038519940283486716], ["Rootkit", 0.03444750342751738], ["Deobfuscate/Decode Files or Information", 0.03259631009165611]], "The dropper is executed by the user.": [["Indicator Removal", 0.07937198862603516], ["Rootkit", 0.05371066161795383], ["System Binary Proxy Execution", 0.043357158937409934], ["Deobfuscate/Decode Files or Information", 0.040913018006847664], ["Masquerading", 0.03412185962751401], ["Hide Artifacts", 0.03184149640711992]], "As long as the dropper successfully launches its legitimate application": [["Event Triggered Execution", 0.084401580595797], ["Hijack Execution Flow", 0.0831384513038232], ["System Binary Proxy Execution", 0.07839790420639828], ["Masquerading", 0.057099597871003445], ["Native API", 0.04518076013170473], ["Process Injection", 0.04373418011770871]], "The dropper bundle in the applications folder appears legitimate,": [["Masquerading", 0.25414975161109793], ["Hijack Execution Flow", 0.10462210554950369], ["System Binary Proxy Execution", 0.058958848565796404], ["Hide Artifacts", 0.04185367037848486], ["Create or Modify System Process", 0.037380151017358074], ["Compromise Client Software Binary", 0.02936909126084576]], "The authors cleverly utilized these legitimate dependencies via symbolic links when dynamically creating the legitimate bundle in the temp folder.": [["Hijack Execution Flow", 0.35746768838481163], ["Masquerading", 0.07097416561302906], ["Shared Modules", 0.059091139402191704], ["System Binary Proxy Execution", 0.0394409025883834], ["Create or Modify System Process", 0.01997654395350865], ["Compromise Client Software Binary", 0.019495362070559217]], "The dropper is installed into a legitimate file path, posing as the legitimate application.": [["Masquerading", 0.20691213573804842], ["Hijack Execution Flow", 0.1656210931340218], ["System Binary Proxy Execution", 0.08547976340477972], ["XSL Script Processing", 0.03382886728390705], ["Process Injection", 0.033807416552689144], ["Native API", 0.032692192121184856]], "utilize legitimate file paths to mask their execution.": [["Masquerading", 0.28684904121559723], ["Hide Artifacts", 0.18165718281761775], ["Hijack Execution Flow", 0.11507059731067011], ["Obfuscated Files or Information", 0.050377868636381], ["System Binary Proxy Execution", 0.04274394473808081], ["Rootkit", 0.02689105615819743]], "In order to appear as a working copy of Logic Pro X, the dropper contains a legitimate copy of the lure application": [["Masquerading", 0.10098904756373786], ["System Binary Proxy Execution", 0.041637335710034314], ["User Execution", 0.03465694525822811], ["Office Application Startup", 0.02889026106054365], ["Compromise Client Software Binary", 0.027545370459977975], ["Hijack Execution Flow", 0.02535056410923675]], "The mirrored bundle contains the legitimate application instead of the dropper binary.": [["Hijack Execution Flow", 0.22995321957873338], ["Masquerading", 0.1691817630891805], ["Compromise Client Software Binary", 0.049675966101253244], ["System Binary Proxy Execution", 0.0421882234891848], ["Process Injection", 0.035933426786453296], ["Hide Artifacts", 0.0329025508715536]], "to mirror all directories found in /Applications/Logic Pro X.app/Contents and /Applications/Logic Pro X.app/Contents/MacOS to their respective /tmp/ locations": [["File and Directory Discovery", 0.11002825732971949], ["Data Staged", 0.09483252109748842], ["Data from Local System", 0.08037831975493949], ["Automated Collection", 0.047039639290000296], ["Indicator Removal", 0.043417855668683364], ["Automated Exfiltration", 0.039300870602203414]], "The malicious dropper contains a legitimate version of the software and executes it to give the illusion of a properly behaving application.": [["Masquerading", 0.18394149748307656], ["Hijack Execution Flow", 0.17763386843709708], ["System Binary Proxy Execution", 0.07983339976685393], ["Process Injection", 0.047664271065190056], ["Compromise Client Software Binary", 0.03331152677659556], ["XSL Script Processing", 0.029808877532349235]], "a check using pgrep for Activity Monitor processes": [["Process Discovery", 0.7962069527987736], ["Virtualization/Sandbox Evasion", 0.023738857828997175], ["Impair Defenses", 0.018279143980685843], ["System Service Discovery", 0.01786082243321924], ["Software Discovery", 0.014195050624166521], ["Native API", 0.009335487344754789]], "This proxy server is located on the I2P network at the destination of the pool tunnel": [["Proxy", 0.410349073217701], ["Protocol Tunneling", 0.08940163441925132], ["Fallback Channels", 0.03937458781337609], ["Non-Application Layer Protocol", 0.024736602247216223], ["Application Layer Protocol", 0.023772440903650386], ["Adversary-in-the-Middle", 0.023201084364161448]], "config via the XMRig miner\u2019s native API.": [["Resource Hijacking", 0.05674287401159279], ["Modify Registry", 0.050751266016331564], ["Create or Modify System Process", 0.035784667546063804], ["Deobfuscate/Decode Files or Information", 0.03177428429379359], ["Query Registry", 0.03133782649051309], ["Windows Management Instrumentation", 0.027569249689079284]], "By modifying the below registry value EnableLUA to \u201c0\u201d": [["Modify Registry", 0.17212834287922427], ["Impair Defenses", 0.0978357860402288], ["Boot or Logon Autostart Execution", 0.06927591463777061], ["Abuse Elevation Control Mechanism", 0.06457943813751588], ["Rootkit", 0.03252125342726838], ["Hide Artifacts", 0.03126566885271439]], "The ConsentPromptBehaviorAdmin key has been set to \u201c0\u201d, indicating that the behavior of the consent prompt for actions requiring administrator privileges has been modified": [["Abuse Elevation Control Mechanism", 0.22035940553994005], ["Domain Policy Modification", 0.14521669734374248], ["Subvert Trust Controls", 0.06013455036893927], ["Access Token Manipulation", 0.03724055769884187], ["Use Alternate Authentication Material", 0.034864520563383496], ["Impair Defenses", 0.028235833570450165]], "the ransomware modifies specific registry values": [["Modify Registry", 0.5095146124857061], ["Query Registry", 0.08698629281453542], ["Boot or Logon Autostart Execution", 0.0661670586653951], ["Impair Defenses", 0.02152606959164226], ["File and Directory Permissions Modification", 0.020400224068070166], ["Masquerading", 0.01984342123692274]], "malware aims to deactivate User Account Control (UAC) on the target system": [["Abuse Elevation Control Mechanism", 0.3310803393318], ["File and Directory Permissions Modification", 0.07506329848534597], ["Account Access Removal", 0.0678311740265577], ["Impair Defenses", 0.04096515287454641], ["Domain Policy Modification", 0.03279351622581304], ["Create Account", 0.031080607294633834]], "UAC BYPASS": [["Abuse Elevation Control Mechanism", 0.6621140692807659], ["Access Token Manipulation", 0.03729224478093471], ["Exploitation for Privilege Escalation", 0.022721489696753295], ["Domain Policy Modification", 0.021894221824677762], ["File and Directory Permissions Modification", 0.015139881266287803], ["Use Alternate Authentication Material", 0.011082277556744053]], "to disable User Access Control (UAC), a security feature in Windows": [["Abuse Elevation Control Mechanism", 0.5328020522038973], ["File and Directory Permissions Modification", 0.09344785549229542], ["Impair Defenses", 0.04458425629156157], ["Domain Policy Modification", 0.029202650783199925], ["Access Token Manipulation", 0.021834327568963665], ["Exploitation for Privilege Escalation", 0.014186796307346006]], "By deactivating UAC, the ransomware gets elevated privileges without requiring user permission or administrator credentials": [["Abuse Elevation Control Mechanism", 0.5570469026467847], ["File and Directory Permissions Modification", 0.07108320846317362], ["Access Token Manipulation", 0.03023161014350026], ["Domain Policy Modification", 0.020800096505566766], ["Valid Accounts", 0.01656487387903953], ["Exploitation for Privilege Escalation", 0.013918441689846127]], "After bypassing UAC": [["Abuse Elevation Control Mechanism", 0.5982199378486506], ["Access Token Manipulation", 0.048036028893977026], ["File and Directory Permissions Modification", 0.03650502775353628], ["Event Triggered Execution", 0.01629252256086964], ["Domain Policy Modification", 0.015361098714849397], ["Create or Modify System Process", 0.013125637916215592]], "the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions": [["File and Directory Discovery", 0.3180513434146596], ["Data Encrypted for Impact", 0.08724780633753379], ["Automated Collection", 0.03889164646873298], ["Masquerading", 0.03186464839339496], ["Deobfuscate/Decode Files or Information", 0.027531910991143625], ["System Information Discovery", 0.0249058226914247]], "using the FindFirstFileW() and FindNextFileW() API functions.": [["File and Directory Discovery", 0.5356744560387704], ["Automated Collection", 0.05711030393667169], ["Data Staged", 0.049979121027805926], ["Data from Local System", 0.040033938224537484], ["Data from Removable Media", 0.02190534720435207], ["Indicator Removal", 0.0199923677659101]], "the malware leverages various functions from the CryptoAPI, including CryptAcquireContextW(), CryptImportKey(), CryptSetKeyParam(), and CryptEncrypt().": [["Deobfuscate/Decode Files or Information", 0.16005531070229395], ["Data Encrypted for Impact", 0.14519840662306913], ["Obfuscated Files or Information", 0.1149965387752832], ["Encrypted Channel", 0.10886942680026512], ["Weaken Encryption", 0.09616110513172597], ["Archive Collected Data", 0.035180759715280445]], "using the MoveFileExW() API function,": [["Indicator Removal", 0.0588039843158126], ["Data Manipulation", 0.05534438553303878], ["Hide Artifacts", 0.04775947607112521], ["Masquerading", 0.03506279815827068], ["Process Injection", 0.022436649305878614], ["Command and Scripting Interpreter", 0.020902235381555764]], "to search and identify accessible volumes on the targeted system.": [["File and Directory Discovery", 0.46608249355233833], ["Network Share Discovery", 0.06744390673712171], ["System Information Discovery", 0.05737929749146778], ["Peripheral Device Discovery", 0.04172001634623008], ["Data from Local System", 0.031538636419853494], ["Data from Network Shared Drive", 0.021311695516535223]], "the malware proceeds to identify files and directories for encryption by iterating through them": [["Data Encrypted for Impact", 0.21202122278507768], ["Obfuscated Files or Information", 0.1927595353282286], ["Deobfuscate/Decode Files or Information", 0.11346566476511016], ["Archive Collected Data", 0.09824548613043196], ["File and Directory Discovery", 0.08476156563842953], ["Execution Guardrails", 0.02316300887569615]], "This function scans a specified path by finding all files within the given directory and its subdirectories.": [["File and Directory Discovery", 0.762341839764564], ["Automated Collection", 0.03762367893179871], ["Data from Local System", 0.02369313799189294], ["Data Staged", 0.01399391002011038], ["Data from Network Shared Drive", 0.012439445582817663], ["Native API", 0.010343641787517954]], "then iterates over each volume to search for specific files related to virtual machines.": [["File and Directory Discovery", 0.4644022469946998], ["Virtualization/Sandbox Evasion", 0.05687707139153381], ["Data from Local System", 0.05432646180050958], ["System Information Discovery", 0.037874075402731855], ["Hide Artifacts", 0.03585589191802902], ["Automated Collection", 0.03214867248248089]], "This function scans VM volumes on an ESXi server.": [["Virtualization/Sandbox Evasion", 0.2252598479371659], ["File and Directory Discovery", 0.1626867649645873], ["System Information Discovery", 0.07885538688979724], ["Network Share Discovery", 0.061211825552924974], ["Automated Collection", 0.04022182010047249], ["Data from Local System", 0.03522989712407426]], "scanning files in a specified or generic path": [["File and Directory Discovery", 0.47402464263937727], ["Automated Collection", 0.10777068166524693], ["Data from Local System", 0.052169688522861184], ["Data Staged", 0.042326175412018434], ["Data from Network Shared Drive", 0.02561684562561731], ["Masquerading", 0.01952404060303585]], "then iterates over each volume to find files": [["File and Directory Discovery", 0.530098364030215], ["Data from Local System", 0.07160657716079312], ["Data from Removable Media", 0.055006457543278216], ["Data from Network Shared Drive", 0.04347611890983353], ["Automated Collection", 0.032849749601048604], ["Data Staged", 0.02662315362243322]], "command uses the Windows Management Instrumentation Command-line (WMIC)": [["Windows Management Instrumentation", 0.4970034241963044], ["System Information Discovery", 0.08124713542074952], ["Query Registry", 0.0402582969562804], ["Application Window Discovery", 0.03879794917466178], ["Native API", 0.029876561490728724], ["Virtualization/Sandbox Evasion", 0.026053075992488635]], "This function is responsible for deleting all files and directories in the user\u2019s trash folder.": [["Indicator Removal", 0.40726572136324096], ["Data Destruction", 0.18774740331815992], ["Disk Wipe", 0.034336731188357325], ["Inhibit System Recovery", 0.02962553893111511], ["Service Stop", 0.014940111918997362], ["System Shutdown/Reboot", 0.01416913870109439]], "by passing the file path to be encrypted as an argument.": [["Obfuscated Files or Information", 0.23629958313015226], ["Data Encrypted for Impact", 0.19526895143974962], ["Archive Collected Data", 0.1513219161861352], ["Deobfuscate/Decode Files or Information", 0.12208984064841137], ["Encrypted Channel", 0.03421222715192932], ["Execution Guardrails", 0.022488280804871297]], "It removes log files and temporary files from the root directory.": [["Indicator Removal", 0.7096924390907591], ["Data Destruction", 0.04198392897315332], ["Inhibit System Recovery", 0.03009217581621857], ["Disk Wipe", 0.019035849413087357], ["System Shutdown/Reboot", 0.013604067527526145], ["Impair Defenses", 0.013179892708466898]], "It also deletes the ransomware, script file, and ransom note (index.html), ensuring that no evidence remains on the compromised system.": [["Indicator Removal", 0.36854091498127806], ["Data Destruction", 0.11929056011248175], ["Inhibit System Recovery", 0.07918912088863662], ["Data Encrypted for Impact", 0.049817806417682124], ["Disk Wipe", 0.035684603480841584], ["System Shutdown/Reboot", 0.030185786351110074]], "It uses the esxcli command to list all VM processes": [["Process Discovery", 0.5546349131598826], ["Virtualization/Sandbox Evasion", 0.11751567218481664], ["Native API", 0.025906947878071577], ["System Service Discovery", 0.0256307518389625], ["Software Discovery", 0.02489245466379164], ["System Information Discovery", 0.024759427610978865]], "configuring autorun entries,": [["Boot or Logon Autostart Execution", 0.4007014084887756], ["Create or Modify System Process", 0.08640923932603313], ["Boot or Logon Initialization Scripts", 0.08075312521138144], ["Modify Registry", 0.05880400741947373], ["Event Triggered Execution", 0.033277912171070415], ["Replication Through Removable Media", 0.03169262288206416]], "through legitimate remote access software such as AnyDesk": [["Remote Access Software", 0.3864766188994661], ["Remote Services", 0.09689824323832351], ["External Remote Services", 0.057954787462789], ["Software Deployment Tools", 0.046046480302612915], ["Valid Accounts", 0.026077636859665545], ["Exploitation of Remote Services", 0.017385047660051917]], "invoked the wave 2 ransomware immediately from the command line": [["Command and Scripting Interpreter", 0.28525344696233995], ["Data Encrypted for Impact", 0.08623548051494294], ["Masquerading", 0.04181302266352804], ["Ingress Tool Transfer", 0.037933161758401425], ["System Binary Proxy Execution", 0.03187255228314384], ["Deobfuscate/Decode Files or Information", 0.030229169456823565]], "both use CreateFile and WriteFile APIs": [["Data Staged", 0.07963368793496892], ["Native API", 0.07883463478066424], ["Hide Artifacts", 0.04895979361748238], ["Archive Collected Data", 0.04381672637149786], ["Ingress Tool Transfer", 0.041805250541872], ["Data from Local System", 0.033948684307584624]], "using DeviceControl API methods": [["Peripheral Device Discovery", 0.240779814094701], ["Pre-OS Boot", 0.05591684478555304], ["Windows Management Instrumentation", 0.03670006985921903], ["Weaken Encryption", 0.0297019951185336], ["Replication Through Removable Media", 0.026821756074432324], ["Modify System Image", 0.02111483838195468]], "use of the same DeviceControl API methods": [["Peripheral Device Discovery", 0.12994120884934643], ["Pre-OS Boot", 0.08456106559386949], ["Replication Through Removable Media", 0.04497590544581756], ["Windows Management Instrumentation", 0.029417710363748916], ["Modify System Image", 0.028225194721689596], ["Weaken Encryption", 0.027910511948654546]], "DeviceControl API methods": [["Peripheral Device Discovery", 0.21628734724916537], ["Pre-OS Boot", 0.06897013365542308], ["Windows Management Instrumentation", 0.0387670430154713], ["Weaken Encryption", 0.033725268779090475], ["Replication Through Removable Media", 0.02527658352822688], ["Modify System Image", 0.020341155021959066]], "ransomware attempts to decrypt": [["Data Encrypted for Impact", 0.4050001610116442], ["Deobfuscate/Decode Files or Information", 0.31959708930607916], ["Obfuscated Files or Information", 0.038508106919092996], ["Archive Collected Data", 0.03182548695999441], ["Execution Guardrails", 0.014923168431295193], ["Weaken Encryption", 0.013794570568665116]], "RC4 key for decryption": [["Deobfuscate/Decode Files or Information", 0.5817004126541944], ["Encrypted Channel", 0.08115483738351768], ["Data Encrypted for Impact", 0.06937643709262976], ["Weaken Encryption", 0.037094608395722505], ["Obfuscated Files or Information", 0.029624263373702213], ["Execution Guardrails", 0.02869440825472556]], "the RC4 decryption method uses CryptoAPI (CryptDecrypt) instead of the usual substitution box method": [["Deobfuscate/Decode Files or Information", 0.5536545338710477], ["Encrypted Channel", 0.09494298245836794], ["Obfuscated Files or Information", 0.07110977762721706], ["Data Encrypted for Impact", 0.0593812499870221], ["Archive Collected Data", 0.038842465113032874], ["Weaken Encryption", 0.030270531734884774]], "execute embedded scripts": [["Command and Scripting Interpreter", 0.25842699629087196], ["System Binary Proxy Execution", 0.19159320636356408], ["XSL Script Processing", 0.04986671752572626], ["Native API", 0.045417614019894754], ["Shared Modules", 0.03438990755556366], ["System Services", 0.02850805025674163]], "Embedding of EldoS RawDisk driver inside the wiper malware": [["Disk Wipe", 0.2174039427528771], ["Pre-OS Boot", 0.048376301625528015], ["Peripheral Device Discovery", 0.04091366420957745], ["Inhibit System Recovery", 0.03842920906086848], ["Data Destruction", 0.03682742449417287], ["Firmware Corruption", 0.03658269126406303]], "the threat actor embedded the signed raw disk driver in the wiper executable": [["Disk Wipe", 0.2343994393953561], ["System Shutdown/Reboot", 0.05945020785612457], ["Inhibit System Recovery", 0.058814676892765295], ["Pre-OS Boot", 0.047604963099102136], ["Data Destruction", 0.04473071087063024], ["Firmware Corruption", 0.03852767961697072]], "the raw disk driver was embedded inside the malware": [["Peripheral Device Discovery", 0.19450280169230996], ["Pre-OS Boot", 0.05568209845195363], ["Replication Through Removable Media", 0.05032760676026722], ["Exfiltration Over Physical Medium", 0.03280513056994839], ["Data from Removable Media", 0.032565757973173244], ["Virtualization/Sandbox Evasion", 0.031022878631942787]], "the download and launch of a suspicious batch file.": [["Command and Scripting Interpreter", 0.412306082421261], ["Ingress Tool Transfer", 0.11429808119510672], ["System Binary Proxy Execution", 0.10964007907338738], ["Scheduled Task/Job", 0.04909832468427822], ["Masquerading", 0.034388094129199444], ["BITS Jobs", 0.024924223186399627]], "the actor introduced a downloader to fetch and spawn the next stage payload": [["Ingress Tool Transfer", 0.35221430439261675], ["Command and Scripting Interpreter", 0.11494881354957172], ["BITS Jobs", 0.03929354697232551], ["Multi-Stage Channels", 0.03607804169828387], ["Deobfuscate/Decode Files or Information", 0.02733277402791514], ["System Binary Proxy Execution", 0.015557747632623468]], "the malicious document connects to the remote server and downloads the payload": [["Ingress Tool Transfer", 0.5734359788224426], ["Template Injection", 0.05892932543957432], ["Command and Scripting Interpreter", 0.05233469473371513], ["Inter-Process Communication", 0.024129363541097442], ["Application Layer Protocol", 0.014015942363795214], ["User Execution", 0.012352639109440726]], "install additional malware": [["Browser Extensions", 0.19901034541817822], ["Ingress Tool Transfer", 0.06824550386061147], ["Supply Chain Compromise", 0.042022211862926116], ["Obtain Capabilities", 0.0362913015282257], ["Software Discovery", 0.03332834331891369], ["Develop Capabilities", 0.030314088267770285]], "They then returned 18 hours later to install further malware": [["Indicator Removal", 0.03664704333120672], ["Compromise Infrastructure", 0.02744150882772678], ["Browser Extensions", 0.02635412823158467], ["User Execution", 0.024878263875826426], ["Command and Scripting Interpreter", 0.024171791185793674], ["Impair Defenses", 0.02378455670632742]], "when the malicious Word document opens it fetches the next payload from the remote server:": [["Template Injection", 0.21222919833614787], ["Command and Scripting Interpreter", 0.08127871469571452], ["Ingress Tool Transfer", 0.0728937392012452], ["User Execution", 0.058476846303892466], ["Inter-Process Communication", 0.05542641965041387], ["Office Application Startup", 0.0258457063503613]], "it fetched an additional script payload": [["Command and Scripting Interpreter", 0.3394455187781994], ["Ingress Tool Transfer", 0.11006283879752263], ["System Binary Proxy Execution", 0.0443549201468482], ["Native API", 0.04371195058610105], ["Deobfuscate/Decode Files or Information", 0.038722100136035324], ["Inter-Process Communication", 0.016216732270286794]], "a different method of fetching and executing the next stage payload": [["Ingress Tool Transfer", 0.11579826527936522], ["Command and Scripting Interpreter", 0.11040506756305264], ["Deobfuscate/Decode Files or Information", 0.05224499348835578], ["Multi-Stage Channels", 0.04967626156405892], ["Native API", 0.030410023901157334], ["Obfuscated Files or Information", 0.027891445233737665]], "a file downloaded from the internet,": [["Ingress Tool Transfer", 0.2523042980404889], ["Archive Collected Data", 0.06328652278773905], ["Data from Local System", 0.060610737586232324], ["Deobfuscate/Decode Files or Information", 0.04921664584844754], ["Automated Collection", 0.030916123088855243], ["Data from Network Shared Drive", 0.02532453485674533]], "fetch the next stage payload.": [["Ingress Tool Transfer", 0.08733211081387285], ["Multi-Stage Channels", 0.06876078899001428], ["Command and Scripting Interpreter", 0.04875305414043171], ["Deobfuscate/Decode Files or Information", 0.04652872111136605], ["Execution Guardrails", 0.033298882981488205], ["Virtualization/Sandbox Evasion", 0.03136069399956023]], "If the fetched data by cURL command": [["Automated Collection", 0.06700909940455164], ["Application Layer Protocol", 0.047175340837391125], ["Web Service", 0.033413818189917496], ["Exfiltration Over C2 Channel", 0.03315926310023022], ["System Network Configuration Discovery", 0.03227609397359748], ["Cloud Service Dashboard", 0.02811969724888853]], "Fetch the payload with cURL command": [["Application Layer Protocol", 0.07714337193489379], ["Ingress Tool Transfer", 0.06183162651988609], ["Deobfuscate/Decode Files or Information", 0.05105431109952925], ["Command and Scripting Interpreter", 0.05025224689876369], ["Data Encoding", 0.04307851302595262], ["Exfiltration Over C2 Channel", 0.04300343139213742]], "fetching the next stage payload": [["Ingress Tool Transfer", 0.08778833932882713], ["Multi-Stage Channels", 0.07690450784529328], ["Command and Scripting Interpreter", 0.06603867993898736], ["Deobfuscate/Decode Files or Information", 0.039702058090992746], ["Execution Guardrails", 0.033501298571604644], ["Virtualization/Sandbox Evasion", 0.0276804608269903]], "fetching a remote payload": [["Ingress Tool Transfer", 0.1636443738546848], ["Command and Scripting Interpreter", 0.09832702627996957], ["Deobfuscate/Decode Files or Information", 0.043265959040425475], ["Application Layer Protocol", 0.03853652178675848], ["Web Service", 0.029705664425051133], ["Inter-Process Communication", 0.022899418033314745]], "fetches a payload from the embedded URL and loads it.": [["Command and Scripting Interpreter", 0.07899770793630051], ["Ingress Tool Transfer", 0.05310986994357868], ["Template Injection", 0.049340103511796615], ["Browser Session Hijacking", 0.04587304187773344], ["User Execution", 0.040419695137011755], ["System Binary Proxy Execution", 0.040183635198316976]], "launch of a suspicious batch file.": [["Command and Scripting Interpreter", 0.2405847750734728], ["Scheduled Task/Job", 0.1188877016364085], ["System Binary Proxy Execution", 0.10075576069717092], ["System Services", 0.06284271721086336], ["Boot or Logon Autostart Execution", 0.05305248787601144], ["Masquerading", 0.03825204427639788]], "Windows Batch script": [["Command and Scripting Interpreter", 0.7232954287656891], ["Scheduled Task/Job", 0.03569833219985124], ["System Binary Proxy Execution", 0.01960954038034906], ["Windows Management Instrumentation", 0.01799589719375472], ["Indicator Removal", 0.009351700282745784], ["Inter-Process Communication", 0.008118734494031192]], "the operator executed several Windows commands": [["Native API", 0.21336749714288228], ["Command and Scripting Interpreter", 0.20565272010865968], ["Indirect Command Execution", 0.04599900860938566], ["Windows Management Instrumentation", 0.0420962017305269], ["Event Triggered Execution", 0.03808717383991332], ["System Binary Proxy Execution", 0.02586357262512935]], "cmd.exe /c": [["Command and Scripting Interpreter", 0.16781719469262], ["Native API", 0.1287862846004426], ["System Binary Proxy Execution", 0.0818180231744525], ["Masquerading", 0.070178780850974], ["Indirect Command Execution", 0.04676183718783553], ["Windows Management Instrumentation", 0.02878834138420436]], "The batch file name": [["Masquerading", 0.24031627452620902], ["Command and Scripting Interpreter", 0.13902633011824647], ["Indicator Removal", 0.06571419306449627], ["File and Directory Discovery", 0.0513501337985102], ["System Binary Proxy Execution", 0.05060075588041862], ["Native API", 0.02997519899196834]], "the scriptlet of the batch file": [["Command and Scripting Interpreter", 0.5702178776623692], ["Scheduled Task/Job", 0.05532909172269857], ["System Binary Proxy Execution", 0.04255822802427235], ["System Services", 0.021496275942343285], ["Boot or Logon Autostart Execution", 0.02108612778510412], ["Windows Management Instrumentation", 0.01739840050099278]], "cmd.exe\" /c": [["Command and Scripting Interpreter", 0.18109335919018363], ["Native API", 0.09306984710565913], ["System Binary Proxy Execution", 0.09215901708649557], ["Masquerading", 0.08389266284379969], ["Indirect Command Execution", 0.05847847104309543], ["Boot or Logon Autostart Execution", 0.032844044354546936]], "Windows Batch file": [["Command and Scripting Interpreter", 0.5500028520869072], ["Scheduled Task/Job", 0.04944139689921296], ["System Binary Proxy Execution", 0.03932052838084782], ["Indicator Removal", 0.02059748292619515], ["Masquerading", 0.020385347445188027], ["Windows Management Instrumentation", 0.018329505949034035]], "This script is for executing the PowerShell script via a Windows scheduled task": [["Scheduled Task/Job", 0.6385841294063259], ["Command and Scripting Interpreter", 0.13857196704405036], ["Inter-Process Communication", 0.044488589470558934], ["System Binary Proxy Execution", 0.014071937132479262], ["System Services", 0.01209974334173205], ["Windows Management Instrumentation", 0.01160165792632084]], "Windows displays a warning message when the user tries to open a file downloaded from the internet.": [["User Execution", 0.17288477376230502], ["Masquerading", 0.08500277451529142], ["Ingress Tool Transfer", 0.0579017375182667], ["Subvert Trust Controls", 0.04203101295589724], ["File and Directory Discovery", 0.03409339502169973], ["Deobfuscate/Decode Files or Information", 0.028583886829388512]], "strategy to persuade the victim to execute the malicious shortcut file": [["User Execution", 0.49385171547317785], ["Boot or Logon Autostart Execution", 0.12335982880249084], ["Masquerading", 0.05243490465856167], ["Office Application Startup", 0.04783377383137856], ["System Binary Proxy Execution", 0.020970136301484296], ["Phishing", 0.020652484841680183]], "executed when the victim double-clicked on the shortcut file": [["Boot or Logon Autostart Execution", 0.276893668835605], ["User Execution", 0.09056342349592936], ["Office Application Startup", 0.06085762866092813], ["Masquerading", 0.04700595790716355], ["Command and Scripting Interpreter", 0.04490597841811952], ["Event Triggered Execution", 0.03634787024854456]], "the executable ieinstal.exe was used to bypass UAC.": [["Abuse Elevation Control Mechanism", 0.6853631903138283], ["System Binary Proxy Execution", 0.03204214322866334], ["Access Token Manipulation", 0.028624105950900817], ["Event Triggered Execution", 0.01726912483760707], ["File and Directory Permissions Modification", 0.015318334451892474], ["Boot or Logon Autostart Execution", 0.012859601270792505]], "one victim in the UAE was attacked using a malicious Word document": [["Phishing", 0.1462362234669478], ["User Execution", 0.09272978248422996], ["Template Injection", 0.09164899596560076], ["Exploitation for Client Execution", 0.037370228180797715], ["Drive-by Compromise", 0.033921072002780904], ["Office Application Startup", 0.030092352175850583]], "to gather basic system information.": [["System Information Discovery", 0.5757984410196689], ["Windows Management Instrumentation", 0.0495515970081696], ["Software Discovery", 0.04683618678162512], ["Gather Victim Host Information", 0.027559811116800385], ["Virtualization/Sandbox Evasion", 0.023794884802701453], ["Query Registry", 0.018146088576809428]], "rundll32.exe": [["System Binary Proxy Execution", 0.5202938033221639], ["Native API", 0.13154649679483202], ["Hijack Execution Flow", 0.03691683071239506], ["System Services", 0.0348483654799575], ["Process Injection", 0.0326266096501466], ["Masquerading", 0.028955025662793645]], "spawns it with the rundll32.exe command with the payload URL": [["System Binary Proxy Execution", 0.38273268994335796], ["Native API", 0.16417328279554144], ["System Services", 0.09243404318418065], ["Process Injection", 0.039889397472702086], ["Command and Scripting Interpreter", 0.03297999330055809], ["Hijack Execution Flow", 0.02881184473011223]], "Embedded files of ISO image": [["Obfuscated Files or Information", 0.10870590314120415], ["Hide Artifacts", 0.06391627633932954], ["Data from Removable Media", 0.05094723214783202], ["Replication Through Removable Media", 0.029273020908446135], ["Masquerading", 0.026705872881603837], ["Build Image on Host", 0.02520903928080363]], "an encrypted Dump.bin file": [["Deobfuscate/Decode Files or Information", 0.21704040883112535], ["Archive Collected Data", 0.18248237328639005], ["Obfuscated Files or Information", 0.17159904425584774], ["Data Encrypted for Impact", 0.05980401583954209], ["OS Credential Dumping", 0.027023486091029197], ["Exfiltration Over Alternative Protocol", 0.02496047523438055]], "downloader contains an encrypted configuration at the end of the file.": [["Deobfuscate/Decode Files or Information", 0.20474201036298237], ["Obfuscated Files or Information", 0.1902780053257697], ["Archive Collected Data", 0.10124822106621151], ["Data Encrypted for Impact", 0.06756209175265995], ["Exfiltration Over Alternative Protocol", 0.04009313733815356], ["Encrypted Channel", 0.034799423359771216]], "the supplied encrypted decoy document.": [["Deobfuscate/Decode Files or Information", 0.3137577453855807], ["Obfuscated Files or Information", 0.19301843827770415], ["Archive Collected Data", 0.09491944394110904], ["Data Encrypted for Impact", 0.08169878123333002], ["Encrypted Channel", 0.04376096430943163], ["Weaken Encryption", 0.029281465513128928]], "an encrypted decoy document": [["Deobfuscate/Decode Files or Information", 0.23346934011646508], ["Obfuscated Files or Information", 0.20343531204069704], ["Data Encrypted for Impact", 0.14932533690886138], ["Archive Collected Data", 0.11203398683923046], ["Encrypted Channel", 0.035827961410568855], ["Weaken Encryption", 0.015492669272659236]], "The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.": [["Masquerading", 0.5365971001989603], ["Hide Artifacts", 0.0956518822266327], ["Obfuscated Files or Information", 0.07847565186979676], ["File and Directory Discovery", 0.03544061502577243], ["Indicator Removal", 0.015501039433745499], ["User Execution", 0.014473167495378794]], "decodes 0x3E8 bytes with that key": [["Deobfuscate/Decode Files or Information", 0.49444449337598323], ["Data Encoding", 0.15927599798669487], ["Obfuscated Files or Information", 0.10024666631029937], ["Encrypted Channel", 0.06847017823093145], ["Data Obfuscation", 0.016039188892562183], ["Archive Collected Data", 0.014292425212270064]], "The decrypted data": [["Deobfuscate/Decode Files or Information", 0.3570982291709188], ["Archive Collected Data", 0.16130546156739392], ["Data Encrypted for Impact", 0.11426671122240507], ["Obfuscated Files or Information", 0.029978354455179056], ["Exfiltration Over Alternative Protocol", 0.026106783328745883], ["Weaken Encryption", 0.025281290561234314]], "loads the decrypted DLL file": [["Deobfuscate/Decode Files or Information", 0.4930676899313801], ["Hijack Execution Flow", 0.08115743206211873], ["Obfuscated Files or Information", 0.061096342154632194], ["System Binary Proxy Execution", 0.05605786683981662], ["Process Injection", 0.05378065661539823], ["Shared Modules", 0.03769758197533827]], "The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.": [["Deobfuscate/Decode Files or Information", 0.5212181404918479], ["Obfuscated Files or Information", 0.09882765992484577], ["Weaken Encryption", 0.044399732152906414], ["Modify Registry", 0.033346392906171966], ["Execution Guardrails", 0.02964425104681997], ["Data Encrypted for Impact", 0.025199595655514332]], "the malware decrypts the payload with a delivered 64-byte RC4 key.": [["Deobfuscate/Decode Files or Information", 0.7212323057535621], ["Obfuscated Files or Information", 0.10184212756465706], ["Encrypted Channel", 0.028166264515321587], ["Execution Guardrails", 0.018319302397525578], ["Data Encrypted for Impact", 0.017938411568813338], ["Weaken Encryption", 0.013100784810102739]], "checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender": [["Software Discovery", 0.6789778147573804], ["Windows Management Instrumentation", 0.03185834824604211], ["Gather Victim Host Information", 0.021845693478511525], ["System Information Discovery", 0.018890350726272407], ["Obtain Capabilities", 0.013770471724541954], ["Query Registry", 0.012934155316797317]], "If TrendMicro, BitDefender, or Windows Defender products are installed": [["Software Discovery", 0.8225787090605258], ["Windows Management Instrumentation", 0.02359005359709223], ["Impair Defenses", 0.01596812827135024], ["Query Registry", 0.012953908908618379], ["System Information Discovery", 0.010237342929839246], ["Virtualization/Sandbox Evasion", 0.006822969059357765]], "If Windows Defender or Bitdefender Antivirus is installed on the victim\u2019s computer": [["Software Discovery", 0.711392537361768], ["Impair Defenses", 0.03152657661266742], ["Windows Management Instrumentation", 0.0252757956487825], ["System Information Discovery", 0.0160549804321172], ["Virtualization/Sandbox Evasion", 0.014530274552867373], ["Query Registry", 0.01369118008734839]], "depending on the antivirus installed.": [["Software Discovery", 0.3312011965150914], ["Impair Defenses", 0.03933843219406114], ["System Time Discovery", 0.02784097455662978], ["System Information Discovery", 0.025876575183355125], ["Indicator Removal", 0.02313358809387587], ["Windows Management Instrumentation", 0.02111508216709496]], "the malware can disable the functionalities of EDR/AV products.": [["Impair Defenses", 0.20521305987073604], ["Subvert Trust Controls", 0.07116712507232281], ["Software Discovery", 0.040065125306961116], ["Pre-OS Boot", 0.0370323504966968], ["Modify System Image", 0.027279020492480575], ["Execution Guardrails", 0.021749159221738885]], "injects the fetched payload into the explorer.exe process": [["Process Injection", 0.5827366839798482], ["Native API", 0.18091644107465107], ["System Binary Proxy Execution", 0.03675761099896985], ["Hijack Execution Flow", 0.020255241478773323], ["Command and Scripting Interpreter", 0.01925900060503055], ["Event Triggered Execution", 0.016393915969806508]], "The Blockchain.pdf file is a malicious HTML application file": [["Template Injection", 0.18397041216332805], ["User Execution", 0.1372025043917967], ["Phishing", 0.0898217018814153], ["Masquerading", 0.03504566589802976], ["Ingress Tool Transfer", 0.028297516340233028], ["Obfuscated Files or Information", 0.025943373328567658]], "This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address": [["Masquerading", 0.11303996065089597], ["Native API", 0.06789427536971537], ["Obfuscated Files or Information", 0.04386449712858259], ["Modify Registry", 0.0428115465295745], ["Dynamic Resolution", 0.04063891825066913], ["Hijack Execution Flow", 0.03946246734710732]], "The campaigns used a variety of email attachments such as Microsoft OneNote attachments and somewhat rare to see .URL attachments,": [["Phishing", 0.4404002308543475], ["User Execution", 0.1485054878547303], ["Phishing for Information", 0.04405878572842304], ["Email Collection", 0.027648820429955985], ["Internal Spearphishing", 0.0169351094096195], ["Application Layer Protocol", 0.01631766767053805]], "This campaign began with thread hijacked emails which contained HTML attachments.": [["Phishing", 0.3703909101291783], ["User Execution", 0.20498215536203812], ["Email Collection", 0.029671368249668966], ["Phishing for Information", 0.0215355938718995], ["Application Layer Protocol", 0.019861031715749797], ["Template Injection", 0.01800406505473537]], "The HTML attachments used HTML Smuggling to drop a password protected, zipped Windows Script File (WSF).": [["User Execution", 0.12180705296452068], ["Obfuscated Files or Information", 0.08984803838165613], ["Template Injection", 0.07686563096613842], ["Phishing", 0.058390296937813196], ["Archive Collected Data", 0.05687606197461902], ["Ingress Tool Transfer", 0.05604381058126098]], "to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export \u201cinit\u201d.": [["System Binary Proxy Execution", 0.13092991351723016], ["Command and Scripting Interpreter", 0.12281777634460876], ["Ingress Tool Transfer", 0.04782460746167973], ["Boot or Logon Autostart Execution", 0.038231761011226884], ["Shared Modules", 0.02787981412430719], ["Create or Modify System Process", 0.02713802274873008]], "used to download and execute an IcedID loader.": [["Command and Scripting Interpreter", 0.08916440976806048], ["Ingress Tool Transfer", 0.08155688107036228], ["OS Credential Dumping", 0.06574681254737287], ["System Binary Proxy Execution", 0.05927115045873856], ["Deobfuscate/Decode Files or Information", 0.028060477667955965], ["Masquerading", 0.026787236441615604]], "opened\u00a0it would initiate the download of a batch (.bat) file.": [["Ingress Tool Transfer", 0.34338675787106576], ["Command and Scripting Interpreter", 0.31596608121981623], ["System Binary Proxy Execution", 0.03375915990345868], ["BITS Jobs", 0.029293860303333228], ["Scheduled Task/Job", 0.021184867079958716], ["Masquerading", 0.011225954209351838]], "The batch file would download and execute": [["Command and Scripting Interpreter", 0.48769693592384905], ["Ingress Tool Transfer", 0.23325415004377867], ["System Binary Proxy Execution", 0.036015831927611396], ["Scheduled Task/Job", 0.03175847749033006], ["BITS Jobs", 0.018418357485482637], ["Inter-Process Communication", 0.014701530928503933]], "When opened, the OneNote document instructed the recipient to \"open\" the document by double-clicking the button displayed in the OneNote document.": [["User Execution", 0.16845387707354487], ["Office Application Startup", 0.08381626876968731], ["Template Injection", 0.0637416021279377], ["Phishing", 0.046745552469904326], ["Masquerading", 0.02856198287178526], ["File and Directory Discovery", 0.026700565423069637]], "file was concealed beneath the \"open\" text which, if clicked, executed the HTA file.": [["Office Application Startup", 0.10154147537063753], ["Hide Artifacts", 0.09313899882794353], ["User Execution", 0.05244586265867705], ["Masquerading", 0.046289778819930676], ["System Binary Proxy Execution", 0.046248227246649995], ["File and Directory Discovery", 0.0401745695469346]], "containing the encrypted bot and DLL loader.": [["Obfuscated Files or Information", 0.3420278373119418], ["Deobfuscate/Decode Files or Information", 0.1802043297003856], ["Process Injection", 0.058403174782239], ["Hijack Execution Flow", 0.05407734950789705], ["System Binary Proxy Execution", 0.04636376041299086], ["Shared Modules", 0.01812189115683359]], "download of a batch (.bat) file.": [["Ingress Tool Transfer", 0.36837733012268903], ["Command and Scripting Interpreter", 0.28399756881161703], ["BITS Jobs", 0.02694072998349844], ["System Binary Proxy Execution", 0.018246443654893953], ["Scheduled Task/Job", 0.017889519823342963], ["Lateral Tool Transfer", 0.015273675157398183]], "that contained various bat files,": [["Command and Scripting Interpreter", 0.5725508020033719], ["System Binary Proxy Execution", 0.07661598268262725], ["Masquerading", 0.027337080658347314], ["Scheduled Task/Job", 0.025906758397565937], ["Native API", 0.022424867154531625], ["System Services", 0.016300279366055645]], "execute an IcedID loader with\u00a0rundll32": [["System Binary Proxy Execution", 0.2825237807040985], ["Event Triggered Execution", 0.06887569727556048], ["Access Token Manipulation", 0.05401694944838962], ["Boot or Logon Autostart Execution", 0.04672724502983609], ["Process Injection", 0.04588310899981425], ["Native API", 0.04143493531826866]], "loader with\u00a0rundll32": [["System Binary Proxy Execution", 0.3711310217646666], ["Hijack Execution Flow", 0.12022219904841738], ["Shared Modules", 0.0897761787167956], ["Native API", 0.07732738531270693], ["Process Injection", 0.03859401936360892], ["Command and Scripting Interpreter", 0.029182170115998284]], "Config decryption within IcedID Lite Loader.": [["Deobfuscate/Decode Files or Information", 0.45951876607909886], ["Obfuscated Files or Information", 0.08636430200331781], ["OS Credential Dumping", 0.03819873884349178], ["Weaken Encryption", 0.03716126477180192], ["Data Encrypted for Impact", 0.022847604776853072], ["Modify Registry", 0.021998267950873025]], "Decryption of the URI within": [["Deobfuscate/Decode Files or Information", 0.43510753717352574], ["Obfuscated Files or Information", 0.1084737339318119], ["Data Encoding", 0.10566193613112211], ["Encrypted Channel", 0.04568702686867958], ["Archive Collected Data", 0.037146799493337955], ["Exfiltration Over Alternative Protocol", 0.023437609743903333]], "The domain is decrypted from the configuration and the URI path is decrypted within the function": [["Deobfuscate/Decode Files or Information", 0.14577418061573263], ["Obfuscated Files or Information", 0.08479598772538373], ["Data Encoding", 0.042418462439242445], ["Dynamic Resolution", 0.03962510695687756], ["Execution Guardrails", 0.03890281590694496], ["Encrypted Channel", 0.0384511706631438]], "Decryption is the same across both": [["Deobfuscate/Decode Files or Information", 0.49388275367831225], ["Data Encrypted for Impact", 0.07540238881913287], ["Archive Collected Data", 0.060577453499924445], ["Obfuscated Files or Information", 0.04987040387562998], ["Encrypted Channel", 0.04161067785939416], ["Weaken Encryption", 0.039396573599566234]], "This pattern of decrypting strings": [["Deobfuscate/Decode Files or Information", 0.5902825946812683], ["Obfuscated Files or Information", 0.13645121468051194], ["Encrypted Channel", 0.04419418915404009], ["Data Encrypted for Impact", 0.037464838479484376], ["Archive Collected Data", 0.023100173251742226], ["Weaken Encryption", 0.019923507708240452]], "the Forked Loader decrypts and copies strings into global variables where they will be later used to resolve required functions.": [["Deobfuscate/Decode Files or Information", 0.43615769936989623], ["Obfuscated Files or Information", 0.20359053673886643], ["Native API", 0.03822849203135317], ["Hijack Execution Flow", 0.03134852154691898], ["Process Injection", 0.01899235995748368], ["Shared Modules", 0.015686769519708398]], "Decryption of the config buffer in the Forked Loader.": [["Deobfuscate/Decode Files or Information", 0.5514016076289898], ["Obfuscated Files or Information", 0.10585414109253521], ["OS Credential Dumping", 0.030885459647303447], ["Modify Registry", 0.018463861902956978], ["Hide Artifacts", 0.014697597584128546], ["Process Injection", 0.012158190098627255]], "With the config decrypted": [["Deobfuscate/Decode Files or Information", 0.5436306059421322], ["Obfuscated Files or Information", 0.06722452441868884], ["Data Encrypted for Impact", 0.06206341776074743], ["Archive Collected Data", 0.04955322495696977], ["Weaken Encryption", 0.02909703107371354], ["Execution Guardrails", 0.016720086596624252]], "The response gets decrypted with the IcedID decryption routine,": [["Deobfuscate/Decode Files or Information", 0.5082268717978806], ["Data Encoding", 0.11050088538564001], ["Encrypted Channel", 0.06771179020728332], ["Obfuscated Files or Information", 0.059580806528296386], ["Archive Collected Data", 0.038616778879981044], ["Exfiltration Over Alternative Protocol", 0.019341664811115915]], "Contains code to decrypt strings and domains": [["Deobfuscate/Decode Files or Information", 0.5649065504098382], ["Obfuscated Files or Information", 0.12931675328031583], ["Encrypted Channel", 0.042294128488829706], ["Data Encoding", 0.03725088723284603], ["Data Encrypted for Impact", 0.03109667622198612], ["Archive Collected Data", 0.026452849270366636]], "String decryption of the DLL names": [["Deobfuscate/Decode Files or Information", 0.5807811732921667], ["Obfuscated Files or Information", 0.2261566171397413], ["Masquerading", 0.020790172727140992], ["Hijack Execution Flow", 0.014358287531979498], ["Native API", 0.009671333853339828], ["Process Injection", 0.008402570287872103]], "With the DLL strings decrypted, the malware then decrypts the loader configuration by taking the first 64 bytes and XORing it against the next 64 bytes.": [["Deobfuscate/Decode Files or Information", 0.5173897195116727], ["Obfuscated Files or Information", 0.2313399898720497], ["Hijack Execution Flow", 0.032345153650981104], ["System Binary Proxy Execution", 0.021106124123257065], ["Process Injection", 0.017506937692073767], ["Shared Modules", 0.011907589833805625]], "The first four bytes of the decrypted buffer will contain the project identifier": [["Deobfuscate/Decode Files or Information", 0.22233659708871845], ["Obfuscated Files or Information", 0.13781320784322], ["Execution Guardrails", 0.068900764469977], ["System Information Discovery", 0.06769927456501043], ["File and Directory Discovery", 0.04188916543222705], ["Native API", 0.024242002285262534]], "This function decrypts strings": [["Deobfuscate/Decode Files or Information", 0.670192256291689], ["Obfuscated Files or Information", 0.10633240806602304], ["Encrypted Channel", 0.03635442946791283], ["Data Encoding", 0.02451840387394263], ["Archive Collected Data", 0.024167342908854084], ["Data Encrypted for Impact", 0.02331177726177376]], "decrypts the DLL strings to be used later to resolve handles to the DLLs needed": [["Deobfuscate/Decode Files or Information", 0.38066344638782357], ["Obfuscated Files or Information", 0.17474950102295603], ["Hijack Execution Flow", 0.08897161244617373], ["Process Injection", 0.038755103151419903], ["Masquerading", 0.032959630335114766], ["System Binary Proxy Execution", 0.03126980193758785]], "The strings are decrypted in the same algorithm where the data is split into DWORDs and XOR\u2019d against a random key.": [["Deobfuscate/Decode Files or Information", 0.6209182816624308], ["Obfuscated Files or Information", 0.10070402211242573], ["Archive Collected Data", 0.0382717767115439], ["Encrypted Channel", 0.0315221900313261], ["Data Encoding", 0.03134497888871458], ["Weaken Encryption", 0.023374506652442405]], "String decryption for the DLL names needed for execution.": [["Deobfuscate/Decode Files or Information", 0.44770249555600394], ["Obfuscated Files or Information", 0.31218218891976535], ["Masquerading", 0.02918154620482384], ["Hijack Execution Flow", 0.028710251355478777], ["Process Injection", 0.013362869562218296], ["Native API", 0.012929304042047148]], "Decryption of \u201cLite Loader\u201d\" domains.": [["Deobfuscate/Decode Files or Information", 0.6562969232352691], ["Obfuscated Files or Information", 0.09078338629176966], ["Data Encrypted for Impact", 0.042906877478264806], ["Archive Collected Data", 0.0298562868931148], ["Encrypted Channel", 0.015348193493340654], ["Execution Guardrails", 0.013325690951231584]], "a function is called that decrypts strings that": [["Deobfuscate/Decode Files or Information", 0.6551188446354309], ["Obfuscated Files or Information", 0.11455824830690753], ["Encrypted Channel", 0.035774530761835795], ["Data Encrypted for Impact", 0.02425324541910618], ["Archive Collected Data", 0.023661591421588014], ["Data Encoding", 0.020834624776767983]], "there are two domains that are decrypted:": [["Deobfuscate/Decode Files or Information", 0.3029886196500147], ["Data Encrypted for Impact", 0.08333549518214504], ["Encrypted Channel", 0.06695296318706745], ["Obfuscated Files or Information", 0.05455377512617302], ["Archive Collected Data", 0.04479479271383462], ["Execution Guardrails", 0.036456586871527925]], "With the domain names decrypted, the DLL Loader decrypts 10 strings that should be URIs to be appended to the domains.": [["Deobfuscate/Decode Files or Information", 0.14066297003265216], ["Obfuscated Files or Information", 0.11633603368770054], ["Masquerading", 0.07689840963218074], ["Dynamic Resolution", 0.03960825687048422], ["Hijack Execution Flow", 0.0368261575611885], ["Web Service", 0.027132140709805967]], "Decryption of \u201cLite Loader\u201d filenames.": [["Deobfuscate/Decode Files or Information", 0.5600705132263039], ["Obfuscated Files or Information", 0.15360248373842078], ["Data Encrypted for Impact", 0.045099309823226574], ["Masquerading", 0.032990573829143985], ["Archive Collected Data", 0.03274364813609149], ["File and Directory Discovery", 0.01725370247427887]], "After the strings are decrypted": [["Deobfuscate/Decode Files or Information", 0.612119746447699], ["Obfuscated Files or Information", 0.10658370914119444], ["Archive Collected Data", 0.0349764064560882], ["Data Encrypted for Impact", 0.03208350008248359], ["Encrypted Channel", 0.03205435901633525], ["Data Encoding", 0.02433060195223941]], "Base64 decoding this value": [["Deobfuscate/Decode Files or Information", 0.3420394646960176], ["Data Encoding", 0.2618699509772105], ["Obfuscated Files or Information", 0.2321473447831878], ["Data Obfuscation", 0.02091928784009777], ["Archive Collected Data", 0.019076844558755406], ["Encrypted Channel", 0.016102342589759733]], "following base64 decoded header": [["Deobfuscate/Decode Files or Information", 0.29164826974681546], ["Obfuscated Files or Information", 0.2562379988990849], ["Data Encoding", 0.22874154209917708], ["Data Obfuscation", 0.04198934192882738], ["Archive Collected Data", 0.019024173613852946], ["Encrypted Channel", 0.013644051234480559]], "showing the decrypted botpack structure.": [["Deobfuscate/Decode Files or Information", 0.637097974825713], ["Obfuscated Files or Information", 0.14288772639308675], ["Archive Collected Data", 0.021810771801208436], ["Data Encrypted for Impact", 0.01980036868695133], ["File and Directory Discovery", 0.014801125495918777], ["Execution Guardrails", 0.012816619522787223]], "that makes the HTTP request.": [["Application Layer Protocol", 0.4877599033567557], ["Endpoint Denial of Service", 0.027833162514661804], ["Data Encoding", 0.02590556016593289], ["Fallback Channels", 0.02575035921845099], ["Data Obfuscation", 0.020877621652727375], ["Non-Standard Port", 0.020268279975050606]], "sends an HTTP request that will contain the encrypted bot response.": [["Encrypted Channel", 0.20372911530068294], ["Data Encoding", 0.17117426004754585], ["Application Layer Protocol", 0.08695996563555786], ["Data Obfuscation", 0.06947179818982613], ["Exfiltration Over Alternative Protocol", 0.0618864603353251], ["Deobfuscate/Decode Files or Information", 0.04075684614119219]], "contain the host information": [["System Information Discovery", 0.268321693486047], ["System Network Configuration Discovery", 0.2184249986787341], ["Remote System Discovery", 0.05274904679802215], ["Gather Victim Host Information", 0.05043239188134754], ["System Owner/User Discovery", 0.03970044321558367], ["System Network Connections Discovery", 0.03463365654553292]], "The Base-64 encoded segment": [["Obfuscated Files or Information", 0.373589329844445], ["Data Encoding", 0.17108812845515364], ["Deobfuscate/Decode Files or Information", 0.16294904862779389], ["Encrypted Channel", 0.029868300383971202], ["Data Obfuscation", 0.027136695656999856], ["Archive Collected Data", 0.01735462141537154]], "may also deliver a weaponized Office document that executes the ReconShark reconnaissance malware.": [["Office Application Startup", 0.058409585857661095], ["Command and Scripting Interpreter", 0.05362917397399615], ["Masquerading", 0.037080365465933504], ["Obtain Capabilities", 0.03469465640785693], ["Indicator Removal", 0.033072270420875384], ["Template Injection", 0.02788640442281429]], "to distribute password-protected weaponized Office documents": [["Template Injection", 0.11592638287772344], ["Phishing", 0.09811100183552446], ["Forced Authentication", 0.04548597121266944], ["User Execution", 0.041874658037802034], ["Valid Accounts", 0.03022642066581147], ["Data Encrypted for Impact", 0.02912669063910324]], "Office documents weaponized": [["Template Injection", 0.1875918931403769], ["Phishing", 0.08612599652695348], ["User Execution", 0.06020600351390731], ["Data from Local System", 0.05465345631611413], ["Office Application Startup", 0.03900794766893956], ["Data Manipulation", 0.03786268346348361]], "hardware information.": [["System Information Discovery", 0.33719395852443834], ["Peripheral Device Discovery", 0.14189044206083556], ["Software Discovery", 0.04496207737169069], ["Gather Victim Host Information", 0.04460917369083892], ["Windows Management Instrumentation", 0.033426271859052774], ["Virtualization/Sandbox Evasion", 0.02874558769908629]], "to use this tool for remote management of its infrastructure.": [["Remote Access Software", 0.19125255831469912], ["Software Deployment Tools", 0.10421227224525091], ["Acquire Infrastructure", 0.058040197912276055], ["Command and Scripting Interpreter", 0.035694406660878156], ["External Remote Services", 0.03456721272920535], ["Windows Management Instrumentation", 0.03205728260198926]], "webshells, mostly obfuscated,": [["Obfuscated Files or Information", 0.20975977421047573], ["Data Encoding", 0.09827404493315751], ["Data Obfuscation", 0.061644643320191136], ["Deobfuscate/Decode Files or Information", 0.050034795675089956], ["Web Service", 0.03932864397567074], ["Template Injection", 0.03418558761420155]], "the hacker also changes the content of the file RedirSuiteServiceProxy.aspx to webshell content.": [["Endpoint Denial of Service", 0.08109419171438648], ["Exploit Public-Facing Application", 0.0769646277116941], ["Compromise Infrastructure", 0.07327267715004764], ["Proxy", 0.04230585540446], ["Fallback Channels", 0.03960198252960091], ["Data Obfuscation", 0.03391014749888053]], "RedirSuiteServiceProxy.aspx is a legitimate file name available in the Exchange server.": [["Masquerading", 0.181031742908197], ["Email Collection", 0.11707623729956818], ["Office Application Startup", 0.0724136677587936], ["Data Manipulation", 0.03314757260995236], ["Application Layer Protocol", 0.026170458205285928], ["Phishing", 0.023530656046234756]], "the attacker downloads files,": [["Ingress Tool Transfer", 0.6444312342723139], ["Data from Local System", 0.02320033583027303], ["Application Layer Protocol", 0.017008035734314555], ["Command and Scripting Interpreter", 0.01591842923192555], ["BITS Jobs", 0.014896099187168195], ["Data Staged", 0.010324650235188401]], "drops suspicious files on the attacked servers": [["Indicator Removal", 0.1755344242556327], ["Ingress Tool Transfer", 0.09692028948948797], ["Automated Exfiltration", 0.04894642325714668], ["Data from Local System", 0.03886210135956468], ["Data Staged", 0.035244455845164946], ["Exfiltration Over C2 Channel", 0.025378642282437573]], "collecting information on the system,": [["Automated Collection", 0.11975215124896312], ["System Information Discovery", 0.09617079124283026], ["Data from Configuration Repository", 0.056189140436858756], ["Data from Information Repositories", 0.05022310974191327], ["Gather Victim Host Information", 0.04919521551149132], ["Data from Local System", 0.040415405452424225]], "\u201ccmd\u201d /c": [["Command and Scripting Interpreter", 0.25743792292596834], ["Indirect Command Execution", 0.13794569916308455], ["Native API", 0.039371729041398844], ["Boot or Logon Autostart Execution", 0.033900451969084505], ["System Services", 0.02138780885918137], ["File and Directory Discovery", 0.019209978537729884]], "\"cmd\" /c": [["Command and Scripting Interpreter", 0.27821598941458037], ["Indirect Command Execution", 0.13883129475240188], ["Native API", 0.0464956116570924], ["Boot or Logon Autostart Execution", 0.026939356929489098], ["File and Directory Discovery", 0.02362398736090109], ["System Binary Proxy Execution", 0.0223005603933724]], "the standard\u00a0Windows command line tool cmd.exe.": [["Command and Scripting Interpreter", 0.3222266033235349], ["Native API", 0.07453300869122541], ["System Binary Proxy Execution", 0.0605058944259036], ["Masquerading", 0.05335292297463932], ["Windows Management Instrumentation", 0.03817180981186517], ["Indirect Command Execution", 0.03777792554785205]], "Delete file or folder": [["Indicator Removal", 0.7155315672544403], ["Data Destruction", 0.10678212518125191], ["Disk Wipe", 0.014287241219990704], ["Inhibit System Recovery", 0.013779108859065043], ["File and Directory Discovery", 0.01112230216030764], ["System Shutdown/Reboot", 0.007296029701326006]], "the hacker also injects malicious DLLs into the memory,": [["Process Injection", 0.450806191200084], ["Hijack Execution Flow", 0.03166688275764454], ["Modify System Image", 0.026767200949417026], ["Exploitation for Client Execution", 0.02006595661576453], ["Event Triggered Execution", 0.01985680562352628], ["Impair Defenses", 0.019113606110258904]], "the DLL was injected into the memory of the svchost.exe process": [["Process Injection", 0.3021046829850761], ["Hijack Execution Flow", 0.2083942811347374], ["System Binary Proxy Execution", 0.1241355794873363], ["Shared Modules", 0.07825004285161911], ["Native API", 0.03237345960829815], ["Event Triggered Execution", 0.025100561468166253]], "executes these files through WMIC.": [["Windows Management Instrumentation", 0.1813261398534146], ["System Binary Proxy Execution", 0.13235510356594124], ["Command and Scripting Interpreter", 0.0691693131480016], ["Native API", 0.04768043022764461], ["Masquerading", 0.043139834267879186], ["OS Credential Dumping", 0.035925182388490476]], ", the above files no longer exist on the compromised system, possibly due to the hacker\u2019s evidence deletion.": [["Indicator Removal", 0.41662586670751706], ["Data from Local System", 0.07214779344916182], ["File and Directory Discovery", 0.06447551577245171], ["Data Staged", 0.03786321752923223], ["Masquerading", 0.02043434285667452], ["Ingress Tool Transfer", 0.017766341245811203]], "Decrypt the request received using AES algorithm": [["Deobfuscate/Decode Files or Information", 0.2963194351765277], ["Encrypted Channel", 0.2705348688824666], ["Obfuscated Files or Information", 0.056343716451206304], ["Weaken Encryption", 0.048706365324434814], ["Data Encrypted for Impact", 0.04373835774019318], ["Data Encoding", 0.03985499135771728]], "After decoding,": [["Deobfuscate/Decode Files or Information", 0.5981126051145969], ["Data Encoding", 0.10476551330467494], ["Obfuscated Files or Information", 0.08411510017090217], ["Archive Collected Data", 0.027855641051007678], ["Encrypted Channel", 0.024108311724273072], ["Data Obfuscation", 0.014407547075500448]], "creates a listener that listens for connections to port 443 at the path https://*:": [["Non-Standard Port", 0.2517634612875367], ["Traffic Signaling", 0.05521172520527049], ["Application Layer Protocol", 0.05471010853723593], ["Data Obfuscation", 0.03850910822663858], ["Impair Defenses", 0.0369761820080652], ["Network Service Discovery", 0.03124181039209663]], "This method is responsible for collecting system information": [["System Information Discovery", 0.7427672268168101], ["Windows Management Instrumentation", 0.03945058230238742], ["Software Discovery", 0.028521372858090286], ["Virtualization/Sandbox Evasion", 0.02220566791583804], ["Query Registry", 0.014622094620324894], ["System Network Configuration Discovery", 0.01311166086137453]], "Information such as operating system architecture, framework version, operating system version, etc.": [["System Information Discovery", 0.6489476430268946], ["Software Discovery", 0.08016533769289219], ["Windows Management Instrumentation", 0.024699379662845154], ["Virtualization/Sandbox Evasion", 0.024410592875372575], ["Gather Victim Host Information", 0.0178239823185763], ["Query Registry", 0.016925175389625523]], "listing directory and file information in the format\n D|-|<Date created> |<Date modified> |<folder or file name>": [["File and Directory Discovery", 0.6858319999921844], ["Automated Collection", 0.04491409714730116], ["Data Staged", 0.04063527175815382], ["Indicator Removal", 0.039278676184796], ["Data from Local System", 0.031438829900739505], ["System Information Discovery", 0.022340553139459044]], "reading files": [["File and Directory Discovery", 0.21203296400721627], ["Data from Local System", 0.1323401627338022], ["Native API", 0.05398880363594563], ["Data from Network Shared Drive", 0.05144621714424366], ["Deobfuscate/Decode Files or Information", 0.04091763965385758], ["Automated Collection", 0.040691518648973385]], "Sending and receiving data with C2 using the RC4 encryption\u00a0algorithm where the key will be generated at runtime.": [["Encrypted Channel", 0.5985699180188765], ["Data Encoding", 0.058527521189391765], ["Deobfuscate/Decode Files or Information", 0.03396395237325678], ["Weaken Encryption", 0.03300174382318765], ["Exfiltration Over Alternative Protocol", 0.03191442637528602], ["Obfuscated Files or Information", 0.02676616958989972]], "delivered via phishing email as an attachment": [["Phishing", 0.5303130345943244], ["User Execution", 0.17280977711153028], ["Phishing for Information", 0.03958626512766387], ["Internal Spearphishing", 0.023288432137494177], ["Template Injection", 0.013169210525332221], ["Email Collection", 0.011502086037617954]], "The archives often include a JavaScript (.js) file": [["Archive Collected Data", 0.1035486977652876], ["Ingress Tool Transfer", 0.06730527746221657], ["Automated Collection", 0.06535421367587431], ["Deobfuscate/Decode Files or Information", 0.056472830119258466], ["Data from Local System", 0.042496215821521945], ["Data Staged", 0.039768751662319086]], "likely exploited known vulnerabilities in unpatched applications for initial access": [["Exploitation of Remote Services", 0.11951063084315885], ["Exploitation for Client Execution", 0.08196979655255959], ["Exploit Public-Facing Application", 0.07491714795812818], ["Exploitation for Privilege Escalation", 0.05378803167326688], ["Supply Chain Compromise", 0.050446120585199136], ["Drive-by Compromise", 0.04789618410229727]], "gains access to the targets through remote exploitation of an unpatched internet-facing device.": [["Exploit Public-Facing Application", 0.06970972535817511], ["Hardware Additions", 0.04293192756113246], ["Network Boundary Bridging", 0.04292075648699224], ["Proxy", 0.04212829508922004], ["Compromise Infrastructure", 0.03445231512145317], ["External Remote Services", 0.03009533176534631]], "to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in": [["Exploitation of Remote Services", 0.12762482115336665], ["Exploit Public-Facing Application", 0.09516277587418029], ["Exploitation for Client Execution", 0.08562986339745038], ["Obtain Capabilities", 0.0818778629162767], ["Develop Capabilities", 0.05292822123750033], ["Exploitation for Privilege Escalation", 0.033087957257533634]], "Installing legitimate remote access tools, such as RPort, Ligolo and eHorus": [["Remote Services", 0.2502040528939333], ["Remote Access Software", 0.15910708435378337], ["External Remote Services", 0.03806689343159478], ["Exploitation of Remote Services", 0.03803574948236389], ["Command and Scripting Interpreter", 0.035260627643379054], ["Lateral Tool Transfer", 0.03191628376337127]], "common native Windows tools and commands such as netstat": [["System Network Connections Discovery", 0.5137158546932679], ["Network Service Discovery", 0.09499057699948385], ["System Network Configuration Discovery", 0.08718702810283892], ["Remote System Discovery", 0.02874035656213864], ["Software Discovery", 0.028440588286095865], ["Network Sniffing", 0.013272443464542446]], "Windows Management Instrumentation (WMI) to launch commands on devices": [["Windows Management Instrumentation", 0.4983179427002928], ["Event Triggered Execution", 0.06059258664316198], ["Peripheral Device Discovery", 0.04218339384934582], ["Command and Scripting Interpreter", 0.027189942937515362], ["Replication Through Removable Media", 0.022749993543278252], ["System Services", 0.01798535333772752]], "Remote scheduled tasks to launch their customized PowerShell backdoor": [["Scheduled Task/Job", 0.64029092730014], ["Command and Scripting Interpreter", 0.10503804757964588], ["Inter-Process Communication", 0.042896155054283173], ["System Services", 0.02082394831300982], ["Masquerading", 0.013084497824246798], ["Windows Management Instrumentation", 0.010783585205923586]], "to register a scheduled task used to launch the ransomware payload.": [["Scheduled Task/Job", 0.6776362837653482], ["Inter-Process Communication", 0.035400521128292624], ["Command and Scripting Interpreter", 0.027047893307744132], ["Masquerading", 0.023885849519588383], ["Create or Modify System Process", 0.02360884213710926], ["System Services", 0.022144677746137407]], "The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.": [["Valid Accounts", 0.1571034360499882], ["Brute Force", 0.0557264131218496], ["Exploitation for Credential Access", 0.05275583845666874], ["Forced Authentication", 0.047184163821196785], ["Gather Victim Identity Information", 0.0435254627382106], ["Forge Web Credentials", 0.03379278311343231]], "GPO was leveraged again to register a scheduled task used to launch the ransomware payload.": [["Scheduled Task/Job", 0.1511816812503559], ["Domain Policy Modification", 0.09091060570102066], ["Abuse Elevation Control Mechanism", 0.05260710836674268], ["Access Token Manipulation", 0.03858121442550098], ["Event Triggered Execution", 0.037951127873454074], ["Masquerading", 0.03259469624608465]], "first interfered with security tools using Group Policy Objects (GPO).": [["Domain Policy Modification", 0.1396652799357643], ["Impair Defenses", 0.13249538385592832], ["Abuse Elevation Control Mechanism", 0.09006743594335799], ["File and Directory Permissions Modification", 0.08280841127981067], ["Boot or Logon Autostart Execution", 0.040379748971987824], ["Modify Registry", 0.040228150786146034]], "the threat actors leveraged highly privileged credentials and access to domain controllers": [["Valid Accounts", 0.33363050040316994], ["Forge Web Credentials", 0.04376908185599653], ["Exploitation for Credential Access", 0.04165751563735263], ["Modify Authentication Process", 0.03887765264893535], ["Brute Force", 0.033250917974658754], ["Domain Policy Modification", 0.02694565083106081]], "The threat actors used the compromised administrator account": [["Valid Accounts", 0.32641102138867706], ["Account Manipulation", 0.07819831383505987], ["Create Account", 0.07313839627052504], ["Account Discovery", 0.07267715599275307], ["Permission Groups Discovery", 0.02935603117989024], ["Domain Policy Modification", 0.021696445879723702]], "the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.": [["Account Manipulation", 0.16996074236448933], ["Valid Accounts", 0.16203976923569433], ["Create Account", 0.08785255475469904], ["Forge Web Credentials", 0.04510745301085469], ["Steal Application Access Token", 0.036662351590320434], ["Domain Policy Modification", 0.028919755569040834]], "the threat actors first used a compromised, highly privileged account to access the device where the Azure\u00a0Active\u00a0Directory (Azure AD) Connect agent is installed.": [["Valid Accounts", 0.11263531469540737], ["Account Manipulation", 0.10465630986875428], ["Steal Application Access Token", 0.06735114882541443], ["Create Account", 0.04200698840162035], ["Remote Services", 0.027761883044974404], ["Forge Web Credentials", 0.02521106319480158]], "The first account was the compromised Azure AD Connector account,": [["Account Discovery", 0.1300636253500731], ["Create Account", 0.12223486442372845], ["Valid Accounts", 0.11789037642312361], ["Account Manipulation", 0.11041745463957123], ["Establish Accounts", 0.037689316672120846], ["Compromise Accounts", 0.03728475073137441]], "the threat actors were observed using compromised credentials to access the Azure AD Connect device.": [["Steal Application Access Token", 0.08663190245554367], ["Valid Accounts", 0.05267981787469899], ["Forge Web Credentials", 0.05076625145890468], ["Account Manipulation", 0.03839247887653451], ["Multi-Factor Authentication Interception", 0.03833991382489075], ["Remote Services", 0.030776167724023595]], "authentication from a known attacker IP address into the Azure AD Connector cloud account.": [["Forge Web Credentials", 0.08373532899546766], ["Valid Accounts", 0.0797427375410952], ["Steal Application Access Token", 0.06140158202358499], ["Account Manipulation", 0.0533823245718113], ["Modify Authentication Process", 0.05331596317111317], ["Brute Force", 0.051788342762897795]], "the threat actors executed multiple actions in the cloud using two privileged accounts.": [["Valid Accounts", 0.20896498888647225], ["Account Manipulation", 0.15362016603019044], ["Create Account", 0.08702669898730477], ["Modify Cloud Compute Infrastructure", 0.04541089646660407], ["Access Token Manipulation", 0.031005125719900276], ["Transfer Data to Cloud Account", 0.02386897402950018]], "The Azure AD Connector account and the compromised administrator account were then used to perform": [["Valid Accounts", 0.22250096498338465], ["Account Manipulation", 0.1609084830493838], ["Create Account", 0.1308550676225458], ["Account Discovery", 0.05448480421014703], ["Steal Application Access Token", 0.026059728491002514], ["Access Token Manipulation", 0.01763508375177666]], "a successful sign-in to the Microsoft Azure environment was observed.": [["Forge Web Credentials", 0.08170733009084524], ["Use Alternate Authentication Material", 0.07353636990825968], ["Account Manipulation", 0.0643959834659995], ["Valid Accounts", 0.04381316688217928], ["Modify Authentication Process", 0.03976416358039567], ["Steal Application Access Token", 0.03360939573752064]], "The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.": [["Valid Accounts", 0.1807781065319648], ["Forge Web Credentials", 0.08202763823393672], ["Account Manipulation", 0.07129457467090623], ["OS Credential Dumping", 0.05748545260159559], ["Modify Authentication Process", 0.05734084745392606], ["Brute Force", 0.04013223866721465]], "the threat actors leveraged RDP for access into the account.": [["Valid Accounts", 0.313046903799807], ["Create Account", 0.08941980067560705], ["Remote Services", 0.0764409613887958], ["Account Manipulation", 0.07426330419795638], ["External Remote Services", 0.04437095949310457], ["Modify Authentication Process", 0.02699066871618458]], "the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.": [["Use Alternate Authentication Material", 0.11111517442508381], ["Impair Defenses", 0.06940964107528627], ["Valid Accounts", 0.06511801834899503], ["Forge Web Credentials", 0.042065781921334255], ["Multi-Factor Authentication Interception", 0.03681430222606822], ["Steal or Forge Kerberos Tickets", 0.035566381847166144]], "Those files will still get executed, if the user clicks on run": [["Indicator Removal", 0.11994329355222592], ["Hide Artifacts", 0.07393836570894932], ["Masquerading", 0.0644842695232938], ["System Binary Proxy Execution", 0.048786939012814376], ["Hijack Execution Flow", 0.04635707058384077], ["Command and Scripting Interpreter", 0.037752010849752375]], "Full path to file and hidden files": [["File and Directory Discovery", 0.5249279553055781], ["Hide Artifacts", 0.13182583730837433], ["Masquerading", 0.04723386108292128], ["Data Staged", 0.0401491590893511], ["Indicator Removal", 0.03022631108209475], ["Data from Local System", 0.021645445322229156]], "As LSASS dumps are nowadays recognized by the dump file itself": [["OS Credential Dumping", 0.20906415272185866], ["Data from Local System", 0.09050163025966751], ["Automated Collection", 0.07864498332043196], ["Deobfuscate/Decode Files or Information", 0.07850663005808735], ["File and Directory Discovery", 0.05110651530004754], ["Data Staged", 0.04217069586682951]], "LSASS dump in c:\\tmp detected and deleted": [["Indicator Removal", 0.43349038582883764], ["File and Directory Discovery", 0.05169283930521555], ["Data Staged", 0.04680640413514003], ["Data from Local System", 0.04559323360444708], ["Automated Collection", 0.03543004156489385], ["OS Credential Dumping", 0.029979696507011575]], "LSASS dump in the WebDAV detected": [["File and Directory Discovery", 0.19034330565038718], ["Data from Local System", 0.15593056778940018], ["Automated Collection", 0.09481237414496316], ["Data Staged", 0.0583672257819426], ["OS Credential Dumping", 0.04313394933818281], ["Data from Network Shared Drive", 0.04137616892687552]], "done via the GetAsyncKeyState API,": [["Native API", 0.15483711308690837], ["Input Capture", 0.10584883323706448], ["Virtualization/Sandbox Evasion", 0.07948337594165307], ["Event Triggered Execution", 0.037693075839364806], ["Process Discovery", 0.031642249873431436], ["Application Window Discovery", 0.031411726453233556]], "this is done via the popen API": [["Native API", 0.1584723688289665], ["Command and Scripting Interpreter", 0.11871570657179407], ["Ingress Tool Transfer", 0.03659578970390463], ["OS Credential Dumping", 0.02947628763787253], ["Automated Collection", 0.02799123843530016], ["Web Service", 0.019752953667998858]], "uses Windows API functions to execute files": [["Native API", 0.34650640948187134], ["System Binary Proxy Execution", 0.21502828153253753], ["Command and Scripting Interpreter", 0.08666455652100355], ["XSL Script Processing", 0.041813519380709506], ["Hijack Execution Flow", 0.029708445162163703], ["System Services", 0.028641140244097526]], "This is done via the GetAsyncKeyState API, with keystrokes being logged": [["Input Capture", 0.877154808353389], ["Clipboard Data", 0.006768429864249084], ["Event Triggered Execution", 0.004199013019428923], ["Screen Capture", 0.004164093040670026], ["Virtualization/Sandbox Evasion", 0.004037236763538203], ["Native API", 0.00394339521358722]], "keylogging are enabled by default,": [["Input Capture", 0.8687948635994357], ["Boot or Logon Autostart Execution", 0.00821684233224481], ["Clipboard Data", 0.005600823887410344], ["Event Triggered Execution", 0.0047427939133664965], ["Screen Capture", 0.003863440777926545], ["Credentials from Password Stores", 0.0037087151078334228]], "logs keystrokes for windows with titles containing substrings specified in its configuration": [["Input Capture", 0.7583546302689766], ["Application Window Discovery", 0.026466664243357016], ["Clipboard Data", 0.01483641431605442], ["Native API", 0.013617941817327771], ["Screen Capture", 0.008525887595120471], ["Automated Collection", 0.006895741466970063]], "Window titles to keylog": [["Input Capture", 0.5031884868190015], ["Application Window Discovery", 0.16197781479590856], ["Screen Capture", 0.023046505479678916], ["Clipboard Data", 0.020790477599674048], ["Native API", 0.019310739020213307], ["Masquerading", 0.0183997190253876]], "can log keystrokes.": [["Input Capture", 0.8894357870710474], ["Screen Capture", 0.005483549296243505], ["Clipboard Data", 0.00511657720942206], ["Credentials from Password Stores", 0.004702136210426907], ["Unsecured Credentials", 0.0034412171082923103], ["Virtualization/Sandbox Evasion", 0.0034042282619593436]], "Screenshots are also taken at a configurable interval; the default is once every 30 seconds.": [["Screen Capture", 0.7509356802521912], ["Video Capture", 0.020943630900403427], ["Input Capture", 0.012881272460905369], ["Application Window Discovery", 0.011997658999533317], ["Virtualization/Sandbox Evasion", 0.010821974067265563], ["Scheduled Task/Job", 0.007388625622428759]], "Screenshots and keylogging are enabled by default,": [["Screen Capture", 0.4911633800274418], ["Input Capture", 0.23706525233807887], ["Video Capture", 0.037034715427587586], ["Clipboard Data", 0.017524404081435185], ["Application Window Discovery", 0.015201386472121667], ["Boot or Logon Autostart Execution", 0.0072390142654005585]], "can capture screenshots": [["Screen Capture", 0.8610877462073023], ["Video Capture", 0.03137128501535957], ["Application Window Discovery", 0.008978660776588272], ["Input Capture", 0.007966862567711865], ["Clipboard Data", 0.0041190664308543064], ["Data from Local System", 0.0035736604741528964]], "the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphin\u2019s startup": [["Query Registry", 0.07175241357206932], ["Boot or Logon Autostart Execution", 0.0715139922068583], ["Modify Registry", 0.05851996812741908], ["Hijack Execution Flow", 0.04683461099312886], ["Event Triggered Execution", 0.04432996438410104], ["Command and Scripting Interpreter", 0.036736718124153626]], "The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\<random_run_name>\\\u201d%appdata%\\Python27({32|64})\\pythonw.exe\u201d \u201c<loader_step_1>\u201d \u201c<loader_encrypted_step_2>\u201d": [["Boot or Logon Autostart Execution", 0.24883508490593625], ["Create or Modify System Process", 0.10067224344284147], ["Event Triggered Execution", 0.06917165122416578], ["Hijack Execution Flow", 0.04655694877601437], ["Pre-OS Boot", 0.03599785108137691], ["Boot or Logon Initialization Scripts", 0.034187038049565015]], "uses Run keys for persistence of its loader": [["Boot or Logon Autostart Execution", 0.5686576544255957], ["Boot or Logon Initialization Scripts", 0.06527970639226491], ["Event Triggered Execution", 0.060780827443261395], ["Create or Modify System Process", 0.03674488577957167], ["Office Application Startup", 0.023759084977810797], ["Modify Registry", 0.019841644446402094]], "can execute shell commands": [["Command and Scripting Interpreter", 0.5805545328628339], ["Indirect Command Execution", 0.0602829538398073], ["System Services", 0.0505449482975758], ["Native API", 0.027529839235505005], ["Ingress Tool Transfer", 0.022073423186361858], ["System Binary Proxy Execution", 0.01591062902292733]], "creates directory listings": [["File and Directory Discovery", 0.5425278104385748], ["Data Staged", 0.07083048030201475], ["Automated Collection", 0.04677138511537519], ["Masquerading", 0.034214247272080556], ["Data from Local System", 0.026035282869257083], ["Hide Artifacts", 0.023144617043019518]], "The command to get specific files": [["File and Directory Discovery", 0.4758733833223782], ["Data from Local System", 0.1356282638664768], ["Automated Collection", 0.05148183613029378], ["Ingress Tool Transfer", 0.041555329455021876], ["Data Staged", 0.03782441973913286], ["Data from Network Shared Drive", 0.033090673092735355]], "It creates directory listings": [["File and Directory Discovery", 0.553551042321158], ["Data Staged", 0.05254841867152369], ["Automated Collection", 0.03590871310508643], ["Data from Local System", 0.030921498258921966], ["Masquerading", 0.028038929353660005], ["Hide Artifacts", 0.021789033944178558]], "to get files from drives": [["File and Directory Discovery", 0.19847904688848617], ["Data from Local System", 0.15701881711430127], ["Data from Removable Media", 0.13932667510932026], ["Data from Network Shared Drive", 0.1061033674459563], ["Exfiltration Over Physical Medium", 0.03246477167592568], ["Data Staged", 0.022020197528323574]], "it searches the drives of compromised systems for interesting files": [["File and Directory Discovery", 0.6262615787579447], ["Data from Local System", 0.06498295726402051], ["Automated Collection", 0.04503416047759207], ["Data from Network Shared Drive", 0.040791752583573426], ["Data from Removable Media", 0.02655943775102181], ["Network Share Discovery", 0.021596304627445873]], "can obtain file and directory listings.": [["File and Directory Discovery", 0.888668919111001], ["Data from Local System", 0.015636170667422903], ["Automated Collection", 0.01110887125312252], ["Data from Network Shared Drive", 0.007330573142167907], ["Data Staged", 0.0071195662113741716], ["System Information Discovery", 0.004894222080232632]], "The following file extensions of interest, specific to media, documents, emails, and certificates,": [["File and Directory Discovery", 0.27435965293432624], ["Masquerading", 0.08049032906006084], ["Automated Collection", 0.056629005460147305], ["Data from Local System", 0.052817322293807124], ["Data from Network Shared Drive", 0.0342220172099057], ["Data Staged", 0.02783223824088054]], "can collect files from local drives.": [["Data from Local System", 0.290708188782751], ["Data from Removable Media", 0.11357384929030492], ["Data from Network Shared Drive", 0.0985678443090604], ["Data Staged", 0.07982161148773155], ["File and Directory Discovery", 0.07305977506229148], ["Automated Collection", 0.0396366758834946]], "obtains the victim\u2019s username.": [["System Owner/User Discovery", 0.883655315464468], ["Account Discovery", 0.030525877918235647], ["System Information Discovery", 0.009305183093587634], ["Native API", 0.0034275090266601437], ["Permission Groups Discovery", 0.002906901518195647], ["Access Token Manipulation", 0.0028306457774181382]], "RAM size and usage": [["System Information Discovery", 0.1840984661395487], ["Virtualization/Sandbox Evasion", 0.04555626361241255], ["Software Discovery", 0.03136559041627349], ["Process Discovery", 0.0256998251783083], ["Command and Scripting Interpreter", 0.025610588527714737], ["Modify System Image", 0.02405651386961229]], "OS version": [["System Information Discovery", 0.5962389190176433], ["Modify System Image", 0.03700249309079024], ["Software Discovery", 0.03596594249855746], ["Windows Management Instrumentation", 0.023466947960087223], ["Virtualization/Sandbox Evasion", 0.01554845787841196], ["Query Registry", 0.012130413527415135]], "obtains various system information including OS version, computer name and RAM size.": [["System Information Discovery", 0.9215327752993426], ["Virtualization/Sandbox Evasion", 0.011465555411438032], ["Windows Management Instrumentation", 0.008913379903915193], ["Software Discovery", 0.005154564361145931], ["Query Registry", 0.004456899036862939], ["System Network Configuration Discovery", 0.004274458394880838]], "List of installed security products": [["Software Discovery", 0.7871949589321955], ["Query Registry", 0.02991124222497673], ["Impair Defenses", 0.02279300582713457], ["Windows Management Instrumentation", 0.01773700917399764], ["System Service Discovery", 0.006407139388959813], ["Domain Trust Discovery", 0.005000632391187223]], "obtains a list of installed security software.": [["Software Discovery", 0.8865219983038515], ["Query Registry", 0.015740089716350516], ["Windows Management Instrumentation", 0.00990093882843343], ["Impair Defenses", 0.009013692731201334], ["System Information Discovery", 0.005077023282733889], ["System Service Discovery", 0.003164065033603338]], "Local and external IP address": [["System Network Configuration Discovery", 0.2868563976734498], ["Dynamic Resolution", 0.13991412703453862], ["Adversary-in-the-Middle", 0.030856613228500515], ["Network Boundary Bridging", 0.030658541077765195], ["Proxy", 0.029869950864264215], ["Impair Defenses", 0.01941214528652678]], "obtains the device\u2019s local and external IP address.": [["System Network Configuration Discovery", 0.8640886348609843], ["System Network Connections Discovery", 0.014650988795783693], ["Remote System Discovery", 0.009658291252899676], ["System Information Discovery", 0.009313947914211754], ["System Location Discovery", 0.00793227385780113], ["Dynamic Resolution", 0.006441658089745411]], "XOR-decrypts an embedded PE file": [["Deobfuscate/Decode Files or Information", 0.7056143232911556], ["Obfuscated Files or Information", 0.06914409543163048], ["Data Encrypted for Impact", 0.040624315210819974], ["Encrypted Channel", 0.014176768170053847], ["Archive Collected Data", 0.01211349439020564], ["Execution Guardrails", 0.011380547742723502]], "XOR-decrypts further shellcode carried within itself,": [["Deobfuscate/Decode Files or Information", 0.7567954651084567], ["Obfuscated Files or Information", 0.12378594760455439], ["Encrypted Channel", 0.021209994839407546], ["Data Encrypted for Impact", 0.010234902556722512], ["Archive Collected Data", 0.00836706531639658], ["Execution Guardrails", 0.0054758949624164974]], "XOR-decrypts its contents,": [["Deobfuscate/Decode Files or Information", 0.7853163762334945], ["Obfuscated Files or Information", 0.041127708131377394], ["Data Encrypted for Impact", 0.03200368742624031], ["Archive Collected Data", 0.029226933047011645], ["Encrypted Channel", 0.026562569401384625], ["Weaken Encryption", 0.008306957327400477]], "a decrypted configuration": [["Deobfuscate/Decode Files or Information", 0.4042533680968185], ["Data Encrypted for Impact", 0.13679237046857862], ["Obfuscated Files or Information", 0.07457129915361], ["Weaken Encryption", 0.05219238402365723], ["Archive Collected Data", 0.05121387208489827], ["Encrypted Channel", 0.03405192373697226]], "injects it into the created process": [["Process Injection", 0.8030810029653116], ["Native API", 0.06254742953696424], ["Create or Modify System Process", 0.014998910544428272], ["Access Token Manipulation", 0.014303090214887109], ["Hijack Execution Flow", 0.012240586009327844], ["Process Discovery", 0.009900500495216404]], "in a specified separate process that is created and injected.": [["Process Injection", 0.5005608540273471], ["Native API", 0.07699366558062781], ["Create or Modify System Process", 0.04683095003613771], ["Hijack Execution Flow", 0.0410484949784666], ["Process Discovery", 0.021851171932770218], ["System Services", 0.01950507671011135]], "and inject processes.": [["Process Injection", 0.6396405365849386], ["Native API", 0.03482720777637763], ["Hijack Execution Flow", 0.02962078582715481], ["Create or Modify System Process", 0.02398711816859819], ["Event Triggered Execution", 0.019160400717953042], ["System Binary Proxy Execution", 0.013843184130885526]], "it creates a one-time scheduled task.": [["Scheduled Task/Job", 0.7250028785282818], ["Masquerading", 0.028570682437965], ["Inter-Process Communication", 0.024860770253382507], ["Create or Modify System Process", 0.022601942910286756], ["Command and Scripting Interpreter", 0.015079668118198851], ["System Services", 0.009723204000123102]], "uses a temporary scheduled task to start after installation.": [["Scheduled Task/Job", 0.20705063127734574], ["Create or Modify System Process", 0.1848533723318493], ["Boot or Logon Autostart Execution", 0.10724994326463266], ["Boot or Logon Initialization Scripts", 0.07057505065600449], ["Event Triggered Execution", 0.05508109639884322], ["System Binary Proxy Execution", 0.02930949135221258]], "After execution, the output of commands is uploaded.": [["Command and Scripting Interpreter", 0.10153513842051919], ["Ingress Tool Transfer", 0.08543988159527657], ["Data Staged", 0.07823960380678066], ["Data from Local System", 0.06865718446563542], ["Automated Exfiltration", 0.06332274470704316], ["Automated Collection", 0.06151826030708352]], "exfiltrates data to Google Drive storage": [["Exfiltration Over Web Service", 0.3056454231532694], ["Archive Collected Data", 0.05362637004385738], ["Data from Local System", 0.048632190325782816], ["Exfiltration Over Physical Medium", 0.0450603953675838], ["Automated Exfiltration", 0.043934216772677386], ["Data Staged", 0.043406304384122185]], "it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.": [["Data from Local System", 0.18392653494988806], ["Exfiltration Over Web Service", 0.09656723852248779], ["Automated Collection", 0.0733033419976304], ["Data from Network Shared Drive", 0.06904047877721992], ["File and Directory Discovery", 0.068162196941387], ["Data from Removable Media", 0.06341448350259893]], "exfiltrates data to Google Drive.": [["Exfiltration Over Web Service", 0.27146485243695073], ["Archive Collected Data", 0.06148711086170675], ["Data from Local System", 0.05515751864930441], ["Exfiltration Over Physical Medium", 0.05068121677051833], ["Exfiltration Over C2 Channel", 0.05062268376209764], ["Automated Exfiltration", 0.04464785916954079]], "The shellcode is stored in the registry,": [["Query Registry", 0.09234845594744387], ["Obfuscated Files or Information", 0.08731694370419234], ["Native API", 0.07996108925964038], ["Deobfuscate/Decode Files or Information", 0.07076712268967342], ["Command and Scripting Interpreter", 0.04198248045002738], ["System Information Discovery", 0.03547179971627012]], "sending an HTTP POST request": [["Application Layer Protocol", 0.47319255656437903], ["Exfiltration Over C2 Channel", 0.05330421599607208], ["Data Encoding", 0.04049778917032732], ["Exfiltration Over Alternative Protocol", 0.0300176894327462], ["Web Service", 0.021923942090276753], ["Data Obfuscation", 0.018326510849988476]], "uses HTTPS to communicate with Google Drive.": [["Application Layer Protocol", 0.22532303926032438], ["Web Service", 0.09136240236724798], ["Exfiltration Over Alternative Protocol", 0.038899639788812085], ["Stage Capabilities", 0.0304064253038709], ["Encrypted Channel", 0.02380474158932506], ["Ingress Tool Transfer", 0.020519014093111382]], "staging the data in encrypted ZIP archives before upload.": [["Archive Collected Data", 0.5402474885258881], ["Obfuscated Files or Information", 0.06418236724066498], ["Exfiltration Over Alternative Protocol", 0.0625367828920649], ["Data Staged", 0.02849054165587805], ["Data Encrypted for Impact", 0.027138508655938358], ["Deobfuscate/Decode Files or Information", 0.02026586895211349]], "stages collected data in a directory before exfiltration": [["Data Staged", 0.4000696035383327], ["Data from Local System", 0.09323595451093163], ["Archive Collected Data", 0.07341151665900163], ["Automated Collection", 0.06120253503585118], ["Automated Exfiltration", 0.05667857130304192], ["Exfiltration Over C2 Channel", 0.03807943461791765]], "The content is encrypted using AES CBC with random 16-byte keys and IVs,": [["Deobfuscate/Decode Files or Information", 0.18804005042051383], ["Archive Collected Data", 0.15415959644440716], ["Encrypted Channel", 0.13167256769064437], ["Obfuscated Files or Information", 0.12439566889869172], ["Data Encoding", 0.06186995795233755], ["Data Encrypted for Impact", 0.04595450128478689]], "Most strings in this version are base64 encoded.": [["Data Encoding", 0.3741233963267507], ["Obfuscated Files or Information", 0.3313917308520832], ["Deobfuscate/Decode Files or Information", 0.1308891489515378], ["Data Obfuscation", 0.017097717599832658], ["Encrypted Channel", 0.013880640073679798], ["Archive Collected Data", 0.013696993232302645]], "The base64-encoded strings were plaintext again in this version.": [["Data Encoding", 0.3589985557177805], ["Obfuscated Files or Information", 0.2766626000099197], ["Deobfuscate/Decode Files or Information", 0.13145929686184854], ["Data Obfuscation", 0.024977973764089566], ["Encrypted Channel", 0.023360572146855867], ["Archive Collected Data", 0.01580685043209105]], "has encrypted components.": [["Obfuscated Files or Information", 0.21105998907868959], ["Data Encrypted for Impact", 0.18214803520445377], ["Encrypted Channel", 0.10320365661622391], ["Weaken Encryption", 0.058761520129679876], ["Archive Collected Data", 0.05443447040068768], ["Execution Guardrails", 0.0456586505702366]], "another shellcode, XOR-decrypts an embedded PE file \u2013 the Dolphin backdoor \u2013 and loads and executes it using a custom PE loader.": [["Deobfuscate/Decode Files or Information", 0.08327953192600732], ["Unsecured Credentials", 0.05241599278977982], ["OS Credential Dumping", 0.044339192180225515], ["Obfuscated Files or Information", 0.04244366556619026], ["Command and Scripting Interpreter", 0.041437924605193896], ["Process Injection", 0.04130634607294761]], "which is vulnerable to a DLL side-loading vulnerability, and loads a file": [["Hijack Execution Flow", 0.5262089568284053], ["Shared Modules", 0.1358322766767916], ["Process Injection", 0.06356911173235683], ["System Binary Proxy Execution", 0.035294326357713526], ["Event Triggered Execution", 0.017771885714729926], ["Native API", 0.01459014698079559]], "sideloading different DLL names, and multiple binary files names being loaded by those DLLs.": [["Hijack Execution Flow", 0.5293693719805963], ["Shared Modules", 0.11216493978418604], ["System Binary Proxy Execution", 0.05647522964382963], ["Masquerading", 0.04374054440644341], ["Process Injection", 0.03195004541532841], ["Native API", 0.01983684667987297]], "the executables and sideloaded files": [["File and Directory Discovery", 0.13649885471714332], ["Hijack Execution Flow", 0.13480505062160708], ["Masquerading", 0.06244902244136105], ["Software Discovery", 0.061431026510647836], ["Indicator Removal", 0.04235259681707273], ["System Binary Proxy Execution", 0.03172028699250333]], "Side-loaded DLL name": [["Hijack Execution Flow", 0.44784097511079024], ["Shared Modules", 0.13281743589910142], ["System Binary Proxy Execution", 0.06560743466453914], ["Masquerading", 0.06429588446495947], ["Process Injection", 0.036572854032029416], ["Native API", 0.031430539751570265]], "a threat actor abusing a sideloading vulnerability": [["Hijack Execution Flow", 0.10320709312437953], ["Exploitation for Client Execution", 0.07564990614519942], ["Exploit Public-Facing Application", 0.0677510950168071], ["Subvert Trust Controls", 0.04613075107290778], ["Process Injection", 0.03718010999153741], ["Obtain Capabilities", 0.03520703660887946]], "Name of the malicious side-loaded DLL": [["Hijack Execution Flow", 0.3689250763061686], ["Shared Modules", 0.15253980808848702], ["System Binary Proxy Execution", 0.07903600567716138], ["Process Injection", 0.0693906001887035], ["Masquerading", 0.03079734549772049], ["Native API", 0.029062366245845378]], "Name of the executable vulnerable to side loading": [["Hijack Execution Flow", 0.5517729397456672], ["System Binary Proxy Execution", 0.06914396764858358], ["Shared Modules", 0.04510152192234605], ["Masquerading", 0.02900514134061803], ["Process Injection", 0.028609250052536995], ["Native API", 0.023049702484641135]], "seemingly legitimate executables and their respective sideloaded files": [["Hijack Execution Flow", 0.4505616571539044], ["Masquerading", 0.10232464594841248], ["System Binary Proxy Execution", 0.08103390859078594], ["Shared Modules", 0.035734604990872186], ["XSL Script Processing", 0.02762260422679758], ["Native API", 0.021457049919433445]], "encoded shellcode": [["Obfuscated Files or Information", 0.49269653858734636], ["Deobfuscate/Decode Files or Information", 0.2197879952134209], ["Data Encoding", 0.10585023664223979], ["Encrypted Channel", 0.015804950355216858], ["Data Obfuscation", 0.01268958244689417], ["Archive Collected Data", 0.00914938116824546]], "Creates a memory section with the DES-encrypted malware configuration": [["Obfuscated Files or Information", 0.20231368483187745], ["Process Injection", 0.1184891856553046], ["Deobfuscate/Decode Files or Information", 0.06038522302107151], ["Data Encrypted for Impact", 0.043495421106549366], ["Archive Collected Data", 0.0332957306892077], ["Hide Artifacts", 0.03272142029708103]], "to obfuscate their malware.": [["Obfuscated Files or Information", 0.5409592636588857], ["Masquerading", 0.043104337752976445], ["Deobfuscate/Decode Files or Information", 0.029901507548284332], ["Data Obfuscation", 0.0164405080776764], ["Data Encoding", 0.015438538937616363], ["Obtain Capabilities", 0.01464810865789703]], "used VMProtect to obfuscate one of them.": [["Obfuscated Files or Information", 0.5208247744038823], ["Deobfuscate/Decode Files or Information", 0.09638266669039744], ["Hide Artifacts", 0.06107305054643987], ["Archive Collected Data", 0.05759651461014286], ["Masquerading", 0.029342112539563973], ["Data Obfuscation", 0.017373837888065766]], "that decompresses and loads the first stage in memory.": [["Deobfuscate/Decode Files or Information", 0.23905148799724335], ["Archive Collected Data", 0.06962618590962916], ["Hide Artifacts", 0.04363366794525905], ["Inhibit System Recovery", 0.03197150278698716], ["Process Injection", 0.030910919394201996], ["Obfuscated Files or Information", 0.030634630126683562]], "shellcode decompressing and loading": [["Deobfuscate/Decode Files or Information", 0.5158367443078649], ["Obfuscated Files or Information", 0.20032931300759227], ["Archive Collected Data", 0.11900885343021232], ["Command and Scripting Interpreter", 0.009914215839285713], ["Hide Artifacts", 0.008873856002836175], ["Data Encrypted for Impact", 0.007180491234303724]], "there was only one stage being decrypted in memory": [["Deobfuscate/Decode Files or Information", 0.5791115868994345], ["Data Encrypted for Impact", 0.05007679475665352], ["Obfuscated Files or Information", 0.046237395071447356], ["Archive Collected Data", 0.03596826617432736], ["Encrypted Channel", 0.02745715847944048], ["Weaken Encryption", 0.027442417594165616]], "the malware decrypts the saved passwords": [["Credentials from Password Stores", 0.2471691136532899], ["Unsecured Credentials", 0.12817056485594316], ["OS Credential Dumping", 0.1248256682422874], ["Deobfuscate/Decode Files or Information", 0.07633242896832976], ["Brute Force", 0.05696063911399928], ["Input Capture", 0.028037864740488316]], "and then decrypts them": [["Deobfuscate/Decode Files or Information", 0.5637595508229543], ["Archive Collected Data", 0.10836438157459376], ["Data Encrypted for Impact", 0.07048576842297345], ["Obfuscated Files or Information", 0.06234476729290524], ["Encrypted Channel", 0.020095611779345893], ["Data Encoding", 0.015947290372805192]], "and then decrypts the content": [["Deobfuscate/Decode Files or Information", 0.4810908065370294], ["Archive Collected Data", 0.1327809914563598], ["Data Encrypted for Impact", 0.08516359599809636], ["Obfuscated Files or Information", 0.08175182062866918], ["Encrypted Channel", 0.029153057748325346], ["Data Encoding", 0.022388891626631727]], "calls Stage 1 again via process hollowing with four parameters": [["Process Injection", 0.20419681152690783], ["Native API", 0.06824252924967202], ["Virtualization/Sandbox Evasion", 0.04353794555438635], ["Command and Scripting Interpreter", 0.03546673264906727], ["Process Discovery", 0.025690444177569143], ["Access Token Manipulation", 0.019984632436188914]], "It then runs Stage 2 via process hollowing.": [["Process Injection", 0.16336595637630422], ["Virtualization/Sandbox Evasion", 0.07111407173126755], ["Create or Modify System Process", 0.02452944633014835], ["Process Discovery", 0.024407974641629925], ["Native API", 0.019403364780574896], ["Deobfuscate/Decode Files or Information", 0.018808753398607984]], "creates a registry key": [["Modify Registry", 0.5357280201522894], ["Boot or Logon Autostart Execution", 0.21938910928854588], ["Query Registry", 0.05814045132180745], ["Office Application Startup", 0.014953849174319998], ["Create or Modify System Process", 0.012209511427760299], ["System Binary Proxy Execution", 0.011435522104467027]], "a service that launches the moved executable rc.exe with one parameter.": [["Create or Modify System Process", 0.26470101114485], ["System Services", 0.16278421717894692], ["Hijack Execution Flow", 0.12216042308696898], ["Boot or Logon Autostart Execution", 0.08042940707957397], ["Masquerading", 0.05898482579968147], ["Event Triggered Execution", 0.04018405402621699]], "Screenshot grab": [["Screen Capture", 0.8348291301322329], ["Application Window Discovery", 0.016057743397264634], ["Video Capture", 0.012922920059352106], ["Clipboard Data", 0.010868319706539216], ["Input Capture", 0.0051394279755837815], ["Data from Local System", 0.005032511012439117]], "Drive information retrieval": [["File and Directory Discovery", 0.4077011667099025], ["Data from Network Shared Drive", 0.06367590840638084], ["Automated Collection", 0.04663850180179539], ["Data from Local System", 0.04628102073908522], ["Peripheral Device Discovery", 0.04528018528915946], ["Data from Removable Media", 0.041828242776494065]], "browses a directory": [["File and Directory Discovery", 0.4974991213248904], ["Data from Local System", 0.04641113927427135], ["Data Staged", 0.0385845642587393], ["Data from Network Shared Drive", 0.034907297373589545], ["Native API", 0.0307470852960768], ["Ingress Tool Transfer", 0.026166671485405368]], "Process manager (browses and terminates processes)": [["Process Discovery", 0.4454511763470157], ["Impair Defenses", 0.08460461341639984], ["Service Stop", 0.07154670393271544], ["Process Injection", 0.048019472402236], ["Native API", 0.04052398475048771], ["Access Token Manipulation", 0.01953495658813369]], "Current process ID": [["Process Discovery", 0.684754519366204], ["Native API", 0.07138572327067161], ["Process Injection", 0.0456830224912337], ["Access Token Manipulation", 0.023688277119731635], ["Windows Management Instrumentation", 0.014133535576396994], ["System Service Discovery", 0.011386364841241335]], "deletes,": [["Indicator Removal", 0.5425086076549627], ["Data Destruction", 0.1598820155812057], ["Inhibit System Recovery", 0.025785090109620903], ["Disk Wipe", 0.022675383680524602], ["System Shutdown/Reboot", 0.019196095553979695], ["Modify Cloud Compute Infrastructure", 0.011621661680276157]], "uploads, downloads a file": [["Ingress Tool Transfer", 0.6338576272891572], ["Data from Local System", 0.03729039654312822], ["Application Layer Protocol", 0.023239910501303356], ["Exfiltration Over C2 Channel", 0.017098966495477413], ["Exfiltration Over Alternative Protocol", 0.015241502326242369], ["Exfiltration Over Web Service", 0.011754681808932124]], "Command execution": [["Command and Scripting Interpreter", 0.5435135383478242], ["Indirect Command Execution", 0.07957730637013076], ["System Services", 0.03813328989876168], ["Scheduled Task/Job", 0.024318750755589907], ["Inter-Process Communication", 0.02261037590418093], ["Native API", 0.020096009441297014]], "by calling the GetNetworkParams API function": [["System Network Configuration Discovery", 0.7401056254686319], ["System Network Connections Discovery", 0.0511958253358458], ["Remote System Discovery", 0.02092891764935399], ["Data from Configuration Repository", 0.018170161110520312], ["Gather Victim Network Information", 0.010926060697337274], ["Adversary-in-the-Middle", 0.009715649740194716]], "Collected machine information includes the following:\nRandomly generated GUID\nHostname": [["System Information Discovery", 0.47291267545904847], ["Remote System Discovery", 0.11074431315176446], ["Windows Management Instrumentation", 0.037912011234143755], ["System Owner/User Discovery", 0.03180680909217078], ["System Network Configuration Discovery", 0.030896635082890166], ["Gather Victim Host Information", 0.025812704152246905]], "Processor architecture": [["System Information Discovery", 0.17543025610404214], ["Virtualization/Sandbox Evasion", 0.06606991576371699], ["Modify System Image", 0.034161706952215404], ["Exploitation for Client Execution", 0.02793360945877584], ["Windows Management Instrumentation", 0.0242534979254004], ["Software Discovery", 0.02403274294209218]], "Operating system version": [["System Information Discovery", 0.6419309529346017], ["Modify System Image", 0.04959978543522392], ["Software Discovery", 0.029740641603293407], ["Windows Management Instrumentation", 0.0181138136628744], ["Virtualization/Sandbox Evasion", 0.01344119562168547], ["Query Registry", 0.012117899615835415]], "Local IP address and port used to send the network packet": [["System Network Configuration Discovery", 0.13536265738568926], ["Non-Standard Port", 0.12316203774660628], ["Dynamic Resolution", 0.08476277931993587], ["Traffic Signaling", 0.07259096232267033], ["System Network Connections Discovery", 0.05426706678407477], ["Non-Application Layer Protocol", 0.05234818010297025]], "The configuration is encrypted with a hardcoded DES key and is a few bytes long": [["Obfuscated Files or Information", 0.15961122127949307], ["Deobfuscate/Decode Files or Information", 0.15738423229419515], ["Unsecured Credentials", 0.1146340765530028], ["Modify Registry", 0.07775912035860952], ["Query Registry", 0.045389449842658774], ["Execution Guardrails", 0.04270892572899761]], "the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.": [["Archive Collected Data", 0.10697111820675052], ["Deobfuscate/Decode Files or Information", 0.10435267553255599], ["Obfuscated Files or Information", 0.09051062670283475], ["Exfiltration Over C2 Channel", 0.037477879175569905], ["Data Encrypted for Impact", 0.0351080714683807], ["Encrypted Channel", 0.03319725104077137]], "information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm:": [["Encrypted Channel", 0.17997955849710287], ["Data Encoding", 0.12222269436878522], ["Deobfuscate/Decode Files or Information", 0.10525474738740802], ["Archive Collected Data", 0.06563358659359866], ["Obfuscated Files or Information", 0.06509791355878625], ["Exfiltration Over Alternative Protocol", 0.05615714838068891]], "the malware retrieves information on the infected machine and sends it to the C&C": [["Data from Local System", 0.1417448976936831], ["Automated Collection", 0.12019402615496239], ["Exfiltration Over C2 Channel", 0.0874862062703311], ["Data Staged", 0.05218180284554204], ["System Information Discovery", 0.0464048319360095], ["Command and Scripting Interpreter", 0.026470703004300506]], "Then, the malware retrieves information on the compromised computer and sends it to the C&C.": [["Data from Local System", 0.1403247154007073], ["Exfiltration Over C2 Channel", 0.12932226895521987], ["Automated Collection", 0.05836283414781074], ["Data Staged", 0.052702824273785], ["Ingress Tool Transfer", 0.0461750961229214], ["Automated Exfiltration", 0.03516756528446281]], "used as a lure to entice the victim into opening the malicious file.": [["User Execution", 0.7655436166990366], ["Masquerading", 0.061948344773041834], ["Phishing", 0.041392863992097094], ["Obfuscated Files or Information", 0.015942991168362175], ["Template Injection", 0.012138942597465724], ["Office Application Startup", 0.007342827302002394]], "to extract the URL, login, and password fields from the file": [["Unsecured Credentials", 0.1886813619684602], ["Credentials from Password Stores", 0.17491518582830803], ["OS Credential Dumping", 0.11915795835529908], ["Browser Session Hijacking", 0.0411554641975689], ["Data from Local System", 0.029522111033919208], ["Network Sniffing", 0.02272363461527858]], "Name of the hardcoded directory where files are copied": [["File and Directory Discovery", 0.2764131143207985], ["Data Staged", 0.11158371235911756], ["Data from Local System", 0.09631384973736884], ["Data from Network Shared Drive", 0.05372883112756686], ["Masquerading", 0.03225425440390755], ["Lateral Tool Transfer", 0.02990876230652285]], "The malware also established persistence on the host with the creation of a registry run key.": [["Boot or Logon Autostart Execution", 0.23272538451695915], ["Modify Registry", 0.1006464129785283], ["Event Triggered Execution", 0.09062197787141969], ["Boot or Logon Initialization Scripts", 0.07231371122188177], ["Create or Modify System Process", 0.0568824744377786], ["Indicator Removal", 0.03792084453895395]], "persistence was achieved by creating a \u2018Run\u2019 key": [["Boot or Logon Autostart Execution", 0.46167289035099707], ["Event Triggered Execution", 0.09914984159278693], ["Boot or Logon Initialization Scripts", 0.07134988556983052], ["Create or Modify System Process", 0.05450364777848324], ["Office Application Startup", 0.03666505532679429], ["Scheduled Task/Job", 0.034642421413659204]], "These files were transferred to the domain controller over SMB.": [["Lateral Tool Transfer", 0.12238826458671198], ["Data from Network Shared Drive", 0.09839597954896256], ["Data from Local System", 0.08393907793422364], ["Data Staged", 0.06702485635755424], ["Transfer Data to Cloud Account", 0.042599663263925724], ["Indicator Removal", 0.03810835979399327]], "dumped lsass memory on the domain controller.": [["OS Credential Dumping", 0.3551369076410935], ["File and Directory Discovery", 0.05080781567076825], ["System Information Discovery", 0.04296021423231635], ["Windows Management Instrumentation", 0.03968313620637267], ["Automated Collection", 0.03452863311027928], ["Data from Local System", 0.0322995398534892]], "We observed a process created by Cobalt Strike accessing lsass.exe": [["Process Injection", 0.16127853579656978], ["Native API", 0.12528386397492086], ["Process Discovery", 0.09991489608807086], ["Windows Management Instrumentation", 0.0349773966965632], ["Hijack Execution Flow", 0.03390310436584902], ["Impair Defenses", 0.032048491958963865]], "is a known indicator of such tools as Mimikatz": [["Virtualization/Sandbox Evasion", 0.12498892876117304], ["System Information Discovery", 0.12060381354954332], ["Software Discovery", 0.07396091541107885], ["File and Directory Discovery", 0.04657010819039703], ["Query Registry", 0.04136688599641713], ["System Service Discovery", 0.02918429599756231]], "most likely using credentials gathered by the previous LSASS access.": [["OS Credential Dumping", 0.3418268569772143], ["Credentials from Password Stores", 0.10117950027168152], ["Unsecured Credentials", 0.08596186597648756], ["Modify Authentication Process", 0.029288378721467046], ["Valid Accounts", 0.025774554299339628], ["Input Capture", 0.025285122398143744]], "then proceeded to access lsass memory on the host to extract credentials.": [["OS Credential Dumping", 0.5096423631226797], ["Unsecured Credentials", 0.17729872004658245], ["Credentials from Password Stores", 0.10922046002394953], ["Network Sniffing", 0.016215726104967278], ["Brute Force", 0.016122295447289065], ["Input Capture", 0.012970492652198977]], "the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.": [["Remote Services", 0.2064435281294775], ["Remote Service Session Hijacking", 0.056517724209360416], ["Remote Access Software", 0.05317967469063442], ["Exploitation of Remote Services", 0.046087448204443354], ["Remote System Discovery", 0.028591807596309374], ["Event Triggered Execution", 0.026918230591765978]], "after completing RDP connections to various hosts on the network": [["Remote Services", 0.4225347271810153], ["Remote Service Session Hijacking", 0.08427108390994555], ["Remote Access Software", 0.06574904312803345], ["System Network Connections Discovery", 0.047512567898916086], ["External Remote Services", 0.02059703474501743], ["Event Triggered Execution", 0.019617546214597475]], "which were started via their interactive RDP session": [["Remote Services", 0.4524009884817587], ["Remote Service Session Hijacking", 0.07299517534909075], ["Remote Access Software", 0.04863375922358758], ["Windows Management Instrumentation", 0.03204871556527839], ["System Network Connections Discovery", 0.03199569427110233], ["Remote System Discovery", 0.025742822694935177]], "RDP was also used by the threat actor": [["Remote Services", 0.49797241624080696], ["Remote Access Software", 0.08696046608125688], ["Exploitation of Remote Services", 0.04230546065493527], ["Remote Service Session Hijacking", 0.035374579975794324], ["External Remote Services", 0.03183269871492283], ["Remote System Discovery", 0.012112114362862698]], "The threat actor was able to RDP to a backup server": [["Remote Services", 0.2708957457806364], ["Remote Access Software", 0.08613972752927043], ["External Remote Services", 0.0495319397423455], ["Lateral Tool Transfer", 0.032031001887836495], ["Valid Accounts", 0.029837078709909898], ["Transfer Data to Cloud Account", 0.024171194874925268]], "running processes were reviewed": [["Process Discovery", 0.6869316471197476], ["Impair Defenses", 0.05148169827781619], ["Process Injection", 0.025029184911246467], ["Native API", 0.01578989662910222], ["Virtualization/Sandbox Evasion", 0.015313596005206839], ["System Service Discovery", 0.014626421318023273]], "the threat actors checked running processes on the accessed hosts via taskmanager": [["Process Discovery", 0.839512386197943], ["Windows Management Instrumentation", 0.01603989118899058], ["System Service Discovery", 0.01566815035409456], ["Software Discovery", 0.012955737519614584], ["Native API", 0.0075180329099074576], ["Virtualization/Sandbox Evasion", 0.006765983184453827]], "checking on running tasks,": [["Process Discovery", 0.47876010671448527], ["System Service Discovery", 0.1046582157357003], ["Scheduled Task/Job", 0.042513503216287], ["Virtualization/Sandbox Evasion", 0.024943455637206752], ["Windows Management Instrumentation", 0.023005912167653655], ["Native API", 0.0174378352700196]], "the new drive contained a LNK file 6570872.lnk and hidden folder \u201cme\u201d.": [["Exfiltration Over Physical Medium", 0.06657526330673438], ["Hide Artifacts", 0.04428352605562692], ["Peripheral Device Discovery", 0.04303487013195195], ["Data from Removable Media", 0.04254985304239384], ["Taint Shared Content", 0.04206820074748786], ["File and Directory Discovery", 0.04028340289182316]], "The contents of hidden folder \u201cme\u201d, included several files and folders that were used for the execution": [["File and Directory Discovery", 0.4537567495623345], ["Hide Artifacts", 0.17994049378571883], ["Data Staged", 0.06850745875489518], ["Data from Local System", 0.03199336069154542], ["Indicator Removal", 0.021627228187714894], ["Masquerading", 0.015635391886753208]], "the folder included a legitimate copy of rundll32.exe": [["System Binary Proxy Execution", 0.3676503710165693], ["Masquerading", 0.11289353823652448], ["Hijack Execution Flow", 0.09703394368768722], ["Native API", 0.06601013343142925], ["Boot or Logon Autostart Execution", 0.02921558441730946], ["System Services", 0.02590413316294556]], "rundll32.exe binary downloaded approximately 0.4 MB of data.": [["Ingress Tool Transfer", 0.11120226199068017], ["BITS Jobs", 0.07437408173261678], ["Data from Local System", 0.07305096650644995], ["Data Transfer Size Limits", 0.045579423328161665], ["Native API", 0.04209717885384787], ["Data Staged", 0.03931746742950931]], "using a renamed copy of rundll32.": [["System Binary Proxy Execution", 0.323638641106379], ["Masquerading", 0.08927465660406433], ["Hijack Execution Flow", 0.08869055053888175], ["Native API", 0.0718503210277028], ["System Services", 0.04697224480526728], ["Process Injection", 0.035536560184735784]], "Batch script to run": [["Command and Scripting Interpreter", 0.7467450919910369], ["Scheduled Task/Job", 0.04418543098746678], ["System Binary Proxy Execution", 0.02015654888320026], ["System Services", 0.011813065555035064], ["Windows Management Instrumentation", 0.010921624743837609], ["Inter-Process Communication", 0.007177970732176791]], "file would execute a batch script": [["Command and Scripting Interpreter", 0.5800033576184708], ["Scheduled Task/Job", 0.07460481062506102], ["System Binary Proxy Execution", 0.07168705950508435], ["System Services", 0.029609869412075752], ["Boot or Logon Autostart Execution", 0.014580394850212154], ["Indirect Command Execution", 0.012792152653223948]], "\"C:\\Windows\\syswow64\\cmd.exe\" /C": [["Native API", 0.16465218114045768], ["Masquerading", 0.12690616242862865], ["System Binary Proxy Execution", 0.08880449613749763], ["File and Directory Discovery", 0.06759335798999201], ["Command and Scripting Interpreter", 0.051443075505296754], ["Hijack Execution Flow", 0.04808362971004559]], "An instance of cmd.exe was launched through explorer.exe which ran the following command": [["Native API", 0.22887519812490661], ["Command and Scripting Interpreter", 0.14560953504111168], ["System Binary Proxy Execution", 0.0653183195998413], ["Process Injection", 0.05911954805993489], ["Event Triggered Execution", 0.04897639402638826], ["Masquerading", 0.04080859960122852]], "cmd.exe session": [["Remote Service Session Hijacking", 0.18491007992320743], ["Command and Scripting Interpreter", 0.10859993182903109], ["Access Token Manipulation", 0.0727944764643813], ["Remote Services", 0.07068752357165364], ["Event Triggered Execution", 0.05645974663555684], ["Windows Management Instrumentation", 0.0236372132293168]], "The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\\Windows\\system32\\cmd.exe /C adcomp.bat which contained the PowerShell command:": [["Remote System Discovery", 0.2931931994981223], ["Windows Management Instrumentation", 0.1758124165361188], ["System Information Discovery", 0.0678916694290193], ["Network Share Discovery", 0.032700459876681826], ["File and Directory Discovery", 0.02999353035756309], ["Command and Scripting Interpreter", 0.029399962051315127]], "Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started.": [["System Binary Proxy Execution", 0.05317314033800528], ["Pre-OS Boot", 0.03624044488945725], ["Command and Scripting Interpreter", 0.03347190055756823], ["Boot or Logon Autostart Execution", 0.030989566702078274], ["Replication Through Removable Media", 0.027993637653575286], ["Masquerading", 0.026473979109142995]], "The names of the registry values changed": [["Modify Registry", 0.5688512019099954], ["Query Registry", 0.14319267791763757], ["Boot or Logon Autostart Execution", 0.060157484115745265], ["Indicator Removal", 0.02650664239760767], ["Impair Defenses", 0.014483453323637539], ["Office Application Startup", 0.011063909258782834]], "The last registry key was used to store additional PowerShell code.": [["Boot or Logon Autostart Execution", 0.2786346163699136], ["Modify Registry", 0.27661103204920995], ["Query Registry", 0.08938495946143772], ["Command and Scripting Interpreter", 0.0369977635567087], ["Office Application Startup", 0.03608770855510046], ["Event Triggered Execution", 0.023287497120778808]], "This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc": [["Process Injection", 0.222348822364002], ["Native API", 0.20068051173192122], ["Process Discovery", 0.11396138008172427], ["Virtualization/Sandbox Evasion", 0.04515450759920733], ["Access Token Manipulation", 0.04121565623459229], ["Command and Scripting Interpreter", 0.024606837898102762]], "the threat actor injected into various processes": [["Process Injection", 0.33394475721725086], ["Process Discovery", 0.12329904842468487], ["Impair Defenses", 0.03843771177322203], ["Access Token Manipulation", 0.027067469033266227], ["Event Triggered Execution", 0.02699887345187801], ["Windows Management Instrumentation", 0.02279229395338363]], "started a BITS job to download a Cobalt Strike beacon": [["BITS Jobs", 0.254743964350061], ["Ingress Tool Transfer", 0.04408139526571113], ["Web Service", 0.0421823431050701], ["Exfiltration Over C2 Channel", 0.029856458509284037], ["Fallback Channels", 0.027970731289264354], ["Command and Scripting Interpreter", 0.026417385302375165]], "whoami  /groups": [["System Owner/User Discovery", 0.32371448044802975], ["Account Discovery", 0.24698434133208122], ["Permission Groups Discovery", 0.12089114362645784], ["Create Account", 0.036724243537560666], ["Valid Accounts", 0.01564629824690374], ["Account Manipulation", 0.015322165342261414]], "threat actor first ran some initial discovery on the host using built-in Windows utilities like ipconfig": [["System Network Configuration Discovery", 0.3490011275083282], ["Remote System Discovery", 0.12725775630637592], ["System Network Connections Discovery", 0.07263957677665446], ["Network Service Discovery", 0.050504952079548124], ["Active Scanning", 0.03296936842687822], ["Dynamic Resolution", 0.02043918789624811]], "WMI was used to pivot to a domain controller on the network.": [["Windows Management Instrumentation", 0.2852827509099004], ["Remote System Discovery", 0.1304258250950095], ["Remote Services", 0.06326449409710001], ["OS Credential Dumping", 0.059265454594232464], ["Valid Accounts", 0.029341675016805086], ["Lateral Tool Transfer", 0.02372389500076096]], "The actor leveraged Impacket\u2019s wmiexec.py to execute commands with a semi-interactive shell": [["Command and Scripting Interpreter", 0.7162082900706962], ["Native API", 0.037578963139727806], ["Indirect Command Execution", 0.027765861965294108], ["Event Triggered Execution", 0.020166200382206713], ["System Binary Proxy Execution", 0.017797221589768694], ["Windows Management Instrumentation", 0.012130840050279198]], "interacts with remote endpoints via WMI": [["Windows Management Instrumentation", 0.6672834057214354], ["Event Triggered Execution", 0.037501328518353784], ["Remote Services", 0.03726671350001807], ["Remote Access Software", 0.01646500750573462], ["Command and Scripting Interpreter", 0.012691754633512398], ["System Services", 0.010489651187502327]], "a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.": [["Windows Management Instrumentation", 0.21429042779572616], ["Network Service Discovery", 0.07636322375135376], ["Traffic Signaling", 0.07586797528900216], ["System Network Connections Discovery", 0.07101147317668759], ["Dynamic Resolution", 0.027156247746166273], ["Command and Scripting Interpreter", 0.02224676488262129]], "the \u2018Powershell.exe\u2019 process initiated the WMI requests.": [["Windows Management Instrumentation", 0.8233838808757439], ["Event Triggered Execution", 0.03321596425779279], ["OS Credential Dumping", 0.010435192142836185], ["Query Registry", 0.007096988196448955], ["Access Token Manipulation", 0.005769502587498538], ["Boot or Logon Autostart Execution", 0.004538785087396543]], "One of the observed commands invoked via WMI was \u2018firefox.exe\u2019.": [["Windows Management Instrumentation", 0.4323117610324043], ["Event Triggered Execution", 0.10229447123939002], ["Software Discovery", 0.027460575158374842], ["Query Registry", 0.026874454663869597], ["Native API", 0.02681468040758196], ["Masquerading", 0.026753823379553527]], "The commands executed included directory traversal,": [["File and Directory Discovery", 0.6144934086684379], ["Native API", 0.033587402711261184], ["Data from Local System", 0.027326732580254667], ["Indicator Removal", 0.01677236317218436], ["Data Staged", 0.015998474648246566], ["Ingress Tool Transfer", 0.014007689070271959]], "Tool Used to Steal Sensitive Information": [["Archive Collected Data", 0.0839395161124788], ["Data from Local System", 0.0786671119854666], ["Email Collection", 0.06320059228452712], ["Exfiltration Over C2 Channel", 0.05727977287991952], ["Exfiltration Over Alternative Protocol", 0.04224174537694806], ["Data from Information Repositories", 0.03169181801746581]], "proxying the traffic": [["Proxy", 0.6280009974623241], ["Application Layer Protocol", 0.0331845700363837], ["Data Obfuscation", 0.031342691132222454], ["Protocol Tunneling", 0.029959784202757644], ["Adversary-in-the-Middle", 0.0196022465255402], ["Non-Application Layer Protocol", 0.01872091403777905]], "initiating a proxied": [["Proxy", 0.5575945925894229], ["Application Layer Protocol", 0.03834431879694853], ["Protocol Tunneling", 0.03058930764732827], ["Fallback Channels", 0.026994236457463284], ["Data Obfuscation", 0.0246803895246629], ["Non-Application Layer Protocol", 0.02140098992218386]], "Several HTTP Post events were observed to the identified domains": [["Application Layer Protocol", 0.21648455243849438], ["Exfiltration Over C2 Channel", 0.05825949688640804], ["Fallback Channels", 0.04630256000183812], ["Data Obfuscation", 0.03821655735515187], ["Data Encoding", 0.03720587527554415], ["Endpoint Denial of Service", 0.02968170474566271]], "HTTP stream containing the content": [["Data Encoding", 0.1442742792974771], ["Application Layer Protocol", 0.1319013310014127], ["Network Sniffing", 0.09670522094566698], ["Exfiltration Over C2 Channel", 0.043309621902716255], ["Exfiltration Over Alternative Protocol", 0.0406460686948378], ["Data Obfuscation", 0.03718157504730505]], "The POST event included a MIME part indicating file upload": [["Ingress Tool Transfer", 0.17096645240484212], ["Exfiltration Over C2 Channel", 0.05144590143719719], ["Data from Local System", 0.04707108392882391], ["Application Layer Protocol", 0.03353095996755732], ["File and Directory Discovery", 0.03042976432544358], ["Automated Exfiltration", 0.03039014706827235]], "The file that was uploaded 775E.bin was deleted by the injected \u2018Explorer.exe\u2019 process from the target endpoint": [["Indicator Removal", 0.5452428309589421], ["Masquerading", 0.02641798912445464], ["Data Staged", 0.02267976808183851], ["Data Destruction", 0.019557477001887473], ["File and Directory Discovery", 0.018617752066477127], ["Ingress Tool Transfer", 0.01852003742038521]], "The threat actor was able to RDP to a backup server using the admin credentials they acquired.": [["Valid Accounts", 0.24297388034455214], ["Remote Services", 0.12871919923917516], ["External Remote Services", 0.06679404840316715], ["OS Credential Dumping", 0.052902908523789975], ["Brute Force", 0.029700564542401216], ["Remote Access Software", 0.022479025540214238]], "This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode": [["Process Injection", 0.7227557073828044], ["Native API", 0.12814439517363854], ["System Binary Proxy Execution", 0.012823302004076054], ["Process Discovery", 0.012407853049498294], ["Access Token Manipulation", 0.011609076889836336], ["Hijack Execution Flow", 0.0090498743618857]], "shellcode stored in Base64.": [["Obfuscated Files or Information", 0.4425392476898826], ["Deobfuscate/Decode Files or Information", 0.2335174832250596], ["Data Encoding", 0.09870382588305578], ["Data Obfuscation", 0.011969829294767387], ["System Information Discovery", 0.011266423363301678], ["Encrypted Channel", 0.011108111903598502]], "The mounted file contains a hidden folder": [["Hide Artifacts", 0.30658209288417754], ["File and Directory Discovery", 0.2514221268461066], ["Data Staged", 0.04282499054259446], ["Masquerading", 0.032576393742969], ["Indicator Removal", 0.023950415975785663], ["Data from Local System", 0.021565907984111978]], "a 200+MB padded file": [["Archive Collected Data", 0.19913767204364397], ["Data Transfer Size Limits", 0.14154084538107323], ["Obfuscated Files or Information", 0.1038510882704078], ["Data Staged", 0.051242878627605126], ["Automated Collection", 0.027972104377281207], ["Indicator Removal", 0.027447178290980163]], "padding the contents with benign data": [["Obfuscated Files or Information", 0.2331106120639699], ["Data Manipulation", 0.05077698596894625], ["Archive Collected Data", 0.03358212855775789], ["Data Encoding", 0.031696345872554425], ["Data Obfuscation", 0.02955644841670517], ["Browser Session Hijacking", 0.022396988026011283]], "It included a standalone file padded with over 200MB of blank spaces, likely to impede analysis of the decompressed ISO file.": [["Obfuscated Files or Information", 0.179093499156716], ["Archive Collected Data", 0.13371733133989464], ["Deobfuscate/Decode Files or Information", 0.09390197104462923], ["Hide Artifacts", 0.055542956370434625], ["Data Encrypted for Impact", 0.020249083460488468], ["Indicator Removal", 0.019333173175582828]], "executes a CMD file": [["Command and Scripting Interpreter", 0.5325328197063962], ["System Binary Proxy Execution", 0.08192651746074209], ["Indirect Command Execution", 0.06513301111664654], ["System Services", 0.04319742881401936], ["Native API", 0.03849052396273752], ["Scheduled Task/Job", 0.023142284219681605]], "The CMD file contains commands": [["Command and Scripting Interpreter", 0.5485147126372948], ["Indirect Command Execution", 0.09021898189320035], ["System Binary Proxy Execution", 0.03390048596169217], ["System Services", 0.022704931026495227], ["Boot or Logon Autostart Execution", 0.02136130804325566], ["Ingress Tool Transfer", 0.019652825254775658]], "which use certutil (renamed here as slaughterhouse.exe) to decode": [["Deobfuscate/Decode Files or Information", 0.5568034257336846], ["Obfuscated Files or Information", 0.1272646355583491], ["Data Encoding", 0.04234205634236599], ["Encrypted Channel", 0.029234957025652358], ["Subvert Trust Controls", 0.021202686513227972], ["Data Obfuscation", 0.017698212956107986]], "The decoded DLL": [["Deobfuscate/Decode Files or Information", 0.5605177523227575], ["Obfuscated Files or Information", 0.16654395202925634], ["Hijack Execution Flow", 0.03701163569156649], ["Process Injection", 0.026842369154594717], ["System Binary Proxy Execution", 0.024231973929077527], ["Native API", 0.01573254423248819]], "thus requires two rounds of decoding using certutil.": [["Deobfuscate/Decode Files or Information", 0.28658941706743823], ["Data Encoding", 0.13628343294114242], ["Obfuscated Files or Information", 0.10257489696412889], ["Encrypted Channel", 0.07142641431246878], ["Data Obfuscation", 0.056470827699632624], ["Subvert Trust Controls", 0.03692502709355114]], "chaining together a series of scripts to decode": [["Deobfuscate/Decode Files or Information", 0.6267151606801642], ["Obfuscated Files or Information", 0.15186757694698008], ["Archive Collected Data", 0.02736639036267379], ["Command and Scripting Interpreter", 0.02226523725532448], ["Data Encoding", 0.017956856506708436], ["Encrypted Channel", 0.010068922471224087]], "The victim double clicks the ISO to mount it": [["Data from Removable Media", 0.07554390662901475], ["Replication Through Removable Media", 0.0721863476830481], ["Hide Artifacts", 0.03668922234732267], ["Masquerading", 0.03208434075520351], ["Exfiltration Over Physical Medium", 0.029938848389328247], ["Peripheral Device Discovery", 0.02677063473964166]], "Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.": [["User Execution", 0.8394169065400863], ["Masquerading", 0.029056204219752118], ["Phishing", 0.028838064502371464], ["Template Injection", 0.006841203006464165], ["Ingress Tool Transfer", 0.004559712747963667], ["Office Application Startup", 0.004091400154709062]], "DLL is then executed using rundll32": [["System Binary Proxy Execution", 0.23681547282532997], ["Hijack Execution Flow", 0.23369346907212984], ["Shared Modules", 0.13039743750346816], ["Process Injection", 0.06813661558673022], ["Native API", 0.06183410337014464], ["System Services", 0.03490578783550365]], "and injects Qakbot into wermgr.exe.": [["Process Injection", 0.07940371552603512], ["System Binary Proxy Execution", 0.05962048676394367], ["Event Triggered Execution", 0.05269023000715446], ["Masquerading", 0.05031200655001017], ["Boot or Logon Autostart Execution", 0.05013706115621968], ["Hijack Execution Flow", 0.04253984585926485]], "This file is base64 twice,": [["Obfuscated Files or Information", 0.378983462904504], ["Deobfuscate/Decode Files or Information", 0.2349540725886164], ["Data Encoding", 0.07676187853327053], ["Archive Collected Data", 0.0555949539170596], ["Masquerading", 0.020351899233502575], ["Data Obfuscation", 0.01778728963749499]], "or unpack the final payload": [["Deobfuscate/Decode Files or Information", 0.3659632187209449], ["Obfuscated Files or Information", 0.1328981079943956], ["Ingress Tool Transfer", 0.05312874669873121], ["Command and Scripting Interpreter", 0.040571520667245474], ["BITS Jobs", 0.01976884769015048], ["Archive Collected Data", 0.01956597500124558]], "modifies registry keys to maintain persistence,": [["Modify Registry", 0.3778762176896222], ["Boot or Logon Autostart Execution", 0.3539866072543695], ["Query Registry", 0.04449450287358033], ["Boot or Logon Initialization Scripts", 0.040616881554513096], ["Event Triggered Execution", 0.02727291555586196], ["Create or Modify System Process", 0.024364468897885468]], "Modifies the Windows registry": [["Modify Registry", 0.5786859981787528], ["Boot or Logon Autostart Execution", 0.09433096004000296], ["Query Registry", 0.09358735677554737], ["Domain Policy Modification", 0.017227536440161968], ["Masquerading", 0.015270662553328205], ["Indicator Removal", 0.014412223406047054]], "modifies the Windows Registry to allow remote desktop connections": [["Remote Services", 0.30889704873899443], ["Remote Access Software", 0.06393296576127656], ["Event Triggered Execution", 0.05317891659504944], ["Boot or Logon Autostart Execution", 0.04514429967255166], ["Modify Registry", 0.04218964532812965], ["Query Registry", 0.0352651925260396]], "establishes persistence through the creation of two keys in CurrentVersion\\Run.": [["Boot or Logon Autostart Execution", 0.32731031251157344], ["Event Triggered Execution", 0.10069663212582233], ["Create or Modify System Process", 0.10040750925766806], ["Boot or Logon Initialization Scripts", 0.096627713058426], ["Scheduled Task/Job", 0.05145076388537696], ["Modify Registry", 0.03312025916142796]], "Creates registry key for persistence only": [["Modify Registry", 0.41300572477746067], ["Boot or Logon Autostart Execution", 0.31480105465655167], ["Query Registry", 0.03804304266414065], ["Boot or Logon Initialization Scripts", 0.035400704128216894], ["Create or Modify System Process", 0.024976445621643445], ["Event Triggered Execution", 0.021102812295148973]], "Creates two registry keys for persistence": [["Modify Registry", 0.4006561446813771], ["Boot or Logon Autostart Execution", 0.31158319168645593], ["Query Registry", 0.04654603368143237], ["Boot or Logon Initialization Scripts", 0.035625481791003624], ["Create or Modify System Process", 0.025950193115094493], ["Event Triggered Execution", 0.024118366742466025]], "Keys found in CurrentVersion\\Run contain references to programs that will execute when a user logs in.": [["Boot or Logon Autostart Execution", 0.1856620025191634], ["Boot or Logon Initialization Scripts", 0.14932140052462348], ["Event Triggered Execution", 0.11033610528321265], ["Query Registry", 0.05424075303515236], ["Hijack Execution Flow", 0.035005396012830634], ["System Service Discovery", 0.030685152081886862]], "operators install and execute remote access tools such as Splashtop on targeted systems.": [["Remote Services", 0.09530786412042862], ["Event Triggered Execution", 0.07138605008955529], ["Remote Access Software", 0.055328141427878626], ["Boot or Logon Initialization Scripts", 0.05152287011283936], ["Boot or Logon Autostart Execution", 0.03550829427495315], ["Remote Service Session Hijacking", 0.02937872256403615]], "remote monitoring and management (RMM) software": [["Remote Access Software", 0.33042173673706493], ["Software Deployment Tools", 0.06416589032344289], ["Windows Management Instrumentation", 0.0541420789544791], ["Command and Scripting Interpreter", 0.02185162834026058], ["External Remote Services", 0.021722566750281776], ["Remote Services", 0.01814385695740541]], "operators use Splashtop to transfer malicious tools from computer to computer in the victim\u2019s environment.": [["Replication Through Removable Media", 0.13005772247490083], ["Lateral Tool Transfer", 0.10653123162276379], ["Communication Through Removable Media", 0.07289198881588291], ["Remote Services", 0.07239749257365384], ["Ingress Tool Transfer", 0.05519041408936187], ["Command and Scripting Interpreter", 0.02272576401342528]], "It copies other malicious batch and EXE files from a compromised internal Server Message Block (SMB) server to the newly created temp folder": [["Lateral Tool Transfer", 0.13350139001113048], ["Data Staged", 0.1315014540047887], ["Data from Local System", 0.0485527816241818], ["Data from Network Shared Drive", 0.04378659429804044], ["Taint Shared Content", 0.04031486969760918], ["Remote Services", 0.038629925668930226]], "operators utilize RDP to move laterally in the victim\u2019s environment.": [["Remote Services", 0.6173521267354387], ["Remote Service Session Hijacking", 0.09680629190585936], ["Remote Access Software", 0.0552327843834739], ["Exploitation of Remote Services", 0.0321282228554513], ["External Remote Services", 0.013938121245968459], ["Valid Accounts", 0.012116917051163576]], "Modifies the Windows registry to allow remote desktop connections.": [["Remote Services", 0.6260948973304465], ["Remote Access Software", 0.12003638684690855], ["Remote Service Session Hijacking", 0.023263343045155715], ["Windows Management Instrumentation", 0.013525838571780665], ["Exploitation of Remote Services", 0.011991146832135048], ["Event Triggered Execution", 0.010542570927818438]], "operators open up an Remote Desktop Protocol (RDP) port": [["Remote Services", 0.23994166375549134], ["Traffic Signaling", 0.15687650186907764], ["Non-Standard Port", 0.06262918575826704], ["Network Service Discovery", 0.046954542585698374], ["Remote Access Software", 0.03612726501808596], ["Non-Application Layer Protocol", 0.030823849572847267]], "operators use Mimikatz to dump passwords.": [["OS Credential Dumping", 0.33345374551628776], ["Credentials from Password Stores", 0.2172988703963362], ["Unsecured Credentials", 0.14083210206666955], ["Brute Force", 0.06371756539457972], ["Password Policy Discovery", 0.04459774221141538], ["Input Capture", 0.03601577784175358]], "operators use Mimikatz to dump passwords from LSASS.": [["OS Credential Dumping", 0.40692463173443705], ["Credentials from Password Stores", 0.16287588368884745], ["Unsecured Credentials", 0.12815978954079896], ["Password Policy Discovery", 0.05708515544226751], ["Brute Force", 0.050890988770719174], ["Input Capture", 0.03354820838552244]], "Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system.": [["OS Credential Dumping", 0.482300628062187], ["Credentials from Password Stores", 0.21408351765660155], ["Unsecured Credentials", 0.12894569670764788], ["Input Capture", 0.017392411109946753], ["Password Policy Discovery", 0.01449063681176818], ["Brute Force", 0.010574193893037582]], "Mimikatz being leveraged maliciously by threat actors in the following ways:\nCredential Loading\nMimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process": [["OS Credential Dumping", 0.4284454448579366], ["Unsecured Credentials", 0.06475404621616253], ["Credentials from Password Stores", 0.06383210051340223], ["Modify Authentication Process", 0.028438526800115434], ["Valid Accounts", 0.02529615703392937], ["Forced Authentication", 0.02162287417370964]], "Mimikatz allows the user to manipulate the dumped credentials,": [["OS Credential Dumping", 0.257028256831143], ["Unsecured Credentials", 0.18268756856731383], ["Credentials from Password Stores", 0.18034692141801567], ["Modify Authentication Process", 0.039225306049047386], ["Brute Force", 0.03595796379286852], ["Input Capture", 0.026555402104012357]], "is a small, UPX-packed password protected binary": [["Credentials from Password Stores", 0.07497036033638513], ["Obfuscated Files or Information", 0.0740567377314735], ["Unsecured Credentials", 0.0720730754674675], ["Modify Authentication Process", 0.054116551541541005], ["Brute Force", 0.04977905341451493], ["OS Credential Dumping", 0.04849623503077822]], "This version of Mimikatz has been compressed using UPX": [["Archive Collected Data", 0.3460974927853289], ["Obfuscated Files or Information", 0.33917914035453844], ["Deobfuscate/Decode Files or Information", 0.0755650949370159], ["Exfiltration Over Alternative Protocol", 0.011010030345525596], ["Masquerading", 0.010331813298432524], ["Data Encoding", 0.008172735817629933]], "While UPX is often legitimately used to reduce file size, we have observed threat actors utilizing UPX and other packing programs to evade static detection of the underlying payload.": [["Obfuscated Files or Information", 0.647587150361778], ["Hide Artifacts", 0.024806611778924875], ["Archive Collected Data", 0.018189355240622478], ["Deobfuscate/Decode Files or Information", 0.016545478633592937], ["Masquerading", 0.01606011535947696], ["Execution Guardrails", 0.012488808478596389]], "operators use UPX to pack DC2.exe and DC4.exe to avoid static signature detection.": [["Subvert Trust Controls", 0.30265881705066705], ["Masquerading", 0.14777850611160528], ["Obfuscated Files or Information", 0.12102088152497174], ["System Script Proxy Execution", 0.05127186749685225], ["System Binary Proxy Execution", 0.045898878203215435], ["Hijack Execution Flow", 0.04260810876909775]], "the batch file makes the following changes to the system": [["Command and Scripting Interpreter", 0.1974923817186284], ["Indicator Removal", 0.09284560559901275], ["Modify Registry", 0.058057104828946035], ["Scheduled Task/Job", 0.04948834533108651], ["Boot or Logon Autostart Execution", 0.04082981193394829], ["Masquerading", 0.028489226099903467]], "executes an embedded batch file.": [["Command and Scripting Interpreter", 0.6148612006955692], ["System Binary Proxy Execution", 0.07661344673044822], ["Scheduled Task/Job", 0.06511703317017928], ["System Services", 0.02065384997497814], ["Inter-Process Communication", 0.01659384723933902], ["Windows Management Instrumentation", 0.014332946900072896]], "is a batch script": [["Command and Scripting Interpreter", 0.6952586462098568], ["Scheduled Task/Job", 0.056757407242331186], ["System Binary Proxy Execution", 0.020283900911528062], ["Windows Management Instrumentation", 0.013506049600152524], ["System Services", 0.011021596559845935], ["Inter-Process Communication", 0.011013430755681713]], "is a batch script that creates a new user": [["Create Account", 0.4600405792770154], ["Valid Accounts", 0.05080583693754507], ["Account Manipulation", 0.04930514556510832], ["Command and Scripting Interpreter", 0.04468464247295415], ["Account Discovery", 0.04395011641850595], ["System Owner/User Discovery", 0.03337146092606454]], "creates a batch script that,": [["Command and Scripting Interpreter", 0.7707428191939152], ["Scheduled Task/Job", 0.03614619799169264], ["System Binary Proxy Execution", 0.017162317489894552], ["System Services", 0.009453282866715809], ["Windows Management Instrumentation", 0.00796518455811882], ["Boot or Logon Autostart Execution", 0.007249588235602116]], "creates a batch script": [["Command and Scripting Interpreter", 0.7281319366918461], ["Scheduled Task/Job", 0.0593034836623635], ["System Binary Proxy Execution", 0.019750726838999828], ["System Services", 0.014658107872977045], ["Boot or Logon Autostart Execution", 0.009102451998911434], ["Inter-Process Communication", 0.008964395615769774]], "Disables the User Account Control (UAC)": [["Abuse Elevation Control Mechanism", 0.40890180401511433], ["Account Access Removal", 0.06265119398247526], ["File and Directory Permissions Modification", 0.05762203178291925], ["Create Account", 0.053697399748575646], ["Access Token Manipulation", 0.03245735028284907], ["Impair Defenses", 0.027623638451560965]], "Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender": [["Service Stop", 0.4968105114099458], ["Impair Defenses", 0.07118712299960483], ["System Service Discovery", 0.06969615278260076], ["System Services", 0.03402344282130941], ["Masquerading", 0.03125688105189524], ["Create or Modify System Process", 0.026819272737959473]], "The HTML code in this file contains embedded JavaScript functionality,": [["Command and Scripting Interpreter", 0.10227916135310322], ["Template Injection", 0.05550235099425238], ["Browser Session Hijacking", 0.0416014185502056], ["User Execution", 0.040824349399776354], ["Ingress Tool Transfer", 0.03854538577666837], ["Server Software Component", 0.03510491094368787]], "cleanup script used to remove evidence of the attack on a system": [["Indicator Removal", 0.6944562323635691], ["Data Destruction", 0.059329359276347395], ["Inhibit System Recovery", 0.025489092813959037], ["Impair Defenses", 0.02227351440225748], ["Disk Wipe", 0.019906937698010826], ["System Shutdown/Reboot", 0.014141171692827418]], "cleanup scripts from other threat actors are usually smaller and more specific to the tools used by that actor.": [["Indicator Removal", 0.6057107661197773], ["Command and Scripting Interpreter", 0.037919024902503165], ["Impair Defenses", 0.034583588487263124], ["Data Destruction", 0.024289946848889035], ["Windows Management Instrumentation", 0.017125113975385325], ["System Shutdown/Reboot", 0.014723551072315556]], "adds an additional layer of obfuscation to the code": [["Obfuscated Files or Information", 0.8300878115467153], ["Deobfuscate/Decode Files or Information", 0.023338170995777858], ["Data Obfuscation", 0.01916092565999988], ["Execution Guardrails", 0.009527832845021768], ["Hide Artifacts", 0.007982783100090164], ["Encrypted Channel", 0.007791469257926568]], "password-protected executables to obfuscate malware": [["Obfuscated Files or Information", 0.486255829903434], ["Deobfuscate/Decode Files or Information", 0.08001238524481581], ["Data Encrypted for Impact", 0.0340075940961885], ["Execution Guardrails", 0.02768014249263026], ["Masquerading", 0.02344442694712595], ["Archive Collected Data", 0.0169989951791085]], "operators used Splashtop \u2013 a remote access and management (RMM) tool \u2013 to transfer the following malware into the target\u2019s environment.": [["Software Deployment Tools", 0.0585758596721842], ["Remote Services", 0.045348235277368636], ["Command and Scripting Interpreter", 0.044572291660963256], ["Remote Access Software", 0.04224024096758965], ["Remote Service Session Hijacking", 0.03756910539196258], ["Lateral Tool Transfer", 0.036566616424489315]], "operators use Splashtop to move laterally and transfer malware between compromised hosts in the victim\u2019s environment.": [["Remote Services", 0.08405949289892156], ["Lateral Tool Transfer", 0.0599154480094896], ["Remote Service Session Hijacking", 0.05444200731423008], ["Replication Through Removable Media", 0.04005331118072932], ["Ingress Tool Transfer", 0.03730566823250231], ["Communication Through Removable Media", 0.0348248765967648]], "utilize Splashtop to transfer netscan.exe, netscan.lic, netscan.xml, newuser.bat, start.bat and turnoff.bat.": [["Command and Scripting Interpreter", 0.11174607518218797], ["Windows Management Instrumentation", 0.03745857619424965], ["Remote Services", 0.0342011500801339], ["OS Credential Dumping", 0.032669119651638504], ["Lateral Tool Transfer", 0.03201455899214026], ["Boot or Logon Autostart Execution", 0.03163323569488165]], "operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks": [["Indicator Removal", 0.7345301059937661], ["Data Destruction", 0.05590073741880556], ["Disk Wipe", 0.019337922281311405], ["Inhibit System Recovery", 0.018646837078804906], ["Masquerading", 0.010653318617220953], ["System Shutdown/Reboot", 0.010212028743117893]], "hid the installer for Advanced Port Scanner within Inno Setup installer to evade static signature detection.": [["Subvert Trust Controls", 0.41346540262968634], ["Masquerading", 0.054262671116135], ["Obfuscated Files or Information", 0.0302082378444801], ["Impair Defenses", 0.023082534921523703], ["Traffic Signaling", 0.020348483186354755], ["System Script Proxy Execution", 0.018820371123731285]], "employing a combination of outdated Microsoft Office document vulnerabilities": [["Exploitation for Client Execution", 0.3788231821378523], ["Obtain Capabilities", 0.11398818033985421], ["Exploit Public-Facing Application", 0.06776658662031756], ["Develop Capabilities", 0.06693235221951337], ["Exploitation of Remote Services", 0.037761967081355374], ["Template Injection", 0.023919279721978826]], "exploit vulnerabilities in Microsoft Word\u2019s Equation Editor": [["Exploitation for Client Execution", 0.12765020081261338], ["Obtain Capabilities", 0.07962370674601395], ["Exploit Public-Facing Application", 0.043910786427539976], ["Develop Capabilities", 0.029155568189200474], ["Exploitation of Remote Services", 0.024269509573712694], ["Supply Chain Compromise", 0.023685173108019673]], "leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office": [["Exploitation for Client Execution", 0.2653170580556479], ["Obtain Capabilities", 0.09938678542306723], ["Develop Capabilities", 0.04205949622983154], ["Exploit Public-Facing Application", 0.0392828726126517], ["Exploitation of Remote Services", 0.030460817529142408], ["Exploitation for Privilege Escalation", 0.024457635825521497]], "employs a forged document linked to G7 to target various governments within the G20 forum.": [["Data Manipulation", 0.05549594188252395], ["Phishing", 0.05347604632989404], ["Develop Capabilities", 0.04143920031258722], ["Drive-by Compromise", 0.038449168664763556], ["Defacement", 0.038435238072909106], ["Obtain Capabilities", 0.03576927348019918]], "spam email comprising an attached MS Office document": [["Phishing", 0.4849038683212554], ["User Execution", 0.10122743635712848], ["Email Collection", 0.04665551619705362], ["Phishing for Information", 0.035810916159283744], ["Office Application Startup", 0.03062477045957713], ["Template Injection", 0.02275788427504216]], "employ the remote template injection method to retrieve the next stage of the malware from the TA\u2019s Command-and-Control (C&C) server.": [["Multi-Stage Channels", 0.11412380250409981], ["Command and Scripting Interpreter", 0.05238277371598363], ["Ingress Tool Transfer", 0.05145304804314357], ["Deobfuscate/Decode Files or Information", 0.045543010494393944], ["Query Registry", 0.027744965726821214], ["Virtualization/Sandbox Evasion", 0.024107399450944113]], "download of a new payload from the attacker\u2019s remote server": [["Ingress Tool Transfer", 0.6920911098136745], ["Command and Scripting Interpreter", 0.02628129028497427], ["Application Layer Protocol", 0.017268838320691555], ["BITS Jobs", 0.016864895380183], ["Multi-Stage Channels", 0.012701357887852194], ["Exfiltration Over C2 Channel", 0.00947962546834868]], "download a backdoor module.": [["Compromise Client Software Binary", 0.08151799500984555], ["Ingress Tool Transfer", 0.043734880105257355], ["BITS Jobs", 0.03402101794747471], ["Impair Defenses", 0.03380297351245644], ["Boot or Logon Autostart Execution", 0.030733466832300306], ["Hijack Execution Flow", 0.030158368518676322]], "downloads and executes a malicious backdoor": [["Ingress Tool Transfer", 0.5402914028027208], ["Command and Scripting Interpreter", 0.10189871736374083], ["BITS Jobs", 0.07277537868666721], ["System Binary Proxy Execution", 0.022206178599328927], ["Multi-Stage Channels", 0.018009635186800942], ["Masquerading", 0.008926267962986982]], "enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word\u2019s Equation Editor": [["Exploitation for Client Execution", 0.10874102906702635], ["Template Injection", 0.10035061941764235], ["Office Application Startup", 0.06171013967002799], ["Obtain Capabilities", 0.052904250822042254], ["Develop Capabilities", 0.03250229525965135], ["Inter-Process Communication", 0.02499832996254791]], "drops an embedded payload, which is a DLL file": [["Hijack Execution Flow", 0.16987404949158477], ["System Binary Proxy Execution", 0.15612983530697427], ["Process Injection", 0.14625130864658878], ["Shared Modules", 0.13667409130294111], ["Deobfuscate/Decode Files or Information", 0.03163771212648471], ["Native API", 0.025135232901493703]], "includes both an encrypted payload and shellcode": [["Obfuscated Files or Information", 0.6230016743391167], ["Deobfuscate/Decode Files or Information", 0.16845310103314706], ["Encrypted Channel", 0.03668036848984804], ["Data Encoding", 0.022217035055611276], ["Archive Collected Data", 0.01831355400179142], ["Execution Guardrails", 0.01714446577022114]], "encrypts the collected information using RC4 encryption with the key \u201cxkYgv127\u201d and encodes it using base64.": [["Archive Collected Data", 0.26176909207485033], ["Obfuscated Files or Information", 0.2543119046679054], ["Deobfuscate/Decode Files or Information", 0.11866366930464653], ["Data Encoding", 0.10115276672460466], ["Encrypted Channel", 0.0593618634446197], ["Data Encrypted for Impact", 0.028269233531398753]], "proceeds to decrypt": [["Deobfuscate/Decode Files or Information", 0.5796304803351824], ["Data Encrypted for Impact", 0.1266768694818637], ["Archive Collected Data", 0.05227783596455634], ["Obfuscated Files or Information", 0.0344820578205697], ["Weaken Encryption", 0.029706335303081092], ["Encrypted Channel", 0.026077042603501334]], "scheduled task entry,": [["Scheduled Task/Job", 0.7659139245126579], ["Inter-Process Communication", 0.04516309182204123], ["Masquerading", 0.018348142331858427], ["Command and Scripting Interpreter", 0.009738566330942396], ["Create or Modify System Process", 0.009073939570116379], ["Process Discovery", 0.00596417029588013]], "executes the export function \u201cStartA\u201d from the DLL": [["Hijack Execution Flow", 0.1771299642961992], ["System Binary Proxy Execution", 0.16687853320822815], ["Shared Modules", 0.07960699478997715], ["Boot or Logon Autostart Execution", 0.06497546597522753], ["Native API", 0.0638768025784473], ["Process Injection", 0.050023027129606795]], "using rundll32.exe": [["System Binary Proxy Execution", 0.5305963224948222], ["Native API", 0.14814962935435358], ["System Services", 0.04347039076978037], ["Hijack Execution Flow", 0.02945494346895674], ["Command and Scripting Interpreter", 0.0260137480155859], ["Masquerading", 0.021931572342433085]], "utilizing the \u201crundll32.exe\u201d command": [["System Binary Proxy Execution", 0.3834023959668552], ["Native API", 0.144659742974232], ["Hijack Execution Flow", 0.0680927977388258], ["System Services", 0.054367985045051824], ["Masquerading", 0.04023300443601554], ["Event Triggered Execution", 0.025933358431802965]], "loader is executed through rundll32.exe": [["System Binary Proxy Execution", 0.29948325461398334], ["Hijack Execution Flow", 0.1614875461151141], ["Native API", 0.07965824532429401], ["Process Injection", 0.07098201501498201], ["Shared Modules", 0.058477465599411756], ["Event Triggered Execution", 0.0256086071212814]], "hostname, operating system name, OS version, username,": [["System Information Discovery", 0.8551474461982719], ["System Owner/User Discovery", 0.025393952692406362], ["Windows Management Instrumentation", 0.008706513564977177], ["File and Directory Discovery", 0.008179596960144584], ["System Network Configuration Discovery", 0.007011347824180568], ["Query Registry", 0.006993622822644274]], "Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type": [["System Information Discovery", 0.36757520074174516], ["System Network Configuration Discovery", 0.23505422480658703], ["Remote System Discovery", 0.061904587552760244], ["System Network Connections Discovery", 0.053120145539473265], ["Windows Management Instrumentation", 0.028384371355949855], ["System Owner/User Discovery", 0.019903626979398445]], "Internet information,": [["Search Open Technical Databases", 0.18214578637173556], ["Search Closed Sources", 0.08832604145778106], ["Search Victim-Owned Websites", 0.07158659541544096], ["Gather Victim Network Information", 0.06861156706802769], ["Search Open Websites/Domains", 0.06740015709563406], ["Gather Victim Host Information", 0.05696022314381776]], "Retrieve TCP/UDP tables": [["System Network Connections Discovery", 0.2644687496563738], ["Network Sniffing", 0.09355029795255458], ["Non-Application Layer Protocol", 0.07597586013781103], ["Network Service Discovery", 0.07357394560028359], ["System Network Configuration Discovery", 0.027927508147669207], ["Automated Collection", 0.027599200808569754]], "the presence of any installed anti-virus software on the machine.": [["Software Discovery", 0.2905975494459258], ["System Information Discovery", 0.10115259226864069], ["Virtualization/Sandbox Evasion", 0.08943404623271574], ["Windows Management Instrumentation", 0.04061127794072407], ["Query Registry", 0.0369942466630237], ["System Time Discovery", 0.020177895203687634]], "encrypted data is then exfiltrated using the below C&C URL": [["Archive Collected Data", 0.31159600591271597], ["Exfiltration Over Alternative Protocol", 0.1289167022508802], ["Data Encrypted for Impact", 0.06481033870035587], ["Deobfuscate/Decode Files or Information", 0.06342314514016135], ["Exfiltration Over C2 Channel", 0.04897951249448002], ["Obfuscated Files or Information", 0.03430526274853636]], "C&C server responds with the next stage executable": [["Native API", 0.15339357778078655], ["System Binary Proxy Execution", 0.10709298416889676], ["Hijack Execution Flow", 0.049421885107819814], ["System Services", 0.0482470809148894], ["Event Triggered Execution", 0.04713619461537995], ["Process Injection", 0.046224679751381566]], "loader establishes a connection with a C&C server in the final stage of the attack.": [["Ingress Tool Transfer", 0.06671279022697127], ["Command and Scripting Interpreter", 0.04962765654971362], ["Fallback Channels", 0.04393401361695638], ["Multi-Stage Channels", 0.0397934486651488], ["Endpoint Denial of Service", 0.03675861078699781], ["Inter-Process Communication", 0.031008115322754416]], "Capture screenshots of victims\u2019 system": [["Screen Capture", 0.8673181376972746], ["Video Capture", 0.026276033317435242], ["Application Window Discovery", 0.009288849979705232], ["Input Capture", 0.006322795534284337], ["Data from Local System", 0.004802765991922295], ["Clipboard Data", 0.003446836407941989]], "Obtain information about processes and services running on the machine": [["Process Discovery", 0.6582063425910989], ["System Service Discovery", 0.12042173879596293], ["Software Discovery", 0.018817064259542823], ["Windows Management Instrumentation", 0.014787198170308108], ["Network Service Discovery", 0.014664632722987686], ["Native API", 0.013056315847971605]], "Retrieve information about registry keys": [["Query Registry", 0.7650825780820449], ["Modify Registry", 0.08030827446140301], ["Software Discovery", 0.01556060916690726], ["Unsecured Credentials", 0.01526204470491733], ["Boot or Logon Autostart Execution", 0.013705514048108339], ["Windows Management Instrumentation", 0.009765950800943432]], "using the remote process execution tool PSExec to execute batch files": [["Command and Scripting Interpreter", 0.2756180380042773], ["System Services", 0.14042960924708744], ["System Binary Proxy Execution", 0.0947024938368049], ["Scheduled Task/Job", 0.06528741632705479], ["Windows Management Instrumentation", 0.05677825672906399], ["Native API", 0.03975581356233519]], "Copy down batch scriptsExecute batch scripts": [["Command and Scripting Interpreter", 0.24756859732632092], ["Scheduled Task/Job", 0.05130722266076933], ["Lateral Tool Transfer", 0.050769341473055965], ["System Binary Proxy Execution", 0.045872559367413634], ["System Services", 0.03585840240160987], ["OS Credential Dumping", 0.032296058984467704]], "defaultChanges the Windows Shell from Explorer to their malicious script": [["Boot or Logon Autostart Execution", 0.11416077900873893], ["Command and Scripting Interpreter", 0.10003863118867734], ["Hide Artifacts", 0.08948396667065923], ["Event Triggered Execution", 0.05414471964824948], ["Masquerading", 0.04528777998147443], ["Process Injection", 0.03892328133495575]], "exe\u2514\u2500\u2500cmd.exe: C:\\Windows\\system32\\cmd.exe /c \"\"rdp.bat\"": [["Remote Services", 0.2539777221766119], ["Command and Scripting Interpreter", 0.17802160190772148], ["Windows Management Instrumentation", 0.03858885137844048], ["Native API", 0.03395449130983229], ["Masquerading", 0.03216387610619294], ["Scheduled Task/Job", 0.03006226985056681]], "executes the shell (file2.bat),": [["Command and Scripting Interpreter", 0.5033206850312698], ["Native API", 0.10603653857779799], ["System Binary Proxy Execution", 0.07047713234040939], ["System Services", 0.02178535713206698], ["Indirect Command Execution", 0.01767056049458216], ["Scheduled Task/Job", 0.014212406718761445]], "tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.": [["Command and Scripting Interpreter", 0.3863241673148486], ["System Services", 0.04844992322759708], ["System Binary Proxy Execution", 0.04531807584770195], ["Scheduled Task/Job", 0.0388702360204978], ["Event Triggered Execution", 0.03564307439581223], ["Native API", 0.03386432293360927]], "Command line flags may be used to change this behavior and invoke one or more of the modules.": [["Modify Registry", 0.07424715771646043], ["Impair Defenses", 0.0707069473700366], ["Event Triggered Execution", 0.054110317524478486], ["Indirect Command Execution", 0.05156331359189538], ["Boot or Logon Autostart Execution", 0.05050195581778174], ["Office Application Startup", 0.03748737939888358]], "that would cause registry changes": [["Modify Registry", 0.4470474452065887], ["Boot or Logon Autostart Execution", 0.06921307059187985], ["Impair Defenses", 0.042611949170110915], ["Indicator Removal", 0.03000107322771509], ["Create or Modify System Process", 0.028202700033912946], ["Query Registry", 0.02694504292383522]], "reg.exe: reg  add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v \"fDenyTSConnections\" /t REG_DWORD /d 0 /": [["Event Triggered Execution", 0.09205797163710208], ["Query Registry", 0.07127004731231378], ["Traffic Signaling", 0.06187737228198222], ["Boot or Logon Autostart Execution", 0.05887754114798691], ["Modify Registry", 0.05676004978235031], ["System Network Connections Discovery", 0.043922915411621466]], "Sets various registry values": [["Modify Registry", 0.625409985409546], ["Query Registry", 0.10067118210399179], ["Boot or Logon Autostart Execution", 0.06863105861187802], ["Boot or Logon Initialization Scripts", 0.016536698520824775], ["Impair Defenses", 0.015475006380910332], ["Domain Policy Modification", 0.011831478860842843]], "to enable Remote Desktop sessions (RDP) using reg.exe.": [["Remote Services", 0.31062940093987684], ["Remote Service Session Hijacking", 0.11797374485475932], ["Event Triggered Execution", 0.06020249402740212], ["Remote Access Software", 0.060173028658269734], ["Access Token Manipulation", 0.02188953507552686], ["Command and Scripting Interpreter", 0.020687942552607703]], "the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service": [["Ingress Tool Transfer", 0.11116183059215928], ["OS Credential Dumping", 0.0945033305270526], ["Command and Scripting Interpreter", 0.042903452514377174], ["Data from Local System", 0.04107912691081495], ["Lateral Tool Transfer", 0.03476539119358472], ["BITS Jobs", 0.033341860597593094]], "Storing the ransomware within a 7zip encrypted archive": [["Archive Collected Data", 0.46579820321776244], ["Data Encrypted for Impact", 0.11327128639757054], ["Obfuscated Files or Information", 0.07521115594873265], ["Deobfuscate/Decode Files or Information", 0.057561188045321385], ["Exfiltration Over Alternative Protocol", 0.02342436076678826], ["Data Staged", 0.018126183545722176]], "encrypted archive containing the ransomware,": [["Archive Collected Data", 0.30162989575592564], ["Data Encrypted for Impact", 0.23289616053563697], ["Obfuscated Files or Information", 0.09116244767501552], ["Deobfuscate/Decode Files or Information", 0.09112591046508457], ["Exfiltration Over Alternative Protocol", 0.01727745020141017], ["Execution Guardrails", 0.01623170761918642]], "a decompression utility to extract the ransomware": [["Deobfuscate/Decode Files or Information", 0.2505265823401596], ["Archive Collected Data", 0.1977387986687213], ["Data Encrypted for Impact", 0.13205167796582573], ["Obfuscated Files or Information", 0.04816819252781375], ["File and Directory Discovery", 0.0182420151676265], ["Data from Local System", 0.01720770746681564]], "drop the defenses of the victim, inhibit monitoring, disable networking": [["Impair Defenses", 0.5818578827279558], ["Endpoint Denial of Service", 0.038282392297113825], ["Modify Cloud Compute Infrastructure", 0.017818659220419693], ["Rootkit", 0.01774589124878256], ["Service Stop", 0.015609065817698258], ["Network Denial of Service", 0.015437810590292507]], "stops specific defensive services (Windows Defender, etc)": [["Impair Defenses", 0.4036605638089959], ["Service Stop", 0.2814527347751254], ["Masquerading", 0.02747003779403889], ["System Service Discovery", 0.017594632928231407], ["Create or Modify System Process", 0.017377671847940118], ["System Shutdown/Reboot", 0.01260305633714723]], "Will also\u00a0skip enumeration and stopping of antivirus software.-": [["Impair Defenses", 0.3575494466376228], ["Software Discovery", 0.12904849977785832], ["Virtualization/Sandbox Evasion", 0.054435592625787316], ["Masquerading", 0.023894643677331448], ["System Binary Proxy Execution", 0.019100136738013262], ["Windows Management Instrumentation", 0.01870791438512558]], "to authenticate to the site behind the onion link on the TOR network": [["Forge Web Credentials", 0.10115923024120763], ["Use Alternate Authentication Material", 0.08774952282058772], ["Browser Session Hijacking", 0.06436127074597824], ["Proxy", 0.034761572157828866], ["Steal Web Session Cookie", 0.03419524712556127], ["Application Layer Protocol", 0.02545589447647097]], "\u00a0ShellExecuteA is also used to launch": [["Native API", 0.1927507820147217], ["Command and Scripting Interpreter", 0.1725797523074611], ["System Binary Proxy Execution", 0.13547341439798383], ["System Services", 0.10592706342339307], ["Boot or Logon Autostart Execution", 0.03305888880075103], ["Hijack Execution Flow", 0.032528525187059946]], "API call attempts to processes:": [["Native API", 0.31167890282500893], ["Process Discovery", 0.16147583629311246], ["Process Injection", 0.06542056109772597], ["Impair Defenses", 0.04060377781668004], ["Access Token Manipulation", 0.030996593530193555], ["Create or Modify System Process", 0.022008759598007327]], "\u00a0The local module utilizes the LookupPrivilegeValueW and AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and OpenProcessToken to obtain SeDebugPrivilege privileges.": [["Access Token Manipulation", 0.31619222840001115], ["Abuse Elevation Control Mechanism", 0.23476584054537036], ["Permission Groups Discovery", 0.042355451455544646], ["Native API", 0.03340745852192526], ["Exploitation for Privilege Escalation", 0.03241374272187013], ["File and Directory Permissions Modification", 0.025631518039378395]], "using Active Directory group policies allows the malicious actor to hit all systems in the environment for as long as that group policy is active in the victim\u2019s environment.": [["Domain Policy Modification", 0.10670804701527073], ["Valid Accounts", 0.08527562644869349], ["Software Deployment Tools", 0.08178232283639325], ["Remote System Discovery", 0.04346180031721319], ["Windows Management Instrumentation", 0.03507373335043118], ["Remote Services", 0.03230634803006294]], "Potential Process Hollowing": [["Process Injection", 0.23828017725740175], ["Native API", 0.04916403556472373], ["Obfuscated Files or Information", 0.034097361828996045], ["Virtualization/Sandbox Evasion", 0.0298376592903592], ["Hide Artifacts", 0.024897057124347068], ["Command and Scripting Interpreter", 0.0152355866422743]], "more sophisticated encryption": [["Encrypted Channel", 0.21312427849161483], ["Obfuscated Files or Information", 0.17904842526608167], ["Data Encrypted for Impact", 0.14524166568334898], ["Weaken Encryption", 0.08711407601444292], ["Archive Collected Data", 0.07245749893790822], ["Deobfuscate/Decode Files or Information", 0.04614656517837897]], "this technique for encryption-decryption is easily more discernable during analysis because both the encrypted data and the mapping are in the same file": [["Obfuscated Files or Information", 0.2618909290758228], ["Deobfuscate/Decode Files or Information", 0.2336240615372645], ["Archive Collected Data", 0.1280290164094052], ["Data Encrypted for Impact", 0.07841481942399794], ["Encrypted Channel", 0.03676965374012128], ["Weaken Encryption", 0.02308364839646524]], "for its execution technique of hiding malicious code inside log files.": [["Impair Defenses", 0.19713577271125515], ["Indicator Removal", 0.1524456113343817], ["Obfuscated Files or Information", 0.12862326033816332], ["Hide Artifacts", 0.049883685520282224], ["Masquerading", 0.04417524077396152], ["Data Staged", 0.030298181584914617]], "The bytes of the encrypted section is a specific index on the byte map": [["Obfuscated Files or Information", 0.28249807700457785], ["Deobfuscate/Decode Files or Information", 0.1996862851219757], ["Archive Collected Data", 0.06373554472938052], ["Data Encrypted for Impact", 0.05507519444883138], ["Encrypted Channel", 0.04310807101953604], ["Data Encoding", 0.03756091636433005]], "Though this is a very rigid method of hiding its codes,": [["Obfuscated Files or Information", 0.3874813731615096], ["Hide Artifacts", 0.09937134258586239], ["Masquerading", 0.061594524590228954], ["Data Obfuscation", 0.060680291374671715], ["Execution Guardrails", 0.03559518470582339], ["Deobfuscate/Decode Files or Information", 0.02512414410457083]], "uses byte remapping to ensure that the shellcode cannot be easily decrypted without the correct byte map": [["Deobfuscate/Decode Files or Information", 0.3853383289586611], ["Obfuscated Files or Information", 0.38352113748955907], ["Encrypted Channel", 0.028051299935645525], ["Data Encoding", 0.025369685617453334], ["Execution Guardrails", 0.015259553524674018], ["Data Obfuscation", 0.012226539103757853]], "usually the encrypted payload": [["Obfuscated Files or Information", 0.23978177705427106], ["Deobfuscate/Decode Files or Information", 0.23203974227309096], ["Data Encoding", 0.08732821997482407], ["Encrypted Channel", 0.05563863734912266], ["Archive Collected Data", 0.0485632958447181], ["Execution Guardrails", 0.03914267101762532]], "shows that their offsets within the encrypted region remain the same since they result in a similar shellcode even if they are composed of different bytes per binary.": [["Obfuscated Files or Information", 0.4693944815460559], ["Deobfuscate/Decode Files or Information", 0.09690851844699305], ["Encrypted Channel", 0.04769811297120545], ["Execution Guardrails", 0.03266568779518779], ["Data Encrypted for Impact", 0.03213494144082674], ["Archive Collected Data", 0.02981289001679774]], "The malware checks if there are monitoring tools, specifically Process Monitor, running in the current machine with the following strings:\nprocmon\nprocmon64\nprocmon64a": [["Process Discovery", 0.3378559709087941], ["Software Discovery", 0.14042313483189137], ["Virtualization/Sandbox Evasion", 0.09074733670895224], ["Windows Management Instrumentation", 0.08588482496887458], ["System Service Discovery", 0.03866588530817401], ["Impair Defenses", 0.033088902876278456]], "checks for a few installed and active antivirus products, namely:\nWindows Defender\nESET": [["Software Discovery", 0.72693614093146], ["Windows Management Instrumentation", 0.03326084352192115], ["System Information Discovery", 0.02843952220847934], ["Query Registry", 0.02322674156564692], ["Virtualization/Sandbox Evasion", 0.022932788951858327], ["File and Directory Discovery", 0.011909881606860033]], "the malware proceeds to decrypt the PowerShell code": [["Deobfuscate/Decode Files or Information", 0.697499149516791], ["Obfuscated Files or Information", 0.11647297694857599], ["Data Encrypted for Impact", 0.036407469450334955], ["Archive Collected Data", 0.014652440743830245], ["Encrypted Channel", 0.011955660103660361], ["Command and Scripting Interpreter", 0.011134160963143267]], "Furthermore, since the data to be decrypted is in another file, the routine becomes even more difficult to investigate, as analysts would need the correct pair for decryption.": [["Deobfuscate/Decode Files or Information", 0.511625432242285], ["Data Encrypted for Impact", 0.11903652955854684], ["Obfuscated Files or Information", 0.09101683840434509], ["Archive Collected Data", 0.07213067746405386], ["Encrypted Channel", 0.01887132190690974], ["Execution Guardrails", 0.015605184197040885]], "Afterward, the shellcode will then decrypt and load the main ViperSoftX DLL embedded within the carrier.": [["Deobfuscate/Decode Files or Information", 0.5426089356377903], ["Obfuscated Files or Information", 0.12338174308842641], ["Process Injection", 0.041928409201518684], ["Hijack Execution Flow", 0.034703147189050876], ["System Binary Proxy Execution", 0.02077280628578169], ["Shared Modules", 0.012338266257351183]], "Moreover, all the strings, binaries, and other relevant data within the ViperSoftX DLL also gets decrypted the same way.": [["Deobfuscate/Decode Files or Information", 0.7324236545007347], ["Obfuscated Files or Information", 0.11401942875519301], ["Archive Collected Data", 0.019240928862150567], ["Data Encrypted for Impact", 0.018596384226168633], ["Encrypted Channel", 0.01415588103389178], ["Weaken Encryption", 0.008235342332346518]], "The actual bytes of the decrypted shellcode": [["Deobfuscate/Decode Files or Information", 0.43764379526721603], ["Obfuscated Files or Information", 0.24785413674465556], ["Data Encoding", 0.029864021124718785], ["Encrypted Channel", 0.02290154918114296], ["System Information Discovery", 0.01980613130962225], ["Data Encrypted for Impact", 0.017267265849629856]], "to crawl through different paths in the system": [["File and Directory Discovery", 0.5191995598695686], ["Automated Collection", 0.0491027432792481], ["Native API", 0.029811038249052357], ["Data from Local System", 0.028906597433810768], ["Data Staged", 0.024449255268086025], ["Hijack Execution Flow", 0.02216115217018312]], "scans for these cryptocurrency wallets in local directories:\nArmory\nAtomic Wallet\nBinance\nBitcoin\nBlockstream Green\nCoinomi\nDelta\nElectrum\nExodus\nGuarda\nJaxx Liberty\nLedger Live\nTrezor Bridge": [["File and Directory Discovery", 0.1307573555083126], ["Automated Collection", 0.06849199789131424], ["Data from Local System", 0.05273125245354783], ["Unsecured Credentials", 0.04407284923822122], ["Network Service Discovery", 0.028157128406622538], ["Data Staged", 0.026828999334824195]], "the use of DLL sideloading for its arrival and execution technique.": [["Hijack Execution Flow", 0.389563737619177], ["Shared Modules", 0.16764925278280673], ["System Binary Proxy Execution", 0.07339022142699497], ["Process Injection", 0.0731405042811414], ["Event Triggered Execution", 0.02397629613438859], ["Native API", 0.01701998776218116]], "found in the sideloaded DLL.": [["Hijack Execution Flow", 0.297029129832566], ["Shared Modules", 0.07960706974586998], ["System Binary Proxy Execution", 0.07914883049859409], ["Process Injection", 0.06637388995832824], ["Native API", 0.048275316010287145], ["Masquerading", 0.03958252928077572]], "the sideloaded DLL),": [["Hijack Execution Flow", 0.25665827076466274], ["System Binary Proxy Execution", 0.14180230633565283], ["Shared Modules", 0.12283957968526356], ["Process Injection", 0.0708434520224743], ["Native API", 0.0415899488557385], ["Masquerading", 0.029559322257621288]], "While other cybercriminals use sideloading to load another non-binary component": [["Hijack Execution Flow", 0.3058535996009388], ["Shared Modules", 0.11612887037347798], ["Process Injection", 0.06583559766042396], ["System Binary Proxy Execution", 0.060698079553482484], ["Masquerading", 0.03251366259261673], ["Event Triggered Execution", 0.02475071776478026]], "We have also found that each sideloader DLL has its own pair of executable and byte map,": [["Hijack Execution Flow", 0.3242018894322651], ["Shared Modules", 0.10312363271933578], ["Obfuscated Files or Information", 0.08322565417272278], ["Process Injection", 0.07084397049259798], ["System Binary Proxy Execution", 0.06353383526194298], ["Deobfuscate/Decode Files or Information", 0.0435216371284042]], "It still downloads a PowerShell code": [["Ingress Tool Transfer", 0.45060271727694945], ["Command and Scripting Interpreter", 0.28118548475568367], ["BITS Jobs", 0.02996249692834237], ["System Binary Proxy Execution", 0.023389846990886927], ["Scheduled Task/Job", 0.008887367497129638], ["Masquerading", 0.008447531831540544]], "or Windows Scripting": [["Command and Scripting Interpreter", 0.3575759691219268], ["Masquerading", 0.04306049720526504], ["System Binary Proxy Execution", 0.03664394906757623], ["Inter-Process Communication", 0.023092031266471837], ["Event Triggered Execution", 0.0214607345406231], ["Native API", 0.021281649977734945]], "File-packed Magniber ransomware": [["Data Encrypted for Impact", 0.26605739539727696], ["Archive Collected Data", 0.06436785567022064], ["Obfuscated Files or Information", 0.05197052941471372], ["Masquerading", 0.040795494485934156], ["Data from Local System", 0.03186658354151119], ["Deobfuscate/Decode Files or Information", 0.030438246933859592]], "To obtain the credentials, the team took a snapshot of lsass.exe": [["OS Credential Dumping", 0.4752576130635019], ["Unsecured Credentials", 0.17693994560550097], ["Credentials from Password Stores", 0.11076628204490119], ["Input Capture", 0.022478169636566837], ["Brute Force", 0.01828611290854484], ["Valid Accounts", 0.011620341569109106]], "with a tool called nanodump, exported the output, and processed the output offline with Mimikatz.": [["Data from Local System", 0.1995130061760605], ["Automated Collection", 0.10047320545580993], ["Archive Collected Data", 0.07563324184528145], ["Data Staged", 0.06368389115695124], ["Automated Exfiltration", 0.053038921419372984], ["Screen Capture", 0.05152820376446176]], "The team obtained the cached credentials from a SharePoint server account by taking a snapshot of lsass.exe with a tool called nanodump, exporting the output and processing the output offline with Mimikatz.": [["OS Credential Dumping", 0.4043581617349728], ["Unsecured Credentials", 0.1765694859353619], ["Credentials from Password Stores", 0.12433612924123506], ["Valid Accounts", 0.02542672887779083], ["Brute Force", 0.024764485806092192], ["Modify Authentication Process", 0.013957146622202238]], "They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization\u2019s mobile device management (MDM) server.": [["Valid Accounts", 0.2566526900881904], ["External Remote Services", 0.04438589444895746], ["Account Manipulation", 0.03747432895054572], ["Brute Force", 0.02878288876480418], ["Remote Services", 0.0264094058565493], ["Browser Extensions", 0.0179815780577193]], "The team used this root access to move laterally to SBS-connected workstations.": [["Valid Accounts", 0.18684248396344322], ["Remote Services", 0.12934591715579333], ["Lateral Tool Transfer", 0.05963539593894056], ["Create Account", 0.03210617797434421], ["Exploitation of Remote Services", 0.027198933697419003], ["Abuse Elevation Control Mechanism", 0.02542638916093362]], "team attempted to determine valid accounts based on group name and purpose": [["Account Discovery", 0.3416990306317609], ["Permission Groups Discovery", 0.2770836310259992], ["System Owner/User Discovery", 0.060567349274485184], ["Create Account", 0.017778231433558216], ["Brute Force", 0.017444811325246713], ["Steal or Forge Kerberos Tickets", 0.013884520855513675]], "The team attempted to leverage these credentials": [["Valid Accounts", 0.15078546392354772], ["Gather Victim Identity Information", 0.08321190787377751], ["Brute Force", 0.06478794677964647], ["Forge Web Credentials", 0.05021018380876788], ["Exploitation for Credential Access", 0.04482312424658232], ["Phishing for Information", 0.03657799263371543]], "From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).": [["Valid Accounts", 0.09056526266661241], ["Compromise Infrastructure", 0.04584281505028249], ["Remote System Discovery", 0.045650537496675955], ["OS Credential Dumping", 0.04319575246771722], ["Remote Services", 0.027455522544363568], ["Domain Policy Modification", 0.025092233366584452]], "with a button, which, when clicked, downloaded a \u201cmalicious\u201d ISO file": [["Ingress Tool Transfer", 0.2601984474275934], ["Command and Scripting Interpreter", 0.09061437233449893], ["User Execution", 0.06588414458560977], ["Masquerading", 0.034856718032479604], ["System Binary Proxy Execution", 0.024189277622226057], ["Data from Removable Media", 0.020595200380158663]], "After the download, another button appeared, which, when clicked, executed the file.": [["Ingress Tool Transfer", 0.6334322512745065], ["Command and Scripting Interpreter", 0.06757097205199022], ["BITS Jobs", 0.04460211323597087], ["System Binary Proxy Execution", 0.03034083399334738], ["User Execution", 0.020694153450991567], ["Masquerading", 0.012702248026402694]], "Users downloaded and executed the team\u2019s initial access payloads after clicking buttons to trigger download and execution.": [["Ingress Tool Transfer", 0.20570153061200222], ["Command and Scripting Interpreter", 0.07249515779367433], ["User Execution", 0.05079014834675704], ["Stage Capabilities", 0.026234036645930787], ["Event Triggered Execution", 0.020981208214917446], ["BITS Jobs", 0.020482880936698138]], "they used compromised workstation and domain admin accounts": [["Valid Accounts", 0.3255109631449094], ["Account Discovery", 0.048775775113438065], ["Compromise Accounts", 0.04688401531278447], ["Create Account", 0.03871848694917779], ["Compromise Infrastructure", 0.037463089785946375], ["Account Manipulation", 0.024047992335428432]], "Use a previously compromised workstation admin account": [["Valid Accounts", 0.35330229135303076], ["Create Account", 0.2048213293064411], ["Account Manipulation", 0.06050336416416414], ["Account Discovery", 0.04365741965342272], ["Account Access Removal", 0.026955505746047475], ["Modify Authentication Process", 0.020618398167666706]], "Use a previously compromised domain admin account": [["Valid Accounts", 0.33889457070377654], ["Create Account", 0.2179787070998362], ["Account Manipulation", 0.06246721741345535], ["Account Discovery", 0.05239047336006734], ["Modify Authentication Process", 0.025299128780224413], ["Account Access Removal", 0.022487537006945186]], "the team leveraged compromised workstation and domain admin accounts to execute a payload": [["Valid Accounts", 0.29230562719938274], ["Create Account", 0.07271758109726667], ["Account Manipulation", 0.059869540935755895], ["Account Discovery", 0.03394944940719677], ["Remote Services", 0.022065587128345887], ["Modify Authentication Process", 0.016983813979470977]], "the team compromised a domain admin account and used it to laterally to multiple workstations and the DC.": [["Valid Accounts", 0.3599726043821047], ["Remote Services", 0.049661195799343284], ["Create Account", 0.03032769662164145], ["Software Deployment Tools", 0.030073698504429574], ["Account Discovery", 0.0298986388732147], ["Account Manipulation", 0.027045437712648824]], "they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC.": [["Lateral Tool Transfer", 0.1619101198904187], ["Ingress Tool Transfer", 0.06234231927070567], ["Valid Accounts", 0.05906810919469956], ["Remote Services", 0.05073685564983875], ["Stage Capabilities", 0.030674204377406613], ["Taint Shared Content", 0.027875034961488115]], "Use a previously compromised workstation admin account to upload and execute a payload via SMB": [["Valid Accounts", 0.28919527189933264], ["Remote Services", 0.13499980844961604], ["Lateral Tool Transfer", 0.09350726594112188], ["Create Account", 0.07579878394208328], ["Account Manipulation", 0.028035020556522367], ["Ingress Tool Transfer", 0.016348990238204335]], "Use a previously compromised domain admin account to upload and execute a payload via SMB": [["Valid Accounts", 0.3283179305807437], ["Remote Services", 0.09288675438045269], ["Create Account", 0.0907763093975277], ["Lateral Tool Transfer", 0.0712435343461129], ["Account Manipulation", 0.03275819928901226], ["Account Discovery", 0.018537177792660297]], "The team\u2019s C2 redirectors used HTTPS reverse proxies to redirect C2 traffic.": [["Proxy", 0.31459391885554844], ["Application Layer Protocol", 0.23070788222105745], ["Data Obfuscation", 0.04820704526785261], ["Fallback Channels", 0.04426988071547433], ["Encrypted Channel", 0.035907214182037385], ["Protocol Tunneling", 0.03428313664486517]], "The team used HTTPS": [["Application Layer Protocol", 0.2646219080394268], ["Stage Capabilities", 0.06157781458383011], ["Fallback Channels", 0.04502555617234996], ["Data Obfuscation", 0.036630300776986306], ["Encrypted Channel", 0.03478893880612177], ["Proxy", 0.03419519120516657]], "the HTTPS beacon": [["Application Layer Protocol", 0.2806506945295609], ["Data Obfuscation", 0.06401041433207444], ["Encrypted Channel", 0.03892921988201682], ["Non-Standard Port", 0.029965180125516324], ["Stage Capabilities", 0.029016883410297838], ["Fallback Channels", 0.02861795667127372]], "post-exploit tool that leverages HTTP protocols for C2 traffic.": [["Application Layer Protocol", 0.4723593748672463], ["Data Obfuscation", 0.0780053803750782], ["Non-Application Layer Protocol", 0.06752239228631197], ["Proxy", 0.04968618928349794], ["Encrypted Channel", 0.040383135116172315], ["Non-Standard Port", 0.03776944564794249]], "used HTTPS reverse proxies to redirect C2 traffic": [["Proxy", 0.4074097702609052], ["Application Layer Protocol", 0.15628949491898195], ["Data Obfuscation", 0.04739631484213848], ["Protocol Tunneling", 0.033780843309203286], ["Encrypted Channel", 0.031939891869589176], ["Fallback Channels", 0.02932243960403547]], "Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.": [["Application Layer Protocol", 0.11796965029806117], ["Remote Service Session Hijacking", 0.07368543664219727], ["Proxy", 0.06850662650712605], ["Remote Services", 0.06454234677879672], ["Non-Application Layer Protocol", 0.0507570808043868], ["Protocol Tunneling", 0.04083708578877278]], "Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP.": [["Remote Service Session Hijacking", 0.09983284714359152], ["Application Layer Protocol", 0.0995664926577344], ["Remote Services", 0.07120513952612155], ["Proxy", 0.052240045029228334], ["Steal Web Session Cookie", 0.04521065343765076], ["Non-Application Layer Protocol", 0.03155699833845565]], "used HTTPS reverse proxies to redirect C2 traffic.": [["Proxy", 0.38735554368866637], ["Application Layer Protocol", 0.16567922039410266], ["Data Obfuscation", 0.05081150777195082], ["Fallback Channels", 0.03744409530938023], ["Encrypted Channel", 0.03256788686200869], ["Protocol Tunneling", 0.031551574335480996]], "the team uploaded and executed well-known malicious files": [["Ingress Tool Transfer", 0.1429670685144534], ["Stage Capabilities", 0.08641832050091036], ["Indicator Removal", 0.04810827387512746], ["Phishing", 0.038658611752116594], ["User Execution", 0.03681008206094639], ["Obfuscated Files or Information", 0.03063098781764404]], "to download and execute a payload": [["Ingress Tool Transfer", 0.61911826201586], ["Command and Scripting Interpreter", 0.13216372476611601], ["BITS Jobs", 0.051405888196374205], ["System Binary Proxy Execution", 0.021467260226186842], ["Deobfuscate/Decode Files or Information", 0.014403661540207136], ["Application Layer Protocol", 0.010215090161210716]], "Upload and execute a well-known (e.g., with a signature) malicious file to a target DC system": [["User Execution", 0.09315851558226233], ["Ingress Tool Transfer", 0.07507095466640004], ["Masquerading", 0.0662551519587856], ["Template Injection", 0.06411264484410727], ["Subvert Trust Controls", 0.060384343662932286], ["Phishing", 0.05829729553166941]], "used redirectors to redirect C2 traffic between the target organization\u2019s network and the team\u2019s C2 servers.": [["Proxy", 0.41293800401197356], ["Application Layer Protocol", 0.07810776960495004], ["Dynamic Resolution", 0.06803866414963362], ["Fallback Channels", 0.05982416499668285], ["Encrypted Channel", 0.02818520540789956], ["Web Service", 0.028166457651121878]], "used HTTPS reverse proxies to redirect C2 traffic between target network and the team\u2019s Cobalt Strike servers.": [["Proxy", 0.5448246345025438], ["Application Layer Protocol", 0.08440976478014836], ["Protocol Tunneling", 0.04189064044702896], ["Fallback Channels", 0.03418978007883349], ["Encrypted Channel", 0.03407161106617864], ["Data Obfuscation", 0.031296656459512545]], "The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team\u2019s Cobalt Strike servers": [["Dynamic Resolution", 0.1487694544861881], ["Proxy", 0.13707627741963077], ["Compromise Infrastructure", 0.0928384781962326], ["Acquire Infrastructure", 0.0777525183486236], ["Fallback Channels", 0.05479531900883696], ["Endpoint Denial of Service", 0.047101133510030584]], "The redirectors used HTTPS reverse proxies to redirect C2 traffic between the target organization\u2019s network and the Cobalt Strike team servers": [["Proxy", 0.43754612529032555], ["Application Layer Protocol", 0.11044680716939141], ["Fallback Channels", 0.04778377573159959], ["Data Obfuscation", 0.032736029390718124], ["Dynamic Resolution", 0.03245372852430038], ["Protocol Tunneling", 0.03213781795638407]], "The team used domain fronting to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating.": [["Dynamic Resolution", 0.14291589484089873], ["Adversary-in-the-Middle", 0.07488301423942277], ["Data Obfuscation", 0.07403613623118006], ["Proxy", 0.07281526241283037], ["Acquire Infrastructure", 0.051550038203977584], ["Fallback Channels", 0.036330309494130526]], "The team used domain fronting [T1090.004] to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating": [["Dynamic Resolution", 0.12162687442695921], ["Adversary-in-the-Middle", 0.09270682176141545], ["Data Obfuscation", 0.07848772448331584], ["Proxy", 0.056404968851651985], ["Fallback Channels", 0.045423675165156496], ["Network Denial of Service", 0.03279832633766682]], "This technique, which also leverages CDNs, allows the beacon to appear to connect to third-party domains, such as nytimes.com, when it is actually connecting to the team\u2019s redirect server": [["Dynamic Resolution", 0.12209342641820055], ["Fallback Channels", 0.09305665389803706], ["Web Service", 0.05290581052823996], ["Acquire Infrastructure", 0.04909002966413128], ["Adversary-in-the-Middle", 0.044017339388443], ["Compromise Infrastructure", 0.030982626112657976]], "This technique leverages CDNs associated with high-reputation domains so that the malicious traffic appears to be directed towards a reputation domain but is actually redirected to the red team-controlled Cobalt Strike servers.": [["Compromise Infrastructure", 0.25807278685410573], ["Acquire Infrastructure", 0.11797099845400254], ["Network Denial of Service", 0.10658033426006072], ["Proxy", 0.07458078471918939], ["Dynamic Resolution", 0.07274512121589452], ["Endpoint Denial of Service", 0.0527337455730259]], "which prompted DC authentication to the SharePoint server using the server\u2019s NTLM hash. The team then deployed Rubeus to capture the incoming DC TGT": [["OS Credential Dumping", 0.3124025950787592], ["Steal or Forge Kerberos Tickets", 0.12081291377827653], ["Use Alternate Authentication Material", 0.03237291720297712], ["Forge Web Credentials", 0.02582606460717481], ["Modify Authentication Process", 0.020027843546226352], ["Remote System Discovery", 0.018833210571744093]], "The team performed an NTLM-relay attack to obtain the DC\u2019s TGT, followed by a golden ticket attack on a SharePoint server with Unconstrained Delegation to gain the ability to impersonate any Site 1 AD account.": [["Valid Accounts", 0.10545679440241379], ["Forge Web Credentials", 0.0673019696238973], ["OS Credential Dumping", 0.06725821199439579], ["Domain Policy Modification", 0.04630758088897831], ["Steal or Forge Kerberos Tickets", 0.03782293851179471], ["Account Discovery", 0.03551258213614501]], "The team ran the DFSCoerce python script, which prompted DC authentication to a server using the server\u2019s NTLM hash. The team then deployed Rubeus to capture the incoming DC TGT.": [["OS Credential Dumping", 0.3482813416552155], ["Steal or Forge Kerberos Tickets", 0.07850686454529135], ["Remote System Discovery", 0.03652888935220765], ["Permission Groups Discovery", 0.023321244057942545], ["Input Capture", 0.017013703334875667], ["Account Discovery", 0.01629394905837988]], "The team ran the DFSCoerce python script, which prompted DC authentication to a server using the server\u2019s NTLM hash": [["OS Credential Dumping", 0.23987642784942337], ["Steal or Forge Kerberos Tickets", 0.0894323448924735], ["Modify Authentication Process", 0.07607383514805971], ["Use Alternate Authentication Material", 0.04250675205378705], ["Forced Authentication", 0.036963248445757206], ["Multi-Factor Authentication Interception", 0.02912215113439702]], "In some instances, they used Windows Management Instrumentation (WMI) Event Subscriptions": [["Event Triggered Execution", 0.48237886192582474], ["Windows Management Instrumentation", 0.0716274300422952], ["Input Capture", 0.03778073410323739], ["Scheduled Task/Job", 0.03229819768247418], ["Application Window Discovery", 0.02556346933806491], ["Native API", 0.02122029504857972]], "The team used WMI Event Subscriptions to move laterally between sites.": [["Server Software Component", 0.06514842493859906], ["Software Deployment Tools", 0.05405877207185854], ["Remote Services", 0.04245022796150949], ["Remote Access Software", 0.037289701871541216], ["Remote Service Session Hijacking", 0.032974225057545346], ["Lateral Tool Transfer", 0.03180053784481697]], "command-line tool": [["Command and Scripting Interpreter", 0.6549102348105545], ["Automated Collection", 0.01557852666973067], ["OS Credential Dumping", 0.01549445962300949], ["Indirect Command Execution", 0.015248255331472676], ["Windows Management Instrumentation", 0.01303565517361492], ["Indicator Removal", 0.012635316221452707]], "which stored credentials in a database file.": [["Unsecured Credentials", 0.3316001368449204], ["Credentials from Password Stores", 0.1849303886462671], ["OS Credential Dumping", 0.18169311111657813], ["Brute Force", 0.030835734125930603], ["Valid Accounts", 0.01607312605530349], ["Password Policy Discovery", 0.012734959965628918]], "searched files on the server, and found plaintext credentials": [["Unsecured Credentials", 0.44199731383036833], ["Credentials from Password Stores", 0.1510312450131719], ["OS Credential Dumping", 0.10313792457432674], ["Brute Force", 0.02702618769581683], ["Network Sniffing", 0.0182316046481313], ["Input Capture", 0.014359103026959386]], "the plaintext credentials in PowerShell scripts": [["Unsecured Credentials", 0.27297055107989227], ["OS Credential Dumping", 0.1470127261401636], ["Credentials from Password Stores", 0.10974584331424463], ["Command and Scripting Interpreter", 0.05920326137913119], ["Input Capture", 0.03877906073081688], ["Modify Authentication Process", 0.033271568221879606]], "the team found a .txt file containing plaintext credentials for the user": [["Unsecured Credentials", 0.32968175652806453], ["Credentials from Password Stores", 0.15954917499977306], ["OS Credential Dumping", 0.1205470799081347], ["Brute Force", 0.05484848782259026], ["Forced Authentication", 0.027866321847366236], ["Valid Accounts", 0.026396557492565625]], "The team found plaintext credentials to an API user account stored in PowerShell scripts on an MDM server.": [["Unsecured Credentials", 0.2871064721613141], ["OS Credential Dumping", 0.22730635020276746], ["Credentials from Password Stores", 0.08932460074748222], ["Brute Force", 0.048102486535142465], ["Valid Accounts", 0.03847551314027507], ["Modify Authentication Process", 0.02448057072866974]], "Using the pattern discovered in these credentials, the team was able to crack the user\u2019s workstation account password": [["Brute Force", 0.40285868900810085], ["OS Credential Dumping", 0.1327859771165377], ["Credentials from Password Stores", 0.06967811733304212], ["Unsecured Credentials", 0.05228723804512177], ["Modify Authentication Process", 0.043540459997026514], ["Password Policy Discovery", 0.041282401287690666]], "The team cracked a user\u2019s workstation account password after learning the user\u2019s patterns from plaintext credentials.": [["Brute Force", 0.3905049235842978], ["OS Credential Dumping", 0.1062801506884011], ["Credentials from Password Stores", 0.08537205576010769], ["Password Policy Discovery", 0.07390657511867134], ["Unsecured Credentials", 0.06321794990541649], ["Modify Authentication Process", 0.02984052475575788]], "Detect and Identify source IP": [["System Network Configuration Discovery", 0.7146555942595411], ["System Network Connections Discovery", 0.02522809754357833], ["Dynamic Resolution", 0.022969371660676984], ["Adversary-in-the-Middle", 0.01635840747217149], ["System Location Discovery", 0.014530727251173057], ["Remote System Discovery", 0.012277917575710935]], "Detect and identify source IP": [["System Network Configuration Discovery", 0.7146555942595411], ["System Network Connections Discovery", 0.02522809754357833], ["Dynamic Resolution", 0.022969371660676984], ["Adversary-in-the-Middle", 0.01635840747217149], ["System Location Discovery", 0.014530727251173057], ["Remote System Discovery", 0.012277917575710935]], "Windows Service Creation": [["Create or Modify System Process", 0.46622576738271515], ["System Services", 0.23450294090268922], ["System Service Discovery", 0.06666487116122378], ["Masquerading", 0.03602839225849278], ["Scheduled Task/Job", 0.015860085413903675], ["Service Stop", 0.015744558506185325]], "execute a payload via SMB and Windows Service Creation, respectively, on several target Workstations.": [["System Services", 0.3091894972578191], ["Remote Services", 0.13564655390897307], ["Lateral Tool Transfer", 0.052162234691284656], ["Exploitation of Remote Services", 0.044619103339063465], ["Create or Modify System Process", 0.03452532320514775], ["Windows Management Instrumentation", 0.027234837376620684]], "execute a payload via SMB and Windows Service Creation, respectively, on a target DC.": [["System Services", 0.11797293839381312], ["Remote Services", 0.06999583443733315], ["Domain Policy Modification", 0.05385484561926884], ["Create or Modify System Process", 0.04858477958204274], ["Inter-Process Communication", 0.04785481325647914], ["Masquerading", 0.044116975087129626]], "execute a payload via Windows Service Creation on target workstations and the DC.": [["System Services", 0.39245146736640313], ["Create or Modify System Process", 0.17842197022446177], ["Scheduled Task/Job", 0.045090190749514356], ["Masquerading", 0.03717202674711096], ["System Service Discovery", 0.028935284462193178], ["Windows Management Instrumentation", 0.013850185185155942]], "The team used the organization\u2019s MDM system to gain root access to machines across the organization\u2019s network without being detected.": [["Valid Accounts", 0.1291270798030029], ["Exploitation of Remote Services", 0.05054530590405491], ["Software Deployment Tools", 0.0403635289241532], ["Remote Services", 0.030542546057274106], ["External Remote Services", 0.029616681441419553], ["Lateral Tool Transfer", 0.021802307224992098]], "The krbtgt account is a domain default account": [["Create Account", 0.18257868868552513], ["Valid Accounts", 0.13929241160553302], ["Account Manipulation", 0.09021327364247922], ["Account Discovery", 0.08715130301492027], ["Steal or Forge Kerberos Tickets", 0.037324774168396475], ["Modify Authentication Process", 0.024557982975718838]], "Use of non-secure default configurations": [["Subvert Trust Controls", 0.09082063752042745], ["Impair Defenses", 0.040007080871691594], ["Exploitation for Defense Evasion", 0.03411908881674498], ["Stage Capabilities", 0.032244031600016536], ["Obfuscated Files or Information", 0.03055009746866158], ["Modify Registry", 0.02698932454441233]], "The organization used default configurations for hosts with Windows Server 2012 R2.": [["Windows Management Instrumentation", 0.04073358625580494], ["Impair Defenses", 0.033305716823800825], ["System Information Discovery", 0.032235845981796823], ["Remote Services", 0.025247013997904615], ["Network Service Discovery", 0.025232238723646095], ["Fallback Channels", 0.02488898637964971]], "The default configuration allows unprivileged users to query group membership of local administrator groups": [["Permission Groups Discovery", 0.8949225509126261], ["Account Discovery", 0.036660919174421096], ["System Owner/User Discovery", 0.012473898017466485], ["Query Registry", 0.0028042551134212883], ["Remote System Discovery", 0.00263203554399281], ["Abuse Elevation Control Mechanism", 0.001599972619501536]], "The red team used and identified several standard user accounts with administrative access from a Windows Server 2012 R2 SharePoint server.": [["Account Discovery", 0.38352063513654644], ["Valid Accounts", 0.12216858406574223], ["Create Account", 0.07895396456669163], ["System Owner/User Discovery", 0.06419469409576746], ["Permission Groups Discovery", 0.04602730478003847], ["Account Manipulation", 0.022339830380644563]], "The team discovered several standard user accounts that have local administrator access to critical servers.": [["Valid Accounts", 0.2616110091952381], ["Create Account", 0.11539687238235442], ["Account Discovery", 0.08480412228151224], ["Account Manipulation", 0.07146521094129926], ["Account Access Removal", 0.02846465903729469], ["Compromise Infrastructure", 0.018656577750681854]], "This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain.": [["Domain Policy Modification", 0.1638046942933298], ["Valid Accounts", 0.13811611759351447], ["Access Token Manipulation", 0.058635413984291326], ["Account Manipulation", 0.03962407458681887], ["Compromise Infrastructure", 0.025514353251038645], ["Permission Groups Discovery", 0.021011690306066668]], "If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges": [["Valid Accounts", 0.2362178413345528], ["Exploitation for Privilege Escalation", 0.06434379048416426], ["Abuse Elevation Control Mechanism", 0.06106221598310671], ["Account Manipulation", 0.05915048395179445], ["Compromise Infrastructure", 0.02975505217803169], ["Access Token Manipulation", 0.025503332061793487]], "Some workstations allowed unprivileged accounts to have local administrator access": [["Valid Accounts", 0.2696117453673015], ["Create Account", 0.16086087290678888], ["Account Manipulation", 0.06861007168707807], ["Abuse Elevation Control Mechanism", 0.05092203295799306], ["Account Discovery", 0.02799572333452314], ["Permission Groups Discovery", 0.0206749550964925]], "keylogged a user during a mandatory password change": [["Input Capture", 0.3249319689940559], ["Modify Authentication Process", 0.11381333054040665], ["Brute Force", 0.08129262408265768], ["Account Access Removal", 0.053208299691627624], ["Password Policy Discovery", 0.03900466940606796], ["Credentials from Password Stores", 0.03419906837829764]], "spear phishing attachments.": [["Phishing", 0.4348580067232156], ["User Execution", 0.15302667492707442], ["Phishing for Information", 0.12157565504373247], ["Internal Spearphishing", 0.03548499514575077], ["Compromise Accounts", 0.026995182042196347], ["Establish Accounts", 0.025403478006345313]], "spear phishing attachments for Initial Access": [["Phishing", 0.45091815957997616], ["User Execution", 0.12715077775677344], ["Phishing for Information", 0.0895828137969209], ["Internal Spearphishing", 0.055173963729905406], ["Establish Accounts", 0.03432204327557418], ["Compromise Accounts", 0.028655009037068892]], "As attackers can quickly change spear phishing attachments": [["Phishing", 0.375486552179867], ["User Execution", 0.10719716405292049], ["Phishing for Information", 0.08919504894679328], ["Internal Spearphishing", 0.06342562264365391], ["Establish Accounts", 0.026320712718447582], ["Compromise Accounts", 0.023620287174281638]], "suspicious email attachments or other phishing techniques.": [["Phishing", 0.3133911186514116], ["Phishing for Information", 0.15429969030805632], ["User Execution", 0.08335881780194986], ["Compromise Accounts", 0.057227031833751024], ["Gather Victim Identity Information", 0.043612181858210516], ["Internal Spearphishing", 0.03625854880954464]], "modification of Registry Keys/Startup folder for persistence": [["Boot or Logon Autostart Execution", 0.4371215590964817], ["Modify Registry", 0.2333251711444083], ["Boot or Logon Initialization Scripts", 0.09050321161969024], ["Create or Modify System Process", 0.040032139049769745], ["Query Registry", 0.026836693605464278], ["Event Triggered Execution", 0.02128702738265655]], "Using valid accounts": [["Valid Accounts", 0.21543682045449947], ["Create Account", 0.1668562257630365], ["Compromise Accounts", 0.07880802097567904], ["Establish Accounts", 0.0713349858679078], ["Account Manipulation", 0.06290853278795196], ["Account Discovery", 0.0290556037758198]], "valid accounts": [["Compromise Accounts", 0.13826455576344704], ["Valid Accounts", 0.12162801247185859], ["Establish Accounts", 0.11023243472273034], ["Create Account", 0.09958475937839235], ["Account Manipulation", 0.05157359569850806], ["Account Discovery", 0.04206883670429571]], "and protocols, such as for Remote Desktop Protocol": [["Remote Services", 0.25739962416354756], ["Non-Application Layer Protocol", 0.08995122017132771], ["Remote Access Software", 0.06274782452631876], ["Application Layer Protocol", 0.042675933386399814], ["System Network Connections Discovery", 0.03353028972965522], ["Protocol Tunneling", 0.026351918026217294]], "used to download files\u2026": [["Ingress Tool Transfer", 0.6193970380627419], ["Command and Scripting Interpreter", 0.03374403657967767], ["Application Layer Protocol", 0.032964259248867665], ["BITS Jobs", 0.022144017269772345], ["Web Service", 0.019664358288636004], ["Data from Local System", 0.016370162173656895]], "The second stage payload, which was later determined to likely be the penetration testing framework \"Brute Ratel,\" was then downloaded via a connection": [["Ingress Tool Transfer", 0.45263421403021836], ["Command and Scripting Interpreter", 0.03557686045820358], ["BITS Jobs", 0.03472575842150879], ["Multi-Stage Channels", 0.024905586671874234], ["Deobfuscate/Decode Files or Information", 0.02404146507694221], ["Application Layer Protocol", 0.022796120509253347]], "\u201cRClone\u201d was downloaded on the file servers": [["Ingress Tool Transfer", 0.14388623117583135], ["Data Staged", 0.06180111206323411], ["File and Directory Discovery", 0.056694689793912616], ["Data from Local System", 0.049290216089981825], ["Indicator Removal", 0.045191092470470456], ["Masquerading", 0.03598200133773929]], "which allowed the threat actor to move freely between domains.": [["Compromise Infrastructure", 0.2727068577701293], ["Acquire Infrastructure", 0.1602409575530074], ["Stage Capabilities", 0.0496406392447991], ["Valid Accounts", 0.0257477538161379], ["Dynamic Resolution", 0.02556063286042931], ["Domain Trust Discovery", 0.02177018276011291]], "Two \".bat\" files were sent throughout the organization.": [["Command and Scripting Interpreter", 0.19760502360907076], ["Masquerading", 0.07566755643592414], ["Office Application Startup", 0.06162650190513176], ["User Execution", 0.04819247762868007], ["Phishing", 0.04276568747907765], ["Inter-Process Communication", 0.03552590387179747]], "before running the \".cmd\" file contained\u00a0within the ISO.": [["Pre-OS Boot", 0.06277805867821755], ["Modify System Image", 0.047375533471612344], ["Masquerading", 0.03334950560353821], ["Replication Through Removable Media", 0.028996505238824053], ["Subvert Trust Controls", 0.0270691403097826], ["Command and Scripting Interpreter", 0.0267489913473731]], "this CMD file calls the \"db\" file. In both samples,": [["Data Staged", 0.15451824093035724], ["File and Directory Discovery", 0.08211715612202876], ["Command and Scripting Interpreter", 0.08057455920741366], ["Data from Local System", 0.04452838721135895], ["Data from Information Repositories", 0.036601720867112275], ["Automated Collection", 0.03389619192070243]], "\".bat\" files": [["Command and Scripting Interpreter", 0.3187071334324782], ["Masquerading", 0.10031301770609365], ["System Binary Proxy Execution", 0.08210446061772197], ["Boot or Logon Autostart Execution", 0.03166168346786932], ["Scheduled Task/Job", 0.02959463132454102], ["Indicator Removal", 0.028735600393046536]], "USING \".BAT\" FILES": [["Command and Scripting Interpreter", 0.54988330941192], ["System Binary Proxy Execution", 0.08714377260439787], ["Scheduled Task/Job", 0.036138065687726796], ["Masquerading", 0.03196506182192964], ["Boot or Logon Autostart Execution", 0.02918997518086819], ["System Services", 0.024987186686426806]], "The two \".bat\" files that were sent": [["Command and Scripting Interpreter", 0.27482590091966475], ["Masquerading", 0.07688062147921976], ["Ingress Tool Transfer", 0.047773614829905935], ["Indicator Removal", 0.04616419759987444], ["Native API", 0.039477842262095365], ["System Binary Proxy Execution", 0.032631267470047944]], "\"cc.bat\" is a simple script": [["Command and Scripting Interpreter", 0.6182730960120459], ["System Binary Proxy Execution", 0.059357045623087815], ["Scheduled Task/Job", 0.027089141259898454], ["System Services", 0.02509631960709683], ["Indirect Command Execution", 0.019687908967647796], ["Event Triggered Execution", 0.014837993279511187]], "\"w.bat\" as viewed through the bash command \"cat\":": [["Command and Scripting Interpreter", 0.183477380971973], ["Native API", 0.10899766861371397], ["File and Directory Discovery", 0.10537056162686756], ["Masquerading", 0.059629316738377264], ["Application Window Discovery", 0.034087781805416], ["Windows Management Instrumentation", 0.026208864095646548]], "these are the same commands as observed in the \".bat\" files:": [["Command and Scripting Interpreter", 0.4419041564605026], ["Boot or Logon Autostart Execution", 0.04697950863290061], ["System Binary Proxy Execution", 0.03958113014256714], ["Indirect Command Execution", 0.03250697219275349], ["Scheduled Task/Job", 0.030164183837917417], ["System Services", 0.02790613036038683]], "Both were designed to turn off antivirus and anti-malware software.": [["Impair Defenses", 0.37413624976042387], ["Software Discovery", 0.11438324086477765], ["Windows Management Instrumentation", 0.024583725676363456], ["Masquerading", 0.022632243279694726], ["Rootkit", 0.01968936179272721], ["Obfuscated Files or Information", 0.016258016963000135]], "\".bat\" files designed to disable Cisco AMP / Microsoft Defender": [["Impair Defenses", 0.38388633395585586], ["Command and Scripting Interpreter", 0.046929463583390084], ["Modify Registry", 0.04093594670446867], ["Masquerading", 0.024581851345463437], ["Boot or Logon Autostart Execution", 0.023721184807204088], ["Software Discovery", 0.02077050327763759]], "the command \"net stop Cisco AMP\".": [["Impair Defenses", 0.14744984295328836], ["Traffic Signaling", 0.12078945055717089], ["Service Stop", 0.04952411621623919], ["Command and Scripting Interpreter", 0.03829879324212359], ["System Shutdown/Reboot", 0.036834170280178366], ["Adversary-in-the-Middle", 0.019367389950836745]], "showing the \u201cuninstall\u201d commands for Windows Defender:": [["Indicator Removal", 0.185513080293108], ["Impair Defenses", 0.1851085118949239], ["Software Discovery", 0.10862371532877632], ["Inhibit System Recovery", 0.047243215349077015], ["Windows Management Instrumentation", 0.045527971263933736], ["Modify Registry", 0.030689744732873597]], "DISABLING ANTIVIRUS/MALWARE SOFTWARE USING \".BAT\" FILES": [["Impair Defenses", 0.2904435621480868], ["Command and Scripting Interpreter", 0.07756267997704709], ["Modify Registry", 0.05659976098261877], ["Software Discovery", 0.053117884606985015], ["Boot or Logon Autostart Execution", 0.040313513256669015], ["Masquerading", 0.03530140898320463]], "were both designed to turn off Antivirus and Antimalware software.": [["Impair Defenses", 0.2903234503460198], ["Software Discovery", 0.18126544195649005], ["Windows Management Instrumentation", 0.026536958964486938], ["Masquerading", 0.02355766269046427], ["Obfuscated Files or Information", 0.01760123808902945], ["Pre-OS Boot", 0.01653573399800146]], "designed to stop Cisco AMP.": [["Impair Defenses", 0.1794423329496428], ["Traffic Signaling", 0.0916201789529342], ["Weaken Encryption", 0.04537646614483807], ["Adversary-in-the-Middle", 0.04210628932274817], ["Network Boundary Bridging", 0.03920946706383076], ["Encrypted Channel", 0.025208875093710875]], "Stopping Cisco AMP /\u00a0 Disabling Microsoft Defender": [["Impair Defenses", 0.5173263143094566], ["Weaken Encryption", 0.027486558694686445], ["Subvert Trust Controls", 0.018984684840943986], ["Modify Registry", 0.015761927335526452], ["Software Discovery", 0.015700732061306018], ["Network Boundary Bridging", 0.015333070623379644]], "From the two phishing emails, both attachments contain similar malware.": [["Phishing", 0.35494033622126164], ["User Execution", 0.13575723383390045], ["Phishing for Information", 0.03814004513550862], ["Internal Spearphishing", 0.03566509276487874], ["Email Collection", 0.02176895594035887], ["Masquerading", 0.01754743065855514]], "The phishing attachment was submitted to the target in a response to an ongoing conversation": [["Phishing", 0.23494168111066432], ["Phishing for Information", 0.08885517561902583], ["User Execution", 0.08136455047929972], ["Internal Spearphishing", 0.07080348160716714], ["Application Layer Protocol", 0.04488928497957868], ["Email Collection", 0.03887226578948546]], "When downloaded, the initial attachment is a local HTML file.": [["Ingress Tool Transfer", 0.3491200752056856], ["User Execution", 0.05881604715371799], ["Phishing", 0.04514296067838925], ["Application Layer Protocol", 0.02719092188046571], ["Command and Scripting Interpreter", 0.0262057132367544], ["Template Injection", 0.022880340867786845]], "were able to be decrypted by leveraging the decryption script": [["Deobfuscate/Decode Files or Information", 0.7148026979329246], ["Data Encrypted for Impact", 0.060932138731130424], ["Obfuscated Files or Information", 0.04147163394549547], ["Archive Collected Data", 0.040407521936396316], ["Encrypted Channel", 0.018467603594716896], ["Weaken Encryption", 0.018019327691454128]], "adds itself to a scheduled task.": [["Scheduled Task/Job", 0.7167366705042997], ["Create or Modify System Process", 0.029493146691460984], ["Inter-Process Communication", 0.020307986318774965], ["Masquerading", 0.01890800604162586], ["Command and Scripting Interpreter", 0.018245798061192715], ["Event Triggered Execution", 0.016996794149096897]], "The emulated C2 Server is now running an HTTPS server": [["Application Layer Protocol", 0.39080443511940727], ["Data Obfuscation", 0.0672835363077425], ["Encrypted Channel", 0.04941902349493894], ["Non-Standard Port", 0.04885341275827964], ["Fallback Channels", 0.04725080565106663], ["Proxy", 0.03471125107921994]], "shows that this connection was likely HTTPS": [["Application Layer Protocol", 0.30293703414497464], ["Non-Standard Port", 0.07008889667064125], ["Data Obfuscation", 0.05468158201205917], ["Fallback Channels", 0.03555362179310376], ["Browser Session Hijacking", 0.032128079983173415], ["System Network Configuration Discovery", 0.02614527006321208]], "the communication is consistent with HTTP/S traffic.": [["Application Layer Protocol", 0.2941505288654834], ["Non-Application Layer Protocol", 0.21608919285720082], ["Non-Standard Port", 0.060203723388100754], ["Encrypted Channel", 0.0524078698132618], ["Data Obfuscation", 0.04091951969021446], ["Protocol Tunneling", 0.028805481245189862]], "on TCP port 2222.": [["Non-Standard Port", 0.2973247342515992], ["Non-Application Layer Protocol", 0.13940492954439737], ["Network Service Discovery", 0.08015757487748064], ["Application Layer Protocol", 0.04103859947707158], ["Traffic Signaling", 0.04025762643314511], ["System Network Connections Discovery", 0.035786592853634745]], "most of the connection attempts to the C2 IP\u2019s are conducted over TCP port 443.": [["Application Layer Protocol", 0.2614396847013861], ["Non-Application Layer Protocol", 0.10909598259520713], ["Non-Standard Port", 0.10092687135931536], ["Proxy", 0.06741764991324016], ["Encrypted Channel", 0.05383479068395663], ["Fallback Channels", 0.04949505493616053]], "Due to TCP port 2222\u2019s common use as an alternate port for SSH communication, the Malware Analyst recorded a manual SSH connection to the emulated C2 host": [["Non-Application Layer Protocol", 0.23933910112682172], ["Protocol Tunneling", 0.08069689614083461], ["Non-Standard Port", 0.07323325565945661], ["Encrypted Channel", 0.06472896226418937], ["Remote Services", 0.04443158917088711], ["Traffic Signaling", 0.03936004986052319]], "some data exfiltration or interaction with the downloaded second stage from the C2.": [["Exfiltration Over C2 Channel", 0.25466801577956705], ["Scheduled Transfer", 0.07956782037134282], ["Fallback Channels", 0.050320332332546645], ["Data Staged", 0.04617865232126647], ["Automated Exfiltration", 0.04536989809549581], ["Ingress Tool Transfer", 0.028084328952622598]], "show the transfer of files using SMB.": [["Lateral Tool Transfer", 0.19357228479907634], ["Network Share Discovery", 0.14498201964453192], ["Remote Services", 0.10855709136547104], ["Data from Network Shared Drive", 0.06131635512829013], ["File and Directory Discovery", 0.033213336160628715], ["Data from Local System", 0.0256576856096187]], "Files commonly observed transferred via SMB include": [["Lateral Tool Transfer", 0.2616632921585019], ["Network Share Discovery", 0.10916340515829569], ["Data from Network Shared Drive", 0.10632417602852506], ["Remote Services", 0.08434962100473314], ["Taint Shared Content", 0.05851164775569499], ["Data from Local System", 0.021986718705376364]], "Showing the Transfer of Cobalt Strike Beacons using RDPClip:": [["Exfiltration Over C2 Channel", 0.06959940181970628], ["Web Service", 0.04421912270964695], ["Fallback Channels", 0.043630439854233656], ["Scheduled Transfer", 0.034566163509214924], ["Automated Exfiltration", 0.029942796612798004], ["Automated Collection", 0.02978131435516115]], "allows for lateral movement leveraging RPC to create SMB traffic.": [["Proxy", 0.15035381577926726], ["Remote Services", 0.14989342737325104], ["Exploitation of Remote Services", 0.05629822383101523], ["Adversary-in-the-Middle", 0.04884331040938992], ["Protocol Tunneling", 0.048142791687648644], ["Non-Application Layer Protocol", 0.04220508239075403]], "indicating the use of Remote Desktop Protocol.[": [["Remote Services", 0.4889336132495371], ["Remote Access Software", 0.0733511725923663], ["System Network Connections Discovery", 0.04873707992096611], ["Remote System Discovery", 0.036602182189390625], ["Remote Service Session Hijacking", 0.023368486938696094], ["Exploitation of Remote Services", 0.016256576285750012]], "the use of RDP by the Threat Actor": [["Remote Services", 0.5074046533380914], ["Remote Access Software", 0.08943927719452849], ["Remote Service Session Hijacking", 0.04585449737502314], ["Exploitation of Remote Services", 0.04220643517562425], ["External Remote Services", 0.03270532588663276], ["Inter-Process Communication", 0.01023065311849843]], "The second encoded Base64 string was not only base64 but also Gziped for size and obfuscation.": [["Obfuscated Files or Information", 0.4122028863255401], ["Data Encoding", 0.26646121981333876], ["Deobfuscate/Decode Files or Information", 0.14222608524165392], ["Archive Collected Data", 0.03848023844896715], ["Data Obfuscation", 0.01935926900358106], ["Encrypted Channel", 0.013031726519368745]], "has some simple but clever obfuscation in place.": [["Obfuscated Files or Information", 0.7201046411409603], ["Data Obfuscation", 0.03578673167978957], ["Deobfuscate/Decode Files or Information", 0.03284085638485007], ["Data Encoding", 0.029820804139537502], ["Masquerading", 0.025925285532138326], ["Encrypted Channel", 0.011596017797061833]], "This shows the decoded and uncompressed data.": [["Deobfuscate/Decode Files or Information", 0.37161562423976036], ["Archive Collected Data", 0.1569050205958024], ["Data Encoding", 0.06915320379695199], ["Obfuscated Files or Information", 0.06277020517746264], ["Automated Collection", 0.023791138954354543], ["Exfiltration Over C2 Channel", 0.01894552142258851]], "payload decoder from Github": [["Deobfuscate/Decode Files or Information", 0.6225485213269596], ["Obfuscated Files or Information", 0.15566862095576128], ["Data Encoding", 0.05497662866026217], ["Data Obfuscation", 0.013431888480659595], ["Archive Collected Data", 0.012651521606190333], ["Encrypted Channel", 0.010302545149601673]], "used to decode the body": [["Deobfuscate/Decode Files or Information", 0.4699713505564773], ["Obfuscated Files or Information", 0.1371748413141596], ["Data Encoding", 0.1126263904723648], ["Archive Collected Data", 0.04719785372599481], ["Data Obfuscation", 0.030649441312331847], ["Encrypted Channel", 0.015412980695415088]], "Task manager was then use to reveal the service running on PID 3488,": [["System Service Discovery", 0.3349791972061737], ["Process Discovery", 0.21124256698192942], ["Create or Modify System Process", 0.07684197826199353], ["System Services", 0.03471099163148935], ["Masquerading", 0.033270629675308826], ["Service Stop", 0.03185110311259604]], "requests using RC4 encryption": [["Encrypted Channel", 0.3859200996087539], ["Obfuscated Files or Information", 0.09473572977046373], ["Deobfuscate/Decode Files or Information", 0.08844109277233533], ["Data Encoding", 0.05653925786591412], ["Archive Collected Data", 0.0435106328296321], ["Data Encrypted for Impact", 0.04271941625311478]], "was abused by the attacker to steal client data.": [["Exfiltration Over C2 Channel", 0.08015451454978484], ["Exfiltration Over Alternative Protocol", 0.06351741233272068], ["Ingress Tool Transfer", 0.03540917919428263], ["Data Manipulation", 0.0350111255218637], ["Data from Local System", 0.03446158996688074], ["Browser Session Hijacking", 0.02509625482913092]], "the malware copied itself to \"$CURRENTUSER\\AppData\\Roaming\\Microsoft\\Isoaahffo\\djkuuhd.dll,\" as confirmed by the file's hashes shown below, and sets itself to auto run.": [["Hijack Execution Flow", 0.16823067933276262], ["System Binary Proxy Execution", 0.11390136398842336], ["Masquerading", 0.09830425421948753], ["Process Injection", 0.043770523812778905], ["Indicator Removal", 0.030764396541543806], ["Boot or Logon Autostart Execution", 0.03020715352146351]], "the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660).": [["Process Discovery", 0.4980691647389127], ["Process Injection", 0.09246942528092804], ["Impair Defenses", 0.053935388756894194], ["Native API", 0.049338201254856565], ["Masquerading", 0.02110728200616382], ["System Service Discovery", 0.020209774903884304]], "This uses a mixture of disguising the ASCII as UTF-16 via manipulating the start of the file, as well as obfuscating the data using a simple cypher.": [["Obfuscated Files or Information", 0.6025904969176074], ["Deobfuscate/Decode Files or Information", 0.10692852931958573], ["Data Encoding", 0.06656508098360364], ["Archive Collected Data", 0.03028691553815543], ["Data Obfuscation", 0.02126615450529832], ["Data Encrypted for Impact", 0.017045021715824865]], "running the malware sets itself up as the service": [["Create or Modify System Process", 0.4652444491535838], ["System Services", 0.2666595029485391], ["System Service Discovery", 0.0518667524190569], ["Masquerading", 0.027286971698105813], ["Hijack Execution Flow", 0.02224609502837202], ["Service Stop", 0.012656903123342876]], "after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains.": [["Domain Trust Discovery", 0.13891383261691323], ["Remote System Discovery", 0.11916583636758332], ["System Network Configuration Discovery", 0.11146090627934234], ["Dynamic Resolution", 0.05608829572037225], ["Fallback Channels", 0.032668264121073716], ["Acquire Infrastructure", 0.02690116151772358]], "a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.": [["Windows Management Instrumentation", 0.4912538021851129], ["Event Triggered Execution", 0.10105099971524581], ["System Binary Proxy Execution", 0.09095561836445308], ["Boot or Logon Autostart Execution", 0.024503347801733334], ["Native API", 0.024258085499393723], ["Command and Scripting Interpreter", 0.014256184016914234]], "indicating that the user deleted the collected data.": [["Indicator Removal", 0.37823960221606606], ["Data Destruction", 0.11682437413198651], ["Inhibit System Recovery", 0.042754243502249566], ["Data Staged", 0.04029991751689966], ["Data Manipulation", 0.02171635448210068], ["Modify Cloud Compute Infrastructure", 0.02105815389471935]], "group utilizes sideloading": [["Ingress Tool Transfer", 0.052419240091929116], ["System Binary Proxy Execution", 0.03672548010075777], ["Command and Scripting Interpreter", 0.033052257987530115], ["Taint Shared Content", 0.03168241704793346], ["Hijack Execution Flow", 0.029967147641917692], ["System Services", 0.02941740527954316]], "DLL for sideloading": [["Hijack Execution Flow", 0.35168708948998295], ["Shared Modules", 0.14767948488281735], ["System Binary Proxy Execution", 0.10197422615594176], ["Process Injection", 0.04641086083473392], ["Ingress Tool Transfer", 0.030231821191469613], ["Masquerading", 0.021662497565866884]], "The group uses DLL sideloading": [["Hijack Execution Flow", 0.3180209452799317], ["Shared Modules", 0.1310474546122409], ["System Binary Proxy Execution", 0.10333515498409027], ["Process Injection", 0.04580850141601213], ["System Services", 0.022914384581067707], ["Event Triggered Execution", 0.022235041887204925]], "detect and remove Alibaba Cloud Security from compromised instances": [["Impair Defenses", 0.345898576813328], ["Modify Cloud Compute Infrastructure", 0.12831285093676045], ["Domain Policy Modification", 0.04544405289933675], ["File and Directory Permissions Modification", 0.03008962116374119], ["Subvert Trust Controls", 0.021910710669399886], ["Software Discovery", 0.020737268772005123]], "relied on their victims to execute the malicious MSI installers": [["System Binary Proxy Execution", 0.1191497747345136], ["Supply Chain Compromise", 0.08658122847104299], ["Command and Scripting Interpreter", 0.05148872717572359], ["Drive-by Compromise", 0.04517010092889443], ["User Execution", 0.03747433745669515], ["Masquerading", 0.03630282336186335]], "uses cmd.exe to download files from Alibaba Cloud Object Storage Service.": [["Ingress Tool Transfer", 0.21851660004824344], ["Data from Local System", 0.0712251714502613], ["Data Staged", 0.05192328725671274], ["Data from Network Shared Drive", 0.051367052841457185], ["Data from Cloud Storage", 0.03727078894253597], ["Exfiltration Over Web Service", 0.03382270890501846]], "executes OSSUTIL (included in the installer package as ssu.exe) to download files": [["Ingress Tool Transfer", 0.4357835701308335], ["Command and Scripting Interpreter", 0.09996241533476749], ["BITS Jobs", 0.049323752126215425], ["System Binary Proxy Execution", 0.03791339124543825], ["Data from Local System", 0.026811059202862784], ["Native API", 0.023388555870945113]], "use API calls such as VirtualAlloc to load and execute malicious components into memory": [["Process Injection", 0.4347964743973044], ["Shared Modules", 0.1168226151124703], ["Native API", 0.0869330857342466], ["Hijack Execution Flow", 0.055469356196152], ["System Binary Proxy Execution", 0.03349240643676804], ["Event Triggered Execution", 0.016303328002398546]], "invokes the Windows API function DisableThreadLibraryCalls": [["Native API", 0.23001666295261466], ["Process Injection", 0.21447796717546427], ["System Binary Proxy Execution", 0.061774375672509214], ["Impair Defenses", 0.043420870728422406], ["Virtualization/Sandbox Evasion", 0.03480116531844253], ["Masquerading", 0.02610394795426425]], "create scheduled tasks to achieve persistence": [["Scheduled Task/Job", 0.7954666163111198], ["Create or Modify System Process", 0.028155328825378474], ["Inter-Process Communication", 0.024616866734067485], ["Event Triggered Execution", 0.015754142143568746], ["Boot or Logon Autostart Execution", 0.012790945351495815], ["Command and Scripting Interpreter", 0.0100282733739124]], "Create scheduled tasks to execute the loader and updater components": [["Scheduled Task/Job", 0.6542789294018626], ["Command and Scripting Interpreter", 0.04265236442789027], ["Create or Modify System Process", 0.03536664173822395], ["Inter-Process Communication", 0.02766957157439361], ["System Services", 0.02202378432453081], ["Masquerading", 0.015429237348247292]], "scheduled tasks created for the updater,": [["Scheduled Task/Job", 0.6871624235618907], ["Inter-Process Communication", 0.03171594681697629], ["Masquerading", 0.03010888960521067], ["Create or Modify System Process", 0.014059779543020803], ["BITS Jobs", 0.010345053167997064], ["Command and Scripting Interpreter", 0.009602414163181562]], "four scheduled tasks are created:": [["Scheduled Task/Job", 0.7862941588971871], ["Inter-Process Communication", 0.03666732114765705], ["Masquerading", 0.016369858127164322], ["Create or Modify System Process", 0.009014830563638648], ["Command and Scripting Interpreter", 0.008182229603371827], ["System Services", 0.005726627970268602]], "creates a registry Run key to achieve persistence": [["Boot or Logon Autostart Execution", 0.6124827044178163], ["Modify Registry", 0.10796038972232094], ["Boot or Logon Initialization Scripts", 0.054940916471307256], ["Event Triggered Execution", 0.040574234562660856], ["Create or Modify System Process", 0.03441225131312349], ["Office Application Startup", 0.018781607092109964]], "use various encryption algorithms to hide payloads and strings.": [["Obfuscated Files or Information", 0.6732441223920442], ["Deobfuscate/Decode Files or Information", 0.03902013587990086], ["Data Obfuscation", 0.03632936150889856], ["Data Encoding", 0.03295643755348542], ["Hide Artifacts", 0.032115168305618065], ["Execution Guardrails", 0.022708907741635077]], "execute an encrypted payload located in the embedded DLL": [["Obfuscated Files or Information", 0.30263025219961703], ["Deobfuscate/Decode Files or Information", 0.24386748900492008], ["Process Injection", 0.07954051854972251], ["System Binary Proxy Execution", 0.04312724598293993], ["Hijack Execution Flow", 0.038894407769648295], ["Shared Modules", 0.02379426073953374]], "contains an XOR-encrypted payload, divided into three files": [["Obfuscated Files or Information", 0.3960277791762115], ["Archive Collected Data", 0.18843156635800792], ["Deobfuscate/Decode Files or Information", 0.13510330883034374], ["Data Encrypted for Impact", 0.05541727000689894], ["Encrypted Channel", 0.01723653820219389], ["Exfiltration Over Alternative Protocol", 0.01705517821148189]], "encrypted with a different, single byte XOR key": [["Deobfuscate/Decode Files or Information", 0.27063666777138246], ["Encrypted Channel", 0.19989689570227312], ["Obfuscated Files or Information", 0.1763426149351864], ["Data Encrypted for Impact", 0.0776983278397584], ["Weaken Encryption", 0.05415954041361009], ["Archive Collected Data", 0.030704034415583253]], "use dynamic API resolution to avoid detection.": [["Masquerading", 0.1020476524663068], ["Data Obfuscation", 0.06020554760858408], ["Native API", 0.04588964503681285], ["Dynamic Resolution", 0.044533560625597435], ["Obfuscated Files or Information", 0.04300465215984446], ["Hijack Execution Flow", 0.036866047255676423]], "calling an export function of the DLL": [["Shared Modules", 0.16050700198587978], ["Hijack Execution Flow", 0.14078674908781946], ["System Binary Proxy Execution", 0.09429457705713633], ["Process Injection", 0.08801641482469322], ["Native API", 0.046517384943703104], ["Obfuscated Files or Information", 0.029598419935405653]], "reconstructs the imports table of the DLL and calls the DllEntryPoint,": [["Hijack Execution Flow", 0.23952941685846352], ["Shared Modules", 0.2038425840635828], ["Process Injection", 0.08198888349872357], ["Native API", 0.05836103765997934], ["System Binary Proxy Execution", 0.039915533922181515], ["Deobfuscate/Decode Files or Information", 0.03337551068743122]], "the DLL will find the address of an export function called SVP7, which contains the entry point of the malware,": [["Hijack Execution Flow", 0.2567540990867515], ["Shared Modules", 0.11214310327557955], ["System Binary Proxy Execution", 0.07084758330836413], ["Native API", 0.0507684095071478], ["Process Injection", 0.04377321791393606], ["Deobfuscate/Decode Files or Information", 0.027060144256554456]], "used DLL side-loading to execute their malicious payloads": [["Hijack Execution Flow", 0.3921122598802453], ["Shared Modules", 0.1923444050410757], ["System Binary Proxy Execution", 0.1173249352395554], ["Process Injection", 0.05935576753952837], ["Event Triggered Execution", 0.020619281519770025], ["Native API", 0.017163174469786487]], "side-loading a malicious DLL, libpng13.dll": [["Hijack Execution Flow", 0.4638050017084227], ["Shared Modules", 0.1114486843341006], ["System Binary Proxy Execution", 0.06900851630159334], ["Process Injection", 0.04482738306434414], ["Masquerading", 0.023197033802039153], ["Obfuscated Files or Information", 0.020148512913544896]], "by side-loading dr.dll, used by a legitimate, signed binary": [["Hijack Execution Flow", 0.27437505813261026], ["Subvert Trust Controls", 0.17418641127823245], ["System Binary Proxy Execution", 0.07086782013264825], ["Masquerading", 0.04730372712198289], ["Obfuscated Files or Information", 0.04362980230576037], ["Shared Modules", 0.03757147114370207]], ", side-loaded by the same legitimate executable": [["Hijack Execution Flow", 0.421296027523531], ["System Binary Proxy Execution", 0.11396663410248031], ["Process Injection", 0.058910178234569], ["Shared Modules", 0.05510125691730262], ["Masquerading", 0.03336772256576472], ["Native API", 0.03269139093438344]], "contains shellcode and an embedded DLL file that loads FatalRAT": [["Hijack Execution Flow", 0.19268648321144308], ["System Binary Proxy Execution", 0.10227133893211227], ["Native API", 0.10146882537780233], ["Process Injection", 0.09546210181635813], ["Deobfuscate/Decode Files or Information", 0.07538441230946691], ["Shared Modules", 0.0701728153564728]], "contains an embedded DLL": [["Hijack Execution Flow", 0.24481885782398133], ["Shared Modules", 0.18483999835029974], ["System Binary Proxy Execution", 0.12534955544378143], ["Process Injection", 0.10152342572805124], ["Native API", 0.04330907369127438], ["Obfuscated Files or Information", 0.01920228476748695]], "has keylogger functionalities": [["Input Capture", 0.9033306048796531], ["Clipboard Data", 0.004946080060337095], ["Screen Capture", 0.0038618395861686502], ["Credentials from Password Stores", 0.00363460720888628], ["Event Triggered Execution", 0.0031144716823499896], ["Boot or Logon Autostart Execution", 0.0029530998703575367]], "Capture keystrokes": [["Input Capture", 0.8535383400285196], ["Clipboard Data", 0.013850376006648454], ["Screen Capture", 0.011204462923151757], ["Video Capture", 0.005214044475840059], ["Credentials from Password Stores", 0.0051224030525599045], ["Network Sniffing", 0.004055756002819014]], "encrypts data with a custom encryption algorithm before it is sent to the C&C server.": [["Obfuscated Files or Information", 0.17938653858507383], ["Archive Collected Data", 0.15744170619706174], ["Encrypted Channel", 0.12826359785406502], ["Data Encrypted for Impact", 0.1190346922071432], ["Deobfuscate/Decode Files or Information", 0.05585712918575741], ["Exfiltration Over Alternative Protocol", 0.0474895428062645]], "uses TCP for C&C communications.": [["Non-Application Layer Protocol", 0.5692176191746425], ["Application Layer Protocol", 0.09153833930909751], ["Encrypted Channel", 0.046270015723008213], ["Non-Standard Port", 0.043618286428376805], ["Protocol Tunneling", 0.033928999578624316], ["Proxy", 0.02826205360592582]], "exfiltrates data over the same channel used for C&C": [["Exfiltration Over C2 Channel", 0.15111421594979937], ["Exfiltration Over Other Network Medium", 0.12315809603155259], ["Exfiltration Over Alternative Protocol", 0.09684878548764363], ["Exfiltration Over Web Service", 0.05739897269745421], ["Archive Collected Data", 0.05196778543494695], ["Scheduled Transfer", 0.03858811577792653]], "Drop a file named ossutilconfig in the %USERPROFILE% directory": [["Indicator Removal", 0.158347296279156], ["Modify Registry", 0.09123688883543704], ["Boot or Logon Autostart Execution", 0.05411783214500843], ["Inhibit System Recovery", 0.04475468450888791], ["Boot or Logon Initialization Scripts", 0.039188570905717764], ["Rootkit", 0.038416092254490296]], "Drop and execute the legitimate installer in C:\\Program Files\\Common Files (see CommonFiles64Folder).": [["Masquerading", 0.1361015388344458], ["Indicator Removal", 0.06957504866666217], ["System Binary Proxy Execution", 0.06549907905225534], ["Modify Registry", 0.050550497068932713], ["Hijack Execution Flow", 0.0375126170465867], ["Hide Artifacts", 0.030100347804237513]], "The original libpng13.dll is also included in the installer package (renamed to what appears to be a random name) because the malicious DLL forwards its exported functions to the original DLL.": [["Hijack Execution Flow", 0.27947630765533793], ["Obfuscated Files or Information", 0.06229318783831252], ["Shared Modules", 0.05608911789114815], ["System Binary Proxy Execution", 0.055150964288107646], ["Masquerading", 0.05432365918766608], ["Process Injection", 0.04588610861116819]], "download files from an attacker-controlled bucket in Alibaba Cloud": [["Ingress Tool Transfer", 0.17312514672364923], ["Exfiltration Over Web Service", 0.054282195337778165], ["Data from Cloud Storage", 0.05292896430997288], ["Web Service", 0.05289452118223966], ["Data from Local System", 0.04052168909190839], ["Data Staged", 0.03365616687126983]], "download and execute further shellcode": [["Ingress Tool Transfer", 0.42393650436606295], ["Command and Scripting Interpreter", 0.24723290341989596], ["System Binary Proxy Execution", 0.04538363453789285], ["Deobfuscate/Decode Files or Information", 0.03792962530518022], ["BITS Jobs", 0.032319725610707964], ["Native API", 0.02244088472619104]], "obfuscated the loader with many calls to a function that just prints some hardcoded values": [["Obfuscated Files or Information", 0.7051085585960764], ["Deobfuscate/Decode Files or Information", 0.06566768237474797], ["Hide Artifacts", 0.018188548402103835], ["Process Injection", 0.014944600948075835], ["Execution Guardrails", 0.011634378465127113], ["Masquerading", 0.010022992067479593]], "decrypt,": [["Deobfuscate/Decode Files or Information", 0.5358064321347003], ["Data Encrypted for Impact", 0.12025292691201604], ["Archive Collected Data", 0.0689242372795054], ["Obfuscated Files or Information", 0.043934643516749174], ["Weaken Encryption", 0.03593955450978625], ["Encrypted Channel", 0.02816117759312221]], "decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration": [["Deobfuscate/Decode Files or Information", 0.7583477476890491], ["Obfuscated Files or Information", 0.054241493328873305], ["Data Encrypted for Impact", 0.03296188982453604], ["Archive Collected Data", 0.024269992746904622], ["Encrypted Channel", 0.021420840297126525], ["Weaken Encryption", 0.015637883718556185]], "decrypt its configuration strings": [["Deobfuscate/Decode Files or Information", 0.6482517435922284], ["Obfuscated Files or Information", 0.12158409359826622], ["Data Encrypted for Impact", 0.029859034684519885], ["Archive Collected Data", 0.02110017663468604], ["Weaken Encryption", 0.02080233602362208], ["Encrypted Channel", 0.018121151028548107]], "the decompiled code used to decrypt strings": [["Deobfuscate/Decode Files or Information", 0.7448811144430612], ["Obfuscated Files or Information", 0.12198796691416287], ["Archive Collected Data", 0.025233829006018532], ["Data Encoding", 0.015880963085944343], ["Encrypted Channel", 0.013209458276462176], ["Data Encrypted for Impact", 0.009823828641319993]], "Decompiled code of a function used by a FatalRAT": [["Deobfuscate/Decode Files or Information", 0.40500711572448017], ["Obfuscated Files or Information", 0.28621777612626237], ["Archive Collected Data", 0.01914015641680111], ["Virtualization/Sandbox Evasion", 0.016033505267289135], ["Process Injection", 0.014887477061536635], ["Hijack Execution Flow", 0.01165483160498095]], "using a variety of software packers": [["Archive Collected Data", 0.19582360735781762], ["Obfuscated Files or Information", 0.1504328146840643], ["Deobfuscate/Decode Files or Information", 0.09270802839530012], ["Automated Collection", 0.06448649003323655], ["Data Staged", 0.04201442443396962], ["Command and Scripting Interpreter", 0.03182783992307921]], "one Zip contained a benign file named screenshot1242.jpeg and another contained a file named privatecopy.pdf.": [["Archive Collected Data", 0.3463507128647786], ["Obfuscated Files or Information", 0.05883862821157392], ["Deobfuscate/Decode Files or Information", 0.04657415158390658], ["Masquerading", 0.035911256031659906], ["Data from Local System", 0.03311709892477762], ["Ingress Tool Transfer", 0.028659642223357328]], "When someone tries to double-click these decoy files, Windows (or the application mapped to the relevant filetype) throws an error because the file isn\u2019t the type of file it appears to be": [["Masquerading", 0.2910638117362602], ["Deobfuscate/Decode Files or Information", 0.17909129794034365], ["Hide Artifacts", 0.10401570986303899], ["Obfuscated Files or Information", 0.06623759240623686], ["Native API", 0.020868528087523014], ["User Execution", 0.02045074472175477]], "The target would then, naturally, double click the other file in the Zip archive": [["Archive Collected Data", 0.2510801937385386], ["Ingress Tool Transfer", 0.08996636947105148], ["Deobfuscate/Decode Files or Information", 0.05184047172031954], ["Masquerading", 0.041734450373623784], ["Command and Scripting Interpreter", 0.03837784425229608], ["Obfuscated Files or Information", 0.030471416020970435]], "command pulls down a Visual Basic script, drops it into the C:\\Windows\\Tasks folder, and executes it.": [["Command and Scripting Interpreter", 0.2628468904210296], ["Scheduled Task/Job", 0.2065846727230066], ["System Binary Proxy Execution", 0.05047500355671969], ["Inter-Process Communication", 0.045563825049887915], ["System Services", 0.034742030587327236], ["Masquerading", 0.02929263426773321]], "90 other encrypted": [["Obfuscated Files or Information", 0.22507757530749856], ["Data Encrypted for Impact", 0.19623959826381288], ["Archive Collected Data", 0.10697363515456809], ["Encrypted Channel", 0.0838369312973755], ["Deobfuscate/Decode Files or Information", 0.06667543681823747], ["Execution Guardrails", 0.03793125492566681]], "\u00a0A heavily obfuscated VBS": [["Obfuscated Files or Information", 0.7451998173354488], ["Deobfuscate/Decode Files or Information", 0.07944161809993147], ["Hide Artifacts", 0.021652758215441655], ["Masquerading", 0.011966723795566618], ["Process Injection", 0.010522967799831556], ["Execution Guardrails", 0.009713626544779539]], "The initial infector is a Visual Basic script, heavily obfuscated": [["Obfuscated Files or Information", 0.5931678497252943], ["Deobfuscate/Decode Files or Information", 0.14737850529832236], ["System Binary Proxy Execution", 0.02352453429087822], ["Process Injection", 0.020222124218658846], ["Masquerading", 0.015247628318871193], ["Command and Scripting Interpreter", 0.012425433880264606]], "A block of base64-encoded, encrypted data comprises almost 150KB of that script,": [["Obfuscated Files or Information", 0.4197196769390147], ["Archive Collected Data", 0.19796413334034277], ["Deobfuscate/Decode Files or Information", 0.1107382233466294], ["Data Encoding", 0.04447860844311037], ["Data Encrypted for Impact", 0.027742681945482184], ["Encrypted Channel", 0.019914882083466746]], "segments of base64 data": [["Obfuscated Files or Information", 0.2238975678039793], ["Data Encoding", 0.19637705715712003], ["Deobfuscate/Decode Files or Information", 0.150058233604292], ["Archive Collected Data", 0.07056010092255763], ["Data Transfer Size Limits", 0.04758387054312912], ["Data Obfuscation", 0.03575186780464484]], "along with code that decodes and decrypts the block of base64.": [["Deobfuscate/Decode Files or Information", 0.4468973196072607], ["Obfuscated Files or Information", 0.23423617033155253], ["Data Encoding", 0.13101189962895254], ["Archive Collected Data", 0.03712031017257127], ["Encrypted Channel", 0.01916602058995977], ["Data Obfuscation", 0.014599768801230165]], "When decoded, the content of the Ir8 variable (a segment of which is shown below) turns out to be just another encoded PowerShell script, which the VBS decodes and then executes.": [["Deobfuscate/Decode Files or Information", 0.5471563910121052], ["Obfuscated Files or Information", 0.14594896838991886], ["Data Encoding", 0.04052589786145519], ["Encrypted Channel", 0.02320189094739191], ["Archive Collected Data", 0.013594568438887223], ["System Binary Proxy Execution", 0.01222153335761657]], "The PowerShell script decoded from the Ir8 variable uses Reflection.": [["Deobfuscate/Decode Files or Information", 0.22671051289845534], ["Obfuscated Files or Information", 0.12143849728532777], ["Native API", 0.040042954313743405], ["Encrypted Channel", 0.028958566921922745], ["Masquerading", 0.028188938059119793], ["Command and Scripting Interpreter", 0.024589569454354247]], "performs a BXOR to decode the bytes": [["Deobfuscate/Decode Files or Information", 0.44729147525084123], ["Data Encoding", 0.19685318581334715], ["Obfuscated Files or Information", 0.1187402903194828], ["Encrypted Channel", 0.044337159532205225], ["Data Obfuscation", 0.024207168886191965], ["Archive Collected Data", 0.02104844306111674]], "for the Ir8 script to decode.": [["Deobfuscate/Decode Files or Information", 0.46938833167515776], ["Data Encoding", 0.1175229213584748], ["Obfuscated Files or Information", 0.09711096639450381], ["Archive Collected Data", 0.04522751491754323], ["Encrypted Channel", 0.03729870880109814], ["Data Obfuscation", 0.0202029902488914]], "These work in tandem to insert data into the Windows Registry": [["Modify Registry", 0.5884644846825549], ["Boot or Logon Autostart Execution", 0.10266913910033773], ["Query Registry", 0.09705805935022546], ["Indicator Removal", 0.01221934161824736], ["Office Application Startup", 0.011905945909144029], ["Masquerading", 0.01085351555122916]], "The concatenated segments of base64 data from O7 get inserted into the Registry,": [["Obfuscated Files or Information", 0.35266580712050855], ["Deobfuscate/Decode Files or Information", 0.13565148815331424], ["Data Encoding", 0.09245953384076427], ["Archive Collected Data", 0.04938079264380994], ["Modify Registry", 0.04716071932040159], ["Query Registry", 0.023600196546735203]], "to load the final payload into memory from a Registry value without": [["Modify Registry", 0.2817746614074909], ["Query Registry", 0.098916000401018], ["Boot or Logon Autostart Execution", 0.0959833306087869], ["System Binary Proxy Execution", 0.08192681125827263], ["Hijack Execution Flow", 0.031150345044460105], ["Event Triggered Execution", 0.028575563897562096]], "It created a Run key in the Registry": [["Boot or Logon Autostart Execution", 0.7481617177139765], ["Modify Registry", 0.03071013989996811], ["Event Triggered Execution", 0.02203814142394432], ["Create or Modify System Process", 0.01710293993636066], ["Abuse Elevation Control Mechanism", 0.01187589071914498], ["Query Registry", 0.011061369307204312]], "And that Run key references a different Registry key": [["Boot or Logon Autostart Execution", 0.5665002087069225], ["Modify Registry", 0.14438654905063453], ["Query Registry", 0.06208078535972839], ["System Binary Proxy Execution", 0.026393382137603894], ["Event Triggered Execution", 0.020673210965870808], ["Boot or Logon Initialization Scripts", 0.015191169685396204]], "On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe": [["Process Injection", 0.567218800164083], ["System Binary Proxy Execution", 0.04852515615474871], ["Native API", 0.04142885923404918], ["Masquerading", 0.040007401429136474], ["Event Triggered Execution", 0.03286933474186043], ["Hijack Execution Flow", 0.01991191221040519]], "obfuscated with legitimate resources": [["Obfuscated Files or Information", 0.7384114087681313], ["Deobfuscate/Decode Files or Information", 0.04444132681893507], ["Archive Collected Data", 0.025993505199935388], ["Data Obfuscation", 0.01581580835331204], ["Data Encoding", 0.013662951520251316], ["Encrypted Channel", 0.01132591799947566]], "encrypted stack strings": [["Obfuscated Files or Information", 0.5527578493726757], ["Deobfuscate/Decode Files or Information", 0.09759861529218647], ["Encrypted Channel", 0.09022966289783708], ["Data Encoding", 0.024752585792827214], ["Archive Collected Data", 0.02473478069118232], ["Data Encrypted for Impact", 0.023638087956941913]], "Embedded Resource": [["Template Injection", 0.0728593091176721], ["System Binary Proxy Execution", 0.059308627874517746], ["User Execution", 0.05296131509653489], ["Process Injection", 0.041056784220121774], ["Hide Artifacts", 0.0334209739014828], ["Masquerading", 0.03338708584368876]], "shellcode from the .data section": [["Obfuscated Files or Information", 0.3038015687244392], ["Deobfuscate/Decode Files or Information", 0.19625178150945505], ["Native API", 0.044572108477636256], ["Command and Scripting Interpreter", 0.03357635657405313], ["File and Directory Discovery", 0.024687348418584602], ["Hide Artifacts", 0.021542596279120477]], "shellcode that was stored in the .data section is now stored in the .rsc section": [["Deobfuscate/Decode Files or Information", 0.18757570926739647], ["Obfuscated Files or Information", 0.10194876348921353], ["OS Credential Dumping", 0.028555257164124288], ["Modify Registry", 0.025733706762766474], ["Archive Collected Data", 0.024156766771003646], ["Data Staged", 0.022945477548103436]], "advapi32.CryptHashData": [["Deobfuscate/Decode Files or Information", 0.2932357238641971], ["Obfuscated Files or Information", 0.13297676108765472], ["Data Encrypted for Impact", 0.08657559900690494], ["Archive Collected Data", 0.05704698500207647], ["Encrypted Channel", 0.053969994912886086], ["Weaken Encryption", 0.02594643951521022]], "will create a key using advapi32.CryptDeriveKey": [["Deobfuscate/Decode Files or Information", 0.13719756741231773], ["Encrypted Channel", 0.10681575970948119], ["Data Encrypted for Impact", 0.10557715656236634], ["Weaken Encryption", 0.07962847547082752], ["Obfuscated Files or Information", 0.05401020116121506], ["Modify Registry", 0.03557118455346799]], "advapi32.CryptEncrypt": [["Obfuscated Files or Information", 0.23217913612638708], ["Data Encrypted for Impact", 0.19499893793907172], ["Deobfuscate/Decode Files or Information", 0.1458425892234791], ["Archive Collected Data", 0.08169380516794227], ["Encrypted Channel", 0.06612713893951747], ["Weaken Encryption", 0.033562791647965974]], "kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.ZwFlushInstructionCache": [["Hijack Execution Flow", 0.054569033861823484], ["Query Registry", 0.0495447530142382], ["Virtualization/Sandbox Evasion", 0.04196614108001298], ["Native API", 0.04147464982472051], ["Indicator Removal", 0.03933903583110739], ["Boot or Logon Autostart Execution", 0.03403509280379771]], "kernel32.VirtualALloc": [["Process Injection", 0.31192519368878013], ["Virtualization/Sandbox Evasion", 0.14211428999216322], ["Native API", 0.052205380341162226], ["Hide Artifacts", 0.04369009432126149], ["System Binary Proxy Execution", 0.03984590283819109], ["Rootkit", 0.029184579900614918]], "kernel32.VirtualProtect,": [["Virtualization/Sandbox Evasion", 0.1327348780473209], ["Process Injection", 0.12064768109641547], ["Impair Defenses", 0.06908868830740159], ["Software Discovery", 0.050956912320342114], ["Obfuscated Files or Information", 0.03852639213496937], ["Hide Artifacts", 0.03511336060072492]], "kernel32.GetLastError": [["Virtualization/Sandbox Evasion", 0.36192250771187384], ["Native API", 0.038862682705490176], ["System Information Discovery", 0.03257340624195839], ["Software Discovery", 0.027319016493642594], ["Impair Defenses", 0.022760557851357312], ["File and Directory Discovery", 0.02106974475949137]], "kernel32.CreateMutexA": [["Process Injection", 0.11525242829637414], ["Event Triggered Execution", 0.04951054461619265], ["System Binary Proxy Execution", 0.041576193583972056], ["Boot or Logon Autostart Execution", 0.04058938073585734], ["Masquerading", 0.03335666607882666], ["Rootkit", 0.029702679671245742]], "wininet.HttpSendRequestA,": [["Application Layer Protocol", 0.30777428207448104], ["Browser Session Hijacking", 0.042436388594843416], ["Data Obfuscation", 0.038433176793418906], ["Non-Standard Port", 0.030373476878892344], ["Native API", 0.021697305717442262], ["Ingress Tool Transfer", 0.01996997637680833]], "shellcode injection": [["Native API", 0.17308488349554763], ["Process Injection", 0.17032109808973353], ["Obfuscated Files or Information", 0.09372303569208082], ["Command and Scripting Interpreter", 0.056822689727339525], ["Hijack Execution Flow", 0.037587621574538294], ["System Binary Proxy Execution", 0.03335718476990939]], "copy each PE section one at a time": [["Command and Scripting Interpreter", 0.06164769216265609], ["OS Credential Dumping", 0.060598408586175594], ["Automated Collection", 0.04130160566594349], ["Data from Local System", 0.03796951480097756], ["Ingress Tool Transfer", 0.03263674417714885], ["Data Staged", 0.03045785773356093]], "creating another PE in memory,": [["Process Injection", 0.11004526899416928], ["Access Token Manipulation", 0.07593333253977257], ["Account Manipulation", 0.029323374970322377], ["OS Credential Dumping", 0.02499666501094175], ["Event Triggered Execution", 0.0240926799521429], ["Domain Policy Modification", 0.022719683970407828]], "injecting a PE executable": [["Process Injection", 0.471121294891398], ["Native API", 0.04148988436788607], ["Hijack Execution Flow", 0.04042834673086412], ["Shared Modules", 0.03507563548792221], ["System Binary Proxy Execution", 0.033180283772449415], ["Event Triggered Execution", 0.029759289327525813]], "handle to the current process for the purpose of allocating memory with PAGE_EXECUTE_READWRITE permissions": [["Process Injection", 0.514902213830123], ["Native API", 0.06413023729231851], ["Process Discovery", 0.06315730892378964], ["Access Token Manipulation", 0.0340971443734256], ["Impair Defenses", 0.01847357704274305], ["Abuse Elevation Control Mechanism", 0.013596497427614969]], "decrypt the shellcode": [["Deobfuscate/Decode Files or Information", 0.620494204335646], ["Obfuscated Files or Information", 0.15721652409557024], ["Data Encrypted for Impact", 0.027089721189332824], ["Encrypted Channel", 0.02670719582932787], ["Execution Guardrails", 0.014722165479194227], ["Weaken Encryption", 0.012318860617269474]], "decyrpt its C2 configuration": [["Deobfuscate/Decode Files or Information", 0.6781238341328256], ["Obfuscated Files or Information", 0.04589043542739099], ["Archive Collected Data", 0.02641282652493887], ["Encrypted Channel", 0.02438274532830089], ["Data Encrypted for Impact", 0.016340038739230504], ["Data Encoding", 0.011922644806423613]], "get a pointer to the encrypted shellcode and to decrypt it have been broken out into their own separate functions": [["Deobfuscate/Decode Files or Information", 0.5573742632308638], ["Obfuscated Files or Information", 0.225621165951323], ["Encrypted Channel", 0.025309162605590855], ["Native API", 0.015171681632707235], ["Data Encrypted for Impact", 0.013789955401931888], ["Archive Collected Data", 0.013390491274974095]], "will need to resolve these APIs dynamically to interact with the Windows operating system": [["Native API", 0.5845249141072293], ["Masquerading", 0.04106786836352826], ["System Binary Proxy Execution", 0.03873473063768247], ["Windows Management Instrumentation", 0.03087103393415056], ["Event Triggered Execution", 0.028833523415897146], ["Hijack Execution Flow", 0.014641595641426993]], "resolving many different Windows APIs using kernel32.GetProcAddress": [["Native API", 0.2508770270759071], ["System Information Discovery", 0.11618062438577063], ["File and Directory Discovery", 0.06898610613755908], ["Masquerading", 0.0679000017871321], ["Query Registry", 0.04857310796467043], ["Windows Management Instrumentation", 0.02743065858175482]], "enumerating the Process Environment Block (PEB)": [["Process Discovery", 0.35106599861575405], ["Native API", 0.11471812531878466], ["Process Injection", 0.08391914203301457], ["Windows Management Instrumentation", 0.043132603022934084], ["Virtualization/Sandbox Evasion", 0.03937442573033258], ["Software Discovery", 0.03559736494969643]], "HTTP HEAD request": [["Application Layer Protocol", 0.26315885088195146], ["Data Obfuscation", 0.03924725623051762], ["Data Encoding", 0.03905789007589535], ["Fallback Channels", 0.033277401531876055], ["System Network Configuration Discovery", 0.02863169496888769], ["Exfiltration Over C2 Channel", 0.026670435002213493]], "check if it is connected to the internet by making a request": [["System Network Configuration Discovery", 0.4505962597291177], ["System Network Connections Discovery", 0.14074121459074831], ["Application Layer Protocol", 0.023383051681642644], ["Fallback Channels", 0.021083104671255317], ["Software Discovery", 0.01750297110410169], ["Traffic Signaling", 0.015280999621856535]], "will make a HTTP GET request": [["Application Layer Protocol", 0.27177479144745054], ["System Network Configuration Discovery", 0.03756899873171502], ["Cloud Service Dashboard", 0.02899340771264642], ["Ingress Tool Transfer", 0.025363865641967902], ["Exfiltration Over C2 Channel", 0.023136224501605074], ["Web Service", 0.021819854573606447]], "will make a POST request": [["Application Layer Protocol", 0.12274176037881432], ["Exfiltration Over C2 Channel", 0.05761954730697832], ["Web Service", 0.03941830668561793], ["Browser Session Hijacking", 0.027515783372575348], ["Data Encoding", 0.027401379461510337], ["Use Alternate Authentication Material", 0.023625247956292988]], "NBTScan for network reconnaissance": [["Remote System Discovery", 0.287456367953625], ["Network Service Discovery", 0.25262976240949064], ["System Network Connections Discovery", 0.06733614562978003], ["Active Scanning", 0.06149631359021243], ["Data from Configuration Repository", 0.0362638806893723], ["Network Share Discovery", 0.03058078956161094]], "System Network Connections Discovery": [["System Network Connections Discovery", 0.6979881997425241], ["Remote System Discovery", 0.051387571549775975], ["Network Service Discovery", 0.047698966959560454], ["System Network Configuration Discovery", 0.04036228688993692], ["Network Share Discovery", 0.015944403046897412], ["Windows Management Instrumentation", 0.015277666120658026]], "PsExec for lateral movement": [["Command and Scripting Interpreter", 0.2074609099848936], ["Native API", 0.09455029939314477], ["Remote Services", 0.08111617690101339], ["System Services", 0.06451619661942926], ["System Binary Proxy Execution", 0.05102755695578594], ["Indirect Command Execution", 0.027516246972782047]], "obtained credentials for pivoting with Mimikatz": [["OS Credential Dumping", 0.13105635040343752], ["Credentials from Password Stores", 0.08170181355216766], ["Valid Accounts", 0.06729712729103719], ["Unsecured Credentials", 0.0530542255310885], ["Remote Services", 0.04469339520370478], ["Brute Force", 0.03341348843998013]], "detect memory dumps of the lsass process": [["Virtualization/Sandbox Evasion", 0.1215851035402957], ["Process Discovery", 0.10515546509371906], ["OS Credential Dumping", 0.08968771392947063], ["Native API", 0.05152353254931439], ["Process Injection", 0.04855803519624295], ["Data from Local System", 0.045529247086174514]], "OS Credential Dumping: LSASS Memory": [["OS Credential Dumping", 0.7702352742872558], ["Credentials from Password Stores", 0.04451243177771729], ["Unsecured Credentials", 0.016335876907688635], ["Data from Local System", 0.014649871128876113], ["Input Capture", 0.007756441498291485], ["Network Sniffing", 0.006761099143438023]], "had been archived": [["Indicator Removal", 0.2392959075848258], ["Archive Collected Data", 0.054456888316282634], ["Data Staged", 0.040492821648146646], ["Automated Collection", 0.03924817260456581], ["Exfiltration Over C2 Channel", 0.029661166135083208], ["Deobfuscate/Decode Files or Information", 0.024889737582834415]], "encrypted copy": [["Data Encrypted for Impact", 0.28377532980624687], ["Archive Collected Data", 0.16847736678483846], ["Obfuscated Files or Information", 0.12680664887226822], ["Deobfuscate/Decode Files or Information", 0.06954452697352556], ["Encrypted Channel", 0.039520949117129195], ["Exfiltration Over Alternative Protocol", 0.027980595965847666]], "encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.": [["Obfuscated Files or Information", 0.16665676556709505], ["Deobfuscate/Decode Files or Information", 0.15163949212158223], ["Encrypted Channel", 0.1402698315571], ["Data Encrypted for Impact", 0.10178209680253883], ["Data Encoding", 0.07932888724513157], ["Archive Collected Data", 0.060007462684436755]], "uploaded.": [["Ingress Tool Transfer", 0.054032274937571734], ["Exfiltration Over Web Service", 0.052302767322654646], ["Exfiltration Over C2 Channel", 0.04462105573643673], ["Indicator Removal", 0.04057537633950837], ["Stage Capabilities", 0.0387979793833659], ["Archive Collected Data", 0.03822633189159097]], "Exfiltration Over C2 Channel": [["Exfiltration Over C2 Channel", 0.3260842881241607], ["Exfiltration Over Alternative Protocol", 0.08332145875528481], ["Scheduled Transfer", 0.0743903136054214], ["Automated Exfiltration", 0.06536364072223574], ["Data Encoding", 0.029147938658234986], ["Fallback Channels", 0.028921308129600747]], "to run bruteforcing offline.": [["Brute Force", 0.4797136580447022], ["Steal or Forge Kerberos Tickets", 0.034913494894362074], ["OS Credential Dumping", 0.03147501907035107], ["Multi-Factor Authentication Interception", 0.02772153576792011], ["Credentials from Password Stores", 0.026613390352385625], ["Use Alternate Authentication Material", 0.01959427670259026]], "scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer": [["Exploitation of Remote Services", 0.3297546198373852], ["Remote Services", 0.04918049867588054], ["Network Service Discovery", 0.0428072805136576], ["Lateral Tool Transfer", 0.03325604689016616], ["Taint Shared Content", 0.0331956211026638], ["Network Share Discovery", 0.033190567186276713]], "Exploitation of Remote Services": [["System Services", 0.10442138633727471], ["Exploitation of Remote Services", 0.08800279812310616], ["Endpoint Denial of Service", 0.04751818727657827], ["Network Service Discovery", 0.0462485149257453], ["Remote Services", 0.04013168807890909], ["System Service Discovery", 0.02631818847204299]], "SysUpdate and HyperBro backdoors were installed": [["Inhibit System Recovery", 0.05189587126915951], ["Boot or Logon Autostart Execution", 0.05037007383509839], ["Impair Defenses", 0.04643179805842909], ["Indicator Removal", 0.043211445415747285], ["Windows Management Instrumentation", 0.03933418698813224], ["Pre-OS Boot", 0.038715955949679276]], "push Polar ransomware to computers and run it,": [["Data Encrypted for Impact", 0.13247749174159604], ["Command and Scripting Interpreter", 0.051122414010790464], ["Masquerading", 0.042491715050713294], ["Ingress Tool Transfer", 0.03971544685041094], ["User Execution", 0.03439606941590337], ["Obfuscated Files or Information", 0.027142456038008755]], "Three files are sent to the victim's computer:": [["Ingress Tool Transfer", 0.09525641647157593], ["Archive Collected Data", 0.05734724297092683], ["Automated Collection", 0.05132942850246025], ["Data from Local System", 0.04504414414317126], ["Exfiltration Over C2 Channel", 0.043519983425703866], ["Phishing", 0.040816474774979676]], "obtained the credentials of a domain administration at headquarters": [["OS Credential Dumping", 0.13935935339419292], ["Valid Accounts", 0.12982929078767405], ["Gather Victim Identity Information", 0.08575958328935637], ["Unsecured Credentials", 0.0564661681699994], ["Brute Force", 0.05269882471498187], ["Credentials from Password Stores", 0.037202417543057746]], "account of the compromised domain admin": [["Account Discovery", 0.26652208633440216], ["Valid Accounts", 0.23447662424445723], ["Create Account", 0.08998578718355328], ["Permission Groups Discovery", 0.035734547985544186], ["Account Manipulation", 0.03548284411704239], ["System Owner/User Discovery", 0.020864615373314757]], "Valid Accounts: Domain Accounts": [["Create Account", 0.2366423260022162], ["Valid Accounts", 0.19843109213870308], ["Account Discovery", 0.15172594576000492], ["Account Manipulation", 0.05628738924727729], ["Establish Accounts", 0.03218642170906604], ["Modify Authentication Process", 0.028871843635349136]], "is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run": [["Hijack Execution Flow", 0.2952736348866759], ["Shared Modules", 0.1163452067952597], ["Process Injection", 0.08234489200856288], ["System Binary Proxy Execution", 0.0657127871776493], ["Native API", 0.03798871485163459], ["Masquerading", 0.02456300510036913]], "XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.": [["Deobfuscate/Decode Files or Information", 0.6715067803020923], ["Data Encrypted for Impact", 0.06609184964163105], ["Encrypted Channel", 0.05037321912715116], ["Obfuscated Files or Information", 0.036463785420620225], ["Weaken Encryption", 0.024846986780100572], ["Archive Collected Data", 0.022980096629235138]], "decoded with Base64": [["Deobfuscate/Decode Files or Information", 0.4593221100221047], ["Data Encoding", 0.21822271014984765], ["Obfuscated Files or Information", 0.1817911200482153], ["Archive Collected Data", 0.023230036416072627], ["Encrypted Channel", 0.014766102023287792], ["Data Obfuscation", 0.014457622417576046]], "decrypts a third component": [["Deobfuscate/Decode Files or Information", 0.6359652708821061], ["Data Encrypted for Impact", 0.07421264157165851], ["Obfuscated Files or Information", 0.056599201323672715], ["Encrypted Channel", 0.03246528462760753], ["Archive Collected Data", 0.03167644918600236], ["Weaken Encryption", 0.031301018535809196]], "decrypted and decoded version": [["Deobfuscate/Decode Files or Information", 0.6947481321876933], ["Obfuscated Files or Information", 0.07915831152852464], ["Archive Collected Data", 0.03470806202476805], ["Data Encrypted for Impact", 0.0270749273121325], ["Encrypted Channel", 0.012377197364893996], ["Execution Guardrails", 0.01093105821357244]], "Deobfuscate/Decode Files or Information": [["Deobfuscate/Decode Files or Information", 0.556379554586449], ["Obfuscated Files or Information", 0.12680600013986945], ["Archive Collected Data", 0.09071973736086], ["Data Encoding", 0.01816563259638432], ["Data Encrypted for Impact", 0.01810426654943801], ["Exfiltration Over Alternative Protocol", 0.014558212383619203]], "payload and intermediate library are deleted before completion": [["Indicator Removal", 0.32674690831158015], ["Deobfuscate/Decode Files or Information", 0.0789226053221147], ["Obfuscated Files or Information", 0.054468685097470236], ["Command and Scripting Interpreter", 0.03570718672899095], ["Ingress Tool Transfer", 0.02240648350306775], ["Hide Artifacts", 0.021452016182254303]], "deletes the intermediate DLL library and encrypted ransomware": [["Indicator Removal", 0.2628220141403232], ["Deobfuscate/Decode Files or Information", 0.05840420518754319], ["Data Encrypted for Impact", 0.04669068434798681], ["Modify Registry", 0.040368764571446204], ["Obfuscated Files or Information", 0.0365473925861541], ["Masquerading", 0.03606412718140995]], "del": [["Indicator Removal", 0.46988473021517513], ["Data Destruction", 0.14017805314980727], ["System Shutdown/Reboot", 0.022387268294680674], ["Disk Wipe", 0.02143604522873098], ["Inhibit System Recovery", 0.01567056250547282], ["Command and Scripting Interpreter", 0.012258652266039505]], "yielding a PE file that is loaded and run in memory with .NET.": [["Process Injection", 0.09915303509672005], ["Native API", 0.0857646526946068], ["System Binary Proxy Execution", 0.04863418333697893], ["OS Credential Dumping", 0.04808740570989416], ["Command and Scripting Interpreter", 0.041678924470224726], ["Event Triggered Execution", 0.040523621116406686]], "Windows Management Instrumentation": [["Windows Management Instrumentation", 0.3379381677559927], ["Native API", 0.07397662094587454], ["Event Triggered Execution", 0.04014999966144999], ["Application Window Discovery", 0.03820208919919487], ["Virtualization/Sandbox Evasion", 0.03787627615165946], ["System Binary Proxy Execution", 0.029522060911799302]], "\"cmd.exe": [["Command and Scripting Interpreter", 0.16332958509524978], ["System Binary Proxy Execution", 0.1589369179713536], ["Masquerading", 0.1025684324169577], ["Native API", 0.08437601867621176], ["Windows Management Instrumentation", 0.033177490001386714], ["Event Triggered Execution", 0.03312391927339726]], "Command and Scripting Interpreter: Windows Command Shell": [["Command and Scripting Interpreter", 0.6836253087470662], ["Native API", 0.08624884555563915], ["System Binary Proxy Execution", 0.03396798234935159], ["Indirect Command Execution", 0.025365927123525877], ["Windows Management Instrumentation", 0.011512595053751736], ["XSL Script Processing", 0.009805219742679764]], "looks for": [["File and Directory Discovery", 0.08495238456344652], ["Active Scanning", 0.05432523238895621], ["Automated Collection", 0.040843208756841824], ["Software Discovery", 0.02501527557643302], ["Virtualization/Sandbox Evasion", 0.02113099363148385], ["Data from Information Repositories", 0.0184779919691582]], "list of connected disks and starts recursive traversal of directories": [["File and Directory Discovery", 0.3226583516007537], ["Peripheral Device Discovery", 0.09858864091959021], ["Network Share Discovery", 0.09334185443423043], ["System Information Discovery", 0.04116315236166531], ["Remote System Discovery", 0.03652063109350239], ["Automated Collection", 0.029539615810406032]], "sends an HTTP POST request with the name of the victim's computer to a server": [["Application Layer Protocol", 0.14872278157247545], ["Exfiltration Over C2 Channel", 0.07622655219780662], ["System Information Discovery", 0.062043783254298615], ["System Owner/User Discovery", 0.047425093038836616], ["Web Service", 0.04045842103235808], ["Dynamic Resolution", 0.039299766685773875]], "T1071\nApplication Layer Protocol: Web Protocols": [["Application Layer Protocol", 0.46058399493973423], ["Data Obfuscation", 0.0728901270455083], ["Non-Standard Port", 0.025559556230680576], ["Fallback Channels", 0.025217605777475394], ["Encrypted Channel", 0.024230427798399602], ["Non-Application Layer Protocol", 0.02367544497506685]], "SCHTASKS /Create": [["Scheduled Task/Job", 0.6132411210129802], ["Create or Modify System Process", 0.029152272498611326], ["Masquerading", 0.026875647653157107], ["System Services", 0.02628667688604846], ["Inter-Process Communication", 0.02474614208394102], ["Command and Scripting Interpreter", 0.020163014851905883]], "schtasks /run": [["Scheduled Task/Job", 0.5695373603847057], ["System Services", 0.03713396160275348], ["Masquerading", 0.02743832101902605], ["Command and Scripting Interpreter", 0.025938442323556517], ["Create or Modify System Process", 0.02151763208506158], ["Inter-Process Communication", 0.016979986808999363]], "Scheduled Task/Job: Scheduled Task": [["Scheduled Task/Job", 0.8320407932773913], ["Inter-Process Communication", 0.030610562239910002], ["Masquerading", 0.016242546999162628], ["Command and Scripting Interpreter", 0.010569908286450951], ["System Services", 0.0054297369758396176], ["Create or Modify System Process", 0.004849189466281408]], "Exploit Public-Facing Application": [["Drive-by Compromise", 0.37399273051824367], ["Exploit Public-Facing Application", 0.08182008081962593], ["Exploitation for Client Execution", 0.05689660555642731], ["Stage Capabilities", 0.05419776707278835], ["Phishing", 0.03606191523214642], ["User Execution", 0.031105366984611565]], "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder": [["Boot or Logon Autostart Execution", 0.4410642107206141], ["Boot or Logon Initialization Scripts", 0.2833182242471115], ["Modify Registry", 0.03532099258278209], ["Create or Modify System Process", 0.028634969526182046], ["Query Registry", 0.022495747983972133], ["Event Triggered Execution", 0.019605932267684856]], "Valid Accounts: Default Accounts": [["Create Account", 0.23449179814636856], ["Account Discovery", 0.12793244327352646], ["Valid Accounts", 0.12127803827112767], ["Account Manipulation", 0.08705954303981688], ["Establish Accounts", 0.038686885851691354], ["Modify Authentication Process", 0.032409273878909364]], "Exploitation for Privilege Escalation": [["Exploitation for Privilege Escalation", 0.48911916585281984], ["Abuse Elevation Control Mechanism", 0.1258154295751735], ["Access Token Manipulation", 0.03849787236480767], ["Exploitation of Remote Services", 0.025885851050430345], ["Process Injection", 0.021474336032656163], ["Domain Policy Modification", 0.019550184788327343]], "System Information Discovery": [["System Information Discovery", 0.6931966664182166], ["Windows Management Instrumentation", 0.052042538837638375], ["Software Discovery", 0.030917754211905804], ["Query Registry", 0.016289997573364672], ["Virtualization/Sandbox Evasion", 0.014432293750720184], ["System Network Configuration Discovery", 0.010718665023001166]], "Lateral Tool Transfer": [["Lateral Tool Transfer", 0.1452164232620835], ["Remote Services", 0.09700394327142509], ["Communication Through Removable Media", 0.06146140168674297], ["Ingress Tool Transfer", 0.03772074533711038], ["Exploitation of Remote Services", 0.02414251059298351], ["Taint Shared Content", 0.02394542921868363]], "Data from Local System": [["Data from Local System", 0.24945194786382585], ["Data Staged", 0.10170365011606342], ["Data from Removable Media", 0.05937573238166106], ["Data from Network Shared Drive", 0.052309969982824216], ["Exfiltration Over C2 Channel", 0.03610186748388125], ["Exfiltration Over Web Service", 0.03240170451684926]], "Encrypted Channel: Symmetric Cryptography": [["Encrypted Channel", 0.4057901017487193], ["Weaken Encryption", 0.08620502545387008], ["Exfiltration Over Alternative Protocol", 0.05710890286796773], ["Data Encrypted for Impact", 0.05580199069768676], ["Obfuscated Files or Information", 0.047615257317112546], ["Deobfuscate/Decode Files or Information", 0.04196253260661152]], "Unpacked file names": [["Deobfuscate/Decode Files or Information", 0.20601139191202708], ["Masquerading", 0.16958432759879996], ["Obfuscated Files or Information", 0.12267721206729308], ["File and Directory Discovery", 0.08631763189377843], ["Archive Collected Data", 0.04089464234950788], ["Automated Collection", 0.02996362946731383]], "obfuscation of the GuLoader shellcode and payloads": [["Obfuscated Files or Information", 0.7865237308202195], ["Deobfuscate/Decode Files or Information", 0.09298288375254302], ["Execution Guardrails", 0.011444436629007678], ["Process Injection", 0.009690986390675543], ["Data Obfuscation", 0.00716311476638248], ["Masquerading", 0.0056727939105720845]], "to download additional malicious files": [["Ingress Tool Transfer", 0.7265148454202252], ["Command and Scripting Interpreter", 0.03018075385762541], ["BITS Jobs", 0.02686828702389171], ["Application Layer Protocol", 0.013524294292026071], ["Data from Local System", 0.01203447803437344], ["Web Service", 0.006784199957832125]], "subsequently download Remcos on the target system": [["Ingress Tool Transfer", 0.12290169939079085], ["Impair Defenses", 0.03628260290212913], ["Command and Scripting Interpreter", 0.032752530777519474], ["Obtain Capabilities", 0.026732582521072815], ["Endpoint Denial of Service", 0.022656652318848728], ["Subvert Trust Controls", 0.02131005678965312]], ":taking full control of the infected machinerecording keystrokes in real time with": [["Input Capture", 0.8307856432569336], ["Clipboard Data", 0.01084980147903336], ["Audio Capture", 0.005014082209493669], ["Screen Capture", 0.0049479106693614975], ["Video Capture", 0.004695289863085408], ["Event Triggered Execution", 0.004373207396844232]], "The second shellcode revealed after the unpacking algorithm finished processing": [["Obfuscated Files or Information", 0.42805964002684727], ["Deobfuscate/Decode Files or Information", 0.26094923489918026], ["Native API", 0.02244911178607162], ["Execution Guardrails", 0.016173440358353802], ["System Information Discovery", 0.015813396155936656], ["Virtualization/Sandbox Evasion", 0.013257287717173319]], "this executable is an archive that can be unpacked with the help of 7zip": [["Deobfuscate/Decode Files or Information", 0.4105466595813257], ["Archive Collected Data", 0.12886233286185364], ["Obfuscated Files or Information", 0.08897251289730877], ["System Binary Proxy Execution", 0.033799094421676036], ["Masquerading", 0.03360932912014769], ["Command and Scripting Interpreter", 0.021681528681003197]], "Once we unpack the file, we can see several elements, as well as directories typical for NSIS:": [["File and Directory Discovery", 0.5517861259743784], ["Data Staged", 0.04732839689151504], ["Automated Collection", 0.0367724439212258], ["Data from Local System", 0.0330016220031278], ["Data from Network Shared Drive", 0.01662833659167167], ["Native API", 0.015434898947654985]], "It is unpacked": [["Deobfuscate/Decode Files or Information", 0.188091550076172], ["Obfuscated Files or Information", 0.13336600346553662], ["Archive Collected Data", 0.05401314705649585], ["Masquerading", 0.03150723219486034], ["Ingress Tool Transfer", 0.024281281351372364], ["Indicator Removal", 0.021518452924113342]], "This packer has been around for many years": [["Obfuscated Files or Information", 0.08573687980829746], ["Masquerading", 0.06896182887013899], ["Acquire Infrastructure", 0.02119137951495102], ["Archive Collected Data", 0.02007491127482405], ["Obtain Capabilities", 0.017219532235680665], ["Data Manipulation", 0.016299990974466053]], "Then the functions are used to load and decrypt the payload.": [["Deobfuscate/Decode Files or Information", 0.5843960407463593], ["Obfuscated Files or Information", 0.19918787623131706], ["Archive Collected Data", 0.02433283010763968], ["Encrypted Channel", 0.017931903750141233], ["Execution Guardrails", 0.016655112920281916], ["Data Encrypted for Impact", 0.013851433728402307]], "The decryption function is custom": [["Deobfuscate/Decode Files or Information", 0.6567944232194726], ["Data Encrypted for Impact", 0.06218182168262839], ["Obfuscated Files or Information", 0.057530713745596], ["Archive Collected Data", 0.036829189254713714], ["Encrypted Channel", 0.033457328479967095], ["Weaken Encryption", 0.02784772029718287]], "custom decryption algorithm is being applied on the buffer": [["Deobfuscate/Decode Files or Information", 0.5322470760883627], ["Obfuscated Files or Information", 0.10789182312745976], ["Encrypted Channel", 0.06690016487238772], ["Data Encrypted for Impact", 0.046562575620912344], ["Weaken Encryption", 0.03831752509877321], ["Archive Collected Data", 0.033827043586686485]], "The algorithm used for the buffer decryption differs across the samples.": [["Deobfuscate/Decode Files or Information", 0.43543075705922085], ["Obfuscated Files or Information", 0.12584179953425056], ["Archive Collected Data", 0.07010224887692959], ["Encrypted Channel", 0.04053921183696343], ["Data Encoding", 0.03001960282578471], ["Weaken Encryption", 0.02907189582483162]], "This shellcode is used for decrypting": [["Deobfuscate/Decode Files or Information", 0.680372890254619], ["Obfuscated Files or Information", 0.11303856627969491], ["Data Encrypted for Impact", 0.0376346108983049], ["Encrypted Channel", 0.03296335567799384], ["Archive Collected Data", 0.018381315106116004], ["Execution Guardrails", 0.011107806249486688]], "the key that will be used for the decryption is prepared.": [["Deobfuscate/Decode Files or Information", 0.6441779463421083], ["Data Encrypted for Impact", 0.06093882354275637], ["Weaken Encryption", 0.03803995827429108], ["Encrypted Channel", 0.03436881635446976], ["Archive Collected Data", 0.02772886264578928], ["Obfuscated Files or Information", 0.026349218727041088]], "After the PE is decrypted": [["Deobfuscate/Decode Files or Information", 0.4090393106490757], ["Data Encrypted for Impact", 0.11639102321362067], ["Weaken Encryption", 0.04719175387917012], ["Obfuscated Files or Information", 0.04545649456560552], ["Archive Collected Data", 0.04347391845834611], ["Execution Guardrails", 0.027991575803223503]], "we can see decryption of the next stage with the help of a custom algorithm": [["Deobfuscate/Decode Files or Information", 0.7083504917969219], ["Data Encrypted for Impact", 0.041537361061990616], ["Obfuscated Files or Information", 0.03738738446875743], ["Archive Collected Data", 0.028767075179924585], ["Encrypted Channel", 0.02493110239215782], ["Weaken Encryption", 0.021543764710444998]], "It contains a very similar function dedicated to decrypting and loading the final payload": [["Deobfuscate/Decode Files or Information", 0.7474148890556409], ["Obfuscated Files or Information", 0.06865844430421568], ["Archive Collected Data", 0.03448051101917], ["Data Encrypted for Impact", 0.026557897410346747], ["Weaken Encryption", 0.010389947194788913], ["Encrypted Channel", 0.010249291307640502]], "Both of them are encrypted,": [["Obfuscated Files or Information", 0.15044991217832002], ["Data Encrypted for Impact", 0.09425078424590327], ["Archive Collected Data", 0.09330836075459739], ["Encrypted Channel", 0.0925225783611304], ["Deobfuscate/Decode Files or Information", 0.08559026318505857], ["Exfiltration Over Alternative Protocol", 0.047069940928925094]], "loading the final payload (PE file) from the third of the encrypted files.": [["Obfuscated Files or Information", 0.21471314135326838], ["Deobfuscate/Decode Files or Information", 0.1858288289159884], ["Data Encrypted for Impact", 0.1268144963220322], ["Archive Collected Data", 0.0902695752026664], ["Execution Guardrails", 0.029356446062809283], ["Encrypted Channel", 0.01704035792408378]], "The authors used several common techniques to obfuscate this process.": [["Obfuscated Files or Information", 0.7383349429198623], ["Deobfuscate/Decode Files or Information", 0.037812532994930946], ["Data Obfuscation", 0.02828966524466839], ["Data Encoding", 0.019639006017820156], ["Masquerading", 0.015731025778402397], ["Archive Collected Data", 0.015067886920888288]], "passing the path to the encrypted component as a parameter.": [["Obfuscated Files or Information", 0.25357001178416777], ["Deobfuscate/Decode Files or Information", 0.1377794534973706], ["Execution Guardrails", 0.05274497153826667], ["Data Encrypted for Impact", 0.049552023240775005], ["Hide Artifacts", 0.034607041483533246], ["Archive Collected Data", 0.03166809650303464]], "obfuscating malicious elements.": [["Obfuscated Files or Information", 0.7232027392333492], ["Deobfuscate/Decode Files or Information", 0.04791816709685917], ["Data Obfuscation", 0.03542394511866436], ["Data Encoding", 0.03444004542371316], ["Encrypted Channel", 0.016113205054124453], ["Archive Collected Data", 0.011137607841879735]], "As before, they are resolved by their hashes.": [["Dynamic Resolution", 0.09928038950996375], ["Masquerading", 0.052645771895164166], ["Adversary-in-the-Middle", 0.052284623675878515], ["System Network Configuration Discovery", 0.03833668098911272], ["Application Layer Protocol", 0.032869619908485394], ["Automated Collection", 0.027461423889785876]], "Then, a function defined by its hash is retrieved (using the same hashing algorithm that was used to retrieve imports from normally loaded DLLs):": [["Shared Modules", 0.1995163254385823], ["Hijack Execution Flow", 0.18909005233208365], ["Native API", 0.09079041078191089], ["Process Injection", 0.0322980084792801], ["Obfuscated Files or Information", 0.029299181918921266], ["Deobfuscate/Decode Files or Information", 0.02537932433892241]], "By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.": [["Hijack Execution Flow", 0.22356619193693197], ["System Binary Proxy Execution", 0.14174934841090694], ["Shared Modules", 0.13934303907087628], ["Process Injection", 0.10116416055095787], ["Native API", 0.06112155964635343], ["Event Triggered Execution", 0.024175511184673176]], "functions has been resolved by their hashes.": [["Native API", 0.06632751397954577], ["Obfuscated Files or Information", 0.05238535854046967], ["Masquerading", 0.05079187349696902], ["System Service Discovery", 0.04189009181226275], ["Virtualization/Sandbox Evasion", 0.04025136248269617], ["Hijack Execution Flow", 0.03255352509563682]], "The hashing function used for import resolving": [["Obfuscated Files or Information", 0.16804345654645386], ["Use Alternate Authentication Material", 0.0497255483834414], ["Masquerading", 0.047726473253638116], ["Deobfuscate/Decode Files or Information", 0.04531455466896931], ["Steal or Forge Kerberos Tickets", 0.03982916510854802], ["Adversary-in-the-Middle", 0.030730082349565296]], "By extracting the syscalls, and executing them manually, the malware can use the API of the operating system,": [["System Information Discovery", 0.16459129660006963], ["Virtualization/Sandbox Evasion", 0.06556095456423928], ["Windows Management Instrumentation", 0.058738199703201176], ["Native API", 0.05310261334720845], ["Software Discovery", 0.05043530985920265], ["System Binary Proxy Execution", 0.037483897963396885]], "using low level APIs: NtCreateSection, NtMapViewOfSection": [["Indicator Removal", 0.0482501036329413], ["Hide Artifacts", 0.04235362984303566], ["Data Staged", 0.03599792903713465], ["Process Injection", 0.03422771206775866], ["Data Manipulation", 0.0332211705041024], ["File and Directory Discovery", 0.03292456429788619]], "Functions are always the same \u2013 dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.": [["File and Directory Discovery", 0.1891694249662229], ["Native API", 0.10770545517358049], ["Data from Local System", 0.05386742060636022], ["Data from Removable Media", 0.0467165066757399], ["Hide Artifacts", 0.046055656925847434], ["Data Staged", 0.03853102783801964]], "The function GetTempPathW is used": [["Virtualization/Sandbox Evasion", 0.11668793283489165], ["Process Discovery", 0.10925151817128254], ["System Information Discovery", 0.07630269605871313], ["Native API", 0.06486740813769372], ["File and Directory Discovery", 0.0523213416276436], ["Query Registry", 0.04435187670329321]], "The low-level functions, directly related with performing the injection, are called via raw syscalls": [["Process Injection", 0.4913264585093684], ["Native API", 0.06592690366349435], ["Shared Modules", 0.057726624294584805], ["Hijack Execution Flow", 0.053144101859590856], ["Event Triggered Execution", 0.02185912224243866], ["System Binary Proxy Execution", 0.020511023573932193]], "PE injection": [["Process Injection", 0.1561651645589143], ["Exploit Public-Facing Application", 0.030512966388655204], ["Exploitation for Credential Access", 0.027657359017104418], ["Drive-by Compromise", 0.02396307490206115], ["Command and Scripting Interpreter", 0.023616136793949166], ["Domain Policy Modification", 0.022332928341859567]], "The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing": [["Process Injection", 0.8119842588359705], ["Event Triggered Execution", 0.021752698630416248], ["Native API", 0.020093232416943434], ["Hijack Execution Flow", 0.01831290328086894], ["Create or Modify System Process", 0.01231000458924478], ["System Binary Proxy Execution", 0.010026620759918477]], "a second, encrypted component, which carries the payload.": [["Obfuscated Files or Information", 0.3997121289383688], ["Execution Guardrails", 0.07209720439001786], ["Deobfuscate/Decode Files or Information", 0.057955103061502165], ["Encrypted Channel", 0.05677737161519066], ["Data Encrypted for Impact", 0.03811114058794662], ["Weaken Encryption", 0.03495669397656225]], "a check against blacklisted processes.": [["Process Discovery", 0.22356939848501314], ["Impair Defenses", 0.1977949205874642], ["Virtualization/Sandbox Evasion", 0.08337737632526314], ["Software Discovery", 0.054991516460477834], ["System Service Discovery", 0.04381974962108675], ["Service Stop", 0.02717156233743569]], "exploiting vulnerabilities in the remote desktop protocol (RDP).": [["Exploitation of Remote Services", 0.4112631149870764], ["Remote Services", 0.13005584002666185], ["Exploitation for Client Execution", 0.07185509757079607], ["Develop Capabilities", 0.03106661949833736], ["Remote Access Software", 0.029724264911943164], ["Exploit Public-Facing Application", 0.02753907370304018]], "distributing phishing emails containing malicious files": [["Phishing", 0.5661209943956649], ["User Execution", 0.20489406177572692], ["Phishing for Information", 0.036766317867785316], ["Internal Spearphishing", 0.021337465495491786], ["Defacement", 0.011404513329119376], ["Establish Accounts", 0.010177509750450373]], "it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack": [["Endpoint Denial of Service", 0.08321679857575143], ["Fallback Channels", 0.06503218377059874], ["Network Denial of Service", 0.0425081525972309], ["Adversary-in-the-Middle", 0.038410067915096206], ["Remote Services", 0.03234827730709349], ["Application Layer Protocol", 0.030087488689230998]], "a malicious template file is downloaded and executed": [["Ingress Tool Transfer", 0.3059795040733], ["System Binary Proxy Execution", 0.08602775848536379], ["Template Injection", 0.08547685926751426], ["Command and Scripting Interpreter", 0.06617128698848167], ["User Execution", 0.045332683224581616], ["Masquerading", 0.03076735959165627]], "to trigger the retrieval of the final stage payload": [["Ingress Tool Transfer", 0.09990896416964075], ["Command and Scripting Interpreter", 0.06204477820543759], ["Multi-Stage Channels", 0.036964836477803596], ["Deobfuscate/Decode Files or Information", 0.03613970121287962], ["Escape to Host", 0.0249244224356523], ["Execution Guardrails", 0.02472032148155123]], "This enables the document to fetch the .dotm file from the remote server required for further actions": [["Ingress Tool Transfer", 0.1734218554443223], ["Template Injection", 0.14262373142978083], ["Command and Scripting Interpreter", 0.05387095143820767], ["Inter-Process Communication", 0.04603665460500152], ["Office Application Startup", 0.03901124689185889], ["User Execution", 0.02638396628504359]], "Upon opening the malicious document": [["User Execution", 0.4494038336658583], ["Template Injection", 0.1070632742073548], ["Office Application Startup", 0.07161537819270264], ["Phishing", 0.034578801636385124], ["Command and Scripting Interpreter", 0.016580292541083848], ["Masquerading", 0.015574383483924786]], "an obfuscated VBA macro": [["Obfuscated Files or Information", 0.7211383278787802], ["Deobfuscate/Decode Files or Information", 0.0635284707575157], ["Command and Scripting Interpreter", 0.023572109017416985], ["Masquerading", 0.01689715670011996], ["Archive Collected Data", 0.011462785978047098], ["Data Obfuscation", 0.010381966407456946]], "\u201ccmd /c": [["Command and Scripting Interpreter", 0.16043844742132135], ["Indirect Command Execution", 0.07748607376639235], ["Indicator Removal", 0.032052535614749196], ["File and Directory Discovery", 0.030552757114817038], ["Native API", 0.029250944630374802], ["Masquerading", 0.026580237521271893]], "the Windows Registry or NTFS Extended Attributes to hide their data,": [["Hide Artifacts", 0.494912516400507], ["Modify Registry", 0.07763574344243213], ["Masquerading", 0.05506494475583887], ["Indicator Removal", 0.052046478576599844], ["Inhibit System Recovery", 0.03774340731946217], ["Rootkit", 0.02373528347574388]], "hide a second stage payload in registry transaction files": [["Modify Registry", 0.4800138439728196], ["Indicator Removal", 0.07155304618250777], ["Impair Defenses", 0.04037724995038841], ["Query Registry", 0.040135744779444454], ["Masquerading", 0.031037665927568577], ["Subvert Trust Controls", 0.018510880089457584]], "perform a\nnumber of changes on the filesystem or registry,": [["Modify Registry", 0.24344488797899932], ["Indicator Removal", 0.16252821161485556], ["Modify System Image", 0.06866372737901412], ["Boot or Logon Autostart Execution", 0.03717291237412199], ["File and Directory Permissions Modification", 0.03197924783306435], ["Masquerading", 0.03037451868468346]], "to store and retrieve binary data with\nthe Windows API.": [["Archive Collected Data", 0.1289560547040402], ["Deobfuscate/Decode Files or Information", 0.07913553553162431], ["Obfuscated Files or Information", 0.07359637860041353], ["Hide Artifacts", 0.06572928431712682], ["File and Directory Discovery", 0.04655436604710995], ["Native API", 0.03986503399352812]], "It provides\napplications with API functions\u2014available": [["Native API", 0.21406128443459785], ["Cloud Service Dashboard", 0.06692880514449197], ["Software Discovery", 0.03055412371296789], ["Web Service", 0.02874486470151782], ["Command and Scripting Interpreter", 0.020007868837368565], ["Ingress Tool Transfer", 0.019019384611396184]], "accessible through API functions.": [["Native API", 0.09428608136328444], ["Cloud Service Dashboard", 0.09244269746355767], ["Web Service", 0.03914670737530277], ["Credentials from Password Stores", 0.03055287694574381], ["Command and Scripting Interpreter", 0.028008503494881553], ["Data from Local System", 0.027693097174721043]], "opened with the CreateLogFile() API": [["Data Staged", 0.1500571327591395], ["Indicator Removal", 0.06687969164028555], ["Hide Artifacts", 0.05060721251119975], ["Input Capture", 0.04481261116255537], ["Data from Local System", 0.037853279308885775], ["Screen Capture", 0.032605183073930205]], "using the clfsw32.dll API function": [["System Binary Proxy Execution", 0.21787569367577508], ["Native API", 0.18309218496028196], ["Hijack Execution Flow", 0.1166279413801006], ["Shared Modules", 0.08225398607791834], ["Process Injection", 0.06431068965611562], ["Deobfuscate/Decode Files or Information", 0.025558107904244263]], "This function is\npatched using Microsoft Detours\u2014a publicly available library used for\ninstrumenting Win32\nfunctions\u2014so": [["Masquerading", 0.12017538215137893], ["Native API", 0.11451786030172016], ["Hijack Execution Flow", 0.07375019948495969], ["System Binary Proxy Execution", 0.058331046871731046], ["Virtualization/Sandbox Evasion", 0.05350434699452685], ["Process Injection", 0.045990870242756984]], "resolves the function\naddress for the ServiceMain export function": [["System Services", 0.2110454207446671], ["System Service Discovery", 0.11120558409056015], ["Create or Modify System Process", 0.10694495074647344], ["Masquerading", 0.058999315341637465], ["Hijack Execution Flow", 0.05285130792567788], ["Native API", 0.052156947083110625]], "via the API CreateFileTransactedA()": [["Data Staged", 0.1284823910709564], ["Hide Artifacts", 0.08523833053784198], ["Indicator Removal", 0.06303595276626667], ["Native API", 0.040173713099565016], ["Masquerading", 0.03691784868478804], ["Data Manipulation", 0.028700523686238197]], "via the API\nNtCreateSection()": [["Data Staged", 0.07554536926789934], ["Native API", 0.04075893507375623], ["Automated Collection", 0.039026893662554886], ["Data from Local System", 0.03881398183096411], ["Process Injection", 0.03831934010594073], ["Hide Artifacts", 0.03703469335693384]], "Malware Obfuscation": [["Obfuscated Files or Information", 0.7709445294417372], ["Deobfuscate/Decode Files or Information", 0.08819976396009235], ["Archive Collected Data", 0.010772650921569902], ["Data Encoding", 0.010491754426142542], ["Data Obfuscation", 0.009496684788950424], ["Execution Guardrails", 0.008398239199556037]], "most of the strings used by\nPRIVATELOG and STASHLOG are obfuscated": [["Obfuscated Files or Information", 0.4971285931659558], ["Deobfuscate/Decode Files or Information", 0.061933039433249376], ["Data Encoding", 0.0517248903925019], ["Data Obfuscation", 0.027251614148594224], ["Archive Collected Data", 0.02292797234630393], ["Impair Defenses", 0.018934711781727658]], "each string is therefore\nencrypted with a unique byte stream.": [["Obfuscated Files or Information", 0.2913651129076421], ["Data Encoding", 0.1599039591850864], ["Deobfuscate/Decode Files or Information", 0.1295593894428733], ["Encrypted Channel", 0.1006975096715981], ["Archive Collected Data", 0.055321269519740104], ["Exfiltration Over Alternative Protocol", 0.030036411356889184]], "relies on XOR\u2019ing each byte with a hard-coded": [["Obfuscated Files or Information", 0.37402662346285703], ["Deobfuscate/Decode Files or Information", 0.26799887737353595], ["Encrypted Channel", 0.056217468210891026], ["Data Encoding", 0.0223997022581708], ["Data Obfuscation", 0.02147359590882569], ["Archive Collected Data", 0.012752392922232991]], "the\ncontrol flow obfuscation.": [["Obfuscated Files or Information", 0.7204290146597604], ["Deobfuscate/Decode Files or Information", 0.048607534204484736], ["Data Obfuscation", 0.023881658674903113], ["Masquerading", 0.014875202416140794], ["Process Injection", 0.014807402054970166], ["Execution Guardrails", 0.01224705012171659]], "In addition to containing obfuscated strings, the installer\u2019s code\nis protected using various control flow obfuscation techniques that\nmake static analysis cumbersome": [["Obfuscated Files or Information", 0.7922524789218215], ["Deobfuscate/Decode Files or Information", 0.03887224232871909], ["Masquerading", 0.02531828849195545], ["Execution Guardrails", 0.01113545562110893], ["Hijack Execution Flow", 0.010550672349088448], ["System Binary Proxy Execution", 0.007476380987436143]], "the installer\ngenerates and prints out encryption keys that the actor uses to\npre-encrypt the payload before it is written to disk": [["Obfuscated Files or Information", 0.32551071442799046], ["Deobfuscate/Decode Files or Information", 0.14149671448195822], ["Data Encrypted for Impact", 0.09207315481723491], ["Archive Collected Data", 0.05225836053666975], ["Execution Guardrails", 0.04987768488381953], ["Weaken Encryption", 0.044651708589607465]], "Following the payload header, the malware expects blocks of\nencrypted data with 8-byte headers.": [["Obfuscated Files or Information", 0.4969650897647662], ["Deobfuscate/Decode Files or Information", 0.14578134668757814], ["Encrypted Channel", 0.06790540005545127], ["Archive Collected Data", 0.04303872362475338], ["Data Encoding", 0.04078151107070745], ["Data Encrypted for Impact", 0.0226278911902046]], "Each block is then\nre-encrypted with the new key material as follows:\n The encryption key is the 16-byte GUID": [["Deobfuscate/Decode Files or Information", 0.18289372003444096], ["Obfuscated Files or Information", 0.11880697675130387], ["Data Encrypted for Impact", 0.09768753464528585], ["Archive Collected Data", 0.0754984903956422], ["Weaken Encryption", 0.0729346906756452], ["Encrypted Channel", 0.06667345460531453]], "The encryption algorithm\nis HC-128,": [["Obfuscated Files or Information", 0.16893774343012066], ["Encrypted Channel", 0.144837007462435], ["Deobfuscate/Decode Files or Information", 0.13396501103856273], ["Data Encrypted for Impact", 0.1305052475380562], ["Archive Collected Data", 0.07750271884754562], ["Weaken Encryption", 0.07180947218244343]], "Sample string deobfuscation": [["Deobfuscate/Decode Files or Information", 0.4938824209964361], ["Obfuscated Files or Information", 0.24754990858963574], ["Data Encoding", 0.039750845882452035], ["Archive Collected Data", 0.016736761559380847], ["Masquerading", 0.012531998334757665], ["Data Obfuscation", 0.012223048313678663]], "some of the deobfuscated strings from the installer\nare used for logging error messages and": [["Obfuscated Files or Information", 0.382020499036305], ["Deobfuscate/Decode Files or Information", 0.11237759837083991], ["Impair Defenses", 0.032397830245962635], ["Masquerading", 0.032175681181319755], ["Indicator Removal", 0.02956016755695777], ["System Information Discovery", 0.023541763905200092]], "the installer opens and decrypts the\ncontents of the file passed as an argument": [["Deobfuscate/Decode Files or Information", 0.4963616540703298], ["Obfuscated Files or Information", 0.21876026597049347], ["Data Encrypted for Impact", 0.02835793607227187], ["System Binary Proxy Execution", 0.02091315926177676], ["Archive Collected Data", 0.017762459661752546], ["Masquerading", 0.016416829848664143]], "decrypted file contents": [["Deobfuscate/Decode Files or Information", 0.5792294152040375], ["Data Encrypted for Impact", 0.14853994418286298], ["Archive Collected Data", 0.07231132364785692], ["Obfuscated Files or Information", 0.043271703865414304], ["Encrypted Channel", 0.010233115955955717], ["File and Directory Discovery", 0.009641654503427393]], "the decrypted data matches\nthe payload": [["Deobfuscate/Decode Files or Information", 0.5622506657710232], ["Archive Collected Data", 0.07683043320224472], ["Obfuscated Files or Information", 0.06455662132439108], ["Data Encrypted for Impact", 0.03751939481759978], ["Encrypted Channel", 0.028695249499336863], ["Exfiltration Over Alternative Protocol", 0.020355116173681406]], "the malware decrypts\neach block using HC-128": [["Deobfuscate/Decode Files or Information", 0.6524893813054157], ["Obfuscated Files or Information", 0.08515397810777095], ["Encrypted Channel", 0.0417087551135002], ["Archive Collected Data", 0.03792907390111464], ["Data Encrypted for Impact", 0.031227545123428704], ["Data Encoding", 0.018318005531861598]], "the payload which will be\ndecrypted.": [["Deobfuscate/Decode Files or Information", 0.5094734587183568], ["Obfuscated Files or Information", 0.09163967137318887], ["Data Encrypted for Impact", 0.04683728359158226], ["Execution Guardrails", 0.04420858064200093], ["Weaken Encryption", 0.043995110678287194], ["Encrypted Channel", 0.035920964795175196]], "its contents are decrypted\nusing the HC-128 encryption algorithm": [["Deobfuscate/Decode Files or Information", 0.4980562263095316], ["Archive Collected Data", 0.1289932112642259], ["Obfuscated Files or Information", 0.08006720398105778], ["Data Encrypted for Impact", 0.06397793816383313], ["Encrypted Channel", 0.029042903687293356], ["Weaken Encryption", 0.02264754864925872]], "The decryption key and IV are\ngenerated using the same unique host properties": [["Deobfuscate/Decode Files or Information", 0.3929156316160969], ["Encrypted Channel", 0.06693932550014813], ["Weaken Encryption", 0.06478061385293596], ["Execution Guardrails", 0.05605987535016429], ["Data Encrypted for Impact", 0.049370546130692125], ["Obfuscated Files or Information", 0.046776028725188136]], "only decrypts the first matching\nblock": [["Deobfuscate/Decode Files or Information", 0.5779810874217539], ["Obfuscated Files or Information", 0.08093362373071007], ["Data Encrypted for Impact", 0.05749637360644244], ["Encrypted Channel", 0.05282552828674468], ["Archive Collected Data", 0.03246387612347971], ["Weaken Encryption", 0.020199381689899338]], "the decrypted\npayload contents": [["Deobfuscate/Decode Files or Information", 0.7345153850551368], ["Obfuscated Files or Information", 0.06135496282961238], ["Archive Collected Data", 0.03517646098363131], ["Data Encrypted for Impact", 0.022766519643426176], ["Encrypted Channel", 0.01711538877409931], ["Data Encoding", 0.011877879732353755]], "file that\nshould be hidden in a CLFS file": [["Hide Artifacts", 0.4375794779541219], ["Indicator Removal", 0.08773578820265747], ["Rootkit", 0.06319205010513346], ["Masquerading", 0.03366580446387283], ["File and Directory Permissions Modification", 0.0335479833714214], ["Obfuscated Files or Information", 0.023012477248653938]], "it searches for .blf files in the\ndefault user\u2019s profile directory": [["Account Discovery", 0.16868379660377344], ["System Owner/User Discovery", 0.10727615309864019], ["File and Directory Discovery", 0.09730687266897184], ["Data from Local System", 0.03289646847336879], ["Unsecured Credentials", 0.030966971699344488], ["Automated Collection", 0.029836627975845725]], "starts by enumerating *.blf files in the default user\u2019s profile\ndirectory": [["File and Directory Discovery", 0.19850042640308727], ["Account Discovery", 0.10665478465555886], ["System Owner/User Discovery", 0.0536715655929184], ["Data from Local System", 0.04817758334228232], ["Automated Collection", 0.04301047274678953], ["Query Registry", 0.030983920655320844]], "malware\nalso checks that the operating system version": [["System Information Discovery", 0.5086032339061457], ["Software Discovery", 0.11523322901699254], ["Virtualization/Sandbox Evasion", 0.06618048747967614], ["Query Registry", 0.038727938350661274], ["Windows Management Instrumentation", 0.019985639388489], ["Execution Guardrails", 0.01586300214447969]], "The injection\nprocess": [["Process Injection", 0.3052807750524484], ["Native API", 0.056045039408135135], ["Exploit Public-Facing Application", 0.0393158621910952], ["Command and Scripting Interpreter", 0.030453265706302465], ["Event Triggered Execution", 0.023635422911531805], ["Inter-Process Communication", 0.022215857058312593]], "For example,\nto open a registry key in a transaction, the functions\nRegCreateKeyTransacted(), RegOpenKeyTransacted(), and\nRegDeleteKeyTransacted() are available.": [["Modify Registry", 0.4451118330053124], ["Query Registry", 0.11187672238457595], ["Boot or Logon Autostart Execution", 0.05577855460014256], ["Command and Scripting Interpreter", 0.01941547870191702], ["Office Application Startup", 0.017510785908408048], ["Deobfuscate/Decode Files or Information", 0.015448864985064769]], "The GUID returned from the registry value": [["Query Registry", 0.5266117698004184], ["Modify Registry", 0.09175916522662367], ["Windows Management Instrumentation", 0.02848081701220261], ["Boot or Logon Autostart Execution", 0.025113247760756692], ["Event Triggered Execution", 0.02416386899945572], ["System Information Discovery", 0.02257703257620585]], "Mimikatz to steal credentials from host memory.": [["OS Credential Dumping", 0.41902826882689936], ["Credentials from Password Stores", 0.18993977173887575], ["Unsecured Credentials", 0.08400544448399311], ["Modify Authentication Process", 0.024979850822657294], ["Input Capture", 0.02423027032284709], ["Brute Force", 0.01697401988061482]], "Mimikatz": [["Masquerading", 0.04389402243231186], ["Command and Scripting Interpreter", 0.033687866855103506], ["OS Credential Dumping", 0.032117896054793565], ["Remote Services", 0.0314035962669948], ["System Owner/User Discovery", 0.02716677839204485], ["Web Service", 0.022602071667573602]], "Uses Mimikatz to harvest credentials.": [["Credentials from Password Stores", 0.2173744342718661], ["OS Credential Dumping", 0.16965086062957327], ["Unsecured Credentials", 0.12830331224170452], ["Modify Authentication Process", 0.03971569776041182], ["Forced Authentication", 0.03815372625143277], ["Brute Force", 0.035930500294739605]], "decrypts them locally.": [["Deobfuscate/Decode Files or Information", 0.6264690274926845], ["Archive Collected Data", 0.0909451145707487], ["Data Encrypted for Impact", 0.06710888927724776], ["Obfuscated Files or Information", 0.041364010118143016], ["Encrypted Channel", 0.014667398180753428], ["Exfiltration Over Alternative Protocol", 0.012166897077151595]], "Once decrypted,": [["Deobfuscate/Decode Files or Information", 0.5079258229648433], ["Data Encrypted for Impact", 0.12887667673738815], ["Archive Collected Data", 0.06238096534749054], ["Weaken Encryption", 0.030272750491647325], ["Obfuscated Files or Information", 0.028007496151954036], ["Encrypted Channel", 0.02101123908271499]], "begins to decrypt and parse its embedded configuration": [["Deobfuscate/Decode Files or Information", 0.854326509611353], ["Obfuscated Files or Information", 0.037146178434134355], ["Archive Collected Data", 0.016642856128145735], ["Data Encrypted for Impact", 0.013614633081983423], ["Encrypted Channel", 0.0068647250627192685], ["Weaken Encryption", 0.006780291952382763]], "decrypting the rest of the blob once it has been decoded.": [["Deobfuscate/Decode Files or Information", 0.6686269719477516], ["Archive Collected Data", 0.07947100158905522], ["Obfuscated Files or Information", 0.07362077549203762], ["Data Encrypted for Impact", 0.036880018331705976], ["Encrypted Channel", 0.01313342091699147], ["Data Encoding", 0.012131551978887746]], "Once the REvil configuration has decrypted": [["Deobfuscate/Decode Files or Information", 0.38763397609696626], ["Data Encrypted for Impact", 0.11309271872045083], ["Archive Collected Data", 0.04453123543728253], ["Weaken Encryption", 0.03983488363897133], ["Obfuscated Files or Information", 0.03037983166242685], ["Service Stop", 0.02878315705147651]], "Decrypted REvil configuration": [["Deobfuscate/Decode Files or Information", 0.4403399023058149], ["Data Encrypted for Impact", 0.12676153390828993], ["Archive Collected Data", 0.05039025367384691], ["Obfuscated Files or Information", 0.0427513508522112], ["Weaken Encryption", 0.03539533725668295], ["Encrypted Channel", 0.029665947464315657]], "decrypted Ransom Cartel configuration": [["Data Encrypted for Impact", 0.5199669582049795], ["Deobfuscate/Decode Files or Information", 0.1621978122035533], ["Obfuscated Files or Information", 0.03399966392257587], ["Archive Collected Data", 0.033675378369276136], ["Execution Guardrails", 0.025534327822136504], ["Weaken Encryption", 0.02263165651264433]], "they are written to the registry,": [["Modify Registry", 0.3950355586191228], ["Query Registry", 0.13462266004398973], ["Indicator Removal", 0.0860631943084553], ["Boot or Logon Autostart Execution", 0.06141734608646863], ["Office Application Startup", 0.023008587314445866], ["Masquerading", 0.017640171956222347]], "it is written to the registry key SOFTWARE\\\\Google_Authenticator\\\\b52dKMhj,": [["Unsecured Credentials", 0.24649409545856407], ["OS Credential Dumping", 0.10907246020915475], ["Credentials from Password Stores", 0.0692132936980076], ["Modify Registry", 0.05548938523148025], ["Query Registry", 0.04529902005915668], ["Modify Authentication Process", 0.03199912376055266]], "Once the data has been written to the registry": [["Modify Registry", 0.4649493702379258], ["Indicator Removal", 0.0964715275629191], ["Query Registry", 0.07007655683411824], ["Boot or Logon Autostart Execution", 0.048201816217498326], ["Hide Artifacts", 0.012974965899137181], ["Inhibit System Recovery", 0.012600733884063034]], "stored within the registry": [["Modify Registry", 0.43558789257611424], ["Query Registry", 0.21905379542487946], ["Boot or Logon Autostart Execution", 0.08453300469341796], ["Indicator Removal", 0.037516806691115547], ["Office Application Startup", 0.014638090932247374], ["Unsecured Credentials", 0.012689978844926304]], "Modifies the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.": [["Abuse Elevation Control Mechanism", 0.41675882196487396], ["Access Token Manipulation", 0.0812294537073066], ["Domain Policy Modification", 0.04902440648546512], ["File and Directory Permissions Modification", 0.02717030822511392], ["Create Account", 0.02383204290805416], ["Valid Accounts", 0.02133527656956445]], "first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.": [["Modify Registry", 0.39371025936264264], ["Query Registry", 0.34160334341719806], ["Boot or Logon Autostart Execution", 0.07328386522976733], ["System Binary Proxy Execution", 0.015584935928424845], ["Office Application Startup", 0.011197836815602578], ["Event Triggered Execution", 0.010349813077130806]], "the command line provided to the ransomware is parsed.": [["Deobfuscate/Decode Files or Information", 0.25475194390741124], ["Obfuscated Files or Information", 0.12461669483261018], ["Data Encrypted for Impact", 0.100813869994845], ["Command and Scripting Interpreter", 0.06154947524694851], ["Masquerading", 0.0546615709226988], ["File and Directory Discovery", 0.033735337001362664]], "cmd.exe": [["Command and Scripting Interpreter", 0.23391745737487038], ["System Binary Proxy Execution", 0.14601169808714543], ["Native API", 0.10359263196936783], ["Masquerading", 0.06188744139108867], ["Windows Management Instrumentation", 0.035867627911140496], ["Indirect Command Execution", 0.032322522366374624]], "Uses cmd.exe to execute commands.": [["Command and Scripting Interpreter", 0.5015568691060363], ["Indirect Command Execution", 0.08067653816356453], ["System Binary Proxy Execution", 0.06780932734328857], ["Native API", 0.058409452365154414], ["System Services", 0.05247804993878084], ["Windows Management Instrumentation", 0.020940005127310937]], "to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.": [["Abuse Elevation Control Mechanism", 0.39114005655771655], ["Access Token Manipulation", 0.0854312956770481], ["Domain Policy Modification", 0.056678209475651706], ["File and Directory Permissions Modification", 0.03197233260941143], ["Impair Defenses", 0.02555390805464857], ["Exploitation for Privilege Escalation", 0.022416962920348327]], "Adds registry run keys to achieve persistence.": [["Boot or Logon Autostart Execution", 0.458714466171399], ["Boot or Logon Initialization Scripts", 0.09440877869538371], ["Event Triggered Execution", 0.07499147608149866], ["Create or Modify System Process", 0.07414132478478114], ["Modify Registry", 0.05294530219862318], ["Scheduled Task/Job", 0.03513318561325234]], "to download and install payloads": [["Ingress Tool Transfer", 0.6154284404826003], ["Command and Scripting Interpreter", 0.09021836860706073], ["BITS Jobs", 0.07942923651366156], ["System Binary Proxy Execution", 0.020159196359962064], ["Web Service", 0.011330652936774061], ["Application Layer Protocol", 0.010464369974954271]], "to retrieve the malicious payload and download additional resources": [["Ingress Tool Transfer", 0.6131891478519386], ["Command and Scripting Interpreter", 0.05719708366879234], ["BITS Jobs", 0.03995947270460604], ["Multi-Stage Channels", 0.015092671458004163], ["Deobfuscate/Decode Files or Information", 0.013227402531433504], ["System Binary Proxy Execution", 0.010908566232055212]], "Downloads and uploads files to and from the victim\u2019s machine.": [["Ingress Tool Transfer", 0.6397189231876109], ["Data from Local System", 0.04194587803583385], ["Application Layer Protocol", 0.023696546159749813], ["Lateral Tool Transfer", 0.0205317582665337], ["Exfiltration Over C2 Channel", 0.01787339422583208], ["Exfiltration Over Alternative Protocol", 0.015779378519758407]], "the tool downloads the files": [["Ingress Tool Transfer", 0.5854072848756701], ["Data from Local System", 0.04789134148248078], ["Command and Scripting Interpreter", 0.037845883777326714], ["Automated Collection", 0.019679069322346695], ["BITS Jobs", 0.018583243497809213], ["Data from Network Shared Drive", 0.018102006564409464]], "Uses legitimate VPN, RDP, Citrix or VNC credentials to maintain access to an environment.": [["Valid Accounts", 0.3091103155641721], ["External Remote Services", 0.19610612767964272], ["Remote Services", 0.07433595817947114], ["Account Manipulation", 0.03594407675475272], ["Modify Authentication Process", 0.024548840297741386], ["Remote Service Session Hijacking", 0.020191109456132797]], "Deploys PDQ Inventory Scanner tool.": [["Automated Collection", 0.05750957566842044], ["Windows Management Instrumentation", 0.039689331488708186], ["Command and Scripting Interpreter", 0.03836828346489446], ["Network Service Discovery", 0.03664331182692343], ["Active Scanning", 0.034908984179330534], ["Remote System Discovery", 0.03125978851829498]], "using a cracked version of a legitimate tool called PDQ Inventory, which is a legitimate system management solution that IT administrators use to scan their network and collect hardware, software and Windows configuration data": [["System Information Discovery", 0.17933020445736056], ["Windows Management Instrumentation", 0.14077732119445852], ["Data from Configuration Repository", 0.09409282717252225], ["Software Discovery", 0.07477248095262412], ["Remote System Discovery", 0.05073710658263089], ["Peripheral Device Discovery", 0.039106037035833506]], "to enable offline password cracking.": [["Brute Force", 0.2002063236656258], ["Credentials from Password Stores", 0.12384609736836007], ["Modify Authentication Process", 0.08517679468843944], ["OS Credential Dumping", 0.05929577637308866], ["Password Policy Discovery", 0.05135701582147032], ["Multi-Factor Authentication Interception", 0.04151629220966069]], "Uses Rundll32 to load and execute malicious DLL.": [["Hijack Execution Flow", 0.28344796425707697], ["System Binary Proxy Execution", 0.2629089330239407], ["Shared Modules", 0.1765235521117337], ["Process Injection", 0.054476098820633145], ["Native API", 0.03936686216877099], ["System Services", 0.019733734314948955]], "the ransomware will proceed to spawn another instance of itself via rundll32.exe": [["System Binary Proxy Execution", 0.17532186430941563], ["Process Injection", 0.078188018484595], ["Native API", 0.07678419625772609], ["Event Triggered Execution", 0.06857517576144599], ["Command and Scripting Interpreter", 0.05467648182867462], ["System Services", 0.05125484712428947]], "Deletes some of its files used during operations as part of cleanup, including removing applications such as 7z.exe, tor.exe, ssh.exe": [["Indicator Removal", 0.7413779876274439], ["Data Destruction", 0.03312919188025231], ["Inhibit System Recovery", 0.021482546208235618], ["System Shutdown/Reboot", 0.015635838451470933], ["Disk Wipe", 0.015318654000972756], ["Service Stop", 0.014925208843602208]], "Uses encoded PowerShell commands.": [["Obfuscated Files or Information", 0.2605617727870993], ["Command and Scripting Interpreter", 0.1801056344896224], ["Deobfuscate/Decode Files or Information", 0.1086247320843757], ["Data Encoding", 0.05190756427868235], ["Masquerading", 0.027682227938897044], ["Native API", 0.021535941677393845]], "utilizing string encryption": [["Obfuscated Files or Information", 0.41036603617736733], ["Encrypted Channel", 0.12654130496477842], ["Deobfuscate/Decode Files or Information", 0.0831641776190127], ["Data Encoding", 0.07456279433453639], ["Data Encrypted for Impact", 0.05052212989814092], ["Archive Collected Data", 0.04608779139279472]], "encrypted configuration": [["Obfuscated Files or Information", 0.23934942086728067], ["Data Encrypted for Impact", 0.12987399506881944], ["Encrypted Channel", 0.09101938390640701], ["Deobfuscate/Decode Files or Information", 0.07549612346319443], ["Weaken Encryption", 0.05859340868202579], ["Execution Guardrails", 0.05653812427247562]], "a base64-encoded ransom note,": [["Obfuscated Files or Information", 0.24709670062576541], ["Data Encrypted for Impact", 0.22409072602968322], ["Deobfuscate/Decode Files or Information", 0.10149436209440188], ["Data Encoding", 0.06185634916036861], ["Archive Collected Data", 0.06015235747568466], ["Masquerading", 0.025298168971858676]], "The configuration is stored as a base64-encoded blob, whereby the first 16 bytes of the base64-encoded blob is the RC4 key": [["Query Registry", 0.2491329323559268], ["Modify Registry", 0.12729263470420144], ["Unsecured Credentials", 0.0939853075041701], ["Deobfuscate/Decode Files or Information", 0.04581858252041865], ["OS Credential Dumping", 0.03545702480054804], ["Boot or Logon Autostart Execution", 0.02618803322226808]], "opts to obfuscate their ransomware much more heavily": [["Obfuscated Files or Information", 0.5491987299387749], ["Data Encrypted for Impact", 0.12809758226390502], ["Deobfuscate/Decode Files or Information", 0.05187956822403968], ["Archive Collected Data", 0.03653888331380346], ["Execution Guardrails", 0.023802309405253796], ["Masquerading", 0.016133698756949616]], "Searches for specific files prior to encryption.": [["File and Directory Discovery", 0.18458531279331403], ["Archive Collected Data", 0.15865137699093199], ["Data Encrypted for Impact", 0.14257729017139942], ["Deobfuscate/Decode Files or Information", 0.0854483114610765], ["Obfuscated Files or Information", 0.07728631040409148], ["Automated Collection", 0.02623200904202965]], "seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.": [["File and Directory Discovery", 0.38238652252401095], ["Data from Local System", 0.12155827997747112], ["Automated Collection", 0.10990491250925645], ["Data Staged", 0.08089069449721663], ["Data from Network Shared Drive", 0.04026046069774322], ["Indicator Removal", 0.02738464289357282]], "Target specific file path": [["File and Directory Discovery", 0.15336445263773496], ["Masquerading", 0.13303636722196063], ["Indicator Removal", 0.09703447401388479], ["Hijack Execution Flow", 0.046254126975539885], ["Data Staged", 0.03473826534995652], ["Ingress Tool Transfer", 0.03132385076259036]], "to search machines for certain files": [["File and Directory Discovery", 0.4617882329788016], ["Data from Local System", 0.07144435203049633], ["Automated Collection", 0.06960357663989958], ["Data from Network Shared Drive", 0.04595398416879322], ["Network Share Discovery", 0.03947385348353743], ["Remote System Discovery", 0.03619194402483814]], "Uses AnyDesk to remotely connect and transfer files.": [["Remote Services", 0.287335174909983], ["Lateral Tool Transfer", 0.21862677961508695], ["Communication Through Removable Media", 0.08311520175510839], ["Remote Access Software", 0.052494871840264114], ["Ingress Tool Transfer", 0.051933501052562614], ["Valid Accounts", 0.013530673036210493]], "used this as a remote access tool to establish an interactive command and control channel": [["Remote Access Software", 0.3779219783109406], ["Remote Services", 0.11181543389826815], ["Command and Scripting Interpreter", 0.0290751700918894], ["Web Service", 0.028275583322865786], ["External Remote Services", 0.027843639126957018], ["Server Software Component", 0.022472839271383258]], "Routes traffic over TOR and VPN servers to obfuscate their activities.": [["Proxy", 0.2478915854508673], ["Data Obfuscation", 0.17040091284242934], ["Encrypted Channel", 0.08688332356267456], ["Protocol Tunneling", 0.06913256594625983], ["Obfuscated Files or Information", 0.046178785160965], ["Data Encoding", 0.032804289964595036]], "TOR sites redirecting to a new ransomware operation": [["Acquire Infrastructure", 0.06608492362951215], ["Compromise Infrastructure", 0.06198260241447845], ["Stage Capabilities", 0.060575398347190786], ["Proxy", 0.05509757408748261], ["Browser Session Hijacking", 0.036948178688900365], ["Web Service", 0.03365348981798578]], "computer name, domain name, locale and product name.": [["System Information Discovery", 0.6435994746329469], ["System Network Configuration Discovery", 0.025869605757693773], ["Remote System Discovery", 0.025001815209504598], ["Gather Victim Host Information", 0.01996801577681661], ["Query Registry", 0.01821896008812569], ["Masquerading", 0.017603462669067527]], "leads to a function that iterates over a call": [["Native API", 0.18615793268834127], ["Virtualization/Sandbox Evasion", 0.04551290410615779], ["Command and Scripting Interpreter", 0.04075008821891431], ["System Services", 0.018283448752376898], ["File and Directory Discovery", 0.016354112816642636], ["Hijack Execution Flow", 0.01439154302624195]], "executes the batch file,": [["Command and Scripting Interpreter", 0.5565349492780326], ["Scheduled Task/Job", 0.07265433808389621], ["System Binary Proxy Execution", 0.05013588022488198], ["System Services", 0.03148194028375452], ["Windows Management Instrumentation", 0.019371324664379724], ["Indirect Command Execution", 0.016149295517116607]], "a batch script used": [["Command and Scripting Interpreter", 0.7460845480415779], ["Scheduled Task/Job", 0.02567747742708736], ["Windows Management Instrumentation", 0.01207563860103489], ["System Binary Proxy Execution", 0.012038420133168831], ["Indicator Removal", 0.010123683426482863], ["Automated Collection", 0.008471699829451333]], "batch files": [["Command and Scripting Interpreter", 0.4860755073166496], ["Scheduled Task/Job", 0.06179640673520961], ["System Binary Proxy Execution", 0.02734110401612183], ["Indicator Removal", 0.02506006252023404], ["Masquerading", 0.020962969214768517], ["System Services", 0.016210277661482683]], "A new batch file, localdisk.bat, was also executed": [["Command and Scripting Interpreter", 0.1470728847290896], ["Indicator Removal", 0.0775206521505595], ["Masquerading", 0.056345756923611885], ["Boot or Logon Autostart Execution", 0.04155130562616491], ["Windows Management Instrumentation", 0.037916584350201815], ["Scheduled Task/Job", 0.030916567584835814]], "These discovery actions were completed several times again in other various batch files.": [["Automated Collection", 0.10620531276708818], ["Indicator Removal", 0.10220351240221155], ["Command and Scripting Interpreter", 0.05307288630087274], ["Windows Management Instrumentation", 0.04322934267674836], ["File and Directory Discovery", 0.03390152442279229], ["Impair Defenses", 0.029854775848517836]], "it was executed using a command line argument": [["Native API", 0.14875221814443407], ["Command and Scripting Interpreter", 0.13167380954282235], ["System Binary Proxy Execution", 0.06575129724210904], ["Indirect Command Execution", 0.04988828312080617], ["System Services", 0.04858811066420874], ["Virtualization/Sandbox Evasion", 0.036224635896332395]], "a batch file.": [["Command and Scripting Interpreter", 0.5022431506037047], ["Scheduled Task/Job", 0.04713360516592866], ["Masquerading", 0.023310377980807796], ["Indicator Removal", 0.02267744196859126], ["System Binary Proxy Execution", 0.022586444838750323], ["Boot or Logon Autostart Execution", 0.020716932593473156]], "the execution of the batch file": [["Command and Scripting Interpreter", 0.3977063987801502], ["Scheduled Task/Job", 0.09764999020841554], ["System Binary Proxy Execution", 0.0611380389063104], ["System Services", 0.03136803195680896], ["Windows Management Instrumentation", 0.028572064874375643], ["Indirect Command Execution", 0.01946795672629405]], "The batch file eyewear.bat then executed two commands": [["Command and Scripting Interpreter", 0.20899585893650713], ["Event Triggered Execution", 0.050904616108959876], ["Windows Management Instrumentation", 0.04714119225131027], ["Masquerading", 0.04331742925508689], ["Scheduled Task/Job", 0.027993120434278075], ["System Binary Proxy Execution", 0.024046091970591977]], "C:\\Windows\\system32\\cmd.exe /c": [["Native API", 0.1331577001742168], ["Masquerading", 0.10039591457046008], ["File and Directory Discovery", 0.0962226818413464], ["System Binary Proxy Execution", 0.05491019659964276], ["Command and Scripting Interpreter", 0.053323963481769515], ["Windows Management Instrumentation", 0.05034487194600984]], "C:\\Windows\\system32\\cmd.exe": [["Native API", 0.11681486548034452], ["Masquerading", 0.09860429522938718], ["Command and Scripting Interpreter", 0.08895256252271494], ["System Binary Proxy Execution", 0.08339578246807118], ["Windows Management Instrumentation", 0.06475733574109067], ["File and Directory Discovery", 0.03665207536808768]], "enter this directly in the host OS command shell.": [["Windows Management Instrumentation", 0.0698608838676248], ["System Information Discovery", 0.06169796693836781], ["Boot or Logon Autostart Execution", 0.04602879858976972], ["Virtualization/Sandbox Evasion", 0.04062573789884614], ["Command and Scripting Interpreter", 0.03165187302815008], ["Create or Modify System Process", 0.02642238579608133]], ":\\Windows\\system32\\cmd.exe /C": [["File and Directory Discovery", 0.1405112893032669], ["Native API", 0.10576712151355831], ["Masquerading", 0.09724339572111292], ["Windows Management Instrumentation", 0.0467086918077122], ["System Binary Proxy Execution", 0.040392157185289046], ["Hijack Execution Flow", 0.03760187271040745]], "invoked from the command line": [["Command and Scripting Interpreter", 0.47326967218893895], ["Native API", 0.1172154427718466], ["Indirect Command Execution", 0.06517560784943593], ["System Services", 0.06135386442034128], ["System Binary Proxy Execution", 0.03907284698884772], ["Event Triggered Execution", 0.01876159144059994]], "Another batch file": [["Command and Scripting Interpreter", 0.5831882607220347], ["Scheduled Task/Job", 0.05120090004387696], ["System Binary Proxy Execution", 0.04458579016577227], ["System Services", 0.023843555526739283], ["Boot or Logon Autostart Execution", 0.016660512970627806], ["Indirect Command Execution", 0.01599705421876331]], "leveraged by a batch file": [["Command and Scripting Interpreter", 0.6979277444310746], ["System Binary Proxy Execution", 0.031499796716051874], ["Scheduled Task/Job", 0.023523122671185327], ["Indirect Command Execution", 0.0161891507272803], ["System Services", 0.01265634761791559], ["Windows Management Instrumentation", 0.01172549730347703]], "C:\\Windows\\System32\\cmd.exe /C": [["Native API", 0.1331577001742168], ["Masquerading", 0.10039591457046008], ["File and Directory Discovery", 0.0962226818413464], ["System Binary Proxy Execution", 0.05491019659964276], ["Command and Scripting Interpreter", 0.053323963481769515], ["Windows Management Instrumentation", 0.05034487194600984]], "using the command line": [["Command and Scripting Interpreter", 0.5094086409839811], ["OS Credential Dumping", 0.026548762716846773], ["Indicator Removal", 0.022372638600056192], ["Virtualization/Sandbox Evasion", 0.01852556338201157], ["Indirect Command Execution", 0.0173012772880036], ["Windows Management Instrumentation", 0.016938504008679914]], "the threat actors dropped several batch scripts on the server:": [["Command and Scripting Interpreter", 0.3848440251027491], ["Scheduled Task/Job", 0.13903495381190217], ["Inter-Process Communication", 0.03535103608377835], ["System Binary Proxy Execution", 0.0295144939394833], ["System Services", 0.02567938512940199], ["Indicator Removal", 0.01969755790773584]], "The threat actor installed Atera and Splashtop remote access software": [["Remote Services", 0.24367504781617724], ["Remote Access Software", 0.1912299814220623], ["External Remote Services", 0.0336554293373998], ["Exploitation of Remote Services", 0.03317464122201774], ["Windows Management Instrumentation", 0.026263732342450122], ["Remote Service Session Hijacking", 0.025722885648723295]], "They then repeated the install of the remote access software package.": [["Remote Access Software", 0.16795306433839513], ["Software Deployment Tools", 0.11974910996316533], ["Remote Services", 0.04854987405296102], ["Supply Chain Compromise", 0.044947002889245496], ["External Remote Services", 0.03789057880887085], ["Exploitation of Remote Services", 0.023818688832458967]], "the threat actor installed RSAT (Remote Server Administration Tools) on the beachhead host": [["Remote Access Software", 0.0748225587870346], ["Remote Services", 0.04787257224844934], ["Command and Scripting Interpreter", 0.03220102897425044], ["Escape to Host", 0.0298983567863167], ["Exploitation of Remote Services", 0.02498641949650012], ["Windows Management Instrumentation", 0.024711169672140303]], "AnyDesk was used to move laterally between a workstation and a backup server": [["Lateral Tool Transfer", 0.10976212465110106], ["Remote Services", 0.08344663270986741], ["Transfer Data to Cloud Account", 0.05257127407989156], ["Taint Shared Content", 0.028739848311094614], ["Communication Through Removable Media", 0.02747672493925454], ["Remote Access Software", 0.024079005293957748]], "three different Remote Access Software were used by the threat actor": [["Remote Access Software", 0.21773042082037983], ["External Remote Services", 0.07868860596147834], ["Software Deployment Tools", 0.07436172883836395], ["Remote Services", 0.06525391649165349], ["Develop Capabilities", 0.058871240540863845], ["Exploitation of Remote Services", 0.04950196059726046]], "the threat actor used three different tools in order to establish an interactive and persistent command and control channel.": [["Remote Access Software", 0.11121986765360489], ["Multi-Stage Channels", 0.05204797018742951], ["Web Service", 0.040526820146040345], ["Develop Capabilities", 0.03866654070755593], ["Event Triggered Execution", 0.03584695107494483], ["Escape to Host", 0.03446299809637225]], "the installation of the remote management tools": [["Remote Access Software", 0.15146496928612802], ["Windows Management Instrumentation", 0.09524466611659012], ["Remote Services", 0.08804056725386092], ["Command and Scripting Interpreter", 0.06262397918918071], ["Lateral Tool Transfer", 0.049783105730261595], ["Software Deployment Tools", 0.03744937187620609]], "began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it": [["Hijack Execution Flow", 0.07419738920543029], ["Ingress Tool Transfer", 0.0715819906689991], ["System Services", 0.07126399237855197], ["Process Injection", 0.046645364389324734], ["Remote Services", 0.04573635256264389], ["System Binary Proxy Execution", 0.04394380302536243]], "the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.": [["Inhibit System Recovery", 0.08798507723202946], ["Modify Cloud Compute Infrastructure", 0.054442279506070126], ["Transfer Data to Cloud Account", 0.04951172657497597], ["Indicator Removal", 0.04190262061509619], ["Service Stop", 0.02711300999154846], ["Masquerading", 0.02085312927956986]], "they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec": [["Command and Scripting Interpreter", 0.16597056494935286], ["OS Credential Dumping", 0.048383009769290435], ["Valid Accounts", 0.032808555401944425], ["Windows Management Instrumentation", 0.026056423575298047], ["Scheduled Task/Job", 0.025849530416012508], ["Data Encrypted for Impact", 0.022787833926844272]], "executing it via a remote service.": [["System Services", 0.41143772511457555], ["System Binary Proxy Execution", 0.1055908800070757], ["Scheduled Task/Job", 0.07845677836040249], ["Command and Scripting Interpreter", 0.07396403295444895], ["Native API", 0.024918702769522887], ["Ingress Tool Transfer", 0.024037212164890787]], "proceeded to dump LSASS memory": [["OS Credential Dumping", 0.26623852421323707], ["Data from Local System", 0.06656040961779697], ["Deobfuscate/Decode Files or Information", 0.055842042241232286], ["Virtualization/Sandbox Evasion", 0.05222920179448388], ["Native API", 0.04628851043965669], ["Automated Collection", 0.03243667139113249]], "ProcDump was used to dump LSASS memory.": [["OS Credential Dumping", 0.38298385884675024], ["Data from Local System", 0.06158466902683487], ["Deobfuscate/Decode Files or Information", 0.04067287883146412], ["Automated Collection", 0.0391138640594741], ["Virtualization/Sandbox Evasion", 0.0335633567604084], ["File and Directory Discovery", 0.0306778462998289]], "several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable": [["OS Credential Dumping", 0.09854924565138243], ["Masquerading", 0.06801775754746288], ["Windows Management Instrumentation", 0.0636659533273767], ["Domain Policy Modification", 0.052021446066814095], ["Inter-Process Communication", 0.03636879753298791], ["Event Triggered Execution", 0.03131414738426038]], "There were several variants of Mimikatz in binary and PowerShell form": [["Command and Scripting Interpreter", 0.42811963975285516], ["System Binary Proxy Execution", 0.04353646075047604], ["Masquerading", 0.027511298243486068], ["Office Application Startup", 0.022987197998803714], ["OS Credential Dumping", 0.022780543558851892], ["Event Triggered Execution", 0.021265542184590085]], "C:\\Windows\\system32\\cmd.exe /C mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\"": [["Abuse Elevation Control Mechanism", 0.14559081641652144], ["Access Token Manipulation", 0.09290999712002537], ["Boot or Logon Autostart Execution", 0.06094979564285789], ["OS Credential Dumping", 0.0553299573363228], ["Input Capture", 0.04798287052215927], ["Event Triggered Execution", 0.047544692972209784]], "C:\\Windows\\system32\\cmd.exe /C mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump": [["Abuse Elevation Control Mechanism", 0.14109535269072943], ["Access Token Manipulation", 0.09883840114318583], ["OS Credential Dumping", 0.0911606689546957], ["Boot or Logon Autostart Execution", 0.05126106882237477], ["Event Triggered Execution", 0.04113601289599953], ["Input Capture", 0.029956410716695085]], "Multiple injections into the LSASS process were observed on multiple hosts.": [["Process Injection", 0.10807661199074867], ["Native API", 0.0649562654039588], ["OS Credential Dumping", 0.06089885545379938], ["Indicator Removal", 0.05471077471702691], ["Obfuscated Files or Information", 0.05338144771952941], ["Hijack Execution Flow", 0.03415409972443695]], "LSASS process to access credentials.": [["OS Credential Dumping", 0.4130590018794408], ["Unsecured Credentials", 0.1616063493346742], ["Credentials from Password Stores", 0.1289034994011506], ["Input Capture", 0.0362884620305223], ["Brute Force", 0.01795891330650482], ["Modify Authentication Process", 0.01653287933273333]], "Process dump of the LSASS process": [["Process Discovery", 0.39930200460011356], ["Native API", 0.07156098617770584], ["OS Credential Dumping", 0.058999780242611294], ["Process Injection", 0.05397857147019255], ["Virtualization/Sandbox Evasion", 0.03827551350654162], ["Impair Defenses", 0.029334025346915888]], "the lsass.exe beacon": [["File and Directory Discovery", 0.1687834673758144], ["System Information Discovery", 0.11270885615367218], ["Native API", 0.06978662188819307], ["Virtualization/Sandbox Evasion", 0.068412521067119], ["Process Discovery", 0.045977230594732445], ["Masquerading", 0.042048697049859224]], "c:\\windows\\temp\\procdump64.exe -accepteula -ma lsass.exe": [["OS Credential Dumping", 0.09052604643128186], ["File and Directory Discovery", 0.06118512469460366], ["Data from Local System", 0.0530763676624286], ["Screen Capture", 0.04916318865117226], ["Masquerading", 0.04722866394753241], ["Archive Collected Data", 0.042418423440599096]], "Several more beacons were also loaded on the host using DLLs and PowerShell.": [["System Services", 0.05614812497227956], ["Fallback Channels", 0.03694163991792322], ["Web Service", 0.03310150479048859], ["Multi-Stage Channels", 0.022773400496378177], ["Masquerading", 0.019938722314744958], ["Indicator Removal", 0.0196879780917467]], "the threat actor moved on to downloading a variety of beacon executables": [["Ingress Tool Transfer", 0.13149793726478384], ["BITS Jobs", 0.06752975771461311], ["Impair Defenses", 0.04973847463832233], ["Fallback Channels", 0.039413327634074624], ["Masquerading", 0.03092603549642417], ["Multi-Stage Channels", 0.02338259077435378]], "to execute various dropped tools or beacons on the endpoint,": [["Web Service", 0.05376900481084243], ["Traffic Signaling", 0.045639390718973334], ["Endpoint Denial of Service", 0.03948006669616921], ["Dynamic Resolution", 0.037062012781561404], ["Data Obfuscation", 0.034889264629568484], ["Application Layer Protocol", 0.03372917615552347]], "files that where downloaded from those sites:": [["Ingress Tool Transfer", 0.1955796599072502], ["Data from Local System", 0.15279994008905692], ["Data Staged", 0.04857332289804903], ["Automated Collection", 0.04583099402720807], ["Data from Network Shared Drive", 0.04254077106652863], ["File and Directory Discovery", 0.0386301027988667]], "file downloads relating to tooling/scripts.": [["Ingress Tool Transfer", 0.47347981785671456], ["Data from Local System", 0.057240789588643703], ["Command and Scripting Interpreter", 0.05004118007111041], ["BITS Jobs", 0.02556877092230696], ["Data from Network Shared Drive", 0.022325880044896673], ["Automated Collection", 0.021174520750501163]], "The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure": [["Impair Defenses", 0.0563470650185372], ["Automated Collection", 0.04752110264588967], ["Indicator Removal", 0.04135277732217992], ["System Information Discovery", 0.032178515040877834], ["Exfiltration Over C2 Channel", 0.029395928748577715], ["Obfuscated Files or Information", 0.023759879003185803]], "Lots of custom scripts dropped by threat actors": [["Command and Scripting Interpreter", 0.16393722332832045], ["Obtain Capabilities", 0.05996501433377032], ["Develop Capabilities", 0.05919944685389436], ["Masquerading", 0.032820031764955473], ["Event Triggered Execution", 0.02764315456237832], ["Inter-Process Communication", 0.025577530213883995]], "Other tools and scripts were dropped onto one endpoint": [["Ingress Tool Transfer", 0.10674342064051003], ["Command and Scripting Interpreter", 0.07149017030558516], ["Multi-Stage Channels", 0.0496555465140878], ["Server Software Component", 0.029827669456785333], ["Native API", 0.025229551038271233], ["Web Service", 0.02486972036582284]], "the threat actors often opened Internet Explorer to download their beacons": [["Ingress Tool Transfer", 0.08976804351641174], ["Application Layer Protocol", 0.0470349792453242], ["Stage Capabilities", 0.042995902337067626], ["Web Service", 0.03912263193019675], ["Command and Scripting Interpreter", 0.037274667920701623], ["Browser Bookmark Discovery", 0.030479953469828687]], "The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion": [["Data Encrypted for Impact", 0.11927651961239961], ["Indicator Removal", 0.06890328552142116], ["Impair Defenses", 0.03941847515491423], ["Deobfuscate/Decode Files or Information", 0.02868871360497854], ["System Time Discovery", 0.024156965011593975], ["Execution Guardrails", 0.022260003568728173]], "the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems": [["Valid Accounts", 0.3599700390017065], ["Modify Authentication Process", 0.06493124757072356], ["OS Credential Dumping", 0.062400747723898184], ["Account Access Removal", 0.047573819603028006], ["Brute Force", 0.043870385420581796], ["Account Manipulation", 0.028782844038130747]], "They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.": [["Remote System Discovery", 0.07793311904531602], ["Active Scanning", 0.06827826843235547], ["Network Service Discovery", 0.05674440482601284], ["Web Service", 0.04033331687886736], ["Windows Management Instrumentation", 0.03897378948867918], ["Automated Collection", 0.037497731529163685]], "additional beacons executed using remote WMIC commands,": [["Windows Management Instrumentation", 0.11485802606021579], ["System Services", 0.0362698612222457], ["Impair Defenses", 0.03179894104100824], ["Fallback Channels", 0.03116930021052815], ["Web Service", 0.026657746533223593], ["Event Triggered Execution", 0.024262193544447763]], "executed using remote WMI commands": [["Windows Management Instrumentation", 0.6342042537912812], ["Event Triggered Execution", 0.06037830330537736], ["Remote Services", 0.045541372841863256], ["Command and Scripting Interpreter", 0.01946109164534856], ["Remote Access Software", 0.019111480142400383], ["System Services", 0.016731548988549064]], "The use of WMIC was leveraged by a batch file": [["Windows Management Instrumentation", 0.45272007598169617], ["Command and Scripting Interpreter", 0.15831241055480866], ["System Binary Proxy Execution", 0.029909677770620816], ["OS Credential Dumping", 0.022591866247895682], ["Event Triggered Execution", 0.017559552716063163], ["Native API", 0.014768029846619273]], "Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers": [["Windows Management Instrumentation", 0.11019610187837485], ["Remote System Discovery", 0.043330564548430935], ["Command and Scripting Interpreter", 0.0390498854476049], ["Web Service", 0.030523224870279468], ["System Services", 0.0305181168846474], ["Automated Collection", 0.023845885434978134]], "WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.": [["Windows Management Instrumentation", 0.47447123292914745], ["Remote System Discovery", 0.1215084241099361], ["System Network Connections Discovery", 0.03893332704477411], ["Remote Services", 0.027534902815426858], ["Remote Access Software", 0.024725874212704117], ["System Information Discovery", 0.020244757778792942]], "the threat actors proceeded to RDP to the domain controller.": [["Remote Services", 0.3535673064285335], ["Remote Service Session Hijacking", 0.06566554900670542], ["Remote Access Software", 0.05559410512585644], ["Valid Accounts", 0.04866726122987838], ["Remote System Discovery", 0.033776814814010236], ["External Remote Services", 0.032376716652343214]], "starting the RDP session": [["Remote Services", 0.45767384783736664], ["Remote Service Session Hijacking", 0.16083486545316222], ["Remote Access Software", 0.0420029209821353], ["Event Triggered Execution", 0.02833573055669359], ["Access Token Manipulation", 0.016451739062471025], ["Command and Scripting Interpreter", 0.015039380984965357]], "run from their interactive RDP session": [["Remote Services", 0.5644336172919899], ["Remote Service Session Hijacking", 0.10646043160110168], ["Remote Access Software", 0.033946121400314576], ["Command and Scripting Interpreter", 0.028003417112337253], ["Windows Management Instrumentation", 0.01957310142262203], ["Event Triggered Execution", 0.016792037119955482]], "used to proxy RDP connections and connect to another computer.": [["Remote Services", 0.28666186432626023], ["Proxy", 0.14072444187985525], ["Remote Access Software", 0.058769098093472597], ["External Remote Services", 0.05213583338916259], ["Protocol Tunneling", 0.03593954456625668], ["Remote Service Session Hijacking", 0.027879429695979518]], "The use of RDP was extensively used throughout the intrusion, using a variety of processes": [["Remote Services", 0.3827553975184001], ["Exploitation of Remote Services", 0.07750463862021713], ["Remote Access Software", 0.05156337093698477], ["Remote Service Session Hijacking", 0.03610227070114509], ["External Remote Services", 0.023325834676157002], ["System Network Connections Discovery", 0.021441228074161302]], "establishing RDP connections": [["Remote Services", 0.6090532069402563], ["Remote Access Software", 0.06200872621992779], ["External Remote Services", 0.036620583890325964], ["Remote Service Session Hijacking", 0.035595267654447184], ["Valid Accounts", 0.016150368017180977], ["System Network Connections Discovery", 0.011403406014158034]], "During these RDP sessions,": [["Remote Services", 0.5444356906816666], ["Remote Service Session Hijacking", 0.10809351073390361], ["Remote Access Software", 0.05850583822318936], ["System Network Connections Discovery", 0.013605064697807576], ["Event Triggered Execution", 0.012337484360182545], ["System Owner/User Discovery", 0.010912245754387288]], "This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:": [["System Services", 0.09293749751597333], ["Event Triggered Execution", 0.029300979536499], ["Command and Scripting Interpreter", 0.029267414922199978], ["Remote Services", 0.027608158302475073], ["Windows Management Instrumentation", 0.02692825599783961], ["Remote Access Software", 0.02520502819870764]], "RDP traffic and minimize external RDP access": [["Remote Services", 0.1142861918793541], ["Proxy", 0.07612425467660175], ["Impair Defenses", 0.07437902085858138], ["Traffic Signaling", 0.05647321577904682], ["Network Boundary Bridging", 0.04550518961085068], ["Encrypted Channel", 0.0402885887888013]], "RDP traffic": [["Remote Services", 0.10947582215925857], ["Non-Application Layer Protocol", 0.0865633425749579], ["Proxy", 0.08651253767656074], ["Protocol Tunneling", 0.06001579937053762], ["Encrypted Channel", 0.05716613509058694], ["System Network Connections Discovery", 0.05201461232718779]], "They then opened an RDP connection back to the primary domain controller": [["Remote Services", 0.36752515608237574], ["Remote Service Session Hijacking", 0.055755442538326025], ["Valid Accounts", 0.05544241380277687], ["Remote Access Software", 0.052201447633349066], ["Remote System Discovery", 0.03340440523764944], ["External Remote Services", 0.022303440260806846]], "the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host": [["Impair Defenses", 0.5847437042833203], ["Software Discovery", 0.08080880055403537], ["Windows Management Instrumentation", 0.032745054594221695], ["Indicator Removal", 0.015558361193885536], ["Modify Registry", 0.013871793742014023], ["Subvert Trust Controls", 0.011230394772390899]], "Windows Defender tampering": [["Impair Defenses", 0.15803030555148953], ["Modify System Image", 0.07174774107390655], ["Software Discovery", 0.06856923447379928], ["Masquerading", 0.052606547790826484], ["Subvert Trust Controls", 0.036362424129426134], ["Windows Management Instrumentation", 0.027549352524723566]], "powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI": [["Indicator Removal", 0.21406588680888627], ["Impair Defenses", 0.0919654824511351], ["Inhibit System Recovery", 0.08354049737631347], ["Windows Management Instrumentation", 0.06386000906967051], ["Modify Registry", 0.05318913089115703], ["Software Discovery", 0.03763874038890918]], "reviewed Group Policy Objects for the domain.": [["Query Registry", 0.15076870243430657], ["Permission Groups Discovery", 0.14938006245065533], ["Domain Policy Modification", 0.1405988059420805], ["Software Discovery", 0.03843146454880491], ["Domain Trust Discovery", 0.03653440677765445], ["Windows Management Instrumentation", 0.03524793980107911]], "the user clicked on the ISO file, which created a new virtual hard drive disk": [["Hide Artifacts", 0.07423231501196498], ["Exfiltration Over Physical Medium", 0.043374559356187135], ["Replication Through Removable Media", 0.039535618515924006], ["Disk Wipe", 0.03838307468476351], ["Pre-OS Boot", 0.03383386700289264], ["Inhibit System Recovery", 0.03269732808008327]], "when the victim clicked on the LNK file, it triggered the execution of the batch file": [["Command and Scripting Interpreter", 0.22219064182080067], ["Boot or Logon Autostart Execution", 0.15676065655664945], ["System Binary Proxy Execution", 0.1252965442592616], ["Event Triggered Execution", 0.03628088571406475], ["System Services", 0.032984933709755436], ["Scheduled Task/Job", 0.030631067038542507]], "Clicking on the LNK file executes the batch file": [["Command and Scripting Interpreter", 0.25806373825989254], ["Boot or Logon Autostart Execution", 0.21227500876379124], ["System Binary Proxy Execution", 0.09465548948790617], ["System Services", 0.032566852464821196], ["Event Triggered Execution", 0.02719525189982227], ["Masquerading", 0.025221371584436318]], "a hidden directory": [["Hide Artifacts", 0.4988932897423236], ["Masquerading", 0.10391450912267207], ["Data Staged", 0.056132271068869415], ["File and Directory Discovery", 0.04088207918414752], ["Indicator Removal", 0.024384247995611206], ["Obfuscated Files or Information", 0.022104628533444703]], "located in a hidden folder": [["Hide Artifacts", 0.5272039317685749], ["Masquerading", 0.0824434824327796], ["Data Staged", 0.05275737167299121], ["File and Directory Discovery", 0.0474556136120538], ["Indicator Removal", 0.030257851395987988], ["Rootkit", 0.01792784993877628]], "the hidden view attribute in file explorer in reference to the ProgramData folder.": [["Hide Artifacts", 0.683973004146508], ["File and Directory Discovery", 0.05461137065698571], ["Masquerading", 0.048471738667576265], ["Rootkit", 0.015883973090264212], ["Data Staged", 0.011692979944537878], ["Indicator Removal", 0.010038996860517263]], "delivered a hidden directory": [["Hide Artifacts", 0.2977469135554328], ["Masquerading", 0.1539408631011945], ["Obfuscated Files or Information", 0.058232805496580005], ["Data Staged", 0.05509924390453065], ["File and Directory Discovery", 0.028276267677019143], ["Indicator Removal", 0.020602782281328783]], "The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.": [["Obfuscated Files or Information", 0.09823264545770145], ["Deobfuscate/Decode Files or Information", 0.03881049703245358], ["Archive Collected Data", 0.038510598390863016], ["Masquerading", 0.035237229757229635], ["Ingress Tool Transfer", 0.029963189875651493], ["Exfiltration Over C2 Channel", 0.029748537492619777]], "DLL was executed using rundll32.exe :\nC:\\Windows\\system32\\cmd.exe /c D:\\max\\eyewear.bat\r\n\t\u279d rundll32": [["Hijack Execution Flow", 0.15290439288779656], ["System Binary Proxy Execution", 0.11515291949771508], ["Process Injection", 0.09288255131231643], ["Event Triggered Execution", 0.07537269925652634], ["Shared Modules", 0.07208482970217853], ["Native API", 0.06233880740110663]], "This process was invoked by RunDLL32.exe": [["Process Discovery", 0.24947036992669586], ["Process Injection", 0.17437206153156398], ["Native API", 0.1641956960284895], ["Access Token Manipulation", 0.0429500517975029], ["System Binary Proxy Execution", 0.03396253281944009], ["Create or Modify System Process", 0.031761048219935833]], "malware running via Rundll32": [["System Binary Proxy Execution", 0.5977245244597521], ["Native API", 0.09051191515145356], ["Hijack Execution Flow", 0.039767382550207085], ["System Services", 0.038320370406276005], ["Process Injection", 0.024573223547066963], ["Event Triggered Execution", 0.015990753500471504]], "file was executed by the injected Rundll32.exe process.": [["System Binary Proxy Execution", 0.22900110009451924], ["Native API", 0.12000368928506203], ["Masquerading", 0.08452077252188031], ["Hijack Execution Flow", 0.0819756889301266], ["Process Injection", 0.06184715482219041], ["Event Triggered Execution", 0.028395781906302583]], "a single Rundll32.exe process": [["Process Injection", 0.195244101744468], ["Native API", 0.18325829297041588], ["System Binary Proxy Execution", 0.12393450023918703], ["Process Discovery", 0.05722573159063116], ["Access Token Manipulation", 0.04823822687227482], ["Create or Modify System Process", 0.04277452364062059]], "rundll32 locker_32.dll,run": [["System Binary Proxy Execution", 0.330491549020157], ["Hijack Execution Flow", 0.15262913780938778], ["Process Injection", 0.06943656918522224], ["Boot or Logon Autostart Execution", 0.044823421322358274], ["Shared Modules", 0.040069055163156266], ["Native API", 0.03058029277603728]], "loads it using rundll32": [["System Binary Proxy Execution", 0.4100996280785649], ["Native API", 0.14403151237621503], ["Hijack Execution Flow", 0.09195894718383868], ["Shared Modules", 0.061202364151441965], ["System Services", 0.033569934312849777], ["Boot or Logon Autostart Execution", 0.024339801137522047]], "The decoded PowerShell function": [["Deobfuscate/Decode Files or Information", 0.3995684930610936], ["Obfuscated Files or Information", 0.19924980666808229], ["Command and Scripting Interpreter", 0.11652257545037031], ["Native API", 0.03586435932276351], ["Data Encoding", 0.016604766913939417], ["System Binary Proxy Execution", 0.010184355607938091]], "Decoded from Base64:": [["Deobfuscate/Decode Files or Information", 0.5117966633613451], ["Data Encoding", 0.18062789775626661], ["Obfuscated Files or Information", 0.16968481727092113], ["Archive Collected Data", 0.02319854795301714], ["Data Obfuscation", 0.014071370002621108], ["Encrypted Channel", 0.011530322999198166]], "A scheduled task was then created using this same DLL.": [["Scheduled Task/Job", 0.36603279893529], ["System Binary Proxy Execution", 0.07644320852563004], ["System Services", 0.07130962688736531], ["Create or Modify System Process", 0.053081944060823325], ["Inter-Process Communication", 0.045912896574842724], ["Masquerading", 0.043635558985016726]], "A scheduled task was created at that time to maintain persistence on this host": [["Scheduled Task/Job", 0.7136026617582772], ["Create or Modify System Process", 0.02980774740192959], ["Indicator Removal", 0.022159702962108216], ["Inter-Process Communication", 0.016938840991434268], ["Event Triggered Execution", 0.014106335742280603], ["Masquerading", 0.008993492815123539]], "GetSystem creates a service": [["Create or Modify System Process", 0.24443630316892168], ["System Services", 0.14830686024531184], ["System Service Discovery", 0.10315132625938264], ["Native API", 0.09306466679056247], ["Process Injection", 0.025914237686668225], ["Masquerading", 0.024449303845730692]], "used to inject a new beacon or a specific program to another process on the victim\u2019s computer.": [["Process Injection", 0.34488113843779966], ["Event Triggered Execution", 0.043328373428526634], ["System Services", 0.04137894130924537], ["Hijack Execution Flow", 0.027188890323200567], ["Create or Modify System Process", 0.022667947018525026], ["Rootkit", 0.019675761876727163]], "The injection is also visible from memory dumps": [["Process Injection", 0.2543966218311599], ["Native API", 0.059227035867328255], ["Virtualization/Sandbox Evasion", 0.04854452853329338], ["Software Discovery", 0.028362803066894274], ["Query Registry", 0.02206006268396691], ["Obfuscated Files or Information", 0.02181478904626511]], "Several hosts showed rundll32 processes exhibiting common process injection behavior": [["Process Injection", 0.45441863185477777], ["Native API", 0.15590281690017113], ["Process Discovery", 0.10242939296655755], ["Access Token Manipulation", 0.02950392484009588], ["System Binary Proxy Execution", 0.02677497025029384], ["Hijack Execution Flow", 0.026491138758331336]], "Code injection in LSASS": [["Obfuscated Files or Information", 0.1251260095006931], ["Native API", 0.1194043421502568], ["Process Injection", 0.099099662033434], ["Hijack Execution Flow", 0.09282630273396421], ["System Binary Proxy Execution", 0.04660019445841506], ["Deobfuscate/Decode Files or Information", 0.046412242353277185]], "an injected Cobalt Strike beacon": [["Web Service", 0.08021887341394078], ["Fallback Channels", 0.06504962294751651], ["Dynamic Resolution", 0.045165578960981626], ["Scheduled Transfer", 0.027041993954003418], ["Data Obfuscation", 0.02040581596230017], ["System Services", 0.020035611987190376]], "the injected Rundll32.exe process.": [["Process Injection", 0.20907062903571158], ["System Binary Proxy Execution", 0.19049362867510256], ["Native API", 0.13873687477502603], ["Hijack Execution Flow", 0.058684036612985206], ["Masquerading", 0.038852933694881235], ["Event Triggered Execution", 0.03859043537669794]], "The common processes observed were two injected processes": [["Process Discovery", 0.3547370820055528], ["Process Injection", 0.25399041372914904], ["Native API", 0.05148134469297131], ["Impair Defenses", 0.02436347579296195], ["Create or Modify System Process", 0.021524855414808117], ["Access Token Manipulation", 0.01831262263251725]], "a beacon injected into a single Rundll32.exe process": [["Process Injection", 0.1997170548234192], ["System Services", 0.10535703323223196], ["System Binary Proxy Execution", 0.06388691607574873], ["Native API", 0.05845731469098995], ["Create or Modify System Process", 0.05128182427277362], ["Event Triggered Execution", 0.04984219849232932]], "to discover information relating to the user": [["System Owner/User Discovery", 0.2648104069958173], ["Account Discovery", 0.1106741516249917], ["Gather Victim Identity Information", 0.03663400045208528], ["Data from Information Repositories", 0.030598390424600275], ["Cloud Service Dashboard", 0.028705128501288982], ["Search Victim-Owned Websites", 0.02015207461634441]], "host,": [["Gather Victim Host Information", 0.07631298769931708], ["System Information Discovery", 0.05137926017562888], ["Acquire Infrastructure", 0.05061613413003135], ["Remote System Discovery", 0.040875212179029376], ["Fallback Channels", 0.03620382389461873], ["Windows Management Instrumentation", 0.026797130133678477]], "cmd.exe /C hostname": [["System Information Discovery", 0.12307939883295835], ["Native API", 0.11406873906924637], ["Masquerading", 0.08613453680582196], ["Command and Scripting Interpreter", 0.07768122485114959], ["Windows Management Instrumentation", 0.07407251138451794], ["Application Window Discovery", 0.03273878835660269]], "queried a number of target hosts to determine the host disk drive configuration": [["System Information Discovery", 0.31391329320694294], ["File and Directory Discovery", 0.144453467763445], ["Peripheral Device Discovery", 0.14183307397526493], ["Virtualization/Sandbox Evasion", 0.04445470801156377], ["Network Share Discovery", 0.03203361213676406], ["Automated Collection", 0.025227012545627887]], "This can be useful to determine drives, including mounted network shares.": [["File and Directory Discovery", 0.2688127021637267], ["Network Share Discovery", 0.2651059087161071], ["System Information Discovery", 0.10330709138315379], ["Peripheral Device Discovery", 0.07051889563026517], ["Data from Network Shared Drive", 0.026126925166920376], ["Remote System Discovery", 0.01888109452141097]], "logicaldisk get caption,description,drivetype,providername,volumename": [["System Information Discovery", 0.5041596004323697], ["File and Directory Discovery", 0.19226089973278973], ["Peripheral Device Discovery", 0.055944246792925444], ["Virtualization/Sandbox Evasion", 0.021671129793894177], ["Query Registry", 0.01332647316885603], ["Windows Management Instrumentation", 0.012861031387242098]], "network configuration": [["Network Boundary Bridging", 0.10289072803487585], ["System Network Configuration Discovery", 0.04808678850380004], ["Adversary-in-the-Middle", 0.0395492702299783], ["Fallback Channels", 0.03489027343500981], ["Hardware Additions", 0.03182295015168579], ["Data from Configuration Repository", 0.03135525450769434]], "C:\\Windows\\system32\\cmd.exe /C dir /s *file/": [["File and Directory Discovery", 0.6713185332129683], ["Masquerading", 0.03479581359229994], ["Data Staged", 0.030258313286050643], ["Native API", 0.026380570137375662], ["Indicator Removal", 0.020639854723281108], ["Automated Collection", 0.020143495115535374]], "threat actors used the dir command": [["File and Directory Discovery", 0.5558974615827489], ["Data Staged", 0.04325382898827775], ["Masquerading", 0.04233655241129284], ["Indicator Removal", 0.024729425329768573], ["Automated Collection", 0.01776636141680104], ["Native API", 0.01685315939717442]], "C:\\Windows\\System32\\cmd.exe /C dir": [["File and Directory Discovery", 0.316874838456235], ["Masquerading", 0.1251049902323955], ["Native API", 0.05700036552098972], ["Hide Artifacts", 0.03359678028150217], ["Indicator Removal", 0.033494044858608574], ["Data Staged", 0.02976885386484375]], "This was double base64 encoded.": [["Data Encoding", 0.45307904124723114], ["Obfuscated Files or Information", 0.18994030508696022], ["Deobfuscate/Decode Files or Information", 0.1769150204437066], ["Data Obfuscation", 0.02887224019830132], ["Archive Collected Data", 0.027296056050583384], ["Encrypted Channel", 0.015993791220886528]], "PowerShell Base64 encoded string:\n\nThe -e is short for -EncodedCommand.": [["Obfuscated Files or Information", 0.46197763577453205], ["Data Encoding", 0.22880279283772725], ["Deobfuscate/Decode Files or Information", 0.12558077645001084], ["Data Obfuscation", 0.015696096443668414], ["Archive Collected Data", 0.014611421647781148], ["Command and Scripting Interpreter", 0.011350146762991406]], "The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $": [["Obfuscated Files or Information", 0.30986338021801363], ["Data Encoding", 0.30914257424301167], ["Deobfuscate/Decode Files or Information", 0.1785715091963676], ["Archive Collected Data", 0.018555927101638586], ["Data Obfuscation", 0.015383775799384887], ["Encrypted Channel", 0.014519455153004679]], "PowerShell encoded commands:": [["Obfuscated Files or Information", 0.2769051103853178], ["Command and Scripting Interpreter", 0.23769609142278103], ["Deobfuscate/Decode Files or Information", 0.08427207445628752], ["Data Encoding", 0.04471571806918448], ["Native API", 0.0209624366348227], ["Indirect Command Execution", 0.015788370557612043]], "powershell -np -w hidden -encodedcommand": [["Obfuscated Files or Information", 0.5281142328203381], ["Deobfuscate/Decode Files or Information", 0.06218145536180003], ["Hide Artifacts", 0.04968553513593675], ["Masquerading", 0.04926288307298411], ["Command and Scripting Interpreter", 0.042422257634120275], ["Data Obfuscation", 0.022610243608191527]], "used to proxy": [["Proxy", 0.6601846742285965], ["Application Layer Protocol", 0.040944915462433826], ["Protocol Tunneling", 0.030887444142312738], ["Data Obfuscation", 0.017995645519423814], ["Fallback Channels", 0.015046239848734896], ["Compromise Infrastructure", 0.013553987802981358]], "Proxying RDP traffic via a processes such as a Cobalt Strike beacon reduces the exposure of the threat actor\u2019s own infrastructure, and blends RDP activity to those of internal hosts on the network.": [["Proxy", 0.1771389895148317], ["Remote Services", 0.06753559366229443], ["Data Obfuscation", 0.05488877300625199], ["Protocol Tunneling", 0.042473486394698605], ["Adversary-in-the-Middle", 0.04075347490986532], ["Encrypted Channel", 0.03828202493476814]], "the threat actors made attempts to proxy RDP traffic": [["Proxy", 0.3722260803909358], ["Protocol Tunneling", 0.10766420866950237], ["Remote Services", 0.04132565706381154], ["Non-Application Layer Protocol", 0.034791414240041646], ["Encrypted Channel", 0.026423810012032607], ["External Remote Services", 0.021166076850537018]], "the RDP traffic was being proxied through": [["Proxy", 0.2960384081159312], ["Protocol Tunneling", 0.08998823369123728], ["Non-Application Layer Protocol", 0.08073425471158278], ["Encrypted Channel", 0.042451267416762514], ["Remote Services", 0.041457273697328524], ["Non-Standard Port", 0.03021654497078481]], "attempted to masquerade dropped files as legitimate Microsoft Windows executables": [["Masquerading", 0.33058264307025637], ["System Binary Proxy Execution", 0.12867811626201278], ["Hijack Execution Flow", 0.09807125711981488], ["Hide Artifacts", 0.03783944807162736], ["XSL Script Processing", 0.03601298561066544], ["Process Injection", 0.030927474553831352]], "Once the file was unpacked": [["Deobfuscate/Decode Files or Information", 0.2441071299537251], ["Obfuscated Files or Information", 0.11175314160424066], ["Ingress Tool Transfer", 0.054534653519003155], ["Archive Collected Data", 0.050433636643435795], ["File and Directory Discovery", 0.027820634529789705], ["Masquerading", 0.02741061689915113]], "the documents were exfiltrated over one of the encrypted C2 channels.": [["Archive Collected Data", 0.15425546149310204], ["Exfiltration Over C2 Channel", 0.12128135045018466], ["Exfiltration Over Alternative Protocol", 0.09886604175939116], ["Exfiltration Over Web Service", 0.05184286194824178], ["Automated Exfiltration", 0.04499516402045605], ["Deobfuscate/Decode Files or Information", 0.04390121899774504]], "When the payload was executed, there were some telltale registry events observed": [["Query Registry", 0.45310841523671563], ["Modify Registry", 0.09732679650107612], ["Event Triggered Execution", 0.07090678304031182], ["Boot or Logon Autostart Execution", 0.024220789009511072], ["Indicator Removal", 0.01870784895506241], ["System Binary Proxy Execution", 0.017081244720885153]], "files were then deleted": [["Indicator Removal", 0.5005907075601311], ["Data Destruction", 0.06890822814731522], ["Inhibit System Recovery", 0.03871031348998607], ["File and Directory Discovery", 0.035044912873164163], ["Data from Local System", 0.032723500656525135], ["Data Staged", 0.024218095378962634]], "packed versions uploaded to VT": [["Ingress Tool Transfer", 0.19743479373527664], ["Obfuscated Files or Information", 0.09174014538569167], ["Data from Local System", 0.033667577886980944], ["Archive Collected Data", 0.026964788277224504], ["Data Staged", 0.02391255274825987], ["Stage Capabilities", 0.023334280875892236]], "pack the code\u2019s dependencies into the .NET assembly so it can run self-contained.": [["Hijack Execution Flow", 0.1785608964980147], ["Shared Modules", 0.07624835207839464], ["System Binary Proxy Execution", 0.07482952394539714], ["Obfuscated Files or Information", 0.06330806030492524], ["Process Injection", 0.03759519296971034], ["Event Triggered Execution", 0.037211016291527975]], "compression using QuickLZ": [["Archive Collected Data", 0.5932355892296645], ["Obfuscated Files or Information", 0.18043443266417078], ["Deobfuscate/Decode Files or Information", 0.04252061085339371], ["Exfiltration Over Alternative Protocol", 0.01304104660554954], ["Data Encoding", 0.012115860099046303], ["Data Transfer Size Limits", 0.009959695566270316]], "with names invoking popular videogames such as Fortnite, Valorant, Roblox or Warzone2.": [["Masquerading", 0.10585523790962241], ["Acquire Infrastructure", 0.041564523043396764], ["Obtain Capabilities", 0.03759898549759178], ["Develop Capabilities", 0.022599004126969396], ["Dynamic Resolution", 0.01636123713655438], ["Obfuscated Files or Information", 0.01599940972022256]], "create a legitimate looking folder to drop an illicit version of the System Configuration Utility msconfig.exe": [["Indicator Removal", 0.1291397947463109], ["Modify Registry", 0.11723384046290446], ["Masquerading", 0.10436941663893617], ["Boot or Logon Autostart Execution", 0.06849871699261291], ["Create or Modify System Process", 0.04595832926293389], ["Inhibit System Recovery", 0.040575816815096026]], "creates the folder \u201cC:Windows System32\u201d, with a space after Windows": [["Masquerading", 0.3920955132552256], ["Hide Artifacts", 0.11068208898198209], ["File and Directory Discovery", 0.05189543129675539], ["Native API", 0.04185493423411941], ["Indicator Removal", 0.023423349259702932], ["Data Staged", 0.020071629791232788]], "packaged into an obfuscated PowerShell batch file": [["Obfuscated Files or Information", 0.6925934989482614], ["Command and Scripting Interpreter", 0.04313479395971188], ["Deobfuscate/Decode Files or Information", 0.0387603525164079], ["Masquerading", 0.025520241602641047], ["System Binary Proxy Execution", 0.019741854275972238], ["Archive Collected Data", 0.013008031119566063]], "heavily obfuscated batch file is hidden and automatically executed when launched.": [["Obfuscated Files or Information", 0.26508906419226286], ["Masquerading", 0.11865450369107125], ["System Binary Proxy Execution", 0.07224857393809982], ["Command and Scripting Interpreter", 0.06634086315500279], ["Hide Artifacts", 0.06347792621946108], ["Deobfuscate/Decode Files or Information", 0.03467653600254477]], "script extracts two separate binaries from the base64 encoded text": [["Deobfuscate/Decode Files or Information", 0.43006716114363985], ["Obfuscated Files or Information", 0.2801272951840699], ["Data Encoding", 0.05570350673248485], ["Archive Collected Data", 0.03969353164137976], ["Data Obfuscation", 0.017597614108003683], ["Masquerading", 0.009389351180816853]], "another obfuscated binary carrying an embedded resource": [["Obfuscated Files or Information", 0.7710202195987402], ["Deobfuscate/Decode Files or Information", 0.062061637300684126], ["Process Injection", 0.015835348030374213], ["Masquerading", 0.014152719041518262], ["Hide Artifacts", 0.012971594801880744], ["Archive Collected Data", 0.008775801187691444]], "extraction of the resources leads to the final payloads": [["Ingress Tool Transfer", 0.06397943016364753], ["Deobfuscate/Decode Files or Information", 0.06327336968066337], ["Command and Scripting Interpreter", 0.047726088835864974], ["Automated Collection", 0.04223906208789837], ["Cloud Infrastructure Discovery", 0.03147487446265992], ["Data from Local System", 0.030646051123527845]], "Option to embed additional malware to be executed": [["System Binary Proxy Execution", 0.12705546098976836], ["User Execution", 0.12081116538332659], ["Command and Scripting Interpreter", 0.07516553237652705], ["Hijack Execution Flow", 0.04669204511545401], ["Process Injection", 0.04205483970982655], ["XSL Script Processing", 0.028480812972438433]], "the rootkit\u2019s DLL that is embedded as a resource": [["Rootkit", 0.16158238023144897], ["Shared Modules", 0.1355389927056961], ["Hijack Execution Flow", 0.10808724057849], ["Process Injection", 0.06994119256082816], ["System Binary Proxy Execution", 0.05707133881443445], ["Native API", 0.033221376488907536]], "fileless and executed only in memory after going through several decryptions and decompression routines": [["Deobfuscate/Decode Files or Information", 0.32256773162808405], ["Archive Collected Data", 0.20676341260123757], ["Obfuscated Files or Information", 0.1507783610026412], ["Data Encrypted for Impact", 0.05789642069891539], ["Hide Artifacts", 0.027776429500783538], ["Service Stop", 0.010925948989367528]], "AES decrypts, and GZIP decompresses it to produce two separate byte arrays": [["Deobfuscate/Decode Files or Information", 0.45826525514626604], ["Archive Collected Data", 0.15859176419036808], ["Obfuscated Files or Information", 0.15550074172418452], ["Encrypted Channel", 0.03253397501817198], ["Data Encrypted for Impact", 0.029603092360175897], ["Exfiltration Over Alternative Protocol", 0.017730686677078684]], "will be decompressed and decrypted": [["Deobfuscate/Decode Files or Information", 0.3948900301118422], ["Archive Collected Data", 0.23537604166056733], ["Obfuscated Files or Information", 0.12416623203322488], ["Data Encrypted for Impact", 0.043048647034931845], ["Exfiltration Over Alternative Protocol", 0.01827789042467021], ["Encrypted Channel", 0.016348365053817975]], "decompress and decrypt the final payload": [["Deobfuscate/Decode Files or Information", 0.5164039579882421], ["Archive Collected Data", 0.16979206203342412], ["Obfuscated Files or Information", 0.11456396697311369], ["Data Encrypted for Impact", 0.0284731660398828], ["Exfiltration Over Alternative Protocol", 0.017069246296480708], ["Encrypted Channel", 0.016183282548213447]], "Hooks several functions from ntdll.dll to hide its presence.": [["Hide Artifacts", 0.15201948671182994], ["Masquerading", 0.11465545134190994], ["Rootkit", 0.09666595478294135], ["Hijack Execution Flow", 0.07586058925253], ["System Binary Proxy Execution", 0.06993036004559833], ["Obfuscated Files or Information", 0.04309620359477907]], "leveraging Windows Management Instrumentation (WMI) to identify the system\u2019s manufacturer.": [["System Information Discovery", 0.5361183947106335], ["Windows Management Instrumentation", 0.1446594898983724], ["Software Discovery", 0.039760428700905924], ["Virtualization/Sandbox Evasion", 0.027189917230599284], ["Query Registry", 0.02561059415405652], ["Peripheral Device Discovery", 0.02015658455020925]], "identify the system\u2019s manufacturer": [["System Information Discovery", 0.3950762300589628], ["Software Discovery", 0.06192840825888165], ["Gather Victim Host Information", 0.06041422340307623], ["Peripheral Device Discovery", 0.04516627016337903], ["Windows Management Instrumentation", 0.044585114200503054], ["Remote System Discovery", 0.023672751866373288]], "delivered to the victim, commonly through a phishing mail": [["Phishing", 0.34975297817090606], ["Phishing for Information", 0.12885134013437893], ["User Execution", 0.08391045511069263], ["Internal Spearphishing", 0.053976710399968396], ["Gather Victim Identity Information", 0.02632435356906408], ["Acquire Infrastructure", 0.01934802065417189]], "receives a ZIP file containing a benign file in plain sight": [["Archive Collected Data", 0.39314110389932844], ["Obfuscated Files or Information", 0.16376770352411624], ["Deobfuscate/Decode Files or Information", 0.07411297018107606], ["Ingress Tool Transfer", 0.03396723745172589], ["Exfiltration Over Alternative Protocol", 0.02371472695148028], ["Masquerading", 0.019843992812702955]], "automatically executed when launched.": [["Boot or Logon Autostart Execution", 0.16780593332084168], ["Event Triggered Execution", 0.13774734337795436], ["Scheduled Task/Job", 0.0871011935944303], ["System Binary Proxy Execution", 0.08226281300106651], ["Create or Modify System Process", 0.05848690854556125], ["Hijack Execution Flow", 0.04869269636827857]], "bat file format": [["Command and Scripting Interpreter", 0.5347718315558844], ["Masquerading", 0.04797406514147082], ["System Binary Proxy Execution", 0.03739379064752961], ["Native API", 0.023214162523775755], ["Obfuscated Files or Information", 0.02034283493881267], ["Indicator Removal", 0.014534270297411897]], "spawned with PowerShell via Task Scheduler": [["Scheduled Task/Job", 0.7609126519561036], ["Inter-Process Communication", 0.036839859635537056], ["Command and Scripting Interpreter", 0.030644620946891184], ["Masquerading", 0.013421606285327075], ["System Services", 0.012619980056750227], ["System Binary Proxy Execution", 0.009834902918629113]], "using PowerShell.": [["Command and Scripting Interpreter", 0.6246544445444219], ["Windows Management Instrumentation", 0.01951231425387585], ["Scheduled Task/Job", 0.018166526737536846], ["System Binary Proxy Execution", 0.014168539240376364], ["OS Credential Dumping", 0.012962660854077953], ["Indicator Removal", 0.012853435478238424]], "base64 encoded text later in the file": [["Obfuscated Files or Information", 0.46449738019253084], ["Data Encoding", 0.19992262762762614], ["Deobfuscate/Decode Files or Information", 0.1459833008903197], ["Archive Collected Data", 0.0443044102072287], ["Data Obfuscation", 0.017631848103486995], ["Encrypted Channel", 0.007377244328206739]], "more obfuscation and encryption techniques that lead to the final payload.": [["Obfuscated Files or Information", 0.6410028521234665], ["Deobfuscate/Decode Files or Information", 0.04920085197867166], ["Data Encoding", 0.03868760469537113], ["Archive Collected Data", 0.02897427706384554], ["Encrypted Channel", 0.025311622578228454], ["Execution Guardrails", 0.020050159913914962]], "stored as obfuscated data in the registry": [["Modify Registry", 0.24079092734000748], ["Obfuscated Files or Information", 0.22613882999438514], ["Deobfuscate/Decode Files or Information", 0.06330295308087354], ["Hide Artifacts", 0.048434139432539464], ["Masquerading", 0.0387081150796352], ["Query Registry", 0.035383951844654454]], "prefix is used to hide files, directories, NamedPipes, scheduled tasks, processes, registry keys/values, and services.": [["Masquerading", 0.2714129480877675], ["Hide Artifacts", 0.17147164844462445], ["Indicator Removal", 0.06618377606856483], ["Rootkit", 0.058766416435187714], ["Obfuscated Files or Information", 0.04324175440703701], ["Modify Registry", 0.02292193647085362]], "writes it as encrypted data.": [["Archive Collected Data", 0.3721981372941881], ["Deobfuscate/Decode Files or Information", 0.09898462766767252], ["Exfiltration Over Alternative Protocol", 0.07030858087484196], ["Obfuscated Files or Information", 0.05861701310259984], ["Data Encrypted for Impact", 0.05636951085291622], ["Encrypted Channel", 0.02725027226369275]], "deletes it as soon as the utility is running": [["Indicator Removal", 0.72024503421186], ["Data Destruction", 0.07126384252132728], ["Inhibit System Recovery", 0.0176735771035206], ["Modify Registry", 0.01442080385561276], ["System Shutdown/Reboot", 0.012982343626647162], ["Disk Wipe", 0.009610332772522177]], "Creating a registry key to store the malware code": [["Modify Registry", 0.42376512854949777], ["Boot or Logon Autostart Execution", 0.2172456206857847], ["Query Registry", 0.08439329297889865], ["System Binary Proxy Execution", 0.02371635529601792], ["Office Application Startup", 0.02280907088690747], ["Masquerading", 0.020061892866585673]], "saves its configuration as a registry key.": [["Modify Registry", 0.40900335643237723], ["Boot or Logon Autostart Execution", 0.21864444402164543], ["Query Registry", 0.04822358847836745], ["Boot or Logon Initialization Scripts", 0.041838916136728126], ["Office Application Startup", 0.025499166895251883], ["Create or Modify System Process", 0.02506138350077611]], "Creating a scheduled task to execute the malware using PowerShell.": [["Scheduled Task/Job", 0.7191349956667891], ["Command and Scripting Interpreter", 0.08964347096062662], ["Inter-Process Communication", 0.024679838250739126], ["System Binary Proxy Execution", 0.021353225243016315], ["System Services", 0.018833181489922877], ["Event Triggered Execution", 0.01038580763727877]], "injected into the winlogon.exe process.": [["Boot or Logon Autostart Execution", 0.1579644047621704], ["Event Triggered Execution", 0.12512451143474948], ["Boot or Logon Initialization Scripts", 0.10140793416965595], ["Process Injection", 0.04885406496379147], ["Input Capture", 0.03964769834576417], ["Access Token Manipulation", 0.03358722985858999]], "injected into other processes.": [["Process Injection", 0.8108043591599591], ["Native API", 0.02751508242880731], ["Hijack Execution Flow", 0.009661771650507398], ["Event Triggered Execution", 0.00934249389479478], ["Process Discovery", 0.0079156093980043], ["Create or Modify System Process", 0.007868169567865053]], "injects itself and additional malware(s) into all processes": [["Process Injection", 0.7372637217743485], ["Process Discovery", 0.03313151709500274], ["Native API", 0.0258110443541429], ["Create or Modify System Process", 0.02232608316953113], ["Access Token Manipulation", 0.014007102447369161], ["Hijack Execution Flow", 0.011503684614622724]], "be injected into the winlogon.exe process": [["Event Triggered Execution", 0.1409945673986914], ["Boot or Logon Autostart Execution", 0.12819481863496288], ["Process Injection", 0.09468354506558403], ["Boot or Logon Initialization Scripts", 0.06211206524308637], ["Access Token Manipulation", 0.043539545605061694], ["Input Capture", 0.043118192923155996]], "carries out process injections": [["Process Injection", 0.7278378750512551], ["Native API", 0.10307534639800259], ["Hijack Execution Flow", 0.012979599015928716], ["Process Discovery", 0.012687972007377948], ["System Binary Proxy Execution", 0.01185181531486992], ["Create or Modify System Process", 0.011058602750456956]], "loads a fresh copy of ntdll.dll,": [["Hijack Execution Flow", 0.24510808091043687], ["System Binary Proxy Execution", 0.12635117383890865], ["Shared Modules", 0.0639751519288061], ["Process Injection", 0.06016645351157537], ["Masquerading", 0.05227088582273397], ["Boot or Logon Autostart Execution", 0.02709302723525745]], "loading a fresh copy of \u201cntdll.dll\u201d from disk to avoid process hollowing detection": [["Process Injection", 0.38735696181284734], ["Hijack Execution Flow", 0.06932477217777788], ["Native API", 0.038414714477756934], ["Masquerading", 0.03552541692926162], ["Hide Artifacts", 0.025614762000680084], ["Rootkit", 0.023353778819311874]], "executed via dllhost.exe using process hollowing techniques.": [["Process Injection", 0.5655916270665101], ["Native API", 0.08396058636629336], ["System Binary Proxy Execution", 0.0672412667794015], ["Hijack Execution Flow", 0.04564223340355682], ["Masquerading", 0.0214817875355302], ["Virtualization/Sandbox Evasion", 0.012794543071571397]], "injects the rootkit when new processes are created": [["Process Injection", 0.3119565254671161], ["Rootkit", 0.2539653436174885], ["Create or Modify System Process", 0.047046738287734514], ["Modify System Image", 0.021435608095652366], ["Access Token Manipulation", 0.021321564389489504], ["Native API", 0.018969978395289546]], "Injects the rootkit to a newly created process by another process and updates the callee via NamedPipe": [["Process Injection", 0.5423886751587188], ["Rootkit", 0.08734455773648542], ["Native API", 0.047642463170562456], ["Access Token Manipulation", 0.03027060632309131], ["Create or Modify System Process", 0.024703340795771234], ["Modify System Image", 0.012904096249010783]], "executes an executable using process hollowing": [["Process Injection", 0.5081043165299283], ["Native API", 0.18822883167136129], ["System Binary Proxy Execution", 0.031874926675154826], ["Hijack Execution Flow", 0.03145691886791087], ["Process Discovery", 0.03046214536228857], ["Access Token Manipulation", 0.01964667442337346]], "Enumerates all running processes": [["Process Discovery", 0.8592463311508584], ["Native API", 0.017148454818439345], ["System Service Discovery", 0.013943897627490999], ["Process Injection", 0.011949539239102826], ["Software Discovery", 0.008064527228406213], ["Windows Management Instrumentation", 0.007840389738864664]], "executes a file using ShellExecute": [["Command and Scripting Interpreter", 0.20992441241470036], ["Native API", 0.1766295699904509], ["System Binary Proxy Execution", 0.1743337356757419], ["System Services", 0.05286514428896263], ["XSL Script Processing", 0.026144354588860677], ["Indirect Command Execution", 0.024993216625084677]], "utilizes the same Common Name in their TLS certificate.": [["Obtain Capabilities", 0.06946404804598387], ["Masquerading", 0.06756811868213677], ["Develop Capabilities", 0.05693545867311955], ["Subvert Trust Controls", 0.055308865271786724], ["Data Obfuscation", 0.049073825540024686], ["Stage Capabilities", 0.0410184681599473]], "secure communication through TLS encryption.": [["Encrypted Channel", 0.4422987935781669], ["Application Layer Protocol", 0.06891136614144593], ["Exfiltration Over Alternative Protocol", 0.05316789884911206], ["Non-Application Layer Protocol", 0.044853842590387445], ["Protocol Tunneling", 0.038608055701211445], ["Data Obfuscation", 0.03835805367288576]], "support for TCP network streams (both IPv4 and IPv6),": [["Non-Application Layer Protocol", 0.22052828312556166], ["Network Sniffing", 0.18102374930809287], ["Non-Standard Port", 0.05681462618900255], ["Encrypted Channel", 0.046387549468981416], ["Application Layer Protocol", 0.035745958018870164], ["Adversary-in-the-Middle", 0.03434246548581794]], "Controlling attached camera devices to take pictures of the compromised computer\u2019s surroundings.": [["Video Capture", 0.4764529799452846], ["Screen Capture", 0.23414667055532098], ["Peripheral Device Discovery", 0.024131738756170844], ["Application Window Discovery", 0.01027978543261684], ["Input Capture", 0.00847497667793178], ["Remote Access Software", 0.007628909982374272]], "takes screenshots at regular intervals.": [["Screen Capture", 0.7703242157618831], ["Video Capture", 0.049694813587964196], ["Input Capture", 0.014260755056908936], ["Application Window Discovery", 0.008598467676796895], ["Virtualization/Sandbox Evasion", 0.0065674970673509445], ["Scheduled Task/Job", 0.006385736450280809]], "can periodically take screenshots and store them with information about the foreground process and time since the last user input": [["Screen Capture", 0.5289879147050458], ["Input Capture", 0.04674474463706827], ["Virtualization/Sandbox Evasion", 0.042477853223561096], ["Video Capture", 0.041597712643682595], ["Application Window Discovery", 0.03998589622208374], ["Process Discovery", 0.032749491252865]], "To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren\u2019t saved.": [["Archive Collected Data", 0.079705153934182], ["Screen Capture", 0.0649459051249445], ["Hide Artifacts", 0.06357985431907026], ["Data Staged", 0.05655618243475258], ["Modify Cloud Compute Infrastructure", 0.04172385746635236], ["Indicator Removal", 0.037292286896484894]], "similar screen captures": [["Screen Capture", 0.7767289970639927], ["Video Capture", 0.043266281828397285], ["Application Window Discovery", 0.015551742926917708], ["Input Capture", 0.008491753877661025], ["Data from Local System", 0.007553557028366937], ["Clipboard Data", 0.00650561500251991]], "uses a custom network protocol, which can function over HTTP": [["Application Layer Protocol", 0.6669049769565857], ["Non-Standard Port", 0.04978374731683257], ["Non-Application Layer Protocol", 0.03516461074868731], ["Data Obfuscation", 0.03286568461364758], ["Proxy", 0.026017200830017094], ["Protocol Tunneling", 0.025002265419845356]], "we can see one more HTTP request": [["Application Layer Protocol", 0.14850626019387045], ["Network Sniffing", 0.058179904318770306], ["Fallback Channels", 0.04263411243617668], ["Data Obfuscation", 0.03933909613329205], ["Data Encoding", 0.033613988420042304], ["System Network Configuration Discovery", 0.030754909352656457]], "HTTP POST request used for FlowCloud C&C communication": [["Application Layer Protocol", 0.4291171390973543], ["Exfiltration Over C2 Channel", 0.06484468081894054], ["Data Obfuscation", 0.035894763721480955], ["Data Encoding", 0.031971012404632286], ["Fallback Channels", 0.03180749506100583], ["Exfiltration Over Alternative Protocol", 0.023094980203428494]], "can send and receive data over HTTP.": [["Application Layer Protocol", 0.6935592027768415], ["Exfiltration Over Alternative Protocol", 0.03150298183938738], ["Non-Application Layer Protocol", 0.03023218028174176], ["Non-Standard Port", 0.027906366693285948], ["Data Encoding", 0.02193753793924679], ["Encrypted Channel", 0.017370288768718073]], "communicates with a hardcoded IP address via HTTP.": [["Application Layer Protocol", 0.3268165499819042], ["Dynamic Resolution", 0.0782736211287044], ["System Network Configuration Discovery", 0.04863864530467022], ["Proxy", 0.04576754593200028], ["Endpoint Denial of Service", 0.04221973309854847], ["Non-Standard Port", 0.034318717181327764]], "can communicate over HTTP or via its \u201cnormal protocol\u201d.": [["Application Layer Protocol", 0.6593388316544858], ["Non-Application Layer Protocol", 0.07449817111535152], ["Non-Standard Port", 0.043452941621304794], ["Exfiltration Over Alternative Protocol", 0.022911903446176798], ["Protocol Tunneling", 0.020450859646292757], ["Encrypted Channel", 0.019417051749852785]], "The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP": [["Application Layer Protocol", 0.36802687257974714], ["Data Obfuscation", 0.16445443849233324], ["Non-Standard Port", 0.06582890554296354], ["Non-Application Layer Protocol", 0.05514436321116458], ["Data Encoding", 0.05329552568017091], ["Encrypted Channel", 0.036271205268686026]], "The fields required for HTTP": [["Application Layer Protocol", 0.6167326833461603], ["Non-Standard Port", 0.03820156086312326], ["Data Obfuscation", 0.0253840950657932], ["Data Encoding", 0.01967312084301515], ["Browser Session Hijacking", 0.018798155245570745], ["Fallback Channels", 0.016254980291858876]], "used for HTTP client requests": [["Application Layer Protocol", 0.5210481272535336], ["Data Encoding", 0.034350010613473037], ["Endpoint Denial of Service", 0.028674534277801096], ["Data Obfuscation", 0.027170157885756788], ["Non-Standard Port", 0.02684152048304989], ["Non-Application Layer Protocol", 0.014947066203748765]], "used for HTTP server responses": [["Application Layer Protocol", 0.43049067025227544], ["Data Encoding", 0.07027991418494711], ["Data Obfuscation", 0.03637468547495046], ["Web Service", 0.025334566883101827], ["Endpoint Denial of Service", 0.02343210427804255], ["Non-Standard Port", 0.0201818943821339]], "HTTP by prepending the data with a hardcoded": [["Application Layer Protocol", 0.41572290541708756], ["Data Encoding", 0.09179133567953812], ["Data Obfuscation", 0.08915706662240153], ["Non-Standard Port", 0.03308422824357341], ["Exfiltration Over Alternative Protocol", 0.02224572974291192], ["Dynamic Resolution", 0.021431492812167878]], "or raw TCP, for C&C server communications.": [["Non-Application Layer Protocol", 0.47247822159013336], ["Application Layer Protocol", 0.07235305510935328], ["Encrypted Channel", 0.058570685173445436], ["Non-Standard Port", 0.05657278193112085], ["Protocol Tunneling", 0.04508183687138507], ["Network Sniffing", 0.03219707023130345]], "can communicate over raw TCP sockets.": [["Non-Application Layer Protocol", 0.5235524235200925], ["Non-Standard Port", 0.0879540488102606], ["Application Layer Protocol", 0.07577206104483634], ["Protocol Tunneling", 0.04481060284991506], ["Encrypted Channel", 0.034214355788071645], ["Traffic Signaling", 0.016562952426858665]], "normal protocol uses raw TCP sockets and a custom message format": [["Non-Application Layer Protocol", 0.3935637790858034], ["Non-Standard Port", 0.0907974207751364], ["Application Layer Protocol", 0.09077743609040362], ["Encrypted Channel", 0.06103246754104648], ["Data Obfuscation", 0.05622049918801012], ["Protocol Tunneling", 0.03403647965170248]], "which can check running processes": [["Process Discovery", 0.8292734472617408], ["Native API", 0.026151156950246827], ["System Service Discovery", 0.015536025679970767], ["Process Injection", 0.013606182772027731], ["Software Discovery", 0.010221641122229293], ["Windows Management Instrumentation", 0.009699415322192213]], "which can check running processes against a hardcoded list": [["Process Discovery", 0.8732815539383919], ["System Service Discovery", 0.014792783730319375], ["Software Discovery", 0.011037873631157468], ["Native API", 0.010642371236136903], ["Process Injection", 0.007694134917146989], ["Windows Management Instrumentation", 0.006890091644774546]], "backdoors can list running processes.": [["Process Discovery", 0.7678262515290991], ["System Service Discovery", 0.02266944361590531], ["Process Injection", 0.02214102563372226], ["Native API", 0.0188163088233506], ["Windows Management Instrumentation", 0.011496243463858082], ["Software Discovery", 0.010778011767844176]], "functionalities that collect information about programs and processes,": [["Process Discovery", 0.5465619420755369], ["Software Discovery", 0.08797132066262824], ["Native API", 0.06037324518373629], ["Windows Management Instrumentation", 0.03330388154201246], ["System Service Discovery", 0.029158314257151312], ["System Information Discovery", 0.02855347973464281]], "Other commands can be used to retrieve a detailed list of available services and currently running processes.": [["System Service Discovery", 0.4429268002196036], ["Process Discovery", 0.19344612658947483], ["Cloud Service Discovery", 0.05636013422465513], ["Service Stop", 0.03508444283026639], ["Network Service Discovery", 0.03411349523570685], ["Create or Modify System Process", 0.025422234661100204]], "It checks running processes": [["Process Discovery", 0.7066980928787416], ["Virtualization/Sandbox Evasion", 0.037601756231654494], ["Native API", 0.03405851853057022], ["Software Discovery", 0.02971245880415781], ["System Service Discovery", 0.025518899743767667], ["Windows Management Instrumentation", 0.017552252000397117]], "the running processes using  CreateToolhelp32Snapshot and  Process32Next": [["Process Discovery", 0.6130159394565676], ["Process Injection", 0.06699021914368306], ["Native API", 0.058714277787130814], ["Access Token Manipulation", 0.02085177245862009], ["Virtualization/Sandbox Evasion", 0.013350541996829007], ["Windows Management Instrumentation", 0.012963251461053244]], "the PID of the process in which the orchestrator is running.": [["Process Discovery", 0.2959332502962529], ["System Information Discovery", 0.05589147192167066], ["Access Token Manipulation", 0.05070772747184582], ["Native API", 0.042073665911249156], ["System Service Discovery", 0.04015879455611529], ["Windows Management Instrumentation", 0.035211029681191684]], "we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products": [["Process Discovery", 0.4810533836347046], ["Software Discovery", 0.17923516393519234], ["System Service Discovery", 0.03272306411210191], ["Native API", 0.029575384130134785], ["Impair Defenses", 0.027657184841064632], ["Windows Management Instrumentation", 0.025431880877502637]], "can check whether specific security software is installed on the machine it tries to compromise,": [["Software Discovery", 0.7959322729190107], ["Windows Management Instrumentation", 0.021691980776277184], ["Query Registry", 0.01941757367134116], ["System Information Discovery", 0.018816640778494195], ["Virtualization/Sandbox Evasion", 0.011628682600256785], ["Execution Guardrails", 0.007471410336728764]], "there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.": [["Process Discovery", 0.3096641639988126], ["Software Discovery", 0.2604590879797016], ["Impair Defenses", 0.039989461830629965], ["Native API", 0.034800866320869026], ["Process Injection", 0.034212810839092375], ["File and Directory Discovery", 0.02906070904427062]], "It checks running processes for executables of several known cybersecurity vendors.": [["Process Discovery", 0.6210708743906821], ["Software Discovery", 0.12218266981617845], ["Windows Management Instrumentation", 0.028108380331307654], ["Virtualization/Sandbox Evasion", 0.026053227350148447], ["System Service Discovery", 0.0237488279198858], ["System Information Discovery", 0.015962136092283932]], "contain a section defining specific security software to check for": [["Software Discovery", 0.7854926000548547], ["Exploitation for Defense Evasion", 0.015517332608481295], ["Query Registry", 0.013238506155369142], ["Execution Guardrails", 0.012900013487006328], ["Obfuscated Files or Information", 0.011005810643921555], ["Impair Defenses", 0.010986164847082055]], "include the ability to collect mouse movements, keyboard activity": [["Input Capture", 0.5685389104368437], ["Screen Capture", 0.026704941932015246], ["Automated Collection", 0.02258270504952829], ["Video Capture", 0.020426013936627276], ["Application Window Discovery", 0.01968064358139145], ["Virtualization/Sandbox Evasion", 0.018709062231362802]], "records keystrokes.": [["Input Capture", 0.8457606200763688], ["Clipboard Data", 0.009446505798390877], ["Credentials from Password Stores", 0.00605762407070485], ["Screen Capture", 0.005518151365684522], ["Video Capture", 0.004228506073846549], ["Virtualization/Sandbox Evasion", 0.004038721567044033]], "backdoor\u2019s components records mouse and keyboard activity to a database.": [["Input Capture", 0.5262174202775465], ["Automated Collection", 0.025369533766913276], ["Event Triggered Execution", 0.017372392393006794], ["Screen Capture", 0.017113762824703223], ["Remote Services", 0.01483163900720957], ["Virtualization/Sandbox Evasion", 0.013310364901363544]], "with the keylogger component of the driver (described in the next section) by reading data from the \\\\.\\pipe\\namedpipe_keymousespy_english named pipe.": [["Input Capture", 0.7553589717428273], ["Clipboard Data", 0.013958021654498885], ["Credentials from Password Stores", 0.010884965566777429], ["Virtualization/Sandbox Evasion", 0.010314669182164808], ["OS Credential Dumping", 0.009009143347868403], ["Native API", 0.008650173161200262]], "it acts as both a keylogger": [["Input Capture", 0.8442253431915873], ["Clipboard Data", 0.00841650131739935], ["Credentials from Password Stores", 0.00698027230523527], ["Boot or Logon Autostart Execution", 0.006584499456967691], ["Screen Capture", 0.006303213167077247], ["Event Triggered Execution", 0.004764512437485981]], "Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0)": [["Input Capture", 0.21513898303732532], ["Query Registry", 0.07367257376156307], ["System Information Discovery", 0.04938426960529217], ["Deobfuscate/Decode Files or Information", 0.03694289462664661], ["Native API", 0.03574907199377622], ["Peripheral Device Discovery", 0.031013706488732834]], "handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.": [["Input Capture", 0.42945924418897236], ["Event Triggered Execution", 0.03903595726571009], ["Peripheral Device Discovery", 0.03532802813851176], ["Virtualization/Sandbox Evasion", 0.03516559425283206], ["Native API", 0.030994091248662155], ["Clipboard Data", 0.016149939945946008]], "by compromising a web-facing application such as Microsoft Exchange or SharePoint": [["Server Software Component", 0.08720737593412578], ["Compromise Infrastructure", 0.08210523880335191], ["Phishing", 0.08004629706990214], ["Stage Capabilities", 0.06525437863266265], ["Drive-by Compromise", 0.05627975998933982], ["Acquire Infrastructure", 0.045312680222999384]], "exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604": [["Exploitation for Client Execution", 0.638459046952498], ["Exploitation of Remote Services", 0.061067291741949935], ["Exploit Public-Facing Application", 0.0534625951871324], ["Exploitation for Privilege Escalation", 0.04443415666690396], ["Obtain Capabilities", 0.026546530989215156], ["Develop Capabilities", 0.015469372735666585]], "The public-facing application compromise approach": [["Drive-by Compromise", 0.23691128846443407], ["Stage Capabilities", 0.08331046645556395], ["Obtain Capabilities", 0.054755056362534485], ["Develop Capabilities", 0.05177149328735625], ["Exploit Public-Facing Application", 0.04942195024263311], ["Compromise Infrastructure", 0.04885111887070204]], "has exploited web server vulnerabilities for initial access.": [["Exploit Public-Facing Application", 0.39568461780741104], ["Server Software Component", 0.15980501597964183], ["Drive-by Compromise", 0.08422386389051516], ["Stage Capabilities", 0.050904726474256416], ["Compromise Infrastructure", 0.022658680285713245], ["Exploitation for Client Execution", 0.018781333461892424]], "Initial access to targets is obtained by exploiting vulnerable internet-facing applications such as Microsoft Exchange,": [["Exploit Public-Facing Application", 0.09718659201118542], ["Drive-by Compromise", 0.0971797268269658], ["Phishing", 0.060965329023950576], ["Stage Capabilities", 0.05539848099875876], ["Exploitation for Client Execution", 0.04597447341815662], ["Develop Capabilities", 0.0398356591791549]], "These were either dropped directly via the webshell or downloaded from a remote server": [["Ingress Tool Transfer", 0.14123695840119588], ["Deobfuscate/Decode Files or Information", 0.04277304939937943], ["Indicator Removal", 0.03261520166743161], ["Browser Bookmark Discovery", 0.030600501809529897], ["Data from Local System", 0.030562839524667134], ["Web Service", 0.030435970668799796]], "The following files are downloaded and written to disk:": [["Ingress Tool Transfer", 0.10721414108530786], ["Data from Local System", 0.09399696205933541], ["Data Staged", 0.07458996723393943], ["File and Directory Discovery", 0.06623786368019405], ["Archive Collected Data", 0.04139388724476091], ["Automated Collection", 0.03821185221286355]], "The communications module then downloads the main backdoor module,": [["Ingress Tool Transfer", 0.2548240045809353], ["Command and Scripting Interpreter", 0.0701708417674123], ["Multi-Stage Channels", 0.0517765639052303], ["BITS Jobs", 0.05013326614900602], ["Non-Application Layer Protocol", 0.03074644342190431], ["Fallback Channels", 0.029320277594713964]], "This downloader simply downloads the loader": [["Ingress Tool Transfer", 0.5442285015017525], ["Command and Scripting Interpreter", 0.07473262497696409], ["BITS Jobs", 0.050944754860944935], ["System Binary Proxy Execution", 0.02998314671427116], ["Deobfuscate/Decode Files or Information", 0.019398232795509462], ["Masquerading", 0.01229874167008194]], "Encoded Royal Road payload": [["Obfuscated Files or Information", 0.3816544333606745], ["Data Encoding", 0.174830819796866], ["Deobfuscate/Decode Files or Information", 0.11019933769461637], ["Data Obfuscation", 0.03876208943806743], ["Encrypted Channel", 0.03286514862033044], ["Archive Collected Data", 0.02614134279517213]], "this encrypted file is": [["Deobfuscate/Decode Files or Information", 0.22930540786740758], ["Data Encrypted for Impact", 0.22455045669484164], ["Obfuscated Files or Information", 0.1755219009949563], ["Archive Collected Data", 0.13455317767647987], ["Encrypted Channel", 0.023082508385127518], ["File and Directory Discovery", 0.016250201090271123]], "The identical encrypted file": [["Data Encrypted for Impact", 0.2699167929921563], ["Archive Collected Data", 0.16854844248764211], ["Deobfuscate/Decode Files or Information", 0.1406924020753344], ["Obfuscated Files or Information", 0.11061163145216234], ["Encrypted Channel", 0.020131645461534568], ["Exfiltration Over Alternative Protocol", 0.01830731358462315]], "deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis": [["Obfuscated Files or Information", 0.5868479591161067], ["Execution Guardrails", 0.043257946611607374], ["Deobfuscate/Decode Files or Information", 0.04010474126984492], ["Process Injection", 0.03992801228692329], ["Hide Artifacts", 0.03029137636829596], ["Data Obfuscation", 0.011788570018784762]], "The values for these executables and configuration data can be found, encrypted, in the loader\u2019s resource section.": [["Obfuscated Files or Information", 0.17347370827168362], ["Deobfuscate/Decode Files or Information", 0.10974010743992431], ["Query Registry", 0.07566016316166714], ["Hijack Execution Flow", 0.05602539160507691], ["Software Discovery", 0.04539081020622357], ["System Information Discovery", 0.035728004782806536]], "most resources are written to disk encrypted,": [["Data Encrypted for Impact", 0.14375403419977328], ["Service Stop", 0.11824481674740887], ["Archive Collected Data", 0.0829597473978675], ["Obfuscated Files or Information", 0.057165840026154845], ["Hide Artifacts", 0.05665080145062019], ["Weaken Encryption", 0.03558800326872697]], "In some cases, they are then re-encrypted but with a different key": [["Data Encrypted for Impact", 0.19240365534067957], ["Deobfuscate/Decode Files or Information", 0.19110503576190285], ["Archive Collected Data", 0.0995115475316946], ["Weaken Encryption", 0.07924228050789336], ["Obfuscated Files or Information", 0.039034018985681464], ["Service Stop", 0.03600885873457509]], "same sequence of opcodes to obfuscate the program\u2019s flow": [["Obfuscated Files or Information", 0.7725895033245525], ["Deobfuscate/Decode Files or Information", 0.04630005772226207], ["Data Obfuscation", 0.015044437674457019], ["Execution Guardrails", 0.014651652343058737], ["Process Injection", 0.012973235661736754], ["Encrypted Channel", 0.012644004323531492]], "control flow obfuscation snippet": [["Obfuscated Files or Information", 0.7821977050874482], ["Deobfuscate/Decode Files or Information", 0.04801714154771483], ["Data Obfuscation", 0.01917151411328734], ["Execution Guardrails", 0.013295781449468946], ["Masquerading", 0.01109189009210611], ["Hide Artifacts", 0.007590010553671082]], "files are distributed and stored in encrypted form.": [["Archive Collected Data", 0.1805740721852846], ["Data Encrypted for Impact", 0.15233125030984349], ["Obfuscated Files or Information", 0.09437806972481162], ["Exfiltration Over Alternative Protocol", 0.07882160967852454], ["Data Staged", 0.034246225683977005], ["Service Stop", 0.033005196693897385]], "Base64-encoded strings": [["Data Encoding", 0.3759338101596064], ["Obfuscated Files or Information", 0.3308772562977163], ["Deobfuscate/Decode Files or Information", 0.15024739737659112], ["Data Obfuscation", 0.018260894609762834], ["Archive Collected Data", 0.017763597645338303], ["Encrypted Channel", 0.012970739822431502]], "new encrypted shellcode": [["Obfuscated Files or Information", 0.5088903565067223], ["Deobfuscate/Decode Files or Information", 0.16686923901508313], ["Encrypted Channel", 0.07042474617240797], ["Data Encrypted for Impact", 0.03756417688318056], ["Data Encoding", 0.02275118131997655], ["Archive Collected Data", 0.019648283144868564]], "This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC": [["Obfuscated Files or Information", 0.37862125979663763], ["Deobfuscate/Decode Files or Information", 0.11765069360855042], ["Modify Registry", 0.07759044406378429], ["Data Encrypted for Impact", 0.040973385600201355], ["Archive Collected Data", 0.034501166859604415], ["Encrypted Channel", 0.03271147358568227]], "and encrypted QuasarRAT payload": [["Obfuscated Files or Information", 0.3141315364208196], ["Encrypted Channel", 0.11809233503617197], ["Archive Collected Data", 0.074076363164122], ["Deobfuscate/Decode Files or Information", 0.061807432359429045], ["Data Encrypted for Impact", 0.043621051633929195], ["Exfiltration Over Alternative Protocol", 0.03945085624933671]], "control flow obfuscation to hinder analysis": [["Obfuscated Files or Information", 0.673680914313035], ["Execution Guardrails", 0.028442298260920987], ["Deobfuscate/Decode Files or Information", 0.026069383013506767], ["Data Obfuscation", 0.025123026091502278], ["Hide Artifacts", 0.018679694080543863], ["Impair Defenses", 0.0133205945838869]], "the document triggers the injection of a custom downloader \u2013 a PE executable \u2013 into an iexplore.exe process.": [["System Binary Proxy Execution", 0.17238323057932842], ["Ingress Tool Transfer", 0.1698814809914718], ["Process Injection", 0.11825233685276237], ["Command and Scripting Interpreter", 0.10237438489971522], ["Inter-Process Communication", 0.05111906577926154], ["Native API", 0.0490371471328371]], "that decrypts hardcoded shellcode": [["Deobfuscate/Decode Files or Information", 0.6697426269022854], ["Obfuscated Files or Information", 0.13338371776632535], ["Data Encrypted for Impact", 0.027096848337518086], ["Encrypted Channel", 0.01773686232786816], ["Execution Guardrails", 0.013314775937476079], ["Weaken Encryption", 0.012381701572226334]], "Shellcode decryption loop": [["Deobfuscate/Decode Files or Information", 0.749995574583596], ["Obfuscated Files or Information", 0.07468536352256358], ["Data Encrypted for Impact", 0.030815143303868423], ["Encrypted Channel", 0.024001116863738188], ["Archive Collected Data", 0.013989179190463252], ["Weaken Encryption", 0.007338798764013181]], "and only decrypted in memory when needed.": [["Deobfuscate/Decode Files or Information", 0.22280325522078706], ["Data Encrypted for Impact", 0.14766325213328224], ["Obfuscated Files or Information", 0.11468187003616094], ["Archive Collected Data", 0.08885213175475955], ["Weaken Encryption", 0.06206387680685914], ["Encrypted Channel", 0.027370195560963876]], "the loader decrypts and parses the embedded installation configuration": [["Deobfuscate/Decode Files or Information", 0.25429386161906614], ["Obfuscated Files or Information", 0.10570942663101529], ["System Binary Proxy Execution", 0.04577377219339233], ["Shared Modules", 0.025836069078210133], ["Command and Scripting Interpreter", 0.02542313272862484], ["OS Credential Dumping", 0.024993532641055905]], "the rootkit module is decrypted": [["Deobfuscate/Decode Files or Information", 0.3335418252381997], ["Rootkit", 0.06925008181439085], ["Obfuscated Files or Information", 0.06560464676068926], ["Weaken Encryption", 0.05750085582873811], ["Modify System Image", 0.036378663902716525], ["Data Encrypted for Impact", 0.033005711851513395]], "the self-decrypting DLL,": [["Deobfuscate/Decode Files or Information", 0.5758397609013683], ["Obfuscated Files or Information", 0.1751018526790542], ["Data Encrypted for Impact", 0.028038120969006174], ["Process Injection", 0.018105292453243875], ["Archive Collected Data", 0.017416837963260434], ["Encrypted Channel", 0.014121182688265435]], "[sic] section of a decoded FlowCloud config": [["Obfuscated Files or Information", 0.13669545942071554], ["Deobfuscate/Decode Files or Information", 0.1356172481387799], ["Data Obfuscation", 0.04189906635061399], ["Data Encoding", 0.038333874238846356], ["Encrypted Channel", 0.03102315431358537], ["Dynamic Resolution", 0.02375999837081584]], "It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme": [["Deobfuscate/Decode Files or Information", 0.7371483939793455], ["Obfuscated Files or Information", 0.1179062237102061], ["Process Injection", 0.013241941051998347], ["Encrypted Channel", 0.009129506105441018], ["Data Encrypted for Impact", 0.0075856183050121906], ["Execution Guardrails", 0.006672632940903348]], "Once it has decrypted the embedded DLL": [["Deobfuscate/Decode Files or Information", 0.577427918024748], ["Obfuscated Files or Information", 0.10229726749373265], ["Process Injection", 0.05075517708104227], ["Hijack Execution Flow", 0.0308406448330594], ["System Binary Proxy Execution", 0.023958232989603645], ["Shared Modules", 0.01307744177617158]], "Self-decrypting DLL": [["Deobfuscate/Decode Files or Information", 0.5217226861839189], ["Obfuscated Files or Information", 0.18845114177650174], ["Process Injection", 0.0326599545364928], ["Hijack Execution Flow", 0.026526812966556207], ["Data Encrypted for Impact", 0.018368069529096562], ["System Binary Proxy Execution", 0.015542036087478731]], "The loaded shellcode is a self-decrypting DLL.": [["Deobfuscate/Decode Files or Information", 0.513801053263272], ["Obfuscated Files or Information", 0.2528724656604076], ["Process Injection", 0.033681729426131374], ["Hijack Execution Flow", 0.022733869755614047], ["System Binary Proxy Execution", 0.013355927686725624], ["Native API", 0.012565144893595594]], "DLL decryption routine": [["Deobfuscate/Decode Files or Information", 0.7383931341408988], ["Obfuscated Files or Information", 0.10919178855940115], ["Data Encrypted for Impact", 0.015971993551528087], ["Archive Collected Data", 0.01448765329362041], ["Encrypted Channel", 0.010385375221516705], ["Process Injection", 0.008434937996713875]], "and only decoded as needed.": [["Deobfuscate/Decode Files or Information", 0.27656568890971517], ["Obfuscated Files or Information", 0.19034288542351901], ["Data Encoding", 0.16941685774304732], ["Archive Collected Data", 0.05338756903346324], ["Data Obfuscation", 0.02544354891701327], ["Encrypted Channel", 0.02537124507391068]], "a thread that decrypts and loads the fcClient module": [["Deobfuscate/Decode Files or Information", 0.35670245347677715], ["Process Injection", 0.11155136380181122], ["Encrypted Channel", 0.041633455345943184], ["Native API", 0.02980562440805642], ["Obfuscated Files or Information", 0.022301936195360618], ["Data Encrypted for Impact", 0.018993408537932358]], "The decrypted shellcode": [["Deobfuscate/Decode Files or Information", 0.6322319356553977], ["Obfuscated Files or Information", 0.1656199507103407], ["Encrypted Channel", 0.021057851259607456], ["Data Encrypted for Impact", 0.020086782453747294], ["Execution Guardrails", 0.014235719848090635], ["Archive Collected Data", 0.009376130112101944]], "decrypt the embedded module": [["Deobfuscate/Decode Files or Information", 0.6270710414483971], ["Obfuscated Files or Information", 0.11635251582414123], ["Data Encrypted for Impact", 0.04722280036957051], ["Weaken Encryption", 0.025381605492437967], ["Archive Collected Data", 0.020428806998914372], ["Encrypted Channel", 0.019764744455971556]], "into the shellcode that will decompress and load the Korplug payload.": [["Deobfuscate/Decode Files or Information", 0.4697294952600069], ["Obfuscated Files or Information", 0.1687809826831837], ["Archive Collected Data", 0.07898407292710519], ["Command and Scripting Interpreter", 0.016570238480421034], ["OS Credential Dumping", 0.010629878700640992], ["Masquerading", 0.009798441699286821]], "It decrypts and loads": [["Deobfuscate/Decode Files or Information", 0.7432237948097752], ["Obfuscated Files or Information", 0.04083679666112508], ["Data Encrypted for Impact", 0.03444070182196496], ["Archive Collected Data", 0.02391582366391987], ["Encrypted Channel", 0.009065789847344179], ["OS Credential Dumping", 0.006411580546074155]], "decrypted before being written": [["Deobfuscate/Decode Files or Information", 0.5769165492259793], ["Data Encrypted for Impact", 0.09083491087828971], ["Archive Collected Data", 0.05718908751098898], ["Obfuscated Files or Information", 0.05423764951696053], ["Weaken Encryption", 0.03465008916808699], ["Encrypted Channel", 0.029858866250389526]], "and injects it into iexplore.exe using WriteProcessMemory.": [["Process Injection", 0.6274497364414197], ["System Binary Proxy Execution", 0.08834999256139518], ["Native API", 0.06866333214347124], ["Hijack Execution Flow", 0.023367901158583258], ["Masquerading", 0.021225886467044916], ["Event Triggered Execution", 0.018688992348216398]], "The next stage, injected into iexplore.exe": [["Process Injection", 0.28481038655767504], ["System Binary Proxy Execution", 0.14546842607833704], ["Event Triggered Execution", 0.05541012641207381], ["Native API", 0.044434288367091526], ["Inter-Process Communication", 0.042434705992090364], ["Command and Scripting Interpreter", 0.03614500760842996]], "The injected code loads the same backdoor (rescure.dat) into the process\u2019s memory and calls its startModule export to finish the installation.": [["Process Injection", 0.3272120705848257], ["System Binary Proxy Execution", 0.04401175688386735], ["Create or Modify System Process", 0.0396712873335541], ["Boot or Logon Autostart Execution", 0.03754345020122066], ["Hijack Execution Flow", 0.035683193427833826], ["Event Triggered Execution", 0.028661689190928784]], "the injection process": [["Process Injection", 0.3052807750524484], ["Native API", 0.056045039408135135], ["Exploit Public-Facing Application", 0.0393158621910952], ["Command and Scripting Interpreter", 0.030453265706302465], ["Event Triggered Execution", 0.023635422911531805], ["Inter-Process Communication", 0.022215857058312593]], "perform process injection to masquerade as harmless processes.": [["Process Injection", 0.638174410308164], ["Native API", 0.05450360632116871], ["Access Token Manipulation", 0.03210287312292349], ["Process Discovery", 0.031475534688827765], ["Create or Modify System Process", 0.021155966300875757], ["Hijack Execution Flow", 0.021048590266836514]], "The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.": [["Process Injection", 0.7008866943543361], ["Native API", 0.04146633822858828], ["Process Discovery", 0.01801864344881915], ["Create or Modify System Process", 0.01398439039346661], ["Access Token Manipulation", 0.01311644734086669], ["Virtualization/Sandbox Evasion", 0.012460272434400548]], "The loader injects an orchestrator into memory in a svchost.exe process.": [["Process Injection", 0.4132702142041507], ["Hijack Execution Flow", 0.08728044454359045], ["Shared Modules", 0.04597394950857287], ["System Binary Proxy Execution", 0.041131341513458125], ["Create or Modify System Process", 0.04009554899267177], ["Native API", 0.034045680819819645]], "the orchestrator injects the network component into memory": [["Adversary-in-the-Middle", 0.060977695172945476], ["Process Injection", 0.04330610139408809], ["Data from Configuration Repository", 0.027521640470794282], ["System Network Connections Discovery", 0.02747511190885068], ["Inter-Process Communication", 0.024002552478674787], ["Pre-OS Boot", 0.022624894770234428]], "the process into which the shellcode will be injected": [["Process Injection", 0.5316747373723371], ["Native API", 0.16541633947264864], ["Event Triggered Execution", 0.027403528457754886], ["Hijack Execution Flow", 0.02593315432834071], ["System Binary Proxy Execution", 0.019071481427737465], ["Obfuscated Files or Information", 0.015989546102173794]], "and inject \u00a0  shellcode,": [["Process Injection", 0.23255588661257676], ["Hijack Execution Flow", 0.0860615206363043], ["Native API", 0.06003795807676413], ["Obfuscated Files or Information", 0.05999687469771105], ["System Binary Proxy Execution", 0.04597065460933751], ["Shared Modules", 0.04565933509062481]], "Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.": [["BITS Jobs", 0.09877161140989263], ["Boot or Logon Autostart Execution", 0.09109620941883594], ["Ingress Tool Transfer", 0.07221247289885983], ["Scheduled Task/Job", 0.06806217878383868], ["Event Triggered Execution", 0.053437735649103674], ["Command and Scripting Interpreter", 0.04634367377149766]], "the task or service attains persistence by being set to start automatically on boot": [["Create or Modify System Process", 0.36334953785130525], ["Scheduled Task/Job", 0.21673046012522146], ["Boot or Logon Autostart Execution", 0.09345680687510355], ["Event Triggered Execution", 0.03481491936339182], ["Boot or Logon Initialization Scripts", 0.033852654828971096], ["System Services", 0.023299688895277403]], "It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.": [["Modify Registry", 0.2776299227511836], ["Boot or Logon Autostart Execution", 0.14665455340557923], ["Boot or Logon Initialization Scripts", 0.049709340210248476], ["Query Registry", 0.04207486642820595], ["Create or Modify System Process", 0.0412090081121585], ["Impair Defenses", 0.035887466360456144]], "uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dll which could be mistaken for rebar.dll) or innocuous looking (e.g., AC146142) to avoid suspicion.": [["Masquerading", 0.5692346372642735], ["Hijack Execution Flow", 0.10990947047251141], ["System Binary Proxy Execution", 0.041114120933333706], ["Obfuscated Files or Information", 0.03691161886557806], ["Hide Artifacts", 0.02459401337909619], ["Native API", 0.017800185002160813]], "named after legitimate utilities are written into the %ProgramFiles%\\MSBuild\\Microsoft\\Expression\\Blend\\msole\\ subdirectory.": [["Masquerading", 0.373690682556661], ["Hijack Execution Flow", 0.12867998690187488], ["File and Directory Discovery", 0.03895995037014406], ["Native API", 0.030425333701531956], ["Office Application Startup", 0.022656945491248415], ["Obfuscated Files or Information", 0.02090190701026925]], "This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.": [["Process Injection", 0.39431890610691844], ["Process Discovery", 0.13163418490775539], ["Masquerading", 0.07683727996932704], ["Impair Defenses", 0.0378229975688821], ["Native API", 0.031293047302387175], ["Rootkit", 0.022918514877462718]], "registry key where each embedded resource is to be written": [["Modify Registry", 0.333806484083458], ["Boot or Logon Autostart Execution", 0.20349896676296156], ["Query Registry", 0.13369506382196805], ["System Binary Proxy Execution", 0.043062840537005875], ["Office Application Startup", 0.03024159234130809], ["Event Triggered Execution", 0.02269081855335394]], "by writing to specific registry keys.": [["Modify Registry", 0.4767070584395782], ["Boot or Logon Autostart Execution", 0.13860368583830518], ["Indicator Removal", 0.03422838194380337], ["Query Registry", 0.033504901950673474], ["Masquerading", 0.021341963869012506], ["Create or Modify System Process", 0.020261221076069102]], "Network shellcode registry keys": [["Modify Registry", 0.3554200585209618], ["Query Registry", 0.1937546360868066], ["Boot or Logon Autostart Execution", 0.13458470798658878], ["Boot or Logon Initialization Scripts", 0.029012931528040395], ["Event Triggered Execution", 0.018618412599262245], ["Windows Management Instrumentation", 0.016166897549973164]], "stored in the Windows registry.": [["Query Registry", 0.25105539790603115], ["Modify Registry", 0.2408758453290545], ["Boot or Logon Autostart Execution", 0.06555521993970027], ["Indicator Removal", 0.06373436461296035], ["Masquerading", 0.024267987921238136], ["OS Credential Dumping", 0.019145308444960204]], "shows the three registry keys used": [["Query Registry", 0.6863228095692837], ["Modify Registry", 0.12828304897715426], ["Boot or Logon Autostart Execution", 0.026982153119183803], ["Software Discovery", 0.018823914112884376], ["Windows Management Instrumentation", 0.010581777610137946], ["Unsecured Credentials", 0.009726723000378952]], "creating the files and registry keys": [["Modify Registry", 0.47509550338086104], ["Boot or Logon Autostart Execution", 0.19982881025099378], ["Query Registry", 0.07446340738464409], ["Create or Modify System Process", 0.019121270436630505], ["Boot or Logon Initialization Scripts", 0.017274716470805154], ["System Binary Proxy Execution", 0.016340751745201238]], "2001Path to the registry key for the PrintProcessor service": [["Modify Registry", 0.2401277388820957], ["Boot or Logon Autostart Execution", 0.17105258390409117], ["Query Registry", 0.08682947081163471], ["Create or Modify System Process", 0.07293055417169696], ["Masquerading", 0.041799004018022404], ["Event Triggered Execution", 0.027404781357933183]], "The paths and registry keys to use": [["Boot or Logon Autostart Execution", 0.2844524158038958], ["Modify Registry", 0.1987274058376612], ["Query Registry", 0.09999739877558145], ["Masquerading", 0.05521240139143249], ["System Binary Proxy Execution", 0.044002174555926095], ["Hijack Execution Flow", 0.04051722313255892]], "it can create a service": [["Create or Modify System Process", 0.4198854492457387], ["System Services", 0.32026012267083614], ["System Service Discovery", 0.04913525426409267], ["Masquerading", 0.018859614848866318], ["Native API", 0.012206910491290242], ["Hijack Execution Flow", 0.011892133125087504]], "service is then created": [["Create or Modify System Process", 0.4629352034749903], ["System Services", 0.26168199542153864], ["System Service Discovery", 0.06015549721772072], ["Masquerading", 0.01763496993621639], ["Hijack Execution Flow", 0.01457578414247893], ["Cloud Service Discovery", 0.013307573976292782]], "can be configured to create a service for persistence.": [["Create or Modify System Process", 0.2924044012237875], ["Scheduled Task/Job", 0.10618944091949427], ["Boot or Logon Autostart Execution", 0.10472632824126578], ["Event Triggered Execution", 0.08435606951334342], ["Boot or Logon Initialization Scripts", 0.06474426318209144], ["Office Application Startup", 0.03258250499965901]], "it can create a service or scheduled task.": [["Scheduled Task/Job", 0.404398152398643], ["Create or Modify System Process", 0.19706457020884763], ["System Services", 0.13150587296317623], ["Masquerading", 0.029619389929162302], ["System Service Discovery", 0.01627984796725129], ["Event Triggered Execution", 0.016240075446664625]], "persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task": [["Scheduled Task/Job", 0.22455206580870932], ["Boot or Logon Autostart Execution", 0.20328588835016112], ["Create or Modify System Process", 0.09438501968262171], ["Event Triggered Execution", 0.08919587996374131], ["Boot or Logon Initialization Scripts", 0.03680722688517828], ["Modify Registry", 0.03579072430987846]], "This task will run the DLL hijacking target as SYSTEM at each boot.": [["Hijack Execution Flow", 0.29174173603273523], ["Boot or Logon Autostart Execution", 0.10488309542672362], ["Event Triggered Execution", 0.08853737564080683], ["System Binary Proxy Execution", 0.0787597544665509], ["Shared Modules", 0.06061504149503539], ["Create or Modify System Process", 0.05112818091605144]], "uses COM interfaces to schedule tasks": [["Scheduled Task/Job", 0.5464770343664002], ["Inter-Process Communication", 0.14890125856656186], ["Masquerading", 0.027565220559357395], ["Command and Scripting Interpreter", 0.026196640051826446], ["Event Triggered Execution", 0.017885537627922568], ["System Binary Proxy Execution", 0.013052694927803855]], "creates a scheduled task for persistence.": [["Scheduled Task/Job", 0.6862393234093357], ["Create or Modify System Process", 0.05313224608261311], ["Boot or Logon Autostart Execution", 0.03253253372495968], ["Event Triggered Execution", 0.030842314384249562], ["Boot or Logon Initialization Scripts", 0.017599090012439422], ["Inter-Process Communication", 0.017221462340915938]], "service was configured to execute the next step of the installation process by running a legitimate application": [["Create or Modify System Process", 0.5617228664594284], ["System Services", 0.10664998162796764], ["Masquerading", 0.053640221318486024], ["System Service Discovery", 0.028323703287423035], ["Hijack Execution Flow", 0.022376410216602225], ["System Binary Proxy Execution", 0.019476629933116222]], "service is then created to run that module and is immediately started": [["Create or Modify System Process", 0.430655122954469], ["System Services", 0.3440673198071478], ["System Service Discovery", 0.026002216967428816], ["Hijack Execution Flow", 0.02112665018554583], ["Masquerading", 0.010341304931823576], ["Boot or Logon Autostart Execution", 0.010220726115029676]], "target for DLL side-loading": [["Hijack Execution Flow", 0.5202266013267492], ["Shared Modules", 0.1419428610480166], ["System Binary Proxy Execution", 0.06425813206250165], ["Process Injection", 0.03534269935986373], ["Event Triggered Execution", 0.01615143665597879], ["Masquerading", 0.012897199341925215]], "DLL side-loading": [["Hijack Execution Flow", 0.46150763282981094], ["Shared Modules", 0.1576745231549214], ["System Binary Proxy Execution", 0.07514434763826179], ["Process Injection", 0.044570073057430215], ["Event Triggered Execution", 0.021010181506860556], ["Boot or Logon Autostart Execution", 0.014663813009899457]], "the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL": [["Hijack Execution Flow", 0.38070002101392675], ["Shared Modules", 0.20061325759533605], ["System Binary Proxy Execution", 0.07899462968882368], ["Process Injection", 0.06370086748590144], ["Native API", 0.03385917774877823], ["Deobfuscate/Decode Files or Information", 0.019999384782315856]], "the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing),": [["Process Injection", 0.4586938344209372], ["Hijack Execution Flow", 0.0940218763872745], ["Deobfuscate/Decode Files or Information", 0.06398848498346597], ["System Binary Proxy Execution", 0.027497917835981416], ["Native API", 0.02410626920222844], ["Masquerading", 0.022142430889092405]], "uses DLL Side-Loading to launch its second-stage dropper.": [["Hijack Execution Flow", 0.32870518441420576], ["System Binary Proxy Execution", 0.13890490103427308], ["Process Injection", 0.06876658747650105], ["Shared Modules", 0.05979999435685862], ["Native API", 0.03612418025041281], ["Event Triggered Execution", 0.03118011626364763]], "If a task with the same name already exists, it is deleted before the new one is created": [["Indicator Removal", 0.1317068329477303], ["Scheduled Task/Job", 0.12805697840272084], ["Masquerading", 0.09635260927984744], ["Process Discovery", 0.03088849101940147], ["Create or Modify System Process", 0.024545047830645483], ["System Service Discovery", 0.01734014290875186]], "After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.": [["Rootkit", 0.09943453799673976], ["Masquerading", 0.0626237198096101], ["Pre-OS Boot", 0.05440665424651451], ["Peripheral Device Discovery", 0.044439775060372076], ["Boot or Logon Autostart Execution", 0.040780662819197615], ["Subvert Trust Controls", 0.04064454984026143]], "Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.": [["Hijack Execution Flow", 0.22213268116444315], ["Rootkit", 0.06758837024212404], ["Indicator Removal", 0.06432838096633689], ["Compromise Client Software Binary", 0.05716809175656309], ["Masquerading", 0.04929555314632801], ["Impair Defenses", 0.04251963582334773]], "removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.": [["Impair Defenses", 0.2112815549633952], ["Indicator Removal", 0.18928915041995933], ["Rootkit", 0.0845883435703037], ["Service Stop", 0.044150430098645894], ["Masquerading", 0.02989612163350323], ["Process Injection", 0.028576425132494313]], "The file is then deleted from the disk": [["Indicator Removal", 0.42342484654066787], ["Data Destruction", 0.16878701002154994], ["Disk Wipe", 0.030703439415616485], ["Inhibit System Recovery", 0.029321615030339275], ["Hide Artifacts", 0.019440732114893697], ["Data Staged", 0.01942054314934574]], "deletes its rootkit\u2019s executable after launching it.": [["Indicator Removal", 0.39525314807220996], ["Rootkit", 0.14523306512990788], ["System Shutdown/Reboot", 0.0344747047703446], ["Masquerading", 0.02278391854838208], ["Modify System Image", 0.020940227916265864], ["Inhibit System Recovery", 0.019935561130243022]], "then starts a suspended process to perform injection on it.": [["Process Injection", 0.6892379501976746], ["Native API", 0.0523686336654256], ["Event Triggered Execution", 0.02202445024512001], ["Create or Modify System Process", 0.0158340988118425], ["Hijack Execution Flow", 0.014759218088822542], ["System Binary Proxy Execution", 0.012966184046367549]], "stores collected data in local SQLite databases prior to exfiltration.": [["Data Staged", 0.37576053873484777], ["Archive Collected Data", 0.08109317228429752], ["Data from Local System", 0.06358677138043207], ["Automated Exfiltration", 0.06193326108611264], ["Exfiltration Over Web Service", 0.04231332346933725], ["Exfiltration Over C2 Channel", 0.040952970423102204]], "Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server": [["Data Staged", 0.5006473141947952], ["Data from Local System", 0.07820127565552419], ["Automated Collection", 0.060866885711556754], ["Automated Exfiltration", 0.0359882416957745], ["Archive Collected Data", 0.02472756077524671], ["Exfiltration Over C2 Channel", 0.02280488153328031]], "uses local caches to stage data": [["Data Staged", 0.15574455570868365], ["Archive Collected Data", 0.06815293230192716], ["Data Manipulation", 0.031648187882430984], ["Hide Artifacts", 0.027577442932366518], ["Indicator Removal", 0.025458229159179096], ["Automated Collection", 0.023856744769557518]], "data can be collected locally by the corresponding class before it is staged for exfiltration.": [["Data Staged", 0.2589699565746983], ["Data from Local System", 0.10788730928313303], ["Automated Exfiltration", 0.08097096011997117], ["Exfiltration Over C2 Channel", 0.07726556085057547], ["Archive Collected Data", 0.06461341933211785], ["Automated Collection", 0.06379370561850721]], "can exfiltrate files from local file systems.": [["Exfiltration Over Web Service", 0.1152154734686416], ["Data from Local System", 0.09556820701510099], ["Exfiltration Over Physical Medium", 0.06269369099643578], ["Inhibit System Recovery", 0.05432516369796089], ["Exfiltration Over C2 Channel", 0.052327414918554374], ["Exfiltration Over Alternative Protocol", 0.04103337726086383]], "The corresponding files are collected": [["Data from Local System", 0.24709031360096925], ["Automated Collection", 0.16068210961204576], ["File and Directory Discovery", 0.15250546622434163], ["Data Staged", 0.1306277428810899], ["Data from Network Shared Drive", 0.04070998709940926], ["Ingress Tool Transfer", 0.03006061684242091]], "Monitoring file system events to collect new and modified files.": [["File and Directory Discovery", 0.3357226613879949], ["Indicator Removal", 0.08733289339037414], ["Data from Local System", 0.08117458066484304], ["Automated Collection", 0.07125069064261147], ["Data Staged", 0.05310317945296333], ["System Information Discovery", 0.025903417060381982]], "can search through connected file systems and obtain directory listings.": [["File and Directory Discovery", 0.8087902654324753], ["Network Share Discovery", 0.027139523336421785], ["Data from Local System", 0.015048635081314205], ["Data from Network Shared Drive", 0.01327125886524271], ["System Information Discovery", 0.010833127728750386], ["Automated Collection", 0.009768352560052226]], "walks through all mapped file systems and collects files": [["File and Directory Discovery", 0.5321122105674256], ["Data from Local System", 0.12282546225085926], ["Automated Collection", 0.04138714295237637], ["Data from Network Shared Drive", 0.03590528375917948], ["Data from Removable Media", 0.02659913212216318], ["Network Share Discovery", 0.025010262192010278]], "collects file and directory metadata": [["File and Directory Discovery", 0.38965278566445666], ["Data from Local System", 0.1498705107931334], ["Automated Collection", 0.11030643002687338], ["Data Staged", 0.0623950908812022], ["Data from Network Shared Drive", 0.0194601708512746], ["Indicator Removal", 0.01940595964011277]], "uses malicious RTF and DOCX attachments to compromise victims.": [["Phishing", 0.3646484326950226], ["User Execution", 0.3085987660679394], ["Template Injection", 0.06365571559892697], ["Exploitation for Client Execution", 0.018507505264573874], ["Stage Capabilities", 0.013358234532059848], ["Obfuscated Files or Information", 0.012420988836152806]], "sending spearphishing emails with malicious attachments such as RTF documents created via the Royal Road builder": [["Phishing", 0.6147155619361028], ["User Execution", 0.15377695469753008], ["Phishing for Information", 0.030299885077612117], ["Internal Spearphishing", 0.01704581662794964], ["Template Injection", 0.010965996351570587], ["Establish Accounts", 0.010267616523239546]], "makes extensive use of the Windows API to execute commands and launch processes.": [["Native API", 0.515664159398992], ["Command and Scripting Interpreter", 0.07219489751626683], ["System Binary Proxy Execution", 0.06584228444888439], ["System Services", 0.0473711296814984], ["Windows Management Instrumentation", 0.0453948234226391], ["Process Injection", 0.028501928741385095]], "performs the functions of LoadLibrary and calls the loaded module\u2019s startModule export.": [["Shared Modules", 0.321609841506679], ["Hijack Execution Flow", 0.16993971239242728], ["System Binary Proxy Execution", 0.055651802038062026], ["Native API", 0.0496597949380224], ["Boot or Logon Autostart Execution", 0.03398196598733043], ["Process Injection", 0.027092954452487786]], "used for function imports (via GetProcAddress)": [["Native API", 0.2985046640910641], ["Hijack Execution Flow", 0.15606228473334371], ["Shared Modules", 0.1069430382291638], ["Process Injection", 0.039263497527780154], ["System Binary Proxy Execution", 0.02025324554135539], ["Masquerading", 0.01612162675036047]], "perform WMI queries": [["Windows Management Instrumentation", 0.7155629156576164], ["System Information Discovery", 0.030630792129367576], ["Query Registry", 0.020650377154927218], ["OS Credential Dumping", 0.01842633065470497], ["Event Triggered Execution", 0.01469743170378006], ["System Network Configuration Discovery", 0.011906036380285033]], "uses WMI for lateral movement and information gathering.": [["Windows Management Instrumentation", 0.3048089959781177], ["Remote Services", 0.05883630852567867], ["Remote Access Software", 0.04118351234769859], ["Application Window Discovery", 0.031281714638316326], ["Input Capture", 0.030897158523021804], ["Peripheral Device Discovery", 0.027392891282566147]], "runs WMI queries every second to get all process creation and termination events.": [["Process Discovery", 0.5768609423992105], ["Windows Management Instrumentation", 0.05276845515931116], ["Virtualization/Sandbox Evasion", 0.0330759154204512], ["Native API", 0.03215746247336305], ["System Service Discovery", 0.026375729370485778], ["Software Discovery", 0.020714927020724604]], "lateral movement scripts such as WMIExec.": [["Remote Services", 0.09877530486856617], ["Command and Scripting Interpreter", 0.06410462058071385], ["Boot or Logon Autostart Execution", 0.053556504529253736], ["Event Triggered Execution", 0.03197574385401106], ["Lateral Tool Transfer", 0.028401168424744033], ["Remote Service Session Hijacking", 0.02764419306735625]], "use locally configured proxies.": [["Proxy", 0.6010628665657708], ["Application Layer Protocol", 0.03242407732933981], ["Fallback Channels", 0.026428509707943124], ["Protocol Tunneling", 0.024472736608581923], ["Adversary-in-the-Middle", 0.013767253732235932], ["Data Obfuscation", 0.013578840720510897]], "can use XOR, TEA, RC4 and a modified AES algorithm to encrypt traffic and files.": [["Encrypted Channel", 0.38366906030213255], ["Obfuscated Files or Information", 0.09691642636901296], ["Weaken Encryption", 0.058629824904121185], ["Data Encrypted for Impact", 0.05721211988977497], ["Exfiltration Over Alternative Protocol", 0.04359887764124316], ["Archive Collected Data", 0.03530699958837549]], "It is encrypted using the AES algorithm": [["Deobfuscate/Decode Files or Information", 0.2667512365536271], ["Obfuscated Files or Information", 0.15183599684701032], ["Archive Collected Data", 0.0964912981663146], ["Data Encrypted for Impact", 0.07845579751728937], ["Encrypted Channel", 0.07698881645399741], ["Weaken Encryption", 0.03976051190046756]], "The application and the accompanying relevant and malicious DLL were both embedded in the loader\u2019s resources.": [["Hijack Execution Flow", 0.4985552042395439], ["Shared Modules", 0.1338880196436838], ["System Binary Proxy Execution", 0.08827785770955084], ["Process Injection", 0.06315516966906264], ["Native API", 0.025740428788795875], ["Masquerading", 0.015884011222592923]], "the embedded DLL": [["Hijack Execution Flow", 0.1779996758275699], ["Shared Modules", 0.16080692301948635], ["Process Injection", 0.14282625600734686], ["System Binary Proxy Execution", 0.11382433692006508], ["Native API", 0.043645389080282586], ["Obfuscated Files or Information", 0.02928097452032611]], "It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources": [["Obfuscated Files or Information", 0.4768115281171693], ["Deobfuscate/Decode Files or Information", 0.07758554373924563], ["Data Encrypted for Impact", 0.043792983715499584], ["Archive Collected Data", 0.03817733333603139], ["Hide Artifacts", 0.03697595788161225], ["Execution Guardrails", 0.02192270121275696]], "This module is embedded in the library\u2019s resource section and encrypted with an algorithm similar to RC4": [["Obfuscated Files or Information", 0.3884605122892309], ["Deobfuscate/Decode Files or Information", 0.12192504126955778], ["Encrypted Channel", 0.10666730893014743], ["Data Encrypted for Impact", 0.08815385042247521], ["Archive Collected Data", 0.055440508964472564], ["Weaken Encryption", 0.026482108079666385]], "the function used to encrypt and decrypt the embedded module": [["Obfuscated Files or Information", 0.29364136028974674], ["Deobfuscate/Decode Files or Information", 0.2680691075120036], ["Data Encrypted for Impact", 0.08099381472040285], ["Encrypted Channel", 0.057792016084490895], ["Archive Collected Data", 0.044973298925370955], ["Weaken Encryption", 0.03683568362950954]], "Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.": [["File and Directory Discovery", 0.35502032697586666], ["System Information Discovery", 0.2417338174175853], ["Peripheral Device Discovery", 0.056999106604779526], ["Network Share Discovery", 0.05528439385849848], ["Virtualization/Sandbox Evasion", 0.025267485859100283], ["Automated Collection", 0.017069591929301676]], "This is sent to the server along with the computer\u2019s name": [["System Information Discovery", 0.3633818932720511], ["System Owner/User Discovery", 0.1571507689880192], ["Remote System Discovery", 0.0459484667518503], ["System Network Configuration Discovery", 0.043965716101481346], ["Automated Collection", 0.02522009629932558], ["Masquerading", 0.01355936423244031]], "This includes bidirectional file transfers between the C&C and the compromised machine.": [["Lateral Tool Transfer", 0.23138711668173892], ["Remote Services", 0.1185368158117502], ["Ingress Tool Transfer", 0.0793757727181518], ["Communication Through Removable Media", 0.0754239203678823], ["Exfiltration Over Alternative Protocol", 0.03311497240759799], ["Taint Shared Content", 0.025950221306408755]], "This configuration corresponds to resource 1000 in the initial loader. It defines the address and port for both the exfiltration server (file_server) and the C&C server": [["Dynamic Resolution", 0.08894485020580332], ["Fallback Channels", 0.04727916377392663], ["Traffic Signaling", 0.036316644011549944], ["Network Service Discovery", 0.027359302888674487], ["Multi-Stage Channels", 0.024867184599348714], ["Rootkit", 0.02360510663157842]], "a given command line.": [["Command and Scripting Interpreter", 0.5084859926695137], ["Indirect Command Execution", 0.05102197528167531], ["Native API", 0.03671610967717983], ["Virtualization/Sandbox Evasion", 0.022624934292968014], ["File and Directory Discovery", 0.019427276270847626], ["System Information Discovery", 0.013619604427645973]], "is protected with DNGuard, a commercial .NET packer.": [["Obfuscated Files or Information", 0.40326105996040856], ["Masquerading", 0.09563318961151025], ["System Binary Proxy Execution", 0.06273342949480426], ["Deobfuscate/Decode Files or Information", 0.040602014548108536], ["Hijack Execution Flow", 0.03285822368864382], ["Subvert Trust Controls", 0.025881134945444993]], "uses both regular and reflective DLL injection.": [["Process Injection", 0.34080248841923344], ["Hijack Execution Flow", 0.20647822133474386], ["Shared Modules", 0.1508963617174915], ["System Binary Proxy Execution", 0.03728193412080107], ["Native API", 0.02366588759087937], ["Event Triggered Execution", 0.019570637271991338]], "proxy/tunneling utilities (HTran, LCX, EarthWorm": [["Proxy", 0.48065957994079483], ["Protocol Tunneling", 0.19466852517753852], ["Application Layer Protocol", 0.03400538084025226], ["Encrypted Channel", 0.020777961241075997], ["Data Obfuscation", 0.018800469371501236], ["Non-Standard Port", 0.017304114048649982]], "read from a file on disk or a registry key.": [["Query Registry", 0.1871962527865809], ["Modify Registry", 0.14555361916618825], ["Boot or Logon Autostart Execution", 0.12302624202275574], ["OS Credential Dumping", 0.04528607337073855], ["Native API", 0.044476564845454356], ["Event Triggered Execution", 0.02458172409899666]], "components use registry keys to signal each other.": [["Event Triggered Execution", 0.14232713529678284], ["Boot or Logon Autostart Execution", 0.07304264161318917], ["Query Registry", 0.06170355062251029], ["Modify Registry", 0.051548395598917086], ["Windows Management Instrumentation", 0.04450600140387992], ["Masquerading", 0.03310682220997496]], "it collects usernames": [["System Owner/User Discovery", 0.6769258408387588], ["Account Discovery", 0.16126397859438987], ["Automated Collection", 0.011150854394619603], ["Permission Groups Discovery", 0.009938339618949807], ["Gather Victim Identity Information", 0.0063165581675879556], ["Data from Local System", 0.00551325776631258]], "usernames": [["System Owner/User Discovery", 0.48041081178552164], ["Account Discovery", 0.12124769616409728], ["Gather Victim Identity Information", 0.029695440432348542], ["Brute Force", 0.016324416908142687], ["Establish Accounts", 0.015204930000319377], ["Compromise Accounts", 0.011992303984538991]], "directory listings": [["File and Directory Discovery", 0.6534950487351348], ["Data Staged", 0.03289824082785682], ["Automated Collection", 0.030893708672252388], ["Data from Local System", 0.021114179169706437], ["Masquerading", 0.020915612208874477], ["Data from Network Shared Drive", 0.01484352273120088]], "directory listings were harvested as a result.": [["File and Directory Discovery", 0.3078312844746147], ["Data Staged", 0.07875456382033827], ["Automated Collection", 0.07655350768221665], ["Data from Local System", 0.06437316374821558], ["Data from Network Shared Drive", 0.0353675391428123], ["Indicator Removal", 0.02598727197386602]], "hostnames": [["Remote System Discovery", 0.19565694238623535], ["System Information Discovery", 0.06679323938869597], ["Dynamic Resolution", 0.06244473971011627], ["System Network Configuration Discovery", 0.05727312733345613], ["Network Service Discovery", 0.03462990839594896], ["Gather Victim Host Information", 0.03393466775068474]], "machine names": [["Remote System Discovery", 0.26414216275519575], ["System Information Discovery", 0.10862224521736158], ["Windows Management Instrumentation", 0.03759331133817876], ["Network Share Discovery", 0.032373573933560024], ["Network Service Discovery", 0.02855778799348306], ["Masquerading", 0.02364430269263684]], "execution using scheduled tasks": [["Scheduled Task/Job", 0.8063354435503254], ["Inter-Process Communication", 0.04363636743450552], ["Command and Scripting Interpreter", 0.01686081018211442], ["System Services", 0.00914064005111264], ["Masquerading", 0.008245375571385384], ["Windows Management Instrumentation", 0.005284871186266113]], "downloaded and run by the plaintext PY files from external infrastructure.": [["Ingress Tool Transfer", 0.2110173350399712], ["Command and Scripting Interpreter", 0.15513260977909868], ["Deobfuscate/Decode Files or Information", 0.06007572462790999], ["Web Service", 0.034802363739014526], ["System Binary Proxy Execution", 0.030703231008984627], ["Obfuscated Files or Information", 0.026219914247774673]], "it download and execute yet another Python script": [["Command and Scripting Interpreter", 0.43846171033688064], ["Ingress Tool Transfer", 0.3130125826350948], ["BITS Jobs", 0.023990518211689207], ["Scheduled Task/Job", 0.017300134783804506], ["System Binary Proxy Execution", 0.015244546445467674], ["Web Service", 0.014232672499574035]], "Code responsible for downloading cron_script file": [["Ingress Tool Transfer", 0.39197917112906433], ["Scheduled Task/Job", 0.13632015325632765], ["Command and Scripting Interpreter", 0.09196927397594867], ["BITS Jobs", 0.03186083971481397], ["System Binary Proxy Execution", 0.020232535278679926], ["Inter-Process Communication", 0.015612632206685363]], "keylogging functionality.": [["Input Capture", 0.8393576795506273], ["Boot or Logon Autostart Execution", 0.0072946487877236085], ["Credentials from Password Stores", 0.007267914770034257], ["Clipboard Data", 0.006645249068191093], ["Event Triggered Execution", 0.005772775862068344], ["Screen Capture", 0.0052048397700737575]], "malware hidden inside the Python compiled byte code": [["Obfuscated Files or Information", 0.47657519450160507], ["Deobfuscate/Decode Files or Information", 0.05535502821834232], ["Hide Artifacts", 0.03998948493116683], ["Hijack Execution Flow", 0.027744603696152868], ["Masquerading", 0.026488061221095077], ["Process Injection", 0.019424736717865907]], "malicious code is embedded in code": [["Obfuscated Files or Information", 0.2315459401553605], ["Exploitation for Client Execution", 0.05684093704221989], ["Template Injection", 0.05143695590972769], ["Hijack Execution Flow", 0.04375891336246907], ["Process Injection", 0.043591478614143114], ["Deobfuscate/Decode Files or Information", 0.030532179776365784]], "unpacking": [["Deobfuscate/Decode Files or Information", 0.25128330312621583], ["Obfuscated Files or Information", 0.17305129157105162], ["Archive Collected Data", 0.04443031318893027], ["Masquerading", 0.03318521116009568], ["Command and Scripting Interpreter", 0.029464128671337672], ["Indicator Removal", 0.022758454075634878]], "Obfuscation is one of the most popular methods to achieve this.": [["Obfuscated Files or Information", 0.696054768423781], ["Deobfuscate/Decode Files or Information", 0.04422373601292144], ["Data Obfuscation", 0.028427915160198682], ["Data Encoding", 0.023369625448741868], ["Masquerading", 0.021339744872659185], ["Hide Artifacts", 0.020499237754237582]], "JavaScript obfuscation was used": [["Obfuscated Files or Information", 0.5843156663612884], ["Deobfuscate/Decode Files or Information", 0.08239193983217219], ["Data Encoding", 0.05227521113769239], ["Data Obfuscation", 0.03461188818688612], ["Encrypted Channel", 0.017604800700739897], ["Masquerading", 0.0153877162618168]], "use of various obfuscation techniques in malware": [["Obfuscated Files or Information", 0.8321600761181147], ["Deobfuscate/Decode Files or Information", 0.04382551449679227], ["Data Obfuscation", 0.008581430766677603], ["Data Encoding", 0.008139716409762058], ["Execution Guardrails", 0.008004384052831635], ["Encrypted Channel", 0.00660630230121624]], "the most popular obfuscation techniques is execution of Base64-encoded malicious code": [["Obfuscated Files or Information", 0.7889996015664096], ["Deobfuscate/Decode Files or Information", 0.07330266678570709], ["Data Encoding", 0.02417225118659822], ["Data Obfuscation", 0.014591741929975267], ["Archive Collected Data", 0.01060364565413249], ["Encrypted Channel", 0.007567929594418191]], "use of W4SP crew obfuscation tools such as Hyperion and Kramer": [["Obfuscated Files or Information", 0.7276250804687101], ["Deobfuscate/Decode Files or Information", 0.071595745656688], ["Masquerading", 0.02601818514737238], ["Data Obfuscation", 0.023484020234683132], ["Data Encoding", 0.018914530967560707], ["Archive Collected Data", 0.010208975110528543]], "The inspected UEFI firmware was tampered with to embed a malicious code that we dub MoonBounce;": [["Pre-OS Boot", 0.1891829360067382], ["Virtualization/Sandbox Evasion", 0.06003555224363126], ["Event Triggered Execution", 0.0424755505466406], ["Modify System Image", 0.036423278589192705], ["Peripheral Device Discovery", 0.027772559614083002], ["Rootkit", 0.02590786828645623]], "be embedded in the loader itself.": [["Hijack Execution Flow", 0.16135037049478715], ["Shared Modules", 0.14836787378789895], ["System Binary Proxy Execution", 0.07306660208576601], ["Process Injection", 0.06142660668188264], ["Ingress Tool Transfer", 0.033340294735352334], ["Command and Scripting Interpreter", 0.03156878347670679]], "that stages execution of further payloads downloaded from the internet": [["Ingress Tool Transfer", 0.30386586311472646], ["Command and Scripting Interpreter", 0.12884247508314353], ["BITS Jobs", 0.05269454240299441], ["System Binary Proxy Execution", 0.03729901421840845], ["Stage Capabilities", 0.031696444628784654], ["Exploitation for Client Execution", 0.03008356712445019]], "attempts to fetch another stage of the payload to run in memory,": [["Process Injection", 0.13208603720783005], ["Command and Scripting Interpreter", 0.05270024354147598], ["Deobfuscate/Decode Files or Information", 0.05218280043479259], ["Native API", 0.04419894027800216], ["Obfuscated Files or Information", 0.04235254399438951], ["Virtualization/Sandbox Evasion", 0.03531036168636462]], "stage the execution of additional plugins in memory,": [["Process Injection", 0.23760243532464628], ["Native API", 0.06885457544467778], ["Shared Modules", 0.059776160487794786], ["System Binary Proxy Execution", 0.04156102428424275], ["Hijack Execution Flow", 0.0401792669385271], ["Command and Scripting Interpreter", 0.0360233461576086]], "Download a file from the C2 server": [["Ingress Tool Transfer", 0.5860536801924384], ["Application Layer Protocol", 0.05476964237332039], ["Exfiltration Over C2 Channel", 0.04127514665111308], ["Command and Scripting Interpreter", 0.029396197514204886], ["Web Service", 0.026766518979379983], ["Data from Local System", 0.010515972403190509]], "reaching out to the server to obtain a further payload.": [["Ingress Tool Transfer", 0.10310869959347957], ["Application Layer Protocol", 0.057818688830772645], ["Multi-Stage Channels", 0.042468534206326625], ["Exfiltration Over C2 Channel", 0.040523628072640414], ["Web Service", 0.037975250754722426], ["Fallback Channels", 0.03593589900142542]], "the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices": [["Pre-OS Boot", 0.07829573352386442], ["Virtualization/Sandbox Evasion", 0.07457527688596824], ["Create or Modify System Process", 0.03865012870645981], ["System Information Discovery", 0.03180792635894993], ["System Service Discovery", 0.02924976548886652], ["Modify System Image", 0.027272890911046878]], "using the WinExec API": [["Native API", 0.3345306659935184], ["System Binary Proxy Execution", 0.16133781806082229], ["Command and Scripting Interpreter", 0.15715345432608566], ["System Services", 0.03191601427134692], ["Event Triggered Execution", 0.023940241668061437], ["XSL Script Processing", 0.020209201667555975]], "injecting it into an svchost.exe process,": [["Process Injection", 0.6670365700555009], ["Native API", 0.05534997980999047], ["System Binary Proxy Execution", 0.05226641984799149], ["Hijack Execution Flow", 0.03496704997411556], ["Masquerading", 0.018195394382741755], ["System Services", 0.017809408093309366]], "injecting it to the address space of another process.": [["Process Injection", 0.8090100109903599], ["Native API", 0.02182825723849094], ["Hijack Execution Flow", 0.012268681013631261], ["Access Token Manipulation", 0.005705565575250062], ["Rootkit", 0.005483145188319976], ["System Binary Proxy Execution", 0.005023247104445046]], "an encrypted blob": [["Obfuscated Files or Information", 0.282111588484103], ["Archive Collected Data", 0.21067121069769032], ["Deobfuscate/Decode Files or Information", 0.1373677427875258], ["Data Encrypted for Impact", 0.1284083603821369], ["Encrypted Channel", 0.03352560710936322], ["Exfiltration Over Alternative Protocol", 0.019237750182814747]], "the encrypted ScrambleCross shellcode": [["Obfuscated Files or Information", 0.44528455032123987], ["Deobfuscate/Decode Files or Information", 0.20795534679281497], ["Encrypted Channel", 0.07309535997201115], ["Data Encrypted for Impact", 0.03844620348866434], ["Archive Collected Data", 0.028786511800772047], ["Data Encoding", 0.02411760821871266]], "an encrypted configuration file": [["Obfuscated Files or Information", 0.23893100532407274], ["Modify Registry", 0.08869525482234362], ["Deobfuscate/Decode Files or Information", 0.08766958011073743], ["Data Encrypted for Impact", 0.07913088478421612], ["Execution Guardrails", 0.044785250697155686], ["Unsecured Credentials", 0.0382682785556715]], "facilitates the functionality of WMI in Windows": [["Windows Management Instrumentation", 0.7363132909753577], ["Event Triggered Execution", 0.06190126839159694], ["Boot or Logon Autostart Execution", 0.00990773671524339], ["Abuse Elevation Control Mechanism", 0.007288990806390096], ["Remote Services", 0.006974401426301486], ["OS Credential Dumping", 0.006159113068194716]], "when the WMI service was initiated": [["Windows Management Instrumentation", 0.6057361051525595], ["Event Triggered Execution", 0.0995779567296865], ["OS Credential Dumping", 0.011715078229144416], ["Boot or Logon Autostart Execution", 0.009331267508358986], ["Access Token Manipulation", 0.008848740536682788], ["Pre-OS Boot", 0.008668061363951273]], "upon initiation of the WMI service": [["Windows Management Instrumentation", 0.549455379819419], ["Event Triggered Execution", 0.12529532118439715], ["Boot or Logon Autostart Execution", 0.018024151281945313], ["Pre-OS Boot", 0.01378804825348779], ["Create or Modify System Process", 0.01235859339141492], ["Access Token Manipulation", 0.011850007158127979]], "Usage of WMI for remote command execution": [["Windows Management Instrumentation", 0.6942158776174434], ["Event Triggered Execution", 0.045442286476804226], ["Remote Services", 0.04399381275930625], ["Command and Scripting Interpreter", 0.03662297238602208], ["System Services", 0.023159357138548862], ["Remote Access Software", 0.012164139238908148]], "wmic  /node:<": [["Windows Management Instrumentation", 0.54443227622025], ["Command and Scripting Interpreter", 0.024415972526553694], ["Event Triggered Execution", 0.021992840088877637], ["OS Credential Dumping", 0.021632430113377604], ["Native API", 0.016913720983197003], ["Remote Services", 0.013604170710631166]], "It works by decrypting a shellcode BLOB with AES-256": [["Deobfuscate/Decode Files or Information", 0.4401612832443015], ["Obfuscated Files or Information", 0.2152366706054664], ["Data Encrypted for Impact", 0.06815166292457468], ["Encrypted Channel", 0.06270821707901633], ["Archive Collected Data", 0.04840184635487212], ["Weaken Encryption", 0.022408197510922434]], "through the command line as": [["Command and Scripting Interpreter", 0.34037285500532877], ["Indicator Removal", 0.05381653344599258], ["OS Credential Dumping", 0.029951023256860727], ["Indirect Command Execution", 0.020350839714311786], ["Modify Registry", 0.01930406130932729], ["Masquerading", 0.018999837368663168]], "via a Windows batch script file": [["Command and Scripting Interpreter", 0.6712606275428699], ["Scheduled Task/Job", 0.02585699685616623], ["System Binary Proxy Execution", 0.024468418451638253], ["Indicator Removal", 0.019564534975002938], ["Windows Management Instrumentation", 0.014917639661328225], ["Masquerading", 0.01337320167164887]], "issuing the following command line": [["Command and Scripting Interpreter", 0.5392809184366821], ["Indirect Command Execution", 0.06118898606833801], ["Virtualization/Sandbox Evasion", 0.02813579310859203], ["System Binary Proxy Execution", 0.0118593664022573], ["System Services", 0.011680043165033573], ["Ingress Tool Transfer", 0.011379003619262817]], "Write text to a given *.bat file and execute it": [["Command and Scripting Interpreter", 0.6451280589529509], ["System Binary Proxy Execution", 0.042666644178058495], ["Masquerading", 0.026986764682657267], ["Native API", 0.025635830947320613], ["Scheduled Task/Job", 0.012605874002410358], ["Indirect Command Execution", 0.011833833467442816]], "Run a shell command": [["Command and Scripting Interpreter", 0.7032382304128096], ["Indirect Command Execution", 0.06472291210822712], ["System Services", 0.021721316220864668], ["Native API", 0.020257792265787437], ["Ingress Tool Transfer", 0.011082011747447993], ["System Binary Proxy Execution", 0.009929073012880719]], "examples of command lines": [["Command and Scripting Interpreter", 0.7170563042017181], ["Indirect Command Execution", 0.05671929195881327], ["Native API", 0.01988171101877111], ["Ingress Tool Transfer", 0.008130225931246467], ["Web Service", 0.008065875194299339], ["Windows Management Instrumentation", 0.007298973202647078]], "executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.": [["Create or Modify System Process", 0.21542063989384247], ["System Services", 0.19731644502117326], ["Hijack Execution Flow", 0.11727007127730936], ["Masquerading", 0.08904577301643614], ["System Binary Proxy Execution", 0.04414888604275784], ["Office Application Startup", 0.02963833641215371]], "reg  add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\"": [["Modify Registry", 0.31674155202794174], ["Boot or Logon Autostart Execution", 0.16539195727270609], ["Query Registry", 0.13719353336138007], ["Masquerading", 0.035506792585013366], ["System Binary Proxy Execution", 0.02780014479062159], ["Abuse Elevation Control Mechanism", 0.023441328936843704]], "reg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\"": [["Modify Registry", 0.2714141310192006], ["Boot or Logon Autostart Execution", 0.15866664344026707], ["Query Registry", 0.13188967557178716], ["Event Triggered Execution", 0.05130976580932068], ["Boot or Logon Initialization Scripts", 0.028195978090251452], ["Abuse Elevation Control Mechanism", 0.027709894518955298]], "reg  add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\iscsiwmi\\Parameters\" /": [["Modify Registry", 0.2596907277837757], ["Boot or Logon Autostart Execution", 0.15600172019614786], ["Query Registry", 0.13988023999199636], ["Event Triggered Execution", 0.0517167827391416], ["Boot or Logon Initialization Scripts", 0.028203742283181413], ["Abuse Elevation Control Mechanism", 0.02797349815014544]], "The second way to execute StealthMutant is through the creation of a scheduled task": [["Scheduled Task/Job", 0.16526826522394777], ["Masquerading", 0.11571832894905447], ["Event Triggered Execution", 0.04671714756760716], ["Create or Modify System Process", 0.040282686079434096], ["System Binary Proxy Execution", 0.024739051260258577], ["Access Token Manipulation", 0.024284109235125338]], "schtasks /create /TN": [["Scheduled Task/Job", 0.5153600094500217], ["Create or Modify System Process", 0.03344420088116548], ["Masquerading", 0.02621313948782563], ["Command and Scripting Interpreter", 0.02579807790890141], ["System Services", 0.024014578959811714], ["Inter-Process Communication", 0.020174752346776903]], "Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor\u2019s image.": [["Obfuscated Files or Information", 0.16192061735754396], ["Encrypted Channel", 0.1378715418028648], ["Deobfuscate/Decode Files or Information", 0.047059303956812716], ["Weaken Encryption", 0.036681812901311714], ["Data Encoding", 0.03654450806894919], ["Execution Guardrails", 0.03538015029913562]], "The commands retrieved from the server are also encrypted with AES-128": [["Encrypted Channel", 0.18327105504823973], ["Deobfuscate/Decode Files or Information", 0.181019719293466], ["Obfuscated Files or Information", 0.14393086769615016], ["Data Encoding", 0.08757006100528548], ["Exfiltration Over Alternative Protocol", 0.03326547308039115], ["Data Obfuscation", 0.024762219704469228]], "Get list of drives": [["File and Directory Discovery", 0.4137576977522953], ["Peripheral Device Discovery", 0.12312921718523126], ["System Information Discovery", 0.06647394425844227], ["Network Share Discovery", 0.06140149514911138], ["Data from Removable Media", 0.02617171259542496], ["Data from Network Shared Drive", 0.026127699846186105]], "Get content list from a specified directory": [["File and Directory Discovery", 0.34614026315114305], ["Data from Local System", 0.16959379604338148], ["Automated Collection", 0.08243424718078082], ["Data from Network Shared Drive", 0.052103953369365325], ["Data Staged", 0.04152751486163904], ["Data from Information Repositories", 0.02467621855663232]], "cmd /C \"C: & cd \\ & dir $temp\\ /od\"": [["File and Directory Discovery", 0.5820367433306972], ["Data Staged", 0.042695093747491024], ["Native API", 0.03293299172428544], ["Masquerading", 0.027706540498601977], ["Hide Artifacts", 0.026923708984719942], ["Automated Collection", 0.02054649630878539]], "Sending back the result of the command\u2019s execution to the C2 server.": [["Command and Scripting Interpreter", 0.10122119712235249], ["Exfiltration Over C2 Channel", 0.0922768750406603], ["Web Service", 0.0747791735006096], ["Automated Collection", 0.05328707834394669], ["Automated Exfiltration", 0.03496163645984963], ["Ingress Tool Transfer", 0.034677782147135974]], "cmd /C \"C: & cd \\ & whoami\"": [["System Owner/User Discovery", 0.27941138828567225], ["File and Directory Discovery", 0.10121690414911974], ["Account Discovery", 0.07058329423812064], ["Command and Scripting Interpreter", 0.04286648799222753], ["Native API", 0.030660263589906124], ["System Information Discovery", 0.029049815526176]], "cmd /C \"C: & cd \\ & tasklist\"": [["Process Discovery", 0.3524676865106605], ["System Service Discovery", 0.07913719113293535], ["Scheduled Task/Job", 0.04084864495282754], ["Windows Management Instrumentation", 0.034301311561582594], ["File and Directory Discovery", 0.033674078229785034], ["Masquerading", 0.031216210668051296]], "cmd /C \"C: & cd \\ & systeminfo\"": [["System Information Discovery", 0.6418754512484113], ["File and Directory Discovery", 0.07567522564010604], ["Query Registry", 0.0377950296206873], ["Windows Management Instrumentation", 0.03611654351594186], ["Virtualization/Sandbox Evasion", 0.022306290199055594], ["Software Discovery", 0.022291256342468587]], "Copying of files across SMB shares": [["Lateral Tool Transfer", 0.42007593106041435], ["Remote Services", 0.17026993275576358], ["Taint Shared Content", 0.0926688025750851], ["Data from Network Shared Drive", 0.06019253632793837], ["Network Share Discovery", 0.046614281755382965], ["Data from Local System", 0.011975833394668813]], "cmd /C \"C: & cd \\ & arp -a\"": [["System Network Configuration Discovery", 0.13117018630455993], ["Remote System Discovery", 0.07543015081014817], ["Virtualization/Sandbox Evasion", 0.064634193541166], ["Native API", 0.03947174683863911], ["System Information Discovery", 0.03925044042640545], ["File and Directory Discovery", 0.03895700886697817]], "Removal of artefacts from the system": [["Indicator Removal", 0.5400837912862148], ["Inhibit System Recovery", 0.05032376234419443], ["Data Destruction", 0.030586011430625455], ["Disk Wipe", 0.02492201836754483], ["Impair Defenses", 0.01985013469076665], ["Modify Registry", 0.016804780984164703]], "wmic  /node": [["Windows Management Instrumentation", 0.6718183057743019], ["Command and Scripting Interpreter", 0.02392687074913851], ["Event Triggered Execution", 0.01640879707541914], ["OS Credential Dumping", 0.013154648349538053], ["Native API", 0.012950856875812267], ["Remote Services", 0.011499305934112492]], "These were used to inject the payload into process memory.": [["Process Injection", 0.6404702448377548], ["Obfuscated Files or Information", 0.04347188466109165], ["Hijack Execution Flow", 0.021220124905289708], ["Native API", 0.020735985549928608], ["Shared Modules", 0.011392523177133735], ["Event Triggered Execution", 0.010723503131295897]], "Adds Run Registry Key for Persistence": [["Boot or Logon Autostart Execution", 0.5285535015636847], ["Modify Registry", 0.1793450460768398], ["Boot or Logon Initialization Scripts", 0.06307337415212291], ["Create or Modify System Process", 0.03549513559751585], ["Event Triggered Execution", 0.03047192442131733], ["Query Registry", 0.02611716875428388]], "The persistence technique is simply adding a run registry key for persistence": [["Boot or Logon Autostart Execution", 0.36662510749156463], ["Boot or Logon Initialization Scripts", 0.09508223824471923], ["Event Triggered Execution", 0.08291830545942], ["Create or Modify System Process", 0.0799490669157555], ["Modify Registry", 0.07896595117874877], ["Office Application Startup", 0.037818395262222484]], "added to the startup folder": [["Boot or Logon Autostart Execution", 0.4702461034259199], ["Boot or Logon Initialization Scripts", 0.16077838397564384], ["Create or Modify System Process", 0.09002225447086676], ["Modify Registry", 0.019477275381269993], ["Office Application Startup", 0.01876354330828786], ["Event Triggered Execution", 0.01763899921174696]], "Screen capture": [["Screen Capture", 0.7624946422003457], ["Video Capture", 0.06924886746774797], ["Input Capture", 0.015460898931132703], ["Application Window Discovery", 0.015323702723236339], ["Clipboard Data", 0.006064269278951724], ["Data from Local System", 0.005736170273273268]], "Screen Logger": [["Input Capture", 0.27295766553382533], ["Screen Capture", 0.1631382573984449], ["Video Capture", 0.0784145032599178], ["Event Triggered Execution", 0.024371035790680656], ["Virtualization/Sandbox Evasion", 0.022143071345248126], ["Impair Defenses", 0.02114925178677487]], "Keylogger": [["Input Capture", 0.8783769134348718], ["Credentials from Password Stores", 0.006552867915854812], ["Clipboard Data", 0.005192453054671352], ["Unsecured Credentials", 0.00471984616802719], ["Screen Capture", 0.004104674376463311], ["OS Credential Dumping", 0.00336816812397881]], "Gathering system information": [["System Information Discovery", 0.7191837381839844], ["Windows Management Instrumentation", 0.04349184952021029], ["Software Discovery", 0.03604108427136741], ["Virtualization/Sandbox Evasion", 0.024849443859261], ["System Network Configuration Discovery", 0.014514013516282209], ["Query Registry", 0.012736850819110848]], "System Information": [["System Information Discovery", 0.7721479848780279], ["Software Discovery", 0.031735905753283146], ["Windows Management Instrumentation", 0.031304527177266714], ["Virtualization/Sandbox Evasion", 0.014884078765612995], ["Query Registry", 0.009300384888106243], ["Peripheral Device Discovery", 0.008690753180610116]], "Encoded shellcode in Project File": [["Obfuscated Files or Information", 0.547062715329515], ["Deobfuscate/Decode Files or Information", 0.15818348765683363], ["Data Encoding", 0.030531961434383335], ["Masquerading", 0.021895023361941497], ["XSL Script Processing", 0.011608731279023737], ["Native API", 0.008720897064251183]], "contained encoded executables and shellcode,": [["Obfuscated Files or Information", 0.5867993769888572], ["Deobfuscate/Decode Files or Information", 0.2122842745970607], ["Data Encoding", 0.025494093784907405], ["Masquerading", 0.01805741461654595], ["Native API", 0.012938703456891628], ["System Binary Proxy Execution", 0.008472010920134937]], "LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.": [["Hijack Execution Flow", 0.20788127632240264], ["Native API", 0.1465795065404989], ["Shared Modules", 0.09333146671471353], ["Process Injection", 0.08566533644165933], ["XSL Script Processing", 0.035552466180959544], ["Hide Artifacts", 0.03178735011472656]], "LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used": [["Process Injection", 0.3469736338600167], ["Native API", 0.18819048185381393], ["Shared Modules", 0.09500806509468174], ["Hijack Execution Flow", 0.07668008593086902], ["System Binary Proxy Execution", 0.024084816331682208], ["Process Discovery", 0.015998393725938115]], "using the callback function pointer in CallWindowProc": [["Native API", 0.4714302977786912], ["Process Injection", 0.0989534472188106], ["Event Triggered Execution", 0.03560441854747271], ["Hijack Execution Flow", 0.02787783717042982], ["Application Window Discovery", 0.02611020145700673], ["Input Capture", 0.020693548901375862]], "The payload from the project files was a remote access tool (RAT) called Remcos.": [["Remote Access Software", 0.062071409558684294], ["Compromise Client Software Binary", 0.04425426651054632], ["Ingress Tool Transfer", 0.03664202820340727], ["Windows Management Instrumentation", 0.03511692965810292], ["Event Triggered Execution", 0.026637035982336188], ["Hijack Execution Flow", 0.025397027303328393]], "two large arrays of decimal bytes were decoded by the function": [["Obfuscated Files or Information", 0.225094989062429], ["Deobfuscate/Decode Files or Information", 0.20622579847233288], ["Data Encoding", 0.13016073560006053], ["Archive Collected Data", 0.04996558672327664], ["Encrypted Channel", 0.02929567113805347], ["Data Obfuscation", 0.023025069047476813]], "Decoding Function": [["Deobfuscate/Decode Files or Information", 0.5177527940582648], ["Obfuscated Files or Information", 0.14765870592526337], ["Data Encoding", 0.08395641365504482], ["Encrypted Channel", 0.030485486298054584], ["Archive Collected Data", 0.028876150309220864], ["Data Obfuscation", 0.014630312622519709]], "decoding function": [["Deobfuscate/Decode Files or Information", 0.5177527940582648], ["Obfuscated Files or Information", 0.14765870592526337], ["Data Encoding", 0.08395641365504482], ["Encrypted Channel", 0.030485486298054584], ["Archive Collected Data", 0.028876150309220864], ["Data Obfuscation", 0.014630312622519709]], "Remote Command Line": [["Command and Scripting Interpreter", 0.4301564076322004], ["Remote Services", 0.21663879437710973], ["Remote Access Software", 0.03631644411391625], ["System Services", 0.030380835445932057], ["Ingress Tool Transfer", 0.02468608829935616], ["Windows Management Instrumentation", 0.018365701587480462]], "Registry Editor": [["Modify Registry", 0.6057672702407788], ["Query Registry", 0.11213165531959748], ["Boot or Logon Autostart Execution", 0.07549707186502289], ["Indicator Removal", 0.015464123344073257], ["Office Application Startup", 0.012925065784422679], ["Impair Defenses", 0.012127880230968493]], "stealing multiple types of data": [["Archive Collected Data", 0.10026011745811145], ["Data from Local System", 0.0907762064524418], ["Exfiltration Over C2 Channel", 0.050173090702463397], ["Data Staged", 0.04804789076483557], ["Automated Collection", 0.04731482912226258], ["Data Manipulation", 0.04456504495346869]], "the \u201cUsingTask\u201d element defines the task that will be compiled by MSBuild.": [["Trusted Developer Utilities Proxy Execution", 0.2044885996767347], ["Virtualization/Sandbox Evasion", 0.05224967658663671], ["Scheduled Task/Job", 0.04591667095233236], ["Event Triggered Execution", 0.029422296945510237], ["Windows Management Instrumentation", 0.028695311323881704], ["Masquerading", 0.02386035017022855]], "MSBuild has an inline task feature": [["Trusted Developer Utilities Proxy Execution", 0.2469831390494766], ["Scheduled Task/Job", 0.09983619951754959], ["Command and Scripting Interpreter", 0.044104082326871644], ["Inter-Process Communication", 0.031098913321867965], ["BITS Jobs", 0.02116493096935993], ["Virtualization/Sandbox Evasion", 0.020754885876402448]], "Modify and query the Windows registry": [["Modify Registry", 0.40135188031763275], ["Query Registry", 0.35656267384833706], ["Boot or Logon Autostart Execution", 0.05280650225715943], ["Indicator Removal", 0.014186270909994152], ["Software Discovery", 0.009014316201326863], ["Impair Defenses", 0.008868950015125275]], "query the Windows registry": [["Query Registry", 0.620372077647046], ["Modify Registry", 0.16993447330305744], ["Boot or Logon Autostart Execution", 0.027573104580366364], ["Software Discovery", 0.019965558954180285], ["Windows Management Instrumentation", 0.012293054659804414], ["Indicator Removal", 0.01098102236089298]], "Log keystrokes": [["Input Capture", 0.8843981789991568], ["Clipboard Data", 0.005845142134033741], ["Unsecured Credentials", 0.0043657164189263966], ["Credentials from Password Stores", 0.004235473322690989], ["Screen Capture", 0.003472447562378733], ["Network Sniffing", 0.0034255328367494313]], "Bypass UAC": [["Abuse Elevation Control Mechanism", 0.7083887818880401], ["Access Token Manipulation", 0.0335745428131095], ["File and Directory Permissions Modification", 0.016987285099050797], ["Domain Policy Modification", 0.015104512858426905], ["Exploitation for Privilege Escalation", 0.014515055330832643], ["Event Triggered Execution", 0.010548605347371186]], "Egress communications over HTTP, HTTPS": [["Application Layer Protocol", 0.608421130278029], ["Non-Standard Port", 0.058269220323881835], ["Proxy", 0.03977821606051337], ["Encrypted Channel", 0.03639450637159295], ["Protocol Tunneling", 0.03549860703515099], ["Data Obfuscation", 0.03039022637179883]], "Set up proxies": [["Proxy", 0.6767648191885153], ["Application Layer Protocol", 0.03077623780575004], ["Fallback Channels", 0.02093612370871667], ["Protocol Tunneling", 0.020377797989875972], ["Compromise Infrastructure", 0.013981428679419438], ["Data Obfuscation", 0.011239552189533163]], "payloads are usually shellcode encrypted with a rolling XOR key.": [["Obfuscated Files or Information", 0.488944301000551], ["Deobfuscate/Decode Files or Information", 0.2451381909869267], ["Encrypted Channel", 0.04280689705422856], ["Execution Guardrails", 0.027515687341932854], ["Archive Collected Data", 0.023801227403414737], ["Data Encoding", 0.019363571032471067]], "Once the encoded payload has been located": [["Deobfuscate/Decode Files or Information", 0.3634822951933705], ["Data Encoding", 0.2658488900447217], ["Obfuscated Files or Information", 0.15685457602262298], ["Data Obfuscation", 0.024025535694513354], ["Archive Collected Data", 0.013377193239679938], ["Encrypted Channel", 0.010428078721906616]], "the project file has an encoded and compressed payload": [["Obfuscated Files or Information", 0.4616963667556692], ["Deobfuscate/Decode Files or Information", 0.20951763736838874], ["Archive Collected Data", 0.08395680755378679], ["Data Encoding", 0.019707147509843058], ["Masquerading", 0.017379941661191833], ["Ingress Tool Transfer", 0.00931294640311309]], "The use of shellcode, encoding, compression, obfuscated strings": [["Obfuscated Files or Information", 0.8096854867256758], ["Data Encoding", 0.05366502320988233], ["Deobfuscate/Decode Files or Information", 0.0457160812191868], ["Archive Collected Data", 0.01726978591005966], ["Encrypted Channel", 0.007099638330470353], ["Data Obfuscation", 0.006771005983295559]], "since each payload will be encrypted with different keys and each configuration will uniquely change the hash value.": [["Obfuscated Files or Information", 0.18667050547534839], ["Encrypted Channel", 0.07645521014231615], ["Deobfuscate/Decode Files or Information", 0.058264375187644], ["Weaken Encryption", 0.048824715788015796], ["Archive Collected Data", 0.04554266072172035], ["Steal or Forge Kerberos Tickets", 0.04410153328947271]], "Encrypted payloads will also obfuscate useful strings from static analysis.": [["Obfuscated Files or Information", 0.7867677418246034], ["Deobfuscate/Decode Files or Information", 0.04566218377406006], ["Data Encoding", 0.01989500443345108], ["Encrypted Channel", 0.01984037491192119], ["Execution Guardrails", 0.012108462745416328], ["Archive Collected Data", 0.01206750531731292]], "using multiple stages and encrypted/obfuscated payloads": [["Obfuscated Files or Information", 0.5867940495548928], ["Deobfuscate/Decode Files or Information", 0.05792090349612441], ["Encrypted Channel", 0.04152319352405753], ["Execution Guardrails", 0.038055627751766616], ["Archive Collected Data", 0.029740084601522433], ["Data Obfuscation", 0.02608586247854523]], "the code can be injected into other legitimate running processes": [["Process Injection", 0.6491489199513062], ["Hijack Execution Flow", 0.05449687446292616], ["Native API", 0.05278814040307621], ["System Binary Proxy Execution", 0.019935306359741146], ["Event Triggered Execution", 0.014878300566930907], ["Shared Modules", 0.01211316226640226]], "The payload, usually shellcode, is injected into another process.": [["Process Injection", 0.6047659427815097], ["Native API", 0.07438261871494338], ["Hijack Execution Flow", 0.038595536870611596], ["Deobfuscate/Decode Files or Information", 0.025352107043588284], ["Obfuscated Files or Information", 0.02307971884251836], ["Event Triggered Execution", 0.01823499370231107]], "The shellcode is then executed in a new thread.": [["Process Injection", 0.20794052245630382], ["Native API", 0.15260232855878986], ["Event Triggered Execution", 0.04094421581182749], ["Virtualization/Sandbox Evasion", 0.03856030502784271], ["Access Token Manipulation", 0.03286583916068846], ["Process Discovery", 0.03266200772544685]], "An endpoint with a system injected": [["Application Layer Protocol", 0.06260845524624273], ["Exploit Public-Facing Application", 0.05057435344922504], ["Data Obfuscation", 0.039490628704229154], ["Endpoint Denial of Service", 0.03787021871978089], ["Process Injection", 0.03444512633078399], ["Proxy", 0.030031342249127565]], "process injection": [["Process Injection", 0.6758071499337207], ["Native API", 0.11413984028311357], ["Process Discovery", 0.022458052912787775], ["Hijack Execution Flow", 0.018328659489891874], ["Access Token Manipulation", 0.013639130101218625], ["System Binary Proxy Execution", 0.012824731937789692]], "and process injection": [["Process Injection", 0.5818164754682457], ["Native API", 0.10970898241101729], ["Hijack Execution Flow", 0.02894277745149963], ["Process Discovery", 0.023157403647148266], ["Event Triggered Execution", 0.020716162769536802], ["System Binary Proxy Execution", 0.01651511032633193]], "Inject malicious code into legitimate processes": [["Process Injection", 0.8044295955328885], ["Native API", 0.03660531907804241], ["Hijack Execution Flow", 0.015558733201595851], ["Process Discovery", 0.01104522366515926], ["System Binary Proxy Execution", 0.009567874133969131], ["Access Token Manipulation", 0.009497844362281736]], "is a memory-only DLL that runs as a service": [["Process Injection", 0.18493683777403072], ["Create or Modify System Process", 0.18157581280422952], ["Hijack Execution Flow", 0.13509148310644167], ["System Services", 0.10715232460536785], ["Native API", 0.04439263893901518], ["System Binary Proxy Execution", 0.04108843404456968]], "that pulls the Cobalt Strike payload from a fake JPG file.": [["Obfuscated Files or Information", 0.10054349262151581], ["Archive Collected Data", 0.079822999647483], ["Screen Capture", 0.07715661611784291], ["Deobfuscate/Decode Files or Information", 0.07570868081245428], ["Data from Local System", 0.036058696561888884], ["Build Image on Host", 0.03601523602431859]], "also leveraging steganography to locate the start of the encoded payload": [["Obfuscated Files or Information", 0.40728054719788936], ["Data Encoding", 0.2045251533776939], ["Deobfuscate/Decode Files or Information", 0.17624833614827745], ["Data Obfuscation", 0.05306701827990624], ["Archive Collected Data", 0.013956493793121246], ["Encrypted Channel", 0.010654259582170693]], "It uses a different custom packer": [["Obfuscated Files or Information", 0.2761556746614276], ["Masquerading", 0.09016254319881438], ["System Binary Proxy Execution", 0.04289851781755002], ["Ingress Tool Transfer", 0.04233096613974552], ["Hijack Execution Flow", 0.04134460739449531], ["Deobfuscate/Decode Files or Information", 0.03579011823037568]], "the malware to unpack": [["Deobfuscate/Decode Files or Information", 0.22610639740507305], ["Obfuscated Files or Information", 0.13590100858791213], ["Masquerading", 0.04535840878007642], ["Command and Scripting Interpreter", 0.04533340067826742], ["System Binary Proxy Execution", 0.03299709549431818], ["Archive Collected Data", 0.029149751794675546]], ", it extracts, decrypts, and decompresses the data to be executed as shellcode.": [["Deobfuscate/Decode Files or Information", 0.661033895444762], ["Obfuscated Files or Information", 0.10446153943473688], ["Archive Collected Data", 0.07881722514882031], ["OS Credential Dumping", 0.009617835011734447], ["Data Encoding", 0.00857826628244476], ["Data Encrypted for Impact", 0.008292525017929644]], "This payload is decrypted, decompressed, and then copied into memory": [["Deobfuscate/Decode Files or Information", 0.6347662759026712], ["Obfuscated Files or Information", 0.11779573484939523], ["Archive Collected Data", 0.07664975311341772], ["Encrypted Channel", 0.01698661317197731], ["Data Encrypted for Impact", 0.014543597743236799], ["Weaken Encryption", 0.009910931761594539]], "it is decrypted and executed": [["Deobfuscate/Decode Files or Information", 0.6977887014546582], ["Data Encrypted for Impact", 0.05087944629898763], ["Obfuscated Files or Information", 0.04379383549638633], ["Archive Collected Data", 0.03494876982656894], ["Encrypted Channel", 0.019763666165280646], ["Weaken Encryption", 0.013816372142161389]], "decode": [["Deobfuscate/Decode Files or Information", 0.604288015227918], ["Data Encoding", 0.09434541396129277], ["Obfuscated Files or Information", 0.08341622040564628], ["Archive Collected Data", 0.03788516408915489], ["Encrypted Channel", 0.020566216491842978], ["Data Obfuscation", 0.01260779502348561]], "or download additional stages.": [["Ingress Tool Transfer", 0.10639361501697518], ["Multi-Stage Channels", 0.0645530537197014], ["Stage Capabilities", 0.05329844671094144], ["Obtain Capabilities", 0.0440797967415354], ["BITS Jobs", 0.03902140213553479], ["Fallback Channels", 0.01860337047962338]], "drops and executes Cobalt Strike in the memory space of \u201crundll32.exe.\u201d": [["System Binary Proxy Execution", 0.1458202184070076], ["Process Injection", 0.1281692034824763], ["Command and Scripting Interpreter", 0.06830132230272552], ["Native API", 0.0470645651739863], ["Scheduled Task/Job", 0.03368399759776107], ["System Services", 0.031493932981695165]], "This requires either social engineering tactics to get the target to execute the malware or another program/script to execute the file.": [["User Execution", 0.4196515028759535], ["System Binary Proxy Execution", 0.11329775853291892], ["Masquerading", 0.060986665661906435], ["Ingress Tool Transfer", 0.04701153384341826], ["Phishing", 0.03903746711123937], ["Command and Scripting Interpreter", 0.025256244083324546]], "To optimize brute forcing efforts, the malware compares the server prompt upon connection to a hardcoded list of strings": [["Brute Force", 0.33652688441037865], ["Network Sniffing", 0.03268862682676029], ["Steal or Forge Kerberos Tickets", 0.03129482637016037], ["Use Alternate Authentication Material", 0.028192490242237345], ["Adversary-in-the-Middle", 0.02649057752354261], ["Multi-Factor Authentication Interception", 0.020807451515685953]], "These credentials used appear to be default credentials for IoT devices.": [["Unsecured Credentials", 0.11836032980272647], ["Multi-Factor Authentication Interception", 0.09676556409240715], ["Modify Authentication Process", 0.06661721480338668], ["Credentials from Password Stores", 0.05653253300147827], ["OS Credential Dumping", 0.05064025780968872], ["Valid Accounts", 0.049871119829109384]], "It attempts to specifically gain root access to these devices via a default password": [["Modify Authentication Process", 0.10789209746757149], ["Brute Force", 0.08302795764323104], ["Multi-Factor Authentication Interception", 0.051834499229323], ["Abuse Elevation Control Mechanism", 0.03996384172501642], ["Input Capture", 0.03209150085335165], ["Credentials from Password Stores", 0.030682832652325673]], "Like the earlier SSH brute-forcing campaign": [["Brute Force", 0.560186302033244], ["Modify Authentication Process", 0.05384193656634445], ["Steal or Forge Kerberos Tickets", 0.0314691486978754], ["Use Alternate Authentication Material", 0.027088592781822417], ["Multi-Factor Authentication Interception", 0.023294269636101747], ["Input Capture", 0.02129196291380617]], "brute-forced devices": [["Brute Force", 0.31439460086297283], ["Multi-Factor Authentication Interception", 0.13803800944366215], ["Weaken Encryption", 0.045437954426022914], ["Peripheral Device Discovery", 0.02103010934938396], ["Modify Authentication Process", 0.01820367768762899], ["Pre-OS Boot", 0.015088546271917745]], "optimizing the brute forcing implementation": [["Brute Force", 0.5348202286685584], ["Steal or Forge Kerberos Tickets", 0.038922448274617306], ["Multi-Factor Authentication Interception", 0.037244942518995135], ["Use Alternate Authentication Material", 0.019365738444023943], ["Modify Authentication Process", 0.013013529168223782], ["Execution Guardrails", 0.010883955752733272]], "Code for the brute forcing implementation is significantly more structured": [["Brute Force", 0.4751668371239894], ["Multi-Factor Authentication Interception", 0.03969608294267252], ["Steal or Forge Kerberos Tickets", 0.03064467125900205], ["Obfuscated Files or Information", 0.028790561047286202], ["Use Alternate Authentication Material", 0.019897253649712413], ["Modify Authentication Process", 0.014965470068287082]], "added to support the Telnet brute force.": [["Brute Force", 0.39736203255301666], ["Steal or Forge Kerberos Tickets", 0.04987457342973449], ["Multi-Factor Authentication Interception", 0.03606138328878311], ["Modify Authentication Process", 0.029297443736506695], ["Use Alternate Authentication Material", 0.02315624357005496], ["Encrypted Channel", 0.022085087923529045]], "Restart Telnet brute forcing": [["Brute Force", 0.45136475159066286], ["Steal or Forge Kerberos Tickets", 0.054896969666916706], ["Multi-Factor Authentication Interception", 0.024687686482927927], ["Endpoint Denial of Service", 0.02075226896641782], ["Use Alternate Authentication Material", 0.020352292159885488], ["Modify Authentication Process", 0.02033002205026138]], "SSH brute forcing code with the more usual Telnet equivalent.": [["Brute Force", 0.5407229554669915], ["Steal or Forge Kerberos Tickets", 0.03660101983220068], ["Modify Authentication Process", 0.03537905518147468], ["Use Alternate Authentication Material", 0.022620367129085422], ["Multi-Factor Authentication Interception", 0.020762860435628593], ["Remote Services", 0.019912481653415838]], "The Telnet brute forcing code is designed primarily for self-propagation": [["Brute Force", 0.4318294490775488], ["Steal or Forge Kerberos Tickets", 0.048078557003179694], ["Multi-Factor Authentication Interception", 0.03997901294933723], ["Adversary-in-the-Middle", 0.02696436091209587], ["Encrypted Channel", 0.021023309062213284], ["Use Alternate Authentication Material", 0.019367168797883836]], "SSH brute-forcing campaign,": [["Brute Force", 0.5548398365507526], ["Modify Authentication Process", 0.056251554647347886], ["Steal or Forge Kerberos Tickets", 0.03034367779997503], ["Use Alternate Authentication Material", 0.026108849466980114], ["Remote Services", 0.021491460899487707], ["Multi-Factor Authentication Interception", 0.020923739945627184]], "This allows it to download and deploy": [["Ingress Tool Transfer", 0.45087753148904947], ["BITS Jobs", 0.05583861211833305], ["Command and Scripting Interpreter", 0.05276657158641591], ["System Binary Proxy Execution", 0.030717083600086174], ["Stage Capabilities", 0.028246978034765422], ["Web Service", 0.016553315772939302]], "are downloaded and executed in the victim's system": [["Ingress Tool Transfer", 0.6062683247349694], ["Command and Scripting Interpreter", 0.03847793305367035], ["BITS Jobs", 0.02299228368962389], ["Data from Local System", 0.01997762632214276], ["System Binary Proxy Execution", 0.012501226768902262], ["Automated Collection", 0.012049059899570383]], "downloader to the compromised device that executes and downloads the primary payload.": [["Ingress Tool Transfer", 0.5241124988114048], ["BITS Jobs", 0.06469390468747019], ["Command and Scripting Interpreter", 0.05824936371013246], ["System Binary Proxy Execution", 0.015163661807117052], ["Data from Removable Media", 0.014746242539951424], ["Replication Through Removable Media", 0.014617880521064051]], "then downloads its payload via software installed on the compromised device, such as ftpget, wget, curl, or tftp, before executing the payload.": [["Ingress Tool Transfer", 0.46448289196650067], ["Command and Scripting Interpreter", 0.10058225757708629], ["BITS Jobs", 0.056351468096932394], ["System Binary Proxy Execution", 0.014156168612127259], ["Replication Through Removable Media", 0.01315047788464591], ["Application Layer Protocol", 0.011743050650316613]], "It uses the cpuinfo Python module to retrieve information about the CPU.": [["System Information Discovery", 0.6125159242939466], ["Virtualization/Sandbox Evasion", 0.07764977519727563], ["Windows Management Instrumentation", 0.03308562309474706], ["Software Discovery", 0.03130633226899961], ["Process Discovery", 0.01984715864879931], ["Native API", 0.010243443671236478]], "This code checks if the disk size is greater than a specified threshold (50 GB as example).": [["Virtualization/Sandbox Evasion", 0.23228496821292202], ["System Information Discovery", 0.1355947541447867], ["File and Directory Discovery", 0.10657665894407739], ["Peripheral Device Discovery", 0.0304996279156244], ["Automated Collection", 0.02471398249601696], ["Obfuscated Files or Information", 0.02468710348336027]], "uses the win32api.GetDiskFreeSpaceEx() function to retrieve the disk size in bytes": [["System Information Discovery", 0.33427045461136], ["File and Directory Discovery", 0.1506029119843212], ["Virtualization/Sandbox Evasion", 0.046920043449206424], ["Peripheral Device Discovery", 0.034141649594700924], ["Native API", 0.032290022970835726], ["Obfuscated Files or Information", 0.020636747228686476]], "Reflective PE injection": [["Process Injection", 0.20386548985192568], ["Domain Policy Modification", 0.041473254538800845], ["Subvert Trust Controls", 0.035720223511774146], ["Event Triggered Execution", 0.026817551936541253], ["Exploitation for Credential Access", 0.023771123044301595], ["Obtain Capabilities", 0.02146850766152541]], "Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk": [["Process Injection", 0.8153763232727507], ["Hijack Execution Flow", 0.014830592793239597], ["Native API", 0.01352029437410927], ["Event Triggered Execution", 0.0080700853109874], ["Shared Modules", 0.007154403864145345], ["Modify System Image", 0.006065841245574499]], "reflective PE injection allows the malware to load and execute its code directly from memory": [["Process Injection", 0.49830556572209], ["Shared Modules", 0.059055941517200235], ["Hijack Execution Flow", 0.05384625058099338], ["Native API", 0.03510149901333791], ["System Binary Proxy Execution", 0.0318438791755103], ["Event Triggered Execution", 0.02493325328819601]], "In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process\u2019s memory.": [["Process Injection", 0.45032646977270113], ["Native API", 0.04405281433470267], ["OS Credential Dumping", 0.03661811948088505], ["Hijack Execution Flow", 0.02008855179182736], ["Access Token Manipulation", 0.016124132377662716], ["Event Triggered Execution", 0.01593821899395183]], "-ReflectivePEInjection\u201d that facilitates reflective PE injection using PowerShell.": [["Process Injection", 0.28238631291939914], ["Command and Scripting Interpreter", 0.04519985237452123], ["Native API", 0.03787992768675895], ["Domain Policy Modification", 0.03512265187733447], ["Event Triggered Execution", 0.03078092088445774], ["Access Token Manipulation", 0.021762699808212282]], "This module allows the injection of a PE file into a remote or local process\u2019s memory without writing it to disk": [["Process Injection", 0.6122988912930306], ["Native API", 0.031155379746531646], ["Event Triggered Execution", 0.016633277628988988], ["Create or Modify System Process", 0.012683440767586013], ["Boot or Logon Autostart Execution", 0.012202100601322992], ["Pre-OS Boot", 0.01178109834820406]], "Once the PE file is injected and reconstructed in memory, the execution flow can be redirected to the injected code, enabling the malware to operate within the context of the compromised process.": [["Process Injection", 0.552680809765874], ["Native API", 0.04407476372405799], ["Event Triggered Execution", 0.024941716639838952], ["Access Token Manipulation", 0.019819033806541913], ["Hijack Execution Flow", 0.01837351872382926], ["System Binary Proxy Execution", 0.014502367966501095]], "PE reflective injection.": [["Process Injection", 0.23692847657044247], ["Subvert Trust Controls", 0.03186356366764922], ["Domain Policy Modification", 0.029176731501271643], ["Execution Guardrails", 0.027491324039324673], ["Exploitation for Credential Access", 0.024841599583335348], ["Event Triggered Execution", 0.024072330668118015]], "The PE file is downloaded on filesystem and than executed.": [["Unsecured Credentials", 0.09404593097151308], ["OS Credential Dumping", 0.08014733986574261], ["Command and Scripting Interpreter", 0.03601942385881567], ["Ingress Tool Transfer", 0.0331117331426078], ["Native API", 0.02596608440620824], ["Access Token Manipulation", 0.024395163189946677]], "uses the DownloadFile method of the WebClient object to download the file from the specified URL and save it to the specified local file path.": [["Ingress Tool Transfer", 0.5521817783036691], ["Command and Scripting Interpreter", 0.025525825012873544], ["Data from Local System", 0.02346661600700565], ["Application Layer Protocol", 0.020413908028520264], ["Credentials from Password Stores", 0.017431598058495333], ["Data Staged", 0.015485151631660391]], "the file to be downloaded.": [["Ingress Tool Transfer", 0.5853303901005222], ["Command and Scripting Interpreter", 0.022086548973904527], ["BITS Jobs", 0.021165832766582484], ["Data from Local System", 0.019448120056711714], ["Archive Collected Data", 0.01370870045768402], ["Data Staged", 0.012553778229569393]], "script that downloads a file from a fixed location and executes it.": [["Ingress Tool Transfer", 0.5434725916880239], ["Command and Scripting Interpreter", 0.16864575670822002], ["System Binary Proxy Execution", 0.023355636522618684], ["Native API", 0.01896659294048527], ["Data Staged", 0.013824010504117589], ["Scheduled Task/Job", 0.012621867378748037]], "PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file:": [["Ingress Tool Transfer", 0.356059888032539], ["Command and Scripting Interpreter", 0.27967353224099883], ["System Binary Proxy Execution", 0.11742028473494272], ["BITS Jobs", 0.018612579771842486], ["Native API", 0.01560841149056948], ["Masquerading", 0.015463997109185702]], "using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell.": [["Ingress Tool Transfer", 0.3650138407218664], ["Command and Scripting Interpreter", 0.09830737839444904], ["System Binary Proxy Execution", 0.059744221744774326], ["BITS Jobs", 0.045906204678059954], ["Masquerading", 0.021994913579688857], ["Web Service", 0.01640114229310341]], "simple stager download of an .exe file and its execution.": [["Ingress Tool Transfer", 0.2576459594399477], ["System Binary Proxy Execution", 0.134215909173105], ["Command and Scripting Interpreter", 0.08216477198462856], ["Native API", 0.06013655375806318], ["BITS Jobs", 0.04823690000359508], ["Masquerading", 0.03396847947929917]], "This line uses the ShellExecute method of the Shell.Application object to execute the downloaded file.": [["Ingress Tool Transfer", 0.45342273675492223], ["Command and Scripting Interpreter", 0.13776264733194324], ["System Binary Proxy Execution", 0.09389158782195892], ["Native API", 0.04181322347701048], ["BITS Jobs", 0.02489784347044172], ["Masquerading", 0.023594403910819472]], "The Shell.Application object provides methods for working with the Windows shell": [["Native API", 0.347840388797009], ["Command and Scripting Interpreter", 0.09585512349811313], ["Application Window Discovery", 0.052697866528467426], ["Process Injection", 0.04679336843624044], ["Event Triggered Execution", 0.03997987217399928], ["Masquerading", 0.037982645258190624]], "This decryption process utilizes the Fernet algorithm": [["Deobfuscate/Decode Files or Information", 0.6507986056102014], ["Data Encrypted for Impact", 0.06035860275572735], ["Encrypted Channel", 0.046110415272362766], ["Obfuscated Files or Information", 0.04454143353279712], ["Archive Collected Data", 0.04150683351675184], ["Weaken Encryption", 0.020421280833494704]], "The script will download and decrypt the string that represents the token": [["Deobfuscate/Decode Files or Information", 0.2268538939946756], ["Unsecured Credentials", 0.0642949068620656], ["Obfuscated Files or Information", 0.06075096529562581], ["Access Token Manipulation", 0.055212192474499495], ["Multi-Factor Authentication Interception", 0.04054606155539525], ["Data Encoding", 0.03318917409928499]], "The fernet_decrypt function decrypts an encrypted string": [["Deobfuscate/Decode Files or Information", 0.6126225659416314], ["Obfuscated Files or Information", 0.10549536563008874], ["Encrypted Channel", 0.04955815344669171], ["Data Encrypted for Impact", 0.04402780156502984], ["Archive Collected Data", 0.03651000664007598], ["Weaken Encryption", 0.021563175647010942]], "It returns the decrypted message as a decoded string.": [["Deobfuscate/Decode Files or Information", 0.6853125592248204], ["Data Encoding", 0.046649835443721546], ["Encrypted Channel", 0.04609667658774938], ["Obfuscated Files or Information", 0.03254341156592558], ["Archive Collected Data", 0.02546802699629255], ["Data Encrypted for Impact", 0.013401619489984185]], "it use the harcoded password for decryption using the fernet_decrypt function, and returns the decrypted AUTH Token.": [["Deobfuscate/Decode Files or Information", 0.2077974538819035], ["Unsecured Credentials", 0.11639288185830733], ["OS Credential Dumping", 0.08622671774883382], ["Credentials from Password Stores", 0.05974592263066994], ["Brute Force", 0.042958161634417416], ["Steal or Forge Kerberos Tickets", 0.03457408893365062]], "the file will be deleted": [["Indicator Removal", 0.6417713595535958], ["Data Destruction", 0.12482268626827865], ["Inhibit System Recovery", 0.015203589658719966], ["Archive Collected Data", 0.01159255398903168], ["Data Staged", 0.011181921634140302], ["Disk Wipe", 0.010206348863133263]], "access to system APIs,": [["Native API", 0.24594328540683486], ["Cloud Service Dashboard", 0.05694303833423319], ["Web Service", 0.02383418654644487], ["Hijack Execution Flow", 0.019938236978033767], ["Windows Management Instrumentation", 0.018068493414929655], ["Data from Local System", 0.01587033118273246]], "It uses the win32api.GetDiskFreeSpaceEx() function": [["File and Directory Discovery", 0.3013822344364792], ["System Information Discovery", 0.101842681518041], ["Native API", 0.06304635640445735], ["Hide Artifacts", 0.05265208790706918], ["Virtualization/Sandbox Evasion", 0.03389355201060041], ["Query Registry", 0.02116091222187008]], "Fernet is a symmetric encryption algorithm and token format used for secure communication and data protection": [["Encrypted Channel", 0.2041021126696207], ["Obfuscated Files or Information", 0.1415818830489845], ["Multi-Factor Authentication Interception", 0.044354268374515476], ["Exfiltration Over Alternative Protocol", 0.038303754598880704], ["Data Encrypted for Impact", 0.03747194052162844], ["Weaken Encryption", 0.03672688759913548]], "It utilizes symmetric key cryptography, where the same secret key is used for both encryption and decryption": [["Deobfuscate/Decode Files or Information", 0.20520880102019362], ["Data Encrypted for Impact", 0.1364059185617816], ["Encrypted Channel", 0.11195078984637613], ["Weaken Encryption", 0.09156092972635936], ["Obfuscated Files or Information", 0.07833992412022484], ["Archive Collected Data", 0.06008882925179381]], "this code comparing the local IP address with a predefined list of network addresses": [["System Network Configuration Discovery", 0.6284269743790049], ["Remote System Discovery", 0.09172915856505162], ["System Network Connections Discovery", 0.043073755531248654], ["Network Service Discovery", 0.018680558604569138], ["System Location Discovery", 0.015616192613555341], ["Active Scanning", 0.013650468216073639]], "obfuscation mechanisms during the compilation process.": [["Obfuscated Files or Information", 0.8117672576827003], ["Deobfuscate/Decode Files or Information", 0.04735495826383843], ["Execution Guardrails", 0.011092115228419686], ["Masquerading", 0.008403763429627556], ["Data Obfuscation", 0.008038126669063103], ["Hijack Execution Flow", 0.005969439581082421]], "the injected code": [["Process Injection", 0.08675979765095028], ["Exploit Public-Facing Application", 0.055344714774691196], ["Obfuscated Files or Information", 0.05311175146516203], ["Template Injection", 0.03234852609895622], ["Exploitation for Client Execution", 0.0315014287424765], ["Drive-by Compromise", 0.02582659282412243]], "the local disk volumes to be encrypted are also configured in a similar manner.": [["Data Encrypted for Impact", 0.21314085436277902], ["Obfuscated Files or Information", 0.0795375627027741], ["Weaken Encryption", 0.06858303401139125], ["Archive Collected Data", 0.06771587435967664], ["Service Stop", 0.06292694322008799], ["Execution Guardrails", 0.05265899221901884]], "In addition to file encryption and obfuscation,": [["Obfuscated Files or Information", 0.32800338858863426], ["Data Encrypted for Impact", 0.15107150812822628], ["Archive Collected Data", 0.14986447607624545], ["Deobfuscate/Decode Files or Information", 0.04099840675140185], ["Hide Artifacts", 0.0312148182893123], ["Service Stop", 0.023579997646225932]], "(crawl whole tree), I:, H:, G:, F:, E:, and D:.": [["File and Directory Discovery", 0.36927853629215285], ["Automated Collection", 0.07184842481540667], ["Data from Local System", 0.026604979473656695], ["Data from Information Repositories", 0.022856346193679492], ["Remote System Discovery", 0.021225619844837836], ["Data Staged", 0.01725614305759736]], "malware will attempt to gather specific, sensitive information from targeted systems.": [["Gather Victim Network Information", 0.07161833726667444], ["Gather Victim Host Information", 0.060889373424679524], ["Gather Victim Identity Information", 0.06073117488376326], ["Email Collection", 0.052202675115474745], ["Automated Collection", 0.04305921382264291], ["Active Scanning", 0.04168952652822736]], "the dropper is distributed in the form of a UPX-packed DLL": [["Hijack Execution Flow", 0.20058765773886342], ["System Binary Proxy Execution", 0.1282102644033195], ["Process Injection", 0.0942977177832299], ["Shared Modules", 0.04941473999595406], ["Masquerading", 0.035293370792469754], ["Obfuscated Files or Information", 0.029425859962092616]], "The malware then abuses the MSDTC service, manipulating the permissions and startup parameters.": [["Abuse Elevation Control Mechanism", 0.11954690874621897], ["Boot or Logon Autostart Execution", 0.10305667417304129], ["File and Directory Permissions Modification", 0.08730319943536327], ["Create or Modify System Process", 0.07513593428447524], ["Event Triggered Execution", 0.07093374661428738], ["System Binary Proxy Execution", 0.061530684895514]], "its abuse of the legitimate MSDTC service,": [["Inter-Process Communication", 0.1318300376737359], ["Masquerading", 0.08842649491509806], ["System Binary Proxy Execution", 0.03320320191493403], ["Web Service", 0.028405581100203907], ["OS Credential Dumping", 0.02226015186722453], ["Steal or Forge Kerberos Tickets", 0.018037994462527327]], "malicious oci.dll into the service\u2019s executable": [["Hijack Execution Flow", 0.2527138983847287], ["System Services", 0.17319515415501321], ["Create or Modify System Process", 0.1478166017082776], ["Process Injection", 0.06604541294963359], ["System Binary Proxy Execution", 0.05728969391493952], ["Masquerading", 0.05258130985838785]], "its attempts to steal credentials and browser data.": [["Credentials from Password Stores", 0.37526067661044105], ["Browser Session Hijacking", 0.1391783094467762], ["Browser Extensions", 0.03780508739915032], ["Browser Bookmark Discovery", 0.033128951149459594], ["Steal Web Session Cookie", 0.031797595458015936], ["Unsecured Credentials", 0.02176888373178676]], "This includes browser session and credential data.": [["Credentials from Password Stores", 0.24969272478154148], ["Browser Bookmark Discovery", 0.14634771784242515], ["Browser Session Hijacking", 0.07272713961341931], ["Steal Web Session Cookie", 0.04843577920582698], ["Unsecured Credentials", 0.04113779352058462], ["Data from Local System", 0.029822993671467905]], "Credential and Browser Data Theft": [["Credentials from Password Stores", 0.5630541661897978], ["Browser Session Hijacking", 0.06697029470205575], ["Steal Web Session Cookie", 0.02350869061447345], ["Browser Bookmark Discovery", 0.02038676154496802], ["Unsecured Credentials", 0.018977844870882207], ["Browser Extensions", 0.01869465164070798]], "It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)": [["Software Discovery", 0.3026670209534166], ["Process Discovery", 0.19654787771681728], ["Virtualization/Sandbox Evasion", 0.10351250056481678], ["Impair Defenses", 0.07661507238462824], ["System Service Discovery", 0.03903243675515897], ["Windows Management Instrumentation", 0.02793852014989369]], "It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)": [["Virtualization/Sandbox Evasion", 0.2774504666031748], ["Software Discovery", 0.1113482539703788], ["System Information Discovery", 0.06212389169491801], ["Peripheral Device Discovery", 0.058809554386537864], ["Query Registry", 0.036287122084828156], ["Windows Management Instrumentation", 0.034845635332238466]], "It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)": [["Software Discovery", 0.2418068272504802], ["System Service Discovery", 0.17674079951145727], ["Virtualization/Sandbox Evasion", 0.07107596267836488], ["Network Service Discovery", 0.042801105357525356], ["Query Registry", 0.04106274184493908], ["Impair Defenses", 0.037496677685547944]], "Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.": [["Dynamic Resolution", 0.25282284793385845], ["Application Layer Protocol", 0.08599037402704714], ["System Network Configuration Discovery", 0.04585808743429756], ["Acquire Infrastructure", 0.03192091867885516], ["Data Encoding", 0.03124204937460709], ["Masquerading", 0.024603170999189426]], "DeleteFile": [["Indicator Removal", 0.6432138831005488], ["Data Destruction", 0.1721339023716349], ["Disk Wipe", 0.025659183623147053], ["Inhibit System Recovery", 0.012522023567394586], ["System Shutdown/Reboot", 0.01026025860696259], ["Data Encrypted for Impact", 0.005665183743386685]], "deleting files": [["Indicator Removal", 0.6922902638768571], ["Data Destruction", 0.1206837518937372], ["Disk Wipe", 0.022438534951292777], ["Inhibit System Recovery", 0.016566889961124223], ["System Shutdown/Reboot", 0.011646033308930038], ["File and Directory Discovery", 0.0065321377650279285]], "ReadRegistryValue": [["Query Registry", 0.2034705121116708], ["Modify Registry", 0.06378720908465484], ["Deobfuscate/Decode Files or Information", 0.04639631098840998], ["OS Credential Dumping", 0.0372713855257063], ["System Binary Proxy Execution", 0.03184373775868158], ["Event Triggered Execution", 0.027021181390185573]], "GetRegistrySubKeyAndValueNames": [["Query Registry", 0.14223749028468266], ["Unsecured Credentials", 0.13828846703620104], ["Input Capture", 0.10930712735702486], ["OS Credential Dumping", 0.07453496978354092], ["Deobfuscate/Decode Files or Information", 0.040307525863615024], ["Native API", 0.0389816047714718]], "enumerate files and registry keys": [["Query Registry", 0.5481240114525603], ["Modify Registry", 0.09306848701004337], ["File and Directory Discovery", 0.060490217918153476], ["Indicator Removal", 0.03223835672542917], ["Boot or Logon Autostart Execution", 0.02590753230206552], ["Software Discovery", 0.017026871342611306]], "The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography": [["Query Registry", 0.4933805098189488], ["Modify Registry", 0.20152144500234867], ["Boot or Logon Autostart Execution", 0.029814438818122947], ["Unsecured Credentials", 0.02534825597981363], ["OS Credential Dumping", 0.022782049426875332], ["Windows Management Instrumentation", 0.01615896711509585]], "DeleteRegistryValue": [["Indicator Removal", 0.4379098956015247], ["Data Destruction", 0.11617768766281096], ["Inhibit System Recovery", 0.06612114632122346], ["Modify Registry", 0.04264829779049778], ["Disk Wipe", 0.028788669646143194], ["System Shutdown/Reboot", 0.02785094933359807]], "SetRegistryValue": [["Modify Registry", 0.2990926425215863], ["Boot or Logon Autostart Execution", 0.05981524241598594], ["Query Registry", 0.05645871930369219], ["Event Triggered Execution", 0.04780890505585044], ["Create or Modify System Process", 0.04437922719999396], ["Domain Policy Modification", 0.025749596848532598]], "manipulating of registry keys": [["Modify Registry", 0.5869641487389989], ["Boot or Logon Autostart Execution", 0.11464187767025694], ["Query Registry", 0.1099699760878279], ["Domain Policy Modification", 0.011735050725588697], ["Office Application Startup", 0.011344669566147294], ["Boot or Logon Initialization Scripts", 0.010484578333685194]], "GetProcessByDescription": [["Native API", 0.4124738672045844], ["Process Discovery", 0.11348953804721201], ["Windows Management Instrumentation", 0.058493760580443616], ["Process Injection", 0.055918412922410655], ["System Information Discovery", 0.04811213837807999], ["Application Window Discovery", 0.03754653436307791]], "enumerate processes": [["Process Discovery", 0.8487055692769226], ["Native API", 0.02088763053724453], ["Process Injection", 0.013301210361274955], ["System Service Discovery", 0.013093375785926792], ["Windows Management Instrumentation", 0.009567414814196406], ["Software Discovery", 0.007383757275723083]], "The command CollectSystemDescription retrieves the following information:\n\nLocal Computer Domain name\nAdministrator Account SID\nHostName": [["System Information Discovery", 0.29455615478474617], ["System Owner/User Discovery", 0.1834772552799524], ["Account Discovery", 0.09229120296052523], ["Remote System Discovery", 0.07376539433861708], ["Permission Groups Discovery", 0.061002753856093474], ["System Network Configuration Discovery", 0.03679962456075976]], "OS Version": [["System Information Discovery", 0.5962389190176433], ["Modify System Image", 0.03700249309079024], ["Software Discovery", 0.03596594249855746], ["Windows Management Instrumentation", 0.023466947960087223], ["Virtualization/Sandbox Evasion", 0.01554845787841196], ["Query Registry", 0.012130413527415135]], "The domain name of the device": [["System Network Configuration Discovery", 0.39716063871808394], ["System Information Discovery", 0.1326534975354492], ["Dynamic Resolution", 0.02881586878783858], ["Remote System Discovery", 0.027850824366221], ["Data from Configuration Repository", 0.025291280670606434], ["Gather Victim Host Information", 0.017063801747239333]], "System Directory": [["File and Directory Discovery", 0.2213251925848244], ["Data Staged", 0.10706861602641633], ["Indicator Removal", 0.06496187402395028], ["Hide Artifacts", 0.047243906841880824], ["Masquerading", 0.045297993258433644], ["Data from Local System", 0.045158324530301316]], "To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration": [["Remote System Discovery", 0.12796440927186992], ["Masquerading", 0.10221298834070537], ["Domain Trust Discovery", 0.051550989007931376], ["Permission Groups Discovery", 0.03942697054654804], ["Domain Policy Modification", 0.03429262482684099], ["Account Discovery", 0.029551124216481966]], "schtasks /create /F /tn \u201c\\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager\u201d /tr \u201cC:\\Windows\\SoftwareDistribution\\EventCacheManager.exe\u201d /sc ONSTART /ru system /": [["Indicator Removal", 0.10298054791801191], ["Scheduled Task/Job", 0.08846034382013773], ["Boot or Logon Autostart Execution", 0.0775817339733474], ["Event Triggered Execution", 0.06697313344435206], ["Query Registry", 0.04708953913459537], ["Create or Modify System Process", 0.0374642858525709]], "With Rundll32,": [["System Binary Proxy Execution", 0.4798350581181103], ["Native API", 0.19523109777395206], ["System Services", 0.04633623688703747], ["Command and Scripting Interpreter", 0.02787959964903952], ["Hijack Execution Flow", 0.02062525779846218], ["Event Triggered Execution", 0.018558931169409893]], "collect and upload information about the device": [["Peripheral Device Discovery", 0.23483999593752056], ["System Information Discovery", 0.21278932014001958], ["Data from Configuration Repository", 0.06952017466020553], ["Automated Collection", 0.049516589603997296], ["System Network Configuration Discovery", 0.026521244690106305], ["Data from Removable Media", 0.018389484166486114]], "to report some basic information about the compromised system": [["System Information Discovery", 0.22111344482643297], ["Gather Victim Host Information", 0.08115082189284337], ["Software Discovery", 0.07508604493760819], ["Active Scanning", 0.03751894743176454], ["Windows Management Instrumentation", 0.03211078097511651], ["Automated Collection", 0.026925430152336907]], "the ability to log keystrokes": [["Input Capture", 0.9000371929604977], ["Clipboard Data", 0.00522294834009781], ["Screen Capture", 0.004357050977199614], ["Credentials from Password Stores", 0.0039346135713945124], ["Unsecured Credentials", 0.0032975932213360776], ["Boot or Logon Autostart Execution", 0.002946287797888457]], "capture screenshots,": [["Screen Capture", 0.8635486665949497], ["Video Capture", 0.026289654415393066], ["Application Window Discovery", 0.009263123242813821], ["Input Capture", 0.00901842283892094], ["Clipboard Data", 0.0043268009970105605], ["Data from Local System", 0.004264952705374887]], "\u201cThe reconnaissance data is exfiltrated to the attacker-controlled server through an HTTP POST request": [["Exfiltration Over C2 Channel", 0.33639678890787394], ["Exfiltration Over Alternative Protocol", 0.1232400949431451], ["Archive Collected Data", 0.042355157844657376], ["Automated Exfiltration", 0.04118454860919355], ["Application Layer Protocol", 0.03376633426836919], ["Data Encoding", 0.02667373037509593]], "the attacker-controlled server through an HTTP POST request": [["Application Layer Protocol", 0.3439008658282833], ["Exfiltration Over C2 Channel", 0.04289420330843569], ["Data Encoding", 0.028878747543523795], ["Exploit Public-Facing Application", 0.028638317503289115], ["Data Obfuscation", 0.026841859214733872], ["Use Alternate Authentication Material", 0.02206580307577846]], "send phishing emails with malicious HTML attachments": [["Phishing", 0.46149447196151683], ["User Execution", 0.2800427243334256], ["Phishing for Information", 0.050799128712072324], ["Internal Spearphishing", 0.02805219858944997], ["Defacement", 0.010142217666718184], ["Template Injection", 0.007866624861278204]], "collecting system information such as hostnames": [["System Information Discovery", 0.5725025202498508], ["Remote System Discovery", 0.10988208781515077], ["System Network Configuration Discovery", 0.05845459058831789], ["Windows Management Instrumentation", 0.02255152875308527], ["System Network Connections Discovery", 0.01774174980696225], ["Virtualization/Sandbox Evasion", 0.017456983985557322]], "OS version information": [["System Information Discovery", 0.8177880220228422], ["Software Discovery", 0.028145559167078192], ["Windows Management Instrumentation", 0.015961624192556086], ["Virtualization/Sandbox Evasion", 0.011646414534195926], ["Query Registry", 0.010819653414273473], ["Modify System Image", 0.009160863403308761]], "insights on anti-virus software present on the machine": [["Software Discovery", 0.8801269623301682], ["System Information Discovery", 0.009994720597961746], ["Windows Management Instrumentation", 0.009191055003008507], ["Impair Defenses", 0.0087565109578727], ["Obfuscated Files or Information", 0.00568193695330493], ["Query Registry", 0.00501694169369759]], "downloading and executing two other PowerShell scripts from a different attacker-controlled server": [["Ingress Tool Transfer", 0.39687969671228845], ["Command and Scripting Interpreter", 0.2877017243149302], ["System Binary Proxy Execution", 0.020953149000646612], ["Multi-Stage Channels", 0.0199133094374901], ["Inter-Process Communication", 0.017201788217074895], ["System Services", 0.015346006619480837]], "IPv4 addresses": [["Dynamic Resolution", 0.1721905435706606], ["System Network Configuration Discovery", 0.14903336963559796], ["Adversary-in-the-Middle", 0.04029949776304701], ["Gather Victim Network Information", 0.03922901179752219], ["Active Scanning", 0.03731850789918421], ["System Location Discovery", 0.032883167024069786]], "\u201cThe banking trojan targets the victim\u2019s sensitive information": [["Browser Session Hijacking", 0.17049431733437506], ["Phishing for Information", 0.03042763923352101], ["Subvert Trust Controls", 0.0252111166480525], ["Obtain Capabilities", 0.02027624821870647], ["Internal Spearphishing", 0.01921940490314254], ["Data Manipulation", 0.01915155412484]], "Once user credentials have been compromised, this tool takes \u201cfull control\u201d of the account": [["Valid Accounts", 0.17068973002897536], ["Modify Authentication Process", 0.1313549338912359], ["Account Access Removal", 0.11546460252872374], ["Account Manipulation", 0.08349698835193363], ["Create Account", 0.05573773185171565], ["Brute Force", 0.03160810921468922]], "\u201cWhen a victim opens the HTML file attachment, an embedded URL is launched in the victim\u2019s browser, redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance": [["User Execution", 0.5298546658281074], ["Phishing", 0.12474511787763383], ["Template Injection", 0.03890945313211734], ["Stage Capabilities", 0.034153230000195205], ["Browser Session Hijacking", 0.02117929367832494], ["Ingress Tool Transfer", 0.01490346410062466]], "Identify processes": [["Process Discovery", 0.790357625864895], ["Native API", 0.03207144046159074], ["Process Injection", 0.021825782114638065], ["System Service Discovery", 0.01526919690256691], ["Windows Management Instrumentation", 0.010630346014422922], ["Impair Defenses", 0.010004329597658975]], "Logged Processes": [["Process Discovery", 0.6408099932785115], ["Impair Defenses", 0.04280694594884459], ["Access Token Manipulation", 0.0298000953749653], ["Process Injection", 0.027926507122681122], ["Native API", 0.015664837126238465], ["Windows Management Instrumentation", 0.013705778756320069]], "Identify processes related to backups, antivirus/anti-spyware,": [["Process Discovery", 0.425354980367064], ["Software Discovery", 0.05047903656178865], ["Impair Defenses", 0.04482394306808788], ["System Service Discovery", 0.03838212978306355], ["Service Stop", 0.033672331334205684], ["File and Directory Discovery", 0.032776990780601166]], "actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments": [["Phishing", 0.38379782592756845], ["Compromise Accounts", 0.10561590960574396], ["User Execution", 0.07359920402341143], ["Establish Accounts", 0.052907762104511556], ["Internal Spearphishing", 0.040931006943874325], ["Phishing for Information", 0.03482000432623672]], "by exploiting the following vulnerabilities against Microsoft Exchange servers": [["Email Collection", 0.15788966912381314], ["Exploitation for Client Execution", 0.11907377848294896], ["Phishing", 0.05411845256110344], ["Application Layer Protocol", 0.034494107859938186], ["Exploit Public-Facing Application", 0.03418240055712181], ["Compromise Infrastructure", 0.030259764403780157]], "removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry": [["Impair Defenses", 0.2965290372270999], ["Modify Registry", 0.12472990280972245], ["Software Discovery", 0.08517466578015652], ["Indicator Removal", 0.07592148578100191], ["Query Registry", 0.035736648349004314], ["Inhibit System Recovery", 0.025521133434089027]], "Microsoft Windows Defender AntiVirus Protection disabled": [["Impair Defenses", 0.3783996142563365], ["Software Discovery", 0.1933329771849169], ["Subvert Trust Controls", 0.025980044875840918], ["Windows Management Instrumentation", 0.024422424176878], ["File and Directory Permissions Modification", 0.015260065044316434], ["System Binary Proxy Execution", 0.014510805794228587]], "Microsoft Windows Defender AntiSpyware Protection disabled": [["Impair Defenses", 0.4450399347114606], ["Software Discovery", 0.14232571855957718], ["Subvert Trust Controls", 0.03127628708668354], ["Windows Management Instrumentation", 0.018821346572891116], ["File and Directory Permissions Modification", 0.01652870104042853], ["System Binary Proxy Execution", 0.013373272373021071]], "Microsoft Exchange Server Privilege Escalation Vulnerability": [["Exploitation for Privilege Escalation", 0.29971324149874423], ["Exploitation for Client Execution", 0.05573731018967789], ["Valid Accounts", 0.037946536982453406], ["Exploitation of Remote Services", 0.03674260163128453], ["Domain Policy Modification", 0.03585322337203016], ["Abuse Elevation Control Mechanism", 0.03154842165003168]], "remove all existing shadow copies via vssadmin on command line": [["Inhibit System Recovery", 0.4233191335301009], ["Indicator Removal", 0.18960134080587668], ["Data Destruction", 0.03059794649769969], ["Modify Cloud Compute Infrastructure", 0.027457866309925225], ["Hide Artifacts", 0.025852693197504526], ["Disk Wipe", 0.018584669479021144]], "This could cause the file to run when double-clicked instead of opening it with a PDF viewer.": [["User Execution", 0.3145292121323346], ["Masquerading", 0.09834276998262818], ["Office Application Startup", 0.03927004322294879], ["Phishing", 0.03458080628682467], ["Hide Artifacts", 0.032767039174424945], ["Deobfuscate/Decode Files or Information", 0.02493915062817749]], "and then downloads a second-stage backdoor from the OpenDrive cloud service.": [["Data from Removable Media", 0.05977542834485488], ["Data from Local System", 0.04907344805968844], ["Exfiltration Over Physical Medium", 0.048853902848698186], ["Exfiltration Over Web Service", 0.045849418205801455], ["Data from Network Shared Drive", 0.040861614707553215], ["Inhibit System Recovery", 0.03327286151577831]], "The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from 2014": [["Deobfuscate/Decode Files or Information", 0.5902061482234127], ["Obfuscated Files or Information", 0.0884932650511719], ["Data Encrypted for Impact", 0.07297305554305439], ["Archive Collected Data", 0.03437335458820059], ["Encrypted Channel", 0.021997388359633083], ["Weaken Encryption", 0.018240690205811535]], "uses the same type of strong encryption \u2013 AES-GCM": [["Encrypted Channel", 0.273442957254747], ["Obfuscated Files or Information", 0.1865115144199231], ["Data Encrypted for Impact", 0.0848939370817795], ["Weaken Encryption", 0.06870976356738162], ["Archive Collected Data", 0.06243955444714537], ["Deobfuscate/Decode Files or Information", 0.05140280121000512]], "creates a scheduled task on the system that provides persistence.": [["Scheduled Task/Job", 0.571215375939845], ["Create or Modify System Process", 0.06517189450955689], ["Boot or Logon Autostart Execution", 0.06436910829615254], ["Event Triggered Execution", 0.05075431145844615], ["Boot or Logon Initialization Scripts", 0.02960058275912533], ["Office Application Startup", 0.020234653237385613]], "establishes persistence by creating an autostart service that allows it to run whenever the machine boots.": [["Boot or Logon Autostart Execution", 0.26830562234317296], ["Boot or Logon Initialization Scripts", 0.15124012011738763], ["Create or Modify System Process", 0.1268958021724565], ["Event Triggered Execution", 0.09787719813518146], ["Scheduled Task/Job", 0.07099721722696956], ["Pre-OS Boot", 0.036488944605641574]], "decodes the configuration data and modules.": [["Deobfuscate/Decode Files or Information", 0.6428705083604135], ["Obfuscated Files or Information", 0.1035333707153493], ["OS Credential Dumping", 0.01661943877358584], ["Modify Registry", 0.01347837905838148], ["Data Encoding", 0.013383872122267639], ["Weaken Encryption", 0.01005653260453886]], "injects into the svchost.exe process.": [["Process Injection", 0.6366782283621883], ["System Binary Proxy Execution", 0.0560247654937163], ["Hijack Execution Flow", 0.04645094034506142], ["Native API", 0.04424022952309001], ["Masquerading", 0.027560457293481652], ["Create or Modify System Process", 0.017737915645311374]], "injects into the svchost.exe process": [["Process Injection", 0.6758701059904186], ["Native API", 0.06561844405190712], ["System Binary Proxy Execution", 0.04855368700361906], ["Hijack Execution Flow", 0.03217438604868833], ["Masquerading", 0.018242972863151734], ["System Services", 0.015307992554430164]], "malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments": [["Phishing", 0.4321948876610629], ["User Execution", 0.09233666457469222], ["Compromise Accounts", 0.0654017341816697], ["Phishing for Information", 0.035559411950932825], ["Establish Accounts", 0.03126935438008021], ["Internal Spearphishing", 0.03016172593576283]], "has used an email with an Excel sheet containing a malicious macro to deploy the malware.": [["User Execution", 0.18095710881232607], ["Phishing", 0.1728502745410235], ["Office Application Startup", 0.11945903103542221], ["Command and Scripting Interpreter", 0.04160793598328153], ["Inter-Process Communication", 0.029001177383564], ["Develop Capabilities", 0.027278091474702556]], "compromised server that prompts the victim to click": [["User Execution", 0.4551062373277513], ["Browser Session Hijacking", 0.049973949948728], ["Stage Capabilities", 0.03734333243360368], ["Server Software Component", 0.03395654997369686], ["Command and Scripting Interpreter", 0.03177483606780857], ["Drive-by Compromise", 0.019795703197454516]], "In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that": [["User Execution", 0.2360943947099139], ["Ingress Tool Transfer", 0.12968785040336187], ["Command and Scripting Interpreter", 0.04304476809184184], ["Browser Session Hijacking", 0.031340354153353345], ["Stage Capabilities", 0.029106906110423464], ["Phishing", 0.026856675113554572]], "has attempted to get users to launch malicious documents to deliver its payload.": [["User Execution", 0.5852650555740234], ["Phishing", 0.11932857620081241], ["Template Injection", 0.08121742289705429], ["Office Application Startup", 0.0247077534189451], ["Exploitation for Client Execution", 0.018707072844492138], ["Inter-Process Communication", 0.01521286756960399]], "spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol.": [["Proxy", 0.09444363057844586], ["Software Deployment Tools", 0.08745482864881236], ["Exploitation of Remote Services", 0.08477752647821571], ["Lateral Tool Transfer", 0.034153969997431796], ["Compromise Infrastructure", 0.03312415955853044], ["Remote Services", 0.031473527473461944]], "modules spread the malware laterally across a network by abusing the SMB Protocol.": [["Exploitation of Remote Services", 0.1333243609995272], ["Software Deployment Tools", 0.1024778176769986], ["Lateral Tool Transfer", 0.07804897769151016], ["Remote Services", 0.0742309282089155], ["Taint Shared Content", 0.06329442286550442], ["Proxy", 0.04135205138102753]], "data exfiltration over a hardcoded C2 server": [["Exfiltration Over C2 Channel", 0.3436779815044284], ["Scheduled Transfer", 0.11489043037990579], ["Automated Exfiltration", 0.0881360226869636], ["Exfiltration Over Alternative Protocol", 0.06516911681724263], ["Web Service", 0.018841213831150668], ["Data Staged", 0.01883231981061877]], "can send information about the compromised host to a hardcoded C2 server.": [["Exfiltration Over C2 Channel", 0.16460489241918225], ["System Owner/User Discovery", 0.10488806023715072], ["System Information Discovery", 0.08141560610014716], ["Automated Collection", 0.05654001630272116], ["Web Service", 0.041288009188480794], ["Gather Victim Host Information", 0.03313332123547347]], "uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.": [["Native API", 0.377013462178761], ["System Binary Proxy Execution", 0.1271259336717056], ["Process Injection", 0.11542458219723008], ["Hijack Execution Flow", 0.05516397648059222], ["Event Triggered Execution", 0.03197024238433917], ["System Services", 0.026936681299924017]], "by capturing the CredEnumerateA API.": [["OS Credential Dumping", 0.13569996459409356], ["System Information Discovery", 0.06813450512030673], ["System Owner/User Discovery", 0.061070445392673665], ["Native API", 0.05672106916161917], ["Automated Collection", 0.04375593903361252], ["Unsecured Credentials", 0.026021919010640365]], "leveraging Microsoft\u2019s CryptoAPI": [["Deobfuscate/Decode Files or Information", 0.15252718471908205], ["Data Encrypted for Impact", 0.1429288262333572], ["Encrypted Channel", 0.11739254932468572], ["Obfuscated Files or Information", 0.07884072405064066], ["Weaken Encryption", 0.05867797277954175], ["Archive Collected Data", 0.04365220508751877]], "uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.": [["Obfuscated Files or Information", 0.36857131936940385], ["Deobfuscate/Decode Files or Information", 0.12567382710625113], ["Encrypted Channel", 0.07379024783596809], ["Data Encrypted for Impact", 0.06717390133888003], ["Weaken Encryption", 0.05106417741434716], ["Archive Collected Data", 0.035144975805551676]], "leverages a custom packer to obfuscate its functionality.": [["Obfuscated Files or Information", 0.8417929507445889], ["Deobfuscate/Decode Files or Information", 0.029514888933360565], ["Masquerading", 0.016477616287918363], ["Data Obfuscation", 0.01171818905135847], ["Hide Artifacts", 0.009438320751078115], ["Archive Collected Data", 0.007320022152882468]], "can modify registry entries": [["Modify Registry", 0.6470026011849418], ["Boot or Logon Autostart Execution", 0.07921897748552931], ["Query Registry", 0.06548304485045461], ["Domain Policy Modification", 0.017385187803861044], ["Impair Defenses", 0.01586967045988752], ["Create or Modify System Process", 0.013418476401970887]], "can disable Windows Defender.": [["Impair Defenses", 0.47613555980566596], ["Software Discovery", 0.02799518271485098], ["Subvert Trust Controls", 0.025842961300540493], ["Masquerading", 0.0256964758796225], ["Hide Artifacts", 0.020755716609561315], ["Modify System Image", 0.020145330860106038]], "can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP.": [["Credentials from Password Stores", 0.30788355254999594], ["Unsecured Credentials", 0.2713768323000753], ["OS Credential Dumping", 0.1692208846229936], ["Brute Force", 0.042631666534380594], ["Password Policy Discovery", 0.03501042875769311], ["Input Capture", 0.017641811774541796]], "it searches for the .vnc.lnk affix to steal VNC credentials.": [["Remote Services", 0.18932923984274605], ["Unsecured Credentials", 0.11119154277167513], ["OS Credential Dumping", 0.08621127283931743], ["Input Capture", 0.05953619053779478], ["Credentials from Password Stores", 0.03506980290430382], ["Valid Accounts", 0.030349760134511905]], "can obtain passwords stored in files": [["Credentials from Password Stores", 0.2696909557104322], ["Unsecured Credentials", 0.26416521166072865], ["OS Credential Dumping", 0.17696674648918762], ["Brute Force", 0.0535635789855539], ["Password Policy Discovery", 0.03440836823146029], ["Input Capture", 0.01969543581356358]], "by querying the Software\\SimonTatham\\Putty\\Sessions registry key.": [["Remote Service Session Hijacking", 0.10860224642048645], ["Remote Services", 0.10428217367045842], ["System Owner/User Discovery", 0.07137656688828281], ["System Network Connections Discovery", 0.062150373212032685], ["Query Registry", 0.058177072267884974], ["Command and Scripting Interpreter", 0.035026223516771815]], "obtains the IP address, location, and other relevant network information from the victim\u2019s machine.": [["System Network Configuration Discovery", 0.7324675015998292], ["Remote System Discovery", 0.031217367283097656], ["System Location Discovery", 0.02422323816112956], ["Gather Victim Network Information", 0.0233863762853611], ["Data from Configuration Repository", 0.023377214178945123], ["System Network Connections Discovery", 0.023271566317862865]], "can identify the user and groups the user belongs to on a compromised host.": [["System Owner/User Discovery", 0.4400731042765459], ["Permission Groups Discovery", 0.2918423104685514], ["Account Discovery", 0.1617963147856724], ["System Information Discovery", 0.006064359056309229], ["Remote System Discovery", 0.0037759235346348603], ["Access Token Manipulation", 0.003454244111882314]], "gathers the OS version, machine name, CPU type, amount of RAM available from the victim\u2019s machine": [["System Information Discovery", 0.8923381559309032], ["Virtualization/Sandbox Evasion", 0.01916739528707028], ["Software Discovery", 0.011291536321978863], ["Windows Management Instrumentation", 0.00938087609728288], ["Query Registry", 0.004569577048266096], ["Process Discovery", 0.0042175911002753814]], "searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.": [["File and Directory Discovery", 0.3483242914704365], ["Automated Collection", 0.11007154379472994], ["Masquerading", 0.04706426379716819], ["Obfuscated Files or Information", 0.04387900904617725], ["Archive Collected Data", 0.034237062117566344], ["Data from Local System", 0.023106216934219895]], "collects local files and information from the victim\u2019s local machine.": [["Data from Local System", 0.5505032922808536], ["Data Staged", 0.07787784474409382], ["File and Directory Discovery", 0.06490662406619181], ["Automated Collection", 0.058552807300754926], ["Data from Network Shared Drive", 0.03582564849277037], ["Data from Removable Media", 0.02067950003385336]], "uses HTTPS to communicate with its C2 servers": [["Application Layer Protocol", 0.6453538588888988], ["Encrypted Channel", 0.04697118675168725], ["Data Obfuscation", 0.033730124861846324], ["Non-Standard Port", 0.0278782853629192], ["Proxy", 0.025770162673270543], ["Non-Application Layer Protocol", 0.01907000039072881]], "samples have used HTTP over ports 447 and 8082 for C2.": [["Application Layer Protocol", 0.476031818131594], ["Non-Standard Port", 0.14775749256921109], ["Non-Application Layer Protocol", 0.09442938141753728], ["Proxy", 0.04160559451283035], ["Protocol Tunneling", 0.03374586514482568], ["Encrypted Channel", 0.02406748757060432]], "downloads several additional files and saves them to the victim's machine.": [["Ingress Tool Transfer", 0.5221846071545918], ["Data from Local System", 0.0629283046119206], ["Command and Scripting Interpreter", 0.03514105337102529], ["Data Staged", 0.030051295025964087], ["Automated Collection", 0.024238600300103226], ["Exfiltration Over C2 Channel", 0.01815956182785298]], "uses a custom crypter leveraging Microsoft\u2019s CryptoAPI to encrypt C2 traffic.": [["Encrypted Channel", 0.5845167882457997], ["Data Encoding", 0.05746156115054782], ["Data Obfuscation", 0.04374815743893786], ["Exfiltration Over Alternative Protocol", 0.030940267757293867], ["Non-Application Layer Protocol", 0.029805188289894823], ["Obfuscated Files or Information", 0.0222326451184213]]}